
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="EvoTorch is an open source evolutionary computation library developed at NNAISENSE, built on top of PyTorch.">
      
      
      
      
        <link rel="prev" href="../base/">
      
      
        <link rel="next" href="../real/">
      
      
      <link rel="icon" href="../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Functional - EvoTorch</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#evotorch.operators.functional" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-header__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EvoTorch
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Functional
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../quickstart/" class="md-tabs__link">
        
  
  
    
  
  Quickstart

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../user_guide/general_usage/" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../advanced_usage/solution_batch/" class="md-tabs__link">
          
  
  
    
  
  Advanced Usage

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-nav__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EvoTorch
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/general_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/algorithm_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithm Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/algorithms_tour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms Tour
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/problems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Defining Problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/problem_parallelization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Problem Parallelization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/neuroevolution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/gym/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution for Gym
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/supervised_ne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervised Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/solution_batch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manipulating Solutions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/dist_based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributed Evolution Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/custom_ea/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Searchers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/custom_logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Loggers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/ray_cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Ray Clusters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Brax_Experiments_Visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization of the brax Experiment Results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Brax_Experiments_with_PGPE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving a Brax environment using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Evolving_Objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Feature_Space_Illumination_with_MAPElites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Space Illumination with MAPElites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Genetic_Programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic Programming using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Gym_Experiments_with_PGPE_and_CoSyNE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gym Experiments with PGPE and CoSyNE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Minimizing_Lennard-Jones_Atom_Cluster_Potentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimising Lennard-Jones Atom Cluster Potentials with Evolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Training_MNIST30K/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training MNIST30K
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Variational_Quantum_Eigensolvers_with_SNES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variational Quantum Eigensolvers with SNES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/batched_searches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maintaining a batch of populations using the functional EvoTorch API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/constrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving constrained optimization problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/func_rl_ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving objects using the functional operators API of EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/functional_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic algorithm with the help of functional operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/multiobj_batched_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multiobjective optimization via functional operators API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving reinforcement learning tasks using functional evolutionary algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/reacher_mpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Predictive Control (MPC) with EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Evotorch
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Evotorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimizers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8" id="__nav_6_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8">
            <span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/cmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ga
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/mapelites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mapelites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/pycmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pycmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/searchalgorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Searchalgorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/distributed/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Distributed
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_7" id="__nav_6_1_8_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_7">
            <span class="md-nav__icon md-icon"></span>
            Distributed
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/distributed/gaussian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/functional/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_8" id="__nav_6_1_8_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_8">
            <span class="md-nav__icon md-icon"></span>
            Functional
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcadam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcadam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funccem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funccem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcclipup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcclipup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcpgpe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcpgpe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcsgd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcsgd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/restarter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Restarter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_9" id="__nav_6_1_8_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_9">
            <span class="md-nav__icon md-icon"></span>
            Restarter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/restarter/modify_restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modify restart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/restarter/restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../neuroevolution/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9" id="__nav_6_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9">
            <span class="md-nav__icon md-icon"></span>
            Neuroevolution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/baseneproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Baseneproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/gymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/neproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/supervisedne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervisedne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/vecgymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecgymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../neuroevolution/net/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Net
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9_7" id="__nav_6_1_9_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_9_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9_7">
            <span class="md-nav__icon md-icon"></span>
            Net
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/layers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/multilayered/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multilayered
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/rl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rl
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/runningnorm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningnorm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/runningstat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningstat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/statefulmodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statefulmodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/vecrl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecrl
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_10" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_10" id="__nav_6_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1_10">
            <span class="md-nav__icon md-icon"></span>
            Operators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional" class="md-nav__link">
    <span class="md-ellipsis">
      functional
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.combine" class="md-nav__link">
    <span class="md-ellipsis">
      combine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.cosyne_permutation" class="md-nav__link">
    <span class="md-ellipsis">
      cosyne_permutation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.dominates" class="md-nav__link">
    <span class="md-ellipsis">
      dominates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.domination_counts" class="md-nav__link">
    <span class="md-ellipsis">
      domination_counts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.domination_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      domination_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.multi_point_cross_over" class="md-nav__link">
    <span class="md-ellipsis">
      multi_point_cross_over
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.one_point_cross_over" class="md-nav__link">
    <span class="md-ellipsis">
      one_point_cross_over
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.pareto_utility" class="md-nav__link">
    <span class="md-ellipsis">
      pareto_utility
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.simulated_binary_cross_over" class="md-nav__link">
    <span class="md-ellipsis">
      simulated_binary_cross_over
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.take_best" class="md-nav__link">
    <span class="md-ellipsis">
      take_best
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.tournament" class="md-nav__link">
    <span class="md-ellipsis">
      tournament
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.two_point_cross_over" class="md-nav__link">
    <span class="md-ellipsis">
      two_point_cross_over
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.utility" class="md-nav__link">
    <span class="md-ellipsis">
      utility
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../real/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Real
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sequence
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tools/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_11" id="__nav_6_1_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_11">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/cloning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/hook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/immutable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Immutable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/objectarray/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Objectarray
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/ranking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ranking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/readonlytensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Readonlytensor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/recursiveprintable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recursiveprintable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/structures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/tensorframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensorframe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/tensormaker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensormaker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional" class="md-nav__link">
    <span class="md-ellipsis">
      functional
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.combine" class="md-nav__link">
    <span class="md-ellipsis">
      combine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.cosyne_permutation" class="md-nav__link">
    <span class="md-ellipsis">
      cosyne_permutation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.dominates" class="md-nav__link">
    <span class="md-ellipsis">
      dominates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.domination_counts" class="md-nav__link">
    <span class="md-ellipsis">
      domination_counts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.domination_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      domination_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.multi_point_cross_over" class="md-nav__link">
    <span class="md-ellipsis">
      multi_point_cross_over
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.one_point_cross_over" class="md-nav__link">
    <span class="md-ellipsis">
      one_point_cross_over
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.pareto_utility" class="md-nav__link">
    <span class="md-ellipsis">
      pareto_utility
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.simulated_binary_cross_over" class="md-nav__link">
    <span class="md-ellipsis">
      simulated_binary_cross_over
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.take_best" class="md-nav__link">
    <span class="md-ellipsis">
      take_best
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.tournament" class="md-nav__link">
    <span class="md-ellipsis">
      tournament
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.two_point_cross_over" class="md-nav__link">
    <span class="md-ellipsis">
      two_point_cross_over
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.operators.functional.utility" class="md-nav__link">
    <span class="md-ellipsis">
      utility
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Functional</h1>

<div class="doc doc-object doc-module">



<a id="evotorch.operators.functional"></a>
    <div class="doc doc-contents first">

        <p>Functional implementations of the genetic algorithm operators.</p>
<p>Instead of the object-oriented genetic algorithm API
(<a class="autorefs autorefs-internal" href="../../algorithms/ga/#evotorch.algorithms.ga.GeneticAlgorithm">GeneticAlgorithm</a>), one might
wish to adopt a style that is more compatible with the functional programming
paradigm. For such cases, the functional operators within this namespace can
be used.</p>
<p>The operators within this namespace are designed to be called directly,
allowing one to implement a genetic algorithm according to which, how, and
when these operators are used.</p>
<p><strong>Reasons for using the functional operators.</strong></p>
<ul>
<li><strong>Flexibility.</strong> This API provides various genetic-algorithm-related
    operators and gets out of the picture. The user has the complete control
    over what happens between this operator calls, and in what order these
    operators are used.</li>
<li><strong>Batched search.</strong> These functional operators are designed in such a way
    that, if they receive a batched population instead of a single population
    (i.e. if they receive a 3-or-more-dimensional tensor instead of a
    2-dimensional tensor), they will broadcast their operations across the
    extra leftmost dimensions. This allows one to implement a genetic
    algorithm that works across many populations at once, in a vectorized
    manner.</li>
<li><strong>Nested optimization.</strong> It could be the case that the optimization problem
    at hand has an inner optimization problem within its fitness function.
    This inner optimization problem could be tackled with the help of a
    genetic algorithm built upon these functional operators.
    Such an approach would allow the user to run a search for each inner
    optimization problem across the entire population of the outer
    problem, in a vectorized manner (see the previous point titled
    "batched search").</li>
</ul>
<p><strong>Example usage.</strong>
Let us assume that we have the following cost function that to be minimized:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>A genetic algorithm could be designed with the help of these functional
operators as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch.operators.functional</span><span class="w"> </span><span class="kn">import</span> <span class="n">two_point_cross_over</span><span class="p">,</span> <span class="n">combine</span><span class="p">,</span> <span class="n">take_best</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="n">popsize</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># population size</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="n">solution_length</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># length of a solution</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="n">num_generations</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c1"># number of generations</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="n">mutation_stdev</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># standard deviation for mutation</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="n">tournament_size</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># size for the tournament selection</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c1"># Randomly initialize a population, and compute the solution costs</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="n">population</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">popsize</span><span class="p">,</span> <span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="n">costs</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="c1"># Initialize the variables that will store the decision values and the cost</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="c1"># for the last population&#39;s best solution.</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="n">pop_best_values</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="n">pop_best_cost</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="c1"># main loop of the optimization</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="k">for</span> <span class="n">generation</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">num_generations</span><span class="p">):</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>    <span class="c1"># Given the population and the solution costs, pick parents and apply</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>    <span class="c1"># cross-over on them.</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>    <span class="n">candidates</span> <span class="o">=</span> <span class="n">two_point_cross_over</span><span class="p">(</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>        <span class="n">population</span><span class="p">,</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>        <span class="n">costs</span><span class="p">,</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>        <span class="n">tournament_size</span><span class="o">=</span><span class="n">tournament_size</span><span class="p">,</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>        <span class="n">objective_sense</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">,</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>    <span class="p">)</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>    <span class="c1"># Apply Gaussian mutation on the candidates</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>    <span class="n">candidates</span> <span class="o">=</span> <span class="n">candidates</span> <span class="o">+</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">popsize</span><span class="p">,</span> <span class="n">solution_length</span><span class="p">)</span> <span class="o">*</span> <span class="n">mutation_stdev</span><span class="p">)</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>    <span class="c1"># Compute the solution costs of the candidates</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>    <span class="n">candidate_costs</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>    <span class="c1"># Combine the parents and the candidates into an extended population</span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>    <span class="n">extended_values</span><span class="p">,</span> <span class="n">extended_costs</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>        <span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">costs</span><span class="p">),</span>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>        <span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">candidate_costs</span><span class="p">),</span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>    <span class="p">)</span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>    <span class="c1"># Take the best `popsize` number of solutions from the extended population</span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>    <span class="n">population</span><span class="p">,</span> <span class="n">costs</span> <span class="o">=</span> <span class="n">take_best</span><span class="p">(</span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>        <span class="n">extended_values</span><span class="p">,</span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a>        <span class="n">extended_costs</span><span class="p">,</span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a>        <span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a>        <span class="n">objective_sense</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">,</span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a>    <span class="p">)</span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a>    <span class="c1"># Take the best solution and its cost</span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a>    <span class="n">pop_best_values</span><span class="p">,</span> <span class="n">pop_best_cost</span> <span class="o">=</span> <span class="n">take_best</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">costs</span><span class="p">,</span> <span class="n">objective_sense</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a>    <span class="c1"># Print the status</span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generation:&quot;</span><span class="p">,</span> <span class="n">generation</span><span class="p">,</span> <span class="s2">&quot;  Best cost within population:&quot;</span><span class="p">,</span> <span class="n">best_cost</span><span class="p">)</span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a><span class="c1"># Print the result</span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a><span class="nb">print</span><span class="p">()</span>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best solution of the last population:&quot;</span><span class="p">)</span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a><span class="nb">print</span><span class="p">(</span><span class="n">pop_best_values</span><span class="p">)</span>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cost of the best solution of the last population:&quot;</span><span class="p">)</span>
<a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a><span class="nb">print</span><span class="p">(</span><span class="n">pop_best_cost</span><span class="p">)</span>
</code></pre></div>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.combine" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">combine</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objective_sense</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.combine" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Combine two populations into one.</p>
<p><strong>Usage 1: without evaluation results.</strong>
Let us assume that we have two decision values matrices, <code>values1</code>
<code>values2</code>. The shapes of these matrices are (n1, L) and (n2, L)
respectively, where L represents the length of a solution.
Let us assume that the solutions that these decision values
represent are not evaluated yet. Therefore, we do not have evaluation
results (i.e. we do not have fitnesses). To combine these two
unevaluated populations, we use this function as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">combined_population</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">values1</span><span class="p">,</span> <span class="n">values2</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># We now have a combined decision values matrix, shaped (n1+n2, L).</span>
</code></pre></div>
<p><strong>Usage 2: with evaluation results, single-objective.</strong>
We again assume that we have two decision values matrices, <code>values1</code>
and <code>values2</code>. Like in our previous example, these matrices are shaped
(n1, L) and (n2, L), respectively. Additionally, let us assume that we
know the evaluation results for the solutions represented by <code>values1</code>
and <code>values2</code>. These evaluation results are represented by the tensors
<code>evals1</code> and <code>evals2</code>, shaped (n1,) and (n2,), respectively. To combine
these two evaluated populations, we use this function as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">c_values</span><span class="p">,</span> <span class="n">c_evals</span> <span class="o">=</span> <span class="n">combine</span><span class="p">((</span><span class="n">values1</span><span class="p">,</span> <span class="n">evals1</span><span class="p">),</span> <span class="p">(</span><span class="n">values2</span><span class="p">,</span> <span class="n">evals2</span><span class="p">))</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># We now have a combined decision values matrix and a combined evaluations</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># vector.</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c1"># `c_values` is shaped (n1+n2, L), and `c_evals` is shaped (n1+n2,).</span>
</code></pre></div>
<p><strong>Usage 3: with evaluation results, multi-objective.</strong>
We again assume that we have two decision values matrices, <code>values1</code>
and <code>values2</code>. Like in our previous example, these matrices are shaped
(n1, L) and (n2, L), respectively. Additionally, we assume that we know
the evaluation results for these solutions. The evaluation results are
stored within the tensors <code>evals1</code> and <code>evals2</code>, whose shapes are
(n1, M) and (n2, M), where M is the number of objectives. To combine
these two evaluated populations, we use this function as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">c_values</span><span class="p">,</span> <span class="n">c_evals</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="p">(</span><span class="n">values1</span><span class="p">,</span> <span class="n">evals1</span><span class="p">),</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="p">(</span><span class="n">values2</span><span class="p">,</span> <span class="n">evals2</span><span class="p">),</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="n">objective_sense</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">],</span>  <span class="c1"># Assuming we have 2 min objectives</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="p">)</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c1"># We now have a combined decision values matrix and a combined evaluations</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># vector.</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c1"># `c_values` is shaped (n1+n2, L), and `c_evals` is shaped (n1+n2,).</span>
</code></pre></div>
<p><strong>Support for ObjectArray.</strong>
This function supports decision values that are expressed via instances
of <code>ObjectArray</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>a</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="torch.Tensor">Tensor</span>, <a class="autorefs autorefs-internal" title="ObjectArray (evotorch.tools.ObjectArray)" href="../../tools/#evotorch.tools.ObjectArray">ObjectArray</a>, <span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A decision values tensor with at least 2 dimensions, or an
<code>ObjectArray</code> of decision values, or a tuple of the form
<code>(values, evals)</code> where <code>values</code> is the decision values
and <code>evals</code> is a tensor with at least 1 dimension.
Additional leftmost dimensions within tensors are interpreted
as batch dimensions.
If this positional argument is a tensor, the second positional
argument must also be a tensor.
If this positional argument is an <code>ObjectArray</code>, the second
positional argument must also be an <code>ObjectArray</code>.
If this positional argument is a tuple, the second positional
argument must also be a tuple.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="torch.Tensor">Tensor</span>, <a class="autorefs autorefs-internal" title="ObjectArray (evotorch.tools.ObjectArray)" href="../../tools/#evotorch.tools.ObjectArray">ObjectArray</a>, <span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A decision values tensor with at least 2 dimensions, or an
<code>ObjectArray</code> of decision values, or a tuple of the form
<code>(values, evals)</code> where <code>values</code> is the decision values
and <code>evals</code> is a tensor with at least 1 dimension.
Additional leftmost dimensions within tensors are interpreted
as batch dimensions.
If this positional argument is a tensor, the first positional
argument must also be a tensor.
If this positional argument is an <code>ObjectArray</code>, the first
positional argument must also be an <code>ObjectArray</code>.
If this positional argument is a tuple, the first positional
argument must also be a tuple.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Iterable">Iterable</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In the case of single-objective optimization,
<code>objective_sense</code> can be left as None, or can be 'min' or 'max',
representing the direction of the optimization.
In the case of multi-objective optimization, <code>objective_sense</code>
is expected as a list of strings, each string being 'min' or
'max', representing the direction for each objective.
Please also note that, if this combination operation is done
without evaluation results (i.e. if the first two positional
arguments are given as tensors, not tuples), <code>objective_sense</code>
is not needed, and can be omitted, regardless of whether or
not the problem at hand is single-objective.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1852" name="__codelineno-0-1852"></a><span class="k">def</span><span class="w"> </span><span class="nf">combine</span><span class="p">(</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>    <span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">],</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">],</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a><span class="sd">    Combine two populations into one.</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a><span class="sd">    **Usage 1: without evaluation results.**</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a><span class="sd">    Let us assume that we have two decision values matrices, `values1`</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a><span class="sd">    `values2`. The shapes of these matrices are (n1, L) and (n2, L)</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a><span class="sd">    respectively, where L represents the length of a solution.</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a><span class="sd">    Let us assume that the solutions that these decision values</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a><span class="sd">    represent are not evaluated yet. Therefore, we do not have evaluation</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a><span class="sd">    results (i.e. we do not have fitnesses). To combine these two</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a><span class="sd">    unevaluated populations, we use this function as follows:</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><span class="sd">    combined_population = combine(values1, values2)</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a><span class="sd">    # We now have a combined decision values matrix, shaped (n1+n2, L).</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a><span class="sd">    **Usage 2: with evaluation results, single-objective.**</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><span class="sd">    We again assume that we have two decision values matrices, `values1`</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a><span class="sd">    and `values2`. Like in our previous example, these matrices are shaped</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><span class="sd">    (n1, L) and (n2, L), respectively. Additionally, let us assume that we</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a><span class="sd">    know the evaluation results for the solutions represented by `values1`</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><span class="sd">    and `values2`. These evaluation results are represented by the tensors</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a><span class="sd">    `evals1` and `evals2`, shaped (n1,) and (n2,), respectively. To combine</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a><span class="sd">    these two evaluated populations, we use this function as follows:</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><span class="sd">    c_values, c_evals = combine((values1, evals1), (values2, evals2))</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><span class="sd">    # We now have a combined decision values matrix and a combined evaluations</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><span class="sd">    # vector.</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><span class="sd">    # `c_values` is shaped (n1+n2, L), and `c_evals` is shaped (n1+n2,).</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a><span class="sd">    **Usage 3: with evaluation results, multi-objective.**</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a><span class="sd">    We again assume that we have two decision values matrices, `values1`</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><span class="sd">    and `values2`. Like in our previous example, these matrices are shaped</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><span class="sd">    (n1, L) and (n2, L), respectively. Additionally, we assume that we know</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a><span class="sd">    the evaluation results for these solutions. The evaluation results are</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><span class="sd">    stored within the tensors `evals1` and `evals2`, whose shapes are</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a><span class="sd">    (n1, M) and (n2, M), where M is the number of objectives. To combine</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a><span class="sd">    these two evaluated populations, we use this function as follows:</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><span class="sd">    c_values, c_evals = combine(</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a><span class="sd">        (values1, evals1),</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a><span class="sd">        (values2, evals2),</span>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><span class="sd">        objective_sense=[&quot;min&quot;, &quot;min&quot;],  # Assuming we have 2 min objectives</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a><span class="sd">    )</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a><span class="sd">    # We now have a combined decision values matrix and a combined evaluations</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a><span class="sd">    # vector.</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><span class="sd">    # `c_values` is shaped (n1+n2, L), and `c_evals` is shaped (n1+n2,).</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a><span class="sd">    **Support for ObjectArray.**</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a><span class="sd">    This function supports decision values that are expressed via instances</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a><span class="sd">    of `ObjectArray`.</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a><span class="sd">        a: A decision values tensor with at least 2 dimensions, or an</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a><span class="sd">            `ObjectArray` of decision values, or a tuple of the form</span>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a><span class="sd">            `(values, evals)` where `values` is the decision values</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a><span class="sd">            and `evals` is a tensor with at least 1 dimension.</span>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a><span class="sd">            Additional leftmost dimensions within tensors are interpreted</span>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a><span class="sd">            as batch dimensions.</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a><span class="sd">            If this positional argument is a tensor, the second positional</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a><span class="sd">            argument must also be a tensor.</span>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a><span class="sd">            If this positional argument is an `ObjectArray`, the second</span>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a><span class="sd">            positional argument must also be an `ObjectArray`.</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a><span class="sd">            If this positional argument is a tuple, the second positional</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a><span class="sd">            argument must also be a tuple.</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><span class="sd">        b: A decision values tensor with at least 2 dimensions, or an</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a><span class="sd">            `ObjectArray` of decision values, or a tuple of the form</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a><span class="sd">            `(values, evals)` where `values` is the decision values</span>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a><span class="sd">            and `evals` is a tensor with at least 1 dimension.</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a><span class="sd">            Additional leftmost dimensions within tensors are interpreted</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a><span class="sd">            as batch dimensions.</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a><span class="sd">            If this positional argument is a tensor, the first positional</span>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a><span class="sd">            argument must also be a tensor.</span>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a><span class="sd">            If this positional argument is an `ObjectArray`, the first</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a><span class="sd">            positional argument must also be an `ObjectArray`.</span>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a><span class="sd">            If this positional argument is a tuple, the first positional</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a><span class="sd">            argument must also be a tuple.</span>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a><span class="sd">        objective_sense: In the case of single-objective optimization,</span>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a><span class="sd">            `objective_sense` can be left as None, or can be &#39;min&#39; or &#39;max&#39;,</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a><span class="sd">            representing the direction of the optimization.</span>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a><span class="sd">            In the case of multi-objective optimization, `objective_sense`</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a><span class="sd">            is expected as a list of strings, each string being &#39;min&#39; or</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a><span class="sd">            &#39;max&#39;, representing the direction for each objective.</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a><span class="sd">            Please also note that, if this combination operation is done</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a><span class="sd">            without evaluation results (i.e. if the first two positional</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a><span class="sd">            arguments are given as tensors, not tuples), `objective_sense`</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a><span class="sd">            is not needed, and can be omitted, regardless of whether or</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a><span class="sd">            not the problem at hand is single-objective.</span>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a><span class="sd">        The combined decision values tensor, or a tuple of the form</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a><span class="sd">        `(values, evals)` where `values` is the combined decision values</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a><span class="sd">        tensor, and `evals` is the combined evaluation results tensor.</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>        <span class="n">values1</span><span class="p">,</span> <span class="n">evals1</span> <span class="o">=</span> <span class="n">a</span>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>                <span class="s2">&quot;The first positional argument was received as a tuple.&quot;</span>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a>                <span class="s2">&quot; Therefore, the second positional argument was also expected as a tuple.&quot;</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>                <span class="sa">f</span><span class="s2">&quot; However, the second argument is </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>            <span class="p">)</span>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>        <span class="n">values2</span><span class="p">,</span> <span class="n">evals2</span> <span class="o">=</span> <span class="n">b</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">objective_sense</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>            <span class="k">if</span> <span class="n">_both_are_tensors</span><span class="p">(</span><span class="n">values1</span><span class="p">,</span> <span class="n">values2</span><span class="p">):</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>                <span class="k">return</span> <span class="n">_combine_values_and_evals</span><span class="p">(</span><span class="n">values1</span><span class="p">,</span> <span class="n">evals1</span><span class="p">,</span> <span class="n">values2</span><span class="p">,</span> <span class="n">evals2</span><span class="p">)</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>            <span class="k">elif</span> <span class="n">_both_are_object_arrays</span><span class="p">(</span><span class="n">values1</span><span class="p">,</span> <span class="n">values2</span><span class="p">):</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>                <span class="k">return</span> <span class="n">_combine_object_arrays_and_evals</span><span class="p">(</span><span class="n">values1</span><span class="p">,</span> <span class="n">evals1</span><span class="p">,</span> <span class="n">values2</span><span class="p">,</span> <span class="n">evals2</span><span class="p">)</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>                    <span class="s2">&quot;Both decision values arrays must be `Tensor`s or `ObjectArray`s.&quot;</span>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>                    <span class="sa">f</span><span class="s2">&quot; However, their types are: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values1</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values2</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>                <span class="p">)</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>            <span class="k">if</span> <span class="n">_both_are_tensors</span><span class="p">(</span><span class="n">values1</span><span class="p">,</span> <span class="n">values2</span><span class="p">):</span>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>                <span class="k">return</span> <span class="n">_combine_values_and_multiobjective_evals</span><span class="p">(</span><span class="n">values1</span><span class="p">,</span> <span class="n">evals1</span><span class="p">,</span> <span class="n">values2</span><span class="p">,</span> <span class="n">evals2</span><span class="p">)</span>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>            <span class="k">elif</span> <span class="n">_both_are_object_arrays</span><span class="p">(</span><span class="n">values1</span><span class="p">,</span> <span class="n">values2</span><span class="p">):</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>                <span class="k">return</span> <span class="n">_combine_object_arrays_and_multiobjective_evals</span><span class="p">(</span><span class="n">values1</span><span class="p">,</span> <span class="n">evals1</span><span class="p">,</span> <span class="n">values2</span><span class="p">,</span> <span class="n">evals2</span><span class="p">)</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>                    <span class="s2">&quot;Both decision values arrays must be `Tensor`s or `ObjectArray`s.&quot;</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>                    <span class="sa">f</span><span class="s2">&quot; However, their types are: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values1</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values2</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>                <span class="p">)</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized `objective_sense`: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">)):</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">)):</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>                <span class="s2">&quot;The first positional argument was received as a tensor or ObjectArray.&quot;</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>                <span class="s2">&quot; Therefore, the second positional argument was also expected as a tensor or ObjectArray.&quot;</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>                <span class="sa">f</span><span class="s2">&quot; However, the second argument is </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>            <span class="p">)</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>        <span class="k">if</span> <span class="n">_both_are_tensors</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>            <span class="k">return</span> <span class="n">_combine_values</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a>        <span class="k">elif</span> <span class="n">_both_are_object_arrays</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>            <span class="k">return</span> <span class="n">_combine_object_arrays</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a>                <span class="s2">&quot;Both decision values arrays must be `Tensor`s or `ObjectArray`s.&quot;</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>                <span class="sa">f</span><span class="s2">&quot; However, their types are: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values1</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values2</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a>            <span class="p">)</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>            <span class="s2">&quot;Expected both positional arguments as tensors, or as tuples.&quot;</span>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>            <span class="sa">f</span><span class="s2">&quot; However, the first positional argument is </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.cosyne_permutation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cosyne_permutation</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">evals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">permute_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">objective_sense</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.cosyne_permutation" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return the permuted (i.e. shuffled) version of the given decision values.</p>
<p>Shuffling of the decision values is done columnwise.</p>
<p>If <code>permute_all</code> is given as True, each item within each column will be
subject to permutation. In this mode, the arguments <code>evals</code> and
<code>objective_sense</code> can be omitted (i.e. can be left as None).</p>
<p>If <code>permute_all</code> is given as False, each item within each column is given
a probability of staying the same. This probability is higher for items
that belong to solutions with better fitnesses. In this mode, the
arguments <code>evals</code> and <code>objective_sense</code> are mandatory.</p>
<p>Reference:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Gomez, F., Schmidhuber, J., Miikkulainen, R., &amp; Mitchell, M. (2008).
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Accelerated Neural Evolution through Cooperatively Coevolved Synapses.
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>Journal of Machine Learning Research, 9(5).
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>population</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor with at least 2 dimensions, representing the
decision values of the solutions. Extra leftmost dimensions will
be considered as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation results (i.e. fitnesses), as a tensor with at least
one dimension. Extra leftmost dimensions will be considered as
batch dimensions. If <code>permute_all</code> is True, this argument can be
left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>permute_all</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not each item within each column will be
subject to permutation operation. If given as False, items
with better fitnesses have greater probabilities of staying the
same. The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string whose value is either 'min' or 'max',
representing the goal of the optimization. If <code>permute_all</code> is
True, this argument can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1737" name="__codelineno-0-1737"></a><span class="k">def</span><span class="w"> </span><span class="nf">cosyne_permutation</span><span class="p">(</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>    <span class="n">values</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>    <span class="n">evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>    <span class="n">permute_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a><span class="sd">    Return the permuted (i.e. shuffled) version of the given decision values.</span>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a><span class="sd">    Shuffling of the decision values is done columnwise.</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a><span class="sd">    If `permute_all` is given as True, each item within each column will be</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a><span class="sd">    subject to permutation. In this mode, the arguments `evals` and</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a><span class="sd">    `objective_sense` can be omitted (i.e. can be left as None).</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a><span class="sd">    If `permute_all` is given as False, each item within each column is given</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a><span class="sd">    a probability of staying the same. This probability is higher for items</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a><span class="sd">    that belong to solutions with better fitnesses. In this mode, the</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a><span class="sd">    arguments `evals` and `objective_sense` are mandatory.</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a><span class="sd">    Reference:</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a><span class="sd">    Gomez, F., Schmidhuber, J., Miikkulainen, R., &amp; Mitchell, M. (2008).</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a><span class="sd">    Accelerated Neural Evolution through Cooperatively Coevolved Synapses.</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a><span class="sd">    Journal of Machine Learning Research, 9(5).</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a><span class="sd">        population: A tensor with at least 2 dimensions, representing the</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a><span class="sd">            decision values of the solutions. Extra leftmost dimensions will</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a><span class="sd">            be considered as batch dimensions.</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a><span class="sd">        evals: Evaluation results (i.e. fitnesses), as a tensor with at least</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a><span class="sd">            one dimension. Extra leftmost dimensions will be considered as</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a><span class="sd">            batch dimensions. If `permute_all` is True, this argument can be</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a><span class="sd">            left as None.</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a><span class="sd">        permute_all: Whether or not each item within each column will be</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a><span class="sd">            subject to permutation operation. If given as False, items</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a><span class="sd">            with better fitnesses have greater probabilities of staying the</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a><span class="sd">            same. The default is True.</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a><span class="sd">        objective_sense: A string whose value is either &#39;min&#39; or &#39;max&#39;,</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a><span class="sd">            representing the goal of the optimization. If `permute_all` is</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a><span class="sd">            True, this argument can be left as None.</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a><span class="sd">        The shuffled counterpart of the given population, as a new tensor.</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>    <span class="k">if</span> <span class="n">permute_all</span><span class="p">:</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>        <span class="k">return</span> <span class="n">_cosyne_permutation_for_entire_population</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>        <span class="k">if</span> <span class="n">evals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When `permute_all` is False, `evals` is required&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>        <span class="k">if</span> <span class="n">objective_sense</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When `permute_all` is False, `objective_sense` is required&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a>        <span class="k">return</span> <span class="n">_partial_cosyne_permutation_for_population</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.dominates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dominates</span><span class="p">(</span><span class="n">evals1</span><span class="p">,</span> <span class="n">evals2</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.dominates" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return whether or not the first solution pareto-dominates the second one.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>evals1</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation results of the first solution. Expected as an
at-least-1-dimensional tensor, the length of which must be
equal to the number of objectives. Extra leftmost dimensions
will be considered as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evals2</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation results of the second solution. Expected as an
at-least-1-dimensional tensor, the length of which must be
equal to the number of objectives. Extra leftmost dimensions
will be considered as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expected as a list of strings, where each
string is either 'min' or 'max', expressing the direction of
optimization regarding each objective.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="k">def</span><span class="w"> </span><span class="nf">dominates</span><span class="p">(</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="n">evals1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">evals2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    Return whether or not the first solution pareto-dominates the second one.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        evals1: Evaluation results of the first solution. Expected as an</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            at-least-1-dimensional tensor, the length of which must be</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            equal to the number of objectives. Extra leftmost dimensions</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            will be considered as batch dimensions.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        evals2: Evaluation results of the second solution. Expected as an</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            at-least-1-dimensional tensor, the length of which must be</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            equal to the number of objectives. Extra leftmost dimensions</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            will be considered as batch dimensions.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        objective_sense: Expected as a list of strings, where each</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            string is either &#39;min&#39; or &#39;max&#39;, expressing the direction of</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            optimization regarding each objective.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        A tensor of boolean(s), indicating whether or not the first</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        solution(s) dominate(s) the second solution(s).</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="s2">&quot;`objective_sense` was received as a string, implying that the problem at hand has a single objective.&quot;</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="s2">&quot; However, this `dominates(...)` function does not support single-objective cases.&quot;</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="k">return</span> <span class="n">_dominates</span><span class="p">(</span><span class="n">evals1</span><span class="p">,</span> <span class="n">evals2</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized `objective_sense`: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.domination_counts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">domination_counts</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.domination_counts" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return a tensor expressing how many times each solution gets dominated</p>
<p>In this returned tensor, the <code>i</code>-th item is an integer which specifies how
many times the <code>i</code>-th solution is dominated.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expected as an at-least-2-dimensional tensor. In such a
2-dimensional evaluation tensor, the item <code>i,j</code> represents the
evaluation result of the <code>i</code>-th solution according to the <code>j</code>-th
objective. Extra leftmost dimensions are interpreted as batch
dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of strings, where each string is either
'min' or 'max', expressing the direction of optimization regarding
each objective.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="k">def</span><span class="w"> </span><span class="nf">domination_counts</span><span class="p">(</span><span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Return a tensor expressing how many times each solution gets dominated</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    In this returned tensor, the `i`-th item is an integer which specifies how</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    many times the `i`-th solution is dominated.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        evals: Expected as an at-least-2-dimensional tensor. In such a</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">            2-dimensional evaluation tensor, the item `i,j` represents the</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">            evaluation result of the `i`-th solution according to the `j`-th</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">            objective. Extra leftmost dimensions are interpreted as batch</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">            dimensions.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        objective_sense: A list of strings, where each string is either</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">            &#39;min&#39; or &#39;max&#39;, expressing the direction of optimization regarding</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">            each objective.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        An integer tensor of length `n`, where `n` is the number of solutions.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="k">return</span> <span class="n">_domination_counts</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.domination_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">domination_matrix</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.domination_matrix" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Compute and return a pareto-domination matrix.</p>
<p>In this pareto-domination matrix <code>P</code>, the item <code>P[i,j]</code> is True if the
<code>i</code>-th solution is dominated by the <code>j</code>-th solution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation results of the solutions, expected as a tensor
with at least 2 dimensions. In a 2-dimensional <code>evals</code> tensor,
the item <code>i,j</code> represents the evaluation result of the
<code>i</code>-th solution according to the <code>j</code>-th objective.
Extra leftmost dimensions are interpreted as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of strings, where each string is either
'min' or 'max', expressing the direction of optimization regarding
each objective.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="k">def</span><span class="w"> </span><span class="nf">domination_matrix</span><span class="p">(</span><span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Compute and return a pareto-domination matrix.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">    In this pareto-domination matrix `P`, the item `P[i,j]` is True if the</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    `i`-th solution is dominated by the `j`-th solution.</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        evals: Evaluation results of the solutions, expected as a tensor</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            with at least 2 dimensions. In a 2-dimensional `evals` tensor,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            the item `i,j` represents the evaluation result of the</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            `i`-th solution according to the `j`-th objective.</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">            Extra leftmost dimensions are interpreted as batch dimensions.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        objective_sense: A list of strings, where each string is either</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            &#39;min&#39; or &#39;max&#39;, expressing the direction of optimization regarding</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">            each objective.</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        A boolean tensor of size `(n,n)`, where `n` is the number of solutions.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="k">return</span> <span class="n">_domination_matrix</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.multi_point_cross_over" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">multi_point_cross_over</span><span class="p">(</span><span class="n">parents</span><span class="p">,</span> <span class="n">evals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">num_points</span><span class="p">,</span> <span class="n">tournament_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_children</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objective_sense</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.multi_point_cross_over" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply multi-point cross-over on the given <code>parents</code>.</p>
<p>If <code>tournament_size</code> is given, parents for the cross-over operation will
be picked with the help of a tournament. Otherwise, the first half of the
given <code>parents</code> will be the first set of parents, and the second half
of the given <code>parents</code> will be the second set of parents.</p>
<p>The return value of this function is a new tensor containing the decision
values of the child solutions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parents</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor with at least 2 dimensions, representing the decision
values of the parent solutions. If this tensor has more than 2
dimensions, the extra leftmost dimension(s) will be considered as
batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor with at least 1 dimension, representing the evaluation
results (i.e. fitnesses) of the parent solutions. If this tensor
has more than 1 dimension, the extra leftmost dimension(s) will be
considered as batch dimensions. If <code>tournament_size</code> is not given,
<code>evals</code> can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_points</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points at which the decision values of the
parent solutions will be cut and recombined to form the child
solutions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tournament_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as an integer that is greater than or equal
to 1, the parents for the cross-over operation will be picked
with the help of a tournament. In more details, each parent will
be picked as the result of comparing multiple competing solutions,
the number of these competing solutions being equal to this
<code>tournament_size</code>. Please note that, if <code>tournament_size</code> is given
as an integer, the arguments <code>evals</code> and <code>objective_sense</code> are
also required. If <code>tournament_size</code> is left as None, the first half
of <code>parents</code> will be the first set of parents, and the second half
of <code>parents</code> will be the second set of parents.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_children</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally the number of children to produce as the
result of tournament selection and cross-over, as an even integer.
If tournament selection is enabled (i.e. if <code>tournament_size</code> is
an integer) but <code>num_children</code> is omitted, the number of children
will be equal to the number of <code>parents</code>.
If there is no tournament selection (i.e. if <code>tournament_size</code> is
None), <code>num_children</code> is expected to be None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="list">list</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mandatory if <code>tournament_size</code> is not None.
For when there is only one objective, <code>objective_sense</code> is
expected as 'max' for when the goal of the optimization is to
maximize <code>evals</code>, 'min' for when the goal of the optimization is
to minimize <code>evals</code>. For when there are multiple objectives,
<code>objective_sense</code> is expected as a list of strings, where each
string is either 'min' or 'max'.
If <code>tournament_size</code> is None, <code>objective_sense</code> can also be left
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="k">def</span><span class="w"> </span><span class="nf">multi_point_cross_over</span><span class="p">(</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="n">parents</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>    <span class="n">evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>    <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>    <span class="n">tournament_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>    <span class="n">num_children</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">    Apply multi-point cross-over on the given `parents`.</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">    If `tournament_size` is given, parents for the cross-over operation will</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">    be picked with the help of a tournament. Otherwise, the first half of the</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">    given `parents` will be the first set of parents, and the second half</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">    of the given `parents` will be the second set of parents.</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">    The return value of this function is a new tensor containing the decision</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">    values of the child solutions.</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">        parents: A tensor with at least 2 dimensions, representing the decision</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">            values of the parent solutions. If this tensor has more than 2</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">            dimensions, the extra leftmost dimension(s) will be considered as</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">            batch dimensions.</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">        evals: A tensor with at least 1 dimension, representing the evaluation</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">            results (i.e. fitnesses) of the parent solutions. If this tensor</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">            has more than 1 dimension, the extra leftmost dimension(s) will be</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">            considered as batch dimensions. If `tournament_size` is not given,</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">            `evals` can be left as None.</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">        num_points: Number of points at which the decision values of the</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">            parent solutions will be cut and recombined to form the child</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">            solutions.</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">        tournament_size: If given as an integer that is greater than or equal</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">            to 1, the parents for the cross-over operation will be picked</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">            with the help of a tournament. In more details, each parent will</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">            be picked as the result of comparing multiple competing solutions,</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">            the number of these competing solutions being equal to this</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">            `tournament_size`. Please note that, if `tournament_size` is given</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">            as an integer, the arguments `evals` and `objective_sense` are</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">            also required. If `tournament_size` is left as None, the first half</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">            of `parents` will be the first set of parents, and the second half</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">            of `parents` will be the second set of parents.</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">        num_children: Optionally the number of children to produce as the</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">            result of tournament selection and cross-over, as an even integer.</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">            If tournament selection is enabled (i.e. if `tournament_size` is</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">            an integer) but `num_children` is omitted, the number of children</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">            will be equal to the number of `parents`.</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">            If there is no tournament selection (i.e. if `tournament_size` is</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">            None), `num_children` is expected to be None.</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">        objective_sense: Mandatory if `tournament_size` is not None.</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">            For when there is only one objective, `objective_sense` is</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">            expected as &#39;max&#39; for when the goal of the optimization is to</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">            maximize `evals`, &#39;min&#39; for when the goal of the optimization is</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">            to minimize `evals`. For when there are multiple objectives,</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">            `objective_sense` is expected as a list of strings, where each</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">            string is either &#39;min&#39; or &#39;max&#39;.</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">            If `tournament_size` is None, `objective_sense` can also be left</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">        Decision values of the child solutions, as a new tensor.</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>    <span class="k">if</span> <span class="n">tournament_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>        <span class="k">if</span> <span class="n">num_children</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>                <span class="s2">&quot;`num_children` was received as something other than None.&quot;</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>                <span class="s2">&quot; However, `num_children` is expected only when a `tournament_size` is given,&quot;</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>                <span class="s2">&quot; which seems to be omitted (i.e. which is None).&quot;</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>            <span class="p">)</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>        <span class="c1"># This is the case where the tournament selection feature is enabled.</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>        <span class="c1"># We first ensure that the required arguments `evals` and `objective_sense` are available.</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>        <span class="k">if</span> <span class="n">evals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>                <span class="s2">&quot;When a `tournament_size` is given, the argument `evals` is also required.&quot;</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>                <span class="s2">&quot; However, it was received as None.&quot;</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>            <span class="p">)</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>        <span class="k">if</span> <span class="n">num_children</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>            <span class="c1"># If `num_children` is not given, we make it equal to the number of `parents`.</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>            <span class="n">num_children</span> <span class="o">=</span> <span class="n">parents</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>        <span class="k">if</span> <span class="n">objective_sense</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>                <span class="s2">&quot;When a `tournament_size` is given, the argument `objective_sense` is also required.&quot;</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>                <span class="s2">&quot; However, it was received as None.&quot;</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>            <span class="p">)</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>        <span class="c1"># Apply tournament selection on the original `parents`</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>        <span class="n">parents</span> <span class="o">=</span> <span class="n">tournament</span><span class="p">(</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>            <span class="n">parents</span><span class="p">,</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>            <span class="n">evals</span><span class="p">,</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>            <span class="n">num_tournaments</span><span class="o">=</span><span class="n">num_children</span><span class="p">,</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>            <span class="n">tournament_size</span><span class="o">=</span><span class="n">tournament_size</span><span class="p">,</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>            <span class="n">objective_sense</span><span class="o">=</span><span class="n">objective_sense</span><span class="p">,</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>            <span class="n">with_evals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>        <span class="p">)</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>    <span class="c1"># Apply the cross-over operation on `parents`, and return the recombined decision values tensor.</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>    <span class="k">return</span> <span class="n">_do_cross_over</span><span class="p">(</span><span class="n">parents</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.one_point_cross_over" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">one_point_cross_over</span><span class="p">(</span><span class="n">parents</span><span class="p">,</span> <span class="n">evals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tournament_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_children</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objective_sense</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.one_point_cross_over" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply one-point cross-over on the given <code>parents</code>.</p>
<p>Let us assume that we have the following two parent solutions:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>         ________________________
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>parentA | a1  a2  a3  a4  a5  a6 |
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>parentB | b1  b2  b3  b4  b5  b6 |
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        |________________________|
</code></pre></div>
<p>This cross-over operation will first randomly decide a cutting point:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>         ________|________________
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>parentA | a1  a2 | a3  a4  a5  a6 |
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>parentB | b1  b2 | b3  b4  b5  b6 |
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>        |________|________________|
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>                 |
</code></pre></div>
<p>...and then form the following child solutions by recombining the decision
values of the parents:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>         ________|________________
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>child1  | a1  a2 | b3  b4  b5  b6 |
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>child2  | b1  b2 | a3  a4  a5  a6 |
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>        |________|________________|
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>                 |
</code></pre></div>
<p>If <code>tournament_size</code> is given, parents for the cross-over operation will
be picked with the help of a tournament. Otherwise, the first half of the
given <code>parents</code> will be the first set of parents, and the second half
of the given <code>parents</code> will be the second set of parents.</p>
<p>The return value of this function is a new tensor containing the decision
values of the child solutions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parents</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor with at least 2 dimensions, representing the decision
values of the parent solutions. If this tensor has more than 2
dimensions, the extra leftmost dimension(s) will be considered as
batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor with at least 1 dimension, representing the evaluation
results (i.e. fitnesses) of the parent solutions. If this tensor
has more than 1 dimension, the extra leftmost dimension(s) will be
considered as batch dimensions. If <code>tournament_size</code> is not given,
<code>evals</code> can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tournament_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as an integer that is greater than or equal
to 1, the parents for the cross-over operation will be picked
with the help of a tournament. In more details, each parent will
be picked as the result of comparing multiple competing solutions,
the number of these competing solutions being equal to this
<code>tournament_size</code>. Please note that, if <code>tournament_size</code> is given
as an integer, the arguments <code>evals</code> and <code>objective_sense</code> are
also required. If <code>tournament_size</code> is left as None, the first half
of <code>parents</code> will be the first set of parents, and the second half
of <code>parents</code> will be the second set of parents.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_children</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally the number of children to produce as the
result of tournament selection and cross-over, as an even integer.
If tournament selection is enabled (i.e. if <code>tournament_size</code> is
an integer) but <code>num_children</code> is omitted, the number of children
will be equal to the number of <code>parents</code>.
If there is no tournament selection (i.e. if <code>tournament_size</code> is
None), <code>num_children</code> is expected to be None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mandatory if <code>tournament_size</code> is not None.
For when there is only one objective, <code>objective_sense</code> is
expected as 'max' for when the goal of the optimization is to
maximize <code>evals</code>, 'min' for when the goal of the optimization is
to minimize <code>evals</code>. For when there are multiple objectives,
<code>objective_sense</code> is expected as a list of strings, where each
string is either 'min' or 'max'.
If <code>tournament_size</code> is None, <code>objective_sense</code> can also be left
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="k">def</span><span class="w"> </span><span class="nf">one_point_cross_over</span><span class="p">(</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>    <span class="n">parents</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>    <span class="n">evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>    <span class="n">tournament_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>    <span class="n">num_children</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">    Apply one-point cross-over on the given `parents`.</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="sd">    Let us assume that we have the following two parent solutions:</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">             ________________________</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">    parentA | a1  a2  a3  a4  a5  a6 |</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">    parentB | b1  b2  b3  b4  b5  b6 |</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">            |________________________|</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">    This cross-over operation will first randomly decide a cutting point:</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">             ________|________________</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">    parentA | a1  a2 | a3  a4  a5  a6 |</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">    parentB | b1  b2 | b3  b4  b5  b6 |</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">            |________|________________|</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><span class="sd">                     |</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">    ...and then form the following child solutions by recombining the decision</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">    values of the parents:</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><span class="sd">             ________|________________</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="sd">    child1  | a1  a2 | b3  b4  b5  b6 |</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">    child2  | b1  b2 | a3  a4  a5  a6 |</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">            |________|________________|</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><span class="sd">                     |</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">    If `tournament_size` is given, parents for the cross-over operation will</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">    be picked with the help of a tournament. Otherwise, the first half of the</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">    given `parents` will be the first set of parents, and the second half</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">    of the given `parents` will be the second set of parents.</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><span class="sd">    The return value of this function is a new tensor containing the decision</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">    values of the child solutions.</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">        parents: A tensor with at least 2 dimensions, representing the decision</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">            values of the parent solutions. If this tensor has more than 2</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">            dimensions, the extra leftmost dimension(s) will be considered as</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">            batch dimensions.</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">        evals: A tensor with at least 1 dimension, representing the evaluation</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">            results (i.e. fitnesses) of the parent solutions. If this tensor</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">            has more than 1 dimension, the extra leftmost dimension(s) will be</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">            considered as batch dimensions. If `tournament_size` is not given,</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">            `evals` can be left as None.</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">        tournament_size: If given as an integer that is greater than or equal</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">            to 1, the parents for the cross-over operation will be picked</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">            with the help of a tournament. In more details, each parent will</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">            be picked as the result of comparing multiple competing solutions,</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">            the number of these competing solutions being equal to this</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">            `tournament_size`. Please note that, if `tournament_size` is given</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">            as an integer, the arguments `evals` and `objective_sense` are</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">            also required. If `tournament_size` is left as None, the first half</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">            of `parents` will be the first set of parents, and the second half</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">            of `parents` will be the second set of parents.</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">        num_children: Optionally the number of children to produce as the</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">            result of tournament selection and cross-over, as an even integer.</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">            If tournament selection is enabled (i.e. if `tournament_size` is</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">            an integer) but `num_children` is omitted, the number of children</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">            will be equal to the number of `parents`.</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">            If there is no tournament selection (i.e. if `tournament_size` is</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">            None), `num_children` is expected to be None.</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">        objective_sense: Mandatory if `tournament_size` is not None.</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">            For when there is only one objective, `objective_sense` is</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">            expected as &#39;max&#39; for when the goal of the optimization is to</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">            maximize `evals`, &#39;min&#39; for when the goal of the optimization is</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">            to minimize `evals`. For when there are multiple objectives,</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">            `objective_sense` is expected as a list of strings, where each</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">            string is either &#39;min&#39; or &#39;max&#39;.</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="sd">            If `tournament_size` is None, `objective_sense` can also be left</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><span class="sd">        Decision values of the child solutions, as a new tensor.</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>    <span class="k">return</span> <span class="n">multi_point_cross_over</span><span class="p">(</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>        <span class="n">parents</span><span class="p">,</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>        <span class="n">evals</span><span class="p">,</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>        <span class="n">num_points</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>        <span class="n">num_children</span><span class="o">=</span><span class="n">num_children</span><span class="p">,</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>        <span class="n">tournament_size</span><span class="o">=</span><span class="n">tournament_size</span><span class="p">,</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>        <span class="n">objective_sense</span><span class="o">=</span><span class="n">objective_sense</span><span class="p">,</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.pareto_utility" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pareto_utility</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">crowdsort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.pareto_utility" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Compute utility values for the solutions of a multi-objective problem.</p>
<p>A solution on a better pareto-front is assigned a higher utility value.
Additionally, if <code>crowdsort</code> is given as True crowding distances will also
be taken into account. In more details, in the same pareto-front,
solutions with higher crowding distances will have increased utility
values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation results, expected as a tensor with at least two
dimensions. A 2-dimensional <code>evals</code> tensor is expected to be
shaped as (numberOfSolutions, numberOfObjectives). Extra
leftmost dimensions will be interpreted as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expected as a list of strings, where each string
is either 'min' or 'max'. The i-th item within this list
represents the direction of the optimization for the i-th
objective.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="k">def</span><span class="w"> </span><span class="nf">pareto_utility</span><span class="p">(</span><span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">crowdsort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    Compute utility values for the solutions of a multi-objective problem.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">    A solution on a better pareto-front is assigned a higher utility value.</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">    Additionally, if `crowdsort` is given as True crowding distances will also</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">    be taken into account. In more details, in the same pareto-front,</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">    solutions with higher crowding distances will have increased utility</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    values.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        evals: Evaluation results, expected as a tensor with at least two</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">            dimensions. A 2-dimensional `evals` tensor is expected to be</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">            shaped as (numberOfSolutions, numberOfObjectives). Extra</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">            leftmost dimensions will be interpreted as batch dimensions.</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        objective_sense: Expected as a list of strings, where each string</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">            is either &#39;min&#39; or &#39;max&#39;. The i-th item within this list</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">            represents the direction of the optimization for the i-th</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">            objective.</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">        A utility tensor. Considering the non-batched case (i.e. considering</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">        that `evals` was given as a 2-dimensional tensor), the i-th item</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        within the returned utility tensor represents the utility value</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        assigned to the i-th solution.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="k">return</span> <span class="n">_pareto_utility</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">crowdsort</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.simulated_binary_cross_over" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">simulated_binary_cross_over</span><span class="p">(</span><span class="n">parents</span><span class="p">,</span> <span class="n">evals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">tournament_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_children</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objective_sense</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.simulated_binary_cross_over" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply simulated binary cross-over (SBX) on the given <code>parents</code>.</p>
<p>If <code>tournament_size</code> is given, parents for the cross-over operation will
be picked with the help of a tournament. Otherwise, the first half of the
given <code>parents</code> will be the first set of parents, and the second half
of the given <code>parents</code> will be the second set of parents.</p>
<p>The return value of this function is a new tensor containing the decision
values of the child solutions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parents</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor with at least 2 dimensions, representing the decision
values of the parent solutions. If this tensor has more than 2
dimensions, the extra leftmost dimension(s) will be considered as
batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor with at least 1 dimension, representing the evaluation
results (i.e. fitnesses) of the parent solutions. If this tensor
has more than 1 dimension, the extra leftmost dimension(s) will be
considered as batch dimensions. If <code>tournament_size</code> is not given,
<code>evals</code> can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eta</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The crowding index, expected as a real number. Bigger eta values
result in children closer to their parents. If <code>eta</code> is given as
an <code>n</code>-dimensional tensor instead of a scalar, those extra
dimensions will be considered as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tournament_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as an integer that is greater than or equal
to 1, the parents for the cross-over operation will be picked
with the help of a tournament. In more details, each parent will
be picked as the result of comparing multiple competing solutions,
the number of these competing solutions being equal to this
<code>tournament_size</code>. Please note that, if <code>tournament_size</code> is given
as an integer, the arguments <code>evals</code> and <code>objective_sense</code> are
also required. If <code>tournament_size</code> is left as None, the first half
of <code>parents</code> will be the first set of parents, and the second half
of <code>parents</code> will be the second set of parents.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_children</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally the number of children to produce as the
result of tournament selection and cross-over, as an even integer.
If tournament selection is enabled (i.e. if <code>tournament_size</code> is
an integer) but <code>num_children</code> is omitted, the number of children
will be equal to the number of <code>parents</code>.
If there is no tournament selection (i.e. if <code>tournament_size</code> is
None), <code>num_children</code> is expected to be None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mandatory if <code>tournament_size</code> is not None.
For when there is only one objective, <code>objective_sense</code> is
expected as 'max' for when the goal of the optimization is to
maximize <code>evals</code>, 'min' for when the goal of the optimization is
to minimize <code>evals</code>. For when there are multiple objectives,
<code>objective_sense</code> is expected as a list of strings, where each
string is either 'min' or 'max'.
If <code>tournament_size</code> is None, <code>objective_sense</code> can also be left
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1411" name="__codelineno-0-1411"></a><span class="k">def</span><span class="w"> </span><span class="nf">simulated_binary_cross_over</span><span class="p">(</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>    <span class="n">parents</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>    <span class="n">evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>    <span class="n">eta</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>    <span class="n">tournament_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>    <span class="n">num_children</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a><span class="sd">    Apply simulated binary cross-over (SBX) on the given `parents`.</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><span class="sd">    If `tournament_size` is given, parents for the cross-over operation will</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a><span class="sd">    be picked with the help of a tournament. Otherwise, the first half of the</span>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a><span class="sd">    given `parents` will be the first set of parents, and the second half</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><span class="sd">    of the given `parents` will be the second set of parents.</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a><span class="sd">    The return value of this function is a new tensor containing the decision</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="sd">    values of the child solutions.</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a><span class="sd">        parents: A tensor with at least 2 dimensions, representing the decision</span>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><span class="sd">            values of the parent solutions. If this tensor has more than 2</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><span class="sd">            dimensions, the extra leftmost dimension(s) will be considered as</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a><span class="sd">            batch dimensions.</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a><span class="sd">        evals: A tensor with at least 1 dimension, representing the evaluation</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><span class="sd">            results (i.e. fitnesses) of the parent solutions. If this tensor</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a><span class="sd">            has more than 1 dimension, the extra leftmost dimension(s) will be</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><span class="sd">            considered as batch dimensions. If `tournament_size` is not given,</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><span class="sd">            `evals` can be left as None.</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><span class="sd">        eta: The crowding index, expected as a real number. Bigger eta values</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a><span class="sd">            result in children closer to their parents. If `eta` is given as</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a><span class="sd">            an `n`-dimensional tensor instead of a scalar, those extra</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a><span class="sd">            dimensions will be considered as batch dimensions.</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><span class="sd">        tournament_size: If given as an integer that is greater than or equal</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><span class="sd">            to 1, the parents for the cross-over operation will be picked</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a><span class="sd">            with the help of a tournament. In more details, each parent will</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a><span class="sd">            be picked as the result of comparing multiple competing solutions,</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a><span class="sd">            the number of these competing solutions being equal to this</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><span class="sd">            `tournament_size`. Please note that, if `tournament_size` is given</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a><span class="sd">            as an integer, the arguments `evals` and `objective_sense` are</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a><span class="sd">            also required. If `tournament_size` is left as None, the first half</span>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a><span class="sd">            of `parents` will be the first set of parents, and the second half</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a><span class="sd">            of `parents` will be the second set of parents.</span>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><span class="sd">        num_children: Optionally the number of children to produce as the</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a><span class="sd">            result of tournament selection and cross-over, as an even integer.</span>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a><span class="sd">            If tournament selection is enabled (i.e. if `tournament_size` is</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a><span class="sd">            an integer) but `num_children` is omitted, the number of children</span>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a><span class="sd">            will be equal to the number of `parents`.</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a><span class="sd">            If there is no tournament selection (i.e. if `tournament_size` is</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="sd">            None), `num_children` is expected to be None.</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><span class="sd">        objective_sense: Mandatory if `tournament_size` is not None.</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="sd">            For when there is only one objective, `objective_sense` is</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a><span class="sd">            expected as &#39;max&#39; for when the goal of the optimization is to</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a><span class="sd">            maximize `evals`, &#39;min&#39; for when the goal of the optimization is</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a><span class="sd">            to minimize `evals`. For when there are multiple objectives,</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a><span class="sd">            `objective_sense` is expected as a list of strings, where each</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a><span class="sd">            string is either &#39;min&#39; or &#39;max&#39;.</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a><span class="sd">            If `tournament_size` is None, `objective_sense` can also be left</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a><span class="sd">        Decision values of the child solutions, as a new tensor.</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>    <span class="k">if</span> <span class="n">tournament_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>        <span class="k">if</span> <span class="n">num_children</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>                <span class="s2">&quot;`num_children` was received as something other than None.&quot;</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>                <span class="s2">&quot; However, `num_children` is expected only when a `tournament_size` is given,&quot;</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>                <span class="s2">&quot; which seems to be omitted (i.e. which is None).&quot;</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>            <span class="p">)</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>        <span class="c1"># This is the case where the tournament selection feature is enabled.</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>        <span class="c1"># We first ensure that the required arguments `evals` and `objective_sense` are available.</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>        <span class="k">if</span> <span class="n">evals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>                <span class="s2">&quot;When a `tournament_size` is given, the argument `evals` is also required.&quot;</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>                <span class="s2">&quot; However, it was received as None.&quot;</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>            <span class="p">)</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>        <span class="k">if</span> <span class="n">num_children</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a>            <span class="c1"># If `num_children` is not given, we make it equal to the number of `parents`.</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>            <span class="n">num_children</span> <span class="o">=</span> <span class="n">parents</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a>        <span class="k">if</span> <span class="n">objective_sense</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>                <span class="s2">&quot;When a `tournament_size` is given, the argument `objective_sense` is also required.&quot;</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a>                <span class="s2">&quot; However, it was received as None.&quot;</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a>            <span class="p">)</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a>        <span class="c1"># Apply tournament selection on the original `parents`</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>        <span class="n">parents</span> <span class="o">=</span> <span class="n">tournament</span><span class="p">(</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a>            <span class="n">parents</span><span class="p">,</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>            <span class="n">evals</span><span class="p">,</span>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a>            <span class="n">num_tournaments</span><span class="o">=</span><span class="n">num_children</span><span class="p">,</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a>            <span class="n">tournament_size</span><span class="o">=</span><span class="n">tournament_size</span><span class="p">,</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>            <span class="n">objective_sense</span><span class="o">=</span><span class="n">objective_sense</span><span class="p">,</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a>            <span class="n">with_evals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>        <span class="p">)</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>    <span class="k">return</span> <span class="n">_do_sbx</span><span class="p">(</span><span class="n">parents</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.take_best" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">take_best</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">crowdsort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.take_best" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Take the best solution, or the best <code>n</code> number of solutions.</p>
<p><strong>Single-objective case.</strong>
If the positional argument <code>n</code> is omitted (i.e. is left as None), the
decision values and the evaluation result of the single best solution
will be returned.
If the positional argument <code>n</code> is provided, top-<code>n</code> solutions, together
with their evaluation results, will be returned.</p>
<p><strong>Multi-objective case.</strong>
In the multi-objective case, the positional argument <code>n</code> is mandatory.
With a valid value for <code>n</code> given, <code>n</code> number of solutions will be taken
from the best pareto-fronts. If <code>crowdsort</code> is given as True (which is
the default), crowding distances of the solutions within the same
pareto-fronts will be an additional criterion when deciding which
solutions to take. Like in the single-objective case, the decision values
and the evaluation results of the taken solutions will be returned.</p>
<p><strong>Support for ObjectArray.</strong>
This function supports decision values expressed via instances of
<code>ObjectArray</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="torch.Tensor">Tensor</span>, <a class="autorefs autorefs-internal" title="ObjectArray (evotorch.tools.ObjectArray)" href="../../tools/#evotorch.tools.ObjectArray">ObjectArray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decision values, expressed via a tensor with at least
2 dimensions or via an <code>ObjectArray</code>. If given as a tensor,
extra leftmost dimensions will be interpreted as batch
dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation results tensor, with at least 1 dimension.
Extra leftmost dimensions will be taken as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If left as None, the single best solution will be taken.
If given as an integer, this number of best solutions will be
taken. Please note that, if the problem at hand has multiple
objectives, this argument cannot be omitted.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="list">list</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In the single-objective case, <code>objective_sense</code> is
expected as a string 'min' or 'max', representing the direction
of the optimization. In the multi-objective case,
<code>objective_sense</code> is expected as a list of strings, each string
being 'min' or 'max', representing the goal of optimization for
each objective.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crowdsort</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relevant only when there are multiple objectives.
If <code>crowdsort</code> is True, the crowding distances of the solutions
within the given population will be an additional criterion
when choosing the best <code>n</code> solution. If <code>crowdsort</code> is False,
how many times a solution was dominated will be the only factor
when deciding whether or not it is among the best <code>n</code> solutions.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2111" name="__codelineno-0-2111"></a><span class="k">def</span><span class="w"> </span><span class="nf">take_best</span><span class="p">(</span>
<a id="__codelineno-0-2112" name="__codelineno-0-2112"></a>    <span class="n">values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">],</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113"></a>    <span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-2114" name="__codelineno-0-2114"></a>    <span class="n">n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2115" name="__codelineno-0-2115"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
<a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>    <span class="n">crowdsort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2118" name="__codelineno-0-2118"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<a id="__codelineno-0-2119" name="__codelineno-0-2119"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2120" name="__codelineno-0-2120"></a><span class="sd">    Take the best solution, or the best `n` number of solutions.</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>
<a id="__codelineno-0-2122" name="__codelineno-0-2122"></a><span class="sd">    **Single-objective case.**</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123"></a><span class="sd">    If the positional argument `n` is omitted (i.e. is left as None), the</span>
<a id="__codelineno-0-2124" name="__codelineno-0-2124"></a><span class="sd">    decision values and the evaluation result of the single best solution</span>
<a id="__codelineno-0-2125" name="__codelineno-0-2125"></a><span class="sd">    will be returned.</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126"></a><span class="sd">    If the positional argument `n` is provided, top-`n` solutions, together</span>
<a id="__codelineno-0-2127" name="__codelineno-0-2127"></a><span class="sd">    with their evaluation results, will be returned.</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128"></a>
<a id="__codelineno-0-2129" name="__codelineno-0-2129"></a><span class="sd">    **Multi-objective case.**</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130"></a><span class="sd">    In the multi-objective case, the positional argument `n` is mandatory.</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131"></a><span class="sd">    With a valid value for `n` given, `n` number of solutions will be taken</span>
<a id="__codelineno-0-2132" name="__codelineno-0-2132"></a><span class="sd">    from the best pareto-fronts. If `crowdsort` is given as True (which is</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133"></a><span class="sd">    the default), crowding distances of the solutions within the same</span>
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a><span class="sd">    pareto-fronts will be an additional criterion when deciding which</span>
<a id="__codelineno-0-2135" name="__codelineno-0-2135"></a><span class="sd">    solutions to take. Like in the single-objective case, the decision values</span>
<a id="__codelineno-0-2136" name="__codelineno-0-2136"></a><span class="sd">    and the evaluation results of the taken solutions will be returned.</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>
<a id="__codelineno-0-2138" name="__codelineno-0-2138"></a><span class="sd">    **Support for ObjectArray.**</span>
<a id="__codelineno-0-2139" name="__codelineno-0-2139"></a><span class="sd">    This function supports decision values expressed via instances of</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a><span class="sd">    `ObjectArray`.</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141"></a>
<a id="__codelineno-0-2142" name="__codelineno-0-2142"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2143" name="__codelineno-0-2143"></a><span class="sd">        values: Decision values, expressed via a tensor with at least</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a><span class="sd">            2 dimensions or via an `ObjectArray`. If given as a tensor,</span>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a><span class="sd">            extra leftmost dimensions will be interpreted as batch</span>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a><span class="sd">            dimensions.</span>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a><span class="sd">        evals: Evaluation results tensor, with at least 1 dimension.</span>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a><span class="sd">            Extra leftmost dimensions will be taken as batch dimensions.</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a><span class="sd">        n: If left as None, the single best solution will be taken.</span>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a><span class="sd">            If given as an integer, this number of best solutions will be</span>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a><span class="sd">            taken. Please note that, if the problem at hand has multiple</span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a><span class="sd">            objectives, this argument cannot be omitted.</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a><span class="sd">        objective_sense: In the single-objective case, `objective_sense` is</span>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a><span class="sd">            expected as a string &#39;min&#39; or &#39;max&#39;, representing the direction</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a><span class="sd">            of the optimization. In the multi-objective case,</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a><span class="sd">            `objective_sense` is expected as a list of strings, each string</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a><span class="sd">            being &#39;min&#39; or &#39;max&#39;, representing the goal of optimization for</span>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a><span class="sd">            each objective.</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a><span class="sd">        crowdsort: Relevant only when there are multiple objectives.</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a><span class="sd">            If `crowdsort` is True, the crowding distances of the solutions</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a><span class="sd">            within the given population will be an additional criterion</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a><span class="sd">            when choosing the best `n` solution. If `crowdsort` is False,</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a><span class="sd">            how many times a solution was dominated will be the only factor</span>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a><span class="sd">            when deciding whether or not it is among the best `n` solutions.</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a><span class="sd">        A tuple of the form `(decision_values, evaluation_results)`, where</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a><span class="sd">        `decision_values` is the decision values (as a tensor or as an</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a><span class="sd">        `ObjectArray`) for the taken solution(s), and `evaluation_results`</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a><span class="sd">        is the evaluation results tensor for the taken solution(s).</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">):</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>        <span class="k">return</span> <span class="n">_take_best_considering_objects</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">crowdsort</span><span class="p">)</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>        <span class="n">multi_objective</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>        <span class="n">multi_objective</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unrecognized `objective_sense`: {repr(objective_sense)}&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a>    <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>        <span class="k">if</span> <span class="n">multi_objective</span><span class="p">:</span>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a>                <span class="s2">&quot;`objective_sense` not given as a string, implying that there are multiple objectives.&quot;</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a>                <span class="s2">&quot; When there are multiple objectives, the argument `n` (i.e. number of solutions to take)&quot;</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a>                <span class="s2">&quot; must not be omitted. However, `n` was encountered as None.&quot;</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a>            <span class="p">)</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a>        <span class="k">return</span> <span class="n">_take_single_best</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a>        <span class="k">if</span> <span class="n">multi_objective</span><span class="p">:</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a>            <span class="k">return</span> <span class="n">_take_multiple_best_with_multiobjective</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">crowdsort</span><span class="p">)</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a>            <span class="k">return</span> <span class="n">_take_multiple_best</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.tournament" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tournament</span><span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">num_tournaments</span><span class="p">,</span> <span class="n">tournament_size</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_evals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">split_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.tournament" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Randomly organize pairs of tournaments and pick the winning solutions.</p>
<p>Hyperparameters regarding the tournament selection are
<code>num_tournaments</code> (number of tournaments), and <code>tournament_size</code>
(size of each tournament).</p>
<p><strong>How does each tournament work?</strong>
<code>tournament_size</code> number of solutions are randomly sampled from the given
<code>solutions</code>, and then, the best solution among the sampled solutions is
declared the winner. In the case of single-objective optimization, the
best solution is the one with the best evaluation result (i.e. best
fitness). In the case of multi-objective optimization, the best solution
is the one within the best pareto-front.</p>
<p><strong>How are multiple tournaments are organized?</strong>
Two sets of tournaments are organized. Each set contains <code>n</code> number of
tournaments, <code>n</code> being the half of <code>num_tournaments</code>.
For example, let us assume that <code>num_tournaments</code> is 6. Then, we have:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>First set of tournaments  : tournamentA, tournamentB, tournamentC
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Second set of tournaments : tournamentD, tournamentE, tournamentF
</code></pre></div>
<p>In this organization of tournaments, the winner of tournamentA is meant
for cross-over with the winner of tournamentD; the winner of tournamentB
is meant for cross-over with the winner of tournamentE; and the winner of
tournamentC is meant for cross-over with the winner of tournamentF.</p>
<p>While sampling the participants for these tournaments, it is ensured that
the winner of tournamentA does not participate into tournamentD; the
winner of tournamentB does not participate into tournamentE; and the
winner of tournamentC does not participate into tournamentF. Therefore,
each cross-over operation is applied on two different parent solutions.</p>
<p><strong>How are the tournament results represented?</strong>
The tournament results are returned in various forms. These various forms
are as follows.</p>
<p><strong>Results in the form of decision values.</strong>
This is the default form of results (with <code>return_indices=False</code>,
<code>with_evals=False</code>, <code>split_results=False</code>). Here, the results are
expressed as a single tensor (or <code>ObjectArray</code>) of decision values.
The first half of these decision values represent the first set of
parents, and the second half of these decision values represent the second
half of these decision values represent the second set of parents.
For example, let us assume that the number of tournaments
(<code>num_tournaments</code>) is configured as 6. In this case, the result is a
decision values tensor with 6 rows (or an <code>ObjectArray</code> of length 6).
In these results (let us call them <code>resulting_values</code>), the pairings
for the cross-over operations are as follows:
- <code>resulting_values[0]</code> and <code>resulting_values[3]</code>;
- <code>resulting_values[1]</code> and <code>resulting_values[4]</code>;
- <code>resulting_values[2]</code> and <code>resulting_values[5]</code>.</p>
<p><strong>Results in the form of indices.</strong>
This form of results can be taken with arguments <code>return_indices=True</code>,
<code>with_evals=False</code>, <code>split_results=False</code>. Here, the results are
expressed as a single tensor of integers, each integer being the index
of a solution within <code>solutions</code>.
For example, let us assume that the number of tournaments
(<code>num_tournaments</code>) is configured as 6. In this case, the result is a
tensor of indices of length 6.
In these results (let us call them <code>resulting_indices</code>), the pairings
for the cross-over operations are as follows:
- <code>resulting_indices[0]</code> and <code>resulting_indices[3]</code>;
- <code>resulting_indices[1]</code> and <code>resulting_indices[4]</code>;
- <code>resulting_indices[2]</code> and <code>resulting_indices[5]</code>.</p>
<p><strong>Results in the form of decision values and evaluations.</strong>
This form of results can be taken with arguments <code>return_indices=False</code>,
<code>with_evals=True</code>, <code>split_results=False</code>. Here, the results are expressed
via a named tuple in the form <code>(parent_values=..., parent_evals=...)</code>.
In this tuple, <code>parent_values</code> stores a tensor (or an <code>ObjectArray</code>)
representing the decision values of the picked solutions, and
<code>parent_evals</code> stores the evaluation results as a tensor.
For example, let us assume that the number of tournaments
(<code>num_tournaments</code>) is 6. With this assumption, in the returned named
tuple (let us call it <code>result</code>), the pairings for the cross-over
operations are as follows:
- <code>result.parent_values[0]</code> and <code>result.parent_values[3]</code>;
- <code>result.parent_values[1]</code> and <code>result.parent_values[4]</code>;
- <code>result.parent_values[2]</code> and <code>result.parent_values[5]</code>.
For any solution <code>result.parent_values[i]</code>, the evaluation result
is stored by <code>result.parent_evals[i]</code>.</p>
<p><strong>Results with split parent solutions.</strong>
This form of results can be taken with arguments <code>return_indices=False</code>,
<code>with_evals=False</code>, <code>split_results=True</code>. The returned object is a
named tuple in the form <code>(parent1_values=..., parent2_values=...)</code>.
In the returned named tuple (let us call it <code>result</code>), the pairings for
the cross-over operations are as follows:
- <code>result.parent1_values[0]</code> and <code>result.parent2_values[0]</code>;
- <code>result.parent1_values[1]</code> and <code>result.parent2_values[1]</code>;
- <code>result.parent1_values[2]</code> and <code>result.parent2_values[2]</code>;
- and so on...</p>
<p><strong>Results with split parent solutions and evaluations.</strong>
This form of results can be taken with arguments <code>return_indices=False</code>,
<code>with_evals=True</code>, <code>split_results=True</code>. The returned object is a
named tuple, its attributes being <code>parent1_values</code>, <code>parent1_evals</code>,
<code>parent2_values</code>, and <code>parent2_evals</code>.
In the returned named tuple (let us call it <code>result</code>), the pairings for
the cross-over operations are as follows:
- <code>result.parent1_values[0]</code> and <code>result.parent2_values[0]</code>;
- <code>result.parent1_values[1]</code> and <code>result.parent2_values[1]</code>;
- <code>result.parent1_values[2]</code> and <code>result.parent2_values[2]</code>;
- and so on...
For any solution <code>result.parent_values[i]</code>, the evaluation result
is stored by <code>result.parent_evals[i]</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>solutions</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="torch.Tensor">Tensor</span>, <a class="autorefs autorefs-internal" title="ObjectArray (evotorch.tools.ObjectArray)" href="../../tools/#evotorch.tools.ObjectArray">ObjectArray</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decision values of the solutions. Can be a tensor with
at least 2 dimensions (where extra leftmost dimensions are to be
interpreted as batch dimensions), or an <code>ObjectArray</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation results of the solutions.
In the single-objective case, this is expected as an
at-least-1-dimensional tensor, the <code>i</code>-th item expressing
the evaluation result of the <code>i</code>-th solution.
In the multi-objective case, this is expected as an
at-least-2-dimensional tensor, the <code>(i,j)</code>-th item
expressing the evaluation result of the <code>i</code>-th solution
according to the <code>j</code>-th objective.
Extra leftmost dimensions are interpreted as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_tournaments</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of tournaments that will be applied.
In other words, number of winners that will be picked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tournament_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of solutions to be picked for the tournament</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="list">list</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string or a list of strings, where (each) string
has either the value 'min' for minimization or 'max' for
maximization.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_indices</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If this is given as True, indices of the selected
solutions will be returned, instead of their decision values.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_evals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If this is given as True, evaluations of the selected
solutions will be returned in addition to their decision values.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>split_results</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If this is given as True, tournament results will be
split as first parents and second parents. If this is given as
False, results will be stacked vertically, in the sense that
the first half of the results are the first parents and the
second half of the results are the second parents.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span>
<span class="normal"><a href="#__codelineno-0-984">984</a></span>
<span class="normal"><a href="#__codelineno-0-985">985</a></span>
<span class="normal"><a href="#__codelineno-0-986">986</a></span>
<span class="normal"><a href="#__codelineno-0-987">987</a></span>
<span class="normal"><a href="#__codelineno-0-988">988</a></span>
<span class="normal"><a href="#__codelineno-0-989">989</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="k">def</span><span class="w"> </span><span class="nf">tournament</span><span class="p">(</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>    <span class="n">solutions</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">],</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>    <span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>    <span class="n">num_tournaments</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>    <span class="n">tournament_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>    <span class="n">return_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>    <span class="n">with_evals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>    <span class="n">split_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TournamentResult</span><span class="p">:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">    Randomly organize pairs of tournaments and pick the winning solutions.</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">    Hyperparameters regarding the tournament selection are</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">    `num_tournaments` (number of tournaments), and `tournament_size`</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">    (size of each tournament).</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">    **How does each tournament work?**</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">    `tournament_size` number of solutions are randomly sampled from the given</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">    `solutions`, and then, the best solution among the sampled solutions is</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">    declared the winner. In the case of single-objective optimization, the</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">    best solution is the one with the best evaluation result (i.e. best</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">    fitness). In the case of multi-objective optimization, the best solution</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">    is the one within the best pareto-front.</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">    **How are multiple tournaments are organized?**</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">    Two sets of tournaments are organized. Each set contains `n` number of</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">    tournaments, `n` being the half of `num_tournaments`.</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">    For example, let us assume that `num_tournaments` is 6. Then, we have:</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">    First set of tournaments  : tournamentA, tournamentB, tournamentC</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">    Second set of tournaments : tournamentD, tournamentE, tournamentF</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">    ```</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">    In this organization of tournaments, the winner of tournamentA is meant</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">    for cross-over with the winner of tournamentD; the winner of tournamentB</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">    is meant for cross-over with the winner of tournamentE; and the winner of</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">    tournamentC is meant for cross-over with the winner of tournamentF.</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">    While sampling the participants for these tournaments, it is ensured that</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">    the winner of tournamentA does not participate into tournamentD; the</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">    winner of tournamentB does not participate into tournamentE; and the</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">    winner of tournamentC does not participate into tournamentF. Therefore,</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">    each cross-over operation is applied on two different parent solutions.</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">    **How are the tournament results represented?**</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">    The tournament results are returned in various forms. These various forms</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">    are as follows.</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">    **Results in the form of decision values.**</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">    This is the default form of results (with `return_indices=False`,</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">    `with_evals=False`, `split_results=False`). Here, the results are</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">    expressed as a single tensor (or `ObjectArray`) of decision values.</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">    The first half of these decision values represent the first set of</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">    parents, and the second half of these decision values represent the second</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">    half of these decision values represent the second set of parents.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">    For example, let us assume that the number of tournaments</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">    (`num_tournaments`) is configured as 6. In this case, the result is a</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">    decision values tensor with 6 rows (or an `ObjectArray` of length 6).</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">    In these results (let us call them `resulting_values`), the pairings</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">    for the cross-over operations are as follows:</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">    - `resulting_values[0]` and `resulting_values[3]`;</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">    - `resulting_values[1]` and `resulting_values[4]`;</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">    - `resulting_values[2]` and `resulting_values[5]`.</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">    **Results in the form of indices.**</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">    This form of results can be taken with arguments `return_indices=True`,</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">    `with_evals=False`, `split_results=False`. Here, the results are</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">    expressed as a single tensor of integers, each integer being the index</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">    of a solution within `solutions`.</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">    For example, let us assume that the number of tournaments</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">    (`num_tournaments`) is configured as 6. In this case, the result is a</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">    tensor of indices of length 6.</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">    In these results (let us call them `resulting_indices`), the pairings</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">    for the cross-over operations are as follows:</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">    - `resulting_indices[0]` and `resulting_indices[3]`;</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">    - `resulting_indices[1]` and `resulting_indices[4]`;</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">    - `resulting_indices[2]` and `resulting_indices[5]`.</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">    **Results in the form of decision values and evaluations.**</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">    This form of results can be taken with arguments `return_indices=False`,</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">    `with_evals=True`, `split_results=False`. Here, the results are expressed</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">    via a named tuple in the form `(parent_values=..., parent_evals=...)`.</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">    In this tuple, `parent_values` stores a tensor (or an `ObjectArray`)</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">    representing the decision values of the picked solutions, and</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">    `parent_evals` stores the evaluation results as a tensor.</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">    For example, let us assume that the number of tournaments</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">    (`num_tournaments`) is 6. With this assumption, in the returned named</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">    tuple (let us call it `result`), the pairings for the cross-over</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">    operations are as follows:</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">    - `result.parent_values[0]` and `result.parent_values[3]`;</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">    - `result.parent_values[1]` and `result.parent_values[4]`;</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">    - `result.parent_values[2]` and `result.parent_values[5]`.</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">    For any solution `result.parent_values[i]`, the evaluation result</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">    is stored by `result.parent_evals[i]`.</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">    **Results with split parent solutions.**</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">    This form of results can be taken with arguments `return_indices=False`,</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">    `with_evals=False`, `split_results=True`. The returned object is a</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">    named tuple in the form `(parent1_values=..., parent2_values=...)`.</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">    In the returned named tuple (let us call it `result`), the pairings for</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">    the cross-over operations are as follows:</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">    - `result.parent1_values[0]` and `result.parent2_values[0]`;</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">    - `result.parent1_values[1]` and `result.parent2_values[1]`;</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">    - `result.parent1_values[2]` and `result.parent2_values[2]`;</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    - and so on...</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">    **Results with split parent solutions and evaluations.**</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">    This form of results can be taken with arguments `return_indices=False`,</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">    `with_evals=True`, `split_results=True`. The returned object is a</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">    named tuple, its attributes being `parent1_values`, `parent1_evals`,</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">    `parent2_values`, and `parent2_evals`.</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">    In the returned named tuple (let us call it `result`), the pairings for</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">    the cross-over operations are as follows:</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">    - `result.parent1_values[0]` and `result.parent2_values[0]`;</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">    - `result.parent1_values[1]` and `result.parent2_values[1]`;</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">    - `result.parent1_values[2]` and `result.parent2_values[2]`;</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">    - and so on...</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">    For any solution `result.parent_values[i]`, the evaluation result</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">    is stored by `result.parent_evals[i]`.</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">        solutions: Decision values of the solutions. Can be a tensor with</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">            at least 2 dimensions (where extra leftmost dimensions are to be</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">            interpreted as batch dimensions), or an `ObjectArray`.</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        evals: Evaluation results of the solutions.</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">            In the single-objective case, this is expected as an</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">            at-least-1-dimensional tensor, the `i`-th item expressing</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">            the evaluation result of the `i`-th solution.</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">            In the multi-objective case, this is expected as an</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">            at-least-2-dimensional tensor, the `(i,j)`-th item</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">            expressing the evaluation result of the `i`-th solution</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">            according to the `j`-th objective.</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">            Extra leftmost dimensions are interpreted as batch dimensions.</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">        num_tournaments: Number of tournaments that will be applied.</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="sd">            In other words, number of winners that will be picked.</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="sd">        tournament_size: Number of solutions to be picked for the tournament</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">        objective_sense: A string or a list of strings, where (each) string</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">            has either the value &#39;min&#39; for minimization or &#39;max&#39; for</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">            maximization.</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        return_indices: If this is given as True, indices of the selected</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">            solutions will be returned, instead of their decision values.</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">        with_evals: If this is given as True, evaluations of the selected</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">            solutions will be returned in addition to their decision values.</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">        split_results: If this is given as True, tournament results will be</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">            split as first parents and second parents. If this is given as</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">            False, results will be stacked vertically, in the sense that</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">            the first half of the results are the first parents and the</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">            second half of the results are the second parents.</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="sd">        Selected solutions (or their indices, with or without their</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">        evaluation results).</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>    <span class="k">if</span> <span class="n">return_indices</span> <span class="ow">and</span> <span class="n">with_evals</span><span class="p">:</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>            <span class="s2">&quot;When `return_indices` is given as True, `with_evals` must be False.&quot;</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>            <span class="s2">&quot; However, `with_evals` was encountered as True.&quot;</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>        <span class="p">)</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">):</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>        <span class="n">pick_fn</span> <span class="o">=</span> <span class="n">_pick_pairs_via_tournament_considering_objects</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>            <span class="n">pick_fn</span> <span class="o">=</span> <span class="n">_pick_pairs_via_tournament_with_single_objective</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>            <span class="n">pick_fn</span> <span class="o">=</span> <span class="n">_pick_pairs_via_tournament_with_multi_objective</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized `objective_sense`: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>    <span class="k">return</span> <span class="n">pick_fn</span><span class="p">(</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>        <span class="n">solutions</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="n">num_tournaments</span><span class="p">,</span> <span class="n">tournament_size</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">return_indices</span><span class="p">,</span> <span class="n">with_evals</span><span class="p">,</span> <span class="n">split_results</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.two_point_cross_over" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">two_point_cross_over</span><span class="p">(</span><span class="n">parents</span><span class="p">,</span> <span class="n">evals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tournament_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_children</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objective_sense</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.two_point_cross_over" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Apply two-point cross-over on the given <code>parents</code>.</p>
<p>Let us assume that we have the following two parent solutions:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>         ________________________
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>parentA | a1  a2  a3  a4  a5  a6 |
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>parentB | b1  b2  b3  b4  b5  b6 |
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        |________________________|
</code></pre></div>
<p>This cross-over operation will first randomly decide two cutting points:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>         ________|____________|____
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>parentA | a1  a2 | a3  a4  a5 | a6 |
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>parentB | b1  b2 | b3  b4  b5 | b6 |
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>        |________|____________|____|
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>                 |            |
</code></pre></div>
<p>...and then form the following child solutions by recombining the decision
values of the parents:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>         ________|____________|____
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>child1  | a1  a2 | b3  b4  b5 | a6 |
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>child2  | b1  b2 | a3  a4  a5 | b6 |
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>        |________|____________|____|
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>                 |            |
</code></pre></div>
<p>If <code>tournament_size</code> is given, parents for the cross-over operation will
be picked with the help of a tournament. Otherwise, the first half of the
given <code>parents</code> will be the first set of parents, and the second half
of the given <code>parents</code> will be the second set of parents.</p>
<p>The return value of this function is a new tensor containing the decision
values of the child solutions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parents</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor with at least 2 dimensions, representing the decision
values of the parent solutions. If this tensor has more than 2
dimensions, the extra leftmost dimension(s) will be considered as
batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tensor with at least 1 dimension, representing the evaluation
results (i.e. fitnesses) of the parent solutions. If this tensor
has more than 1 dimension, the extra leftmost dimension(s) will be
considered as batch dimensions. If <code>tournament_size</code> is not given,
<code>evals</code> can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tournament_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as an integer that is greater than or equal
to 1, the parents for the cross-over operation will be picked
with the help of a tournament. In more details, each parent will
be picked as the result of comparing multiple competing solutions,
the number of these competing solutions being equal to this
<code>tournament_size</code>. Please note that, if <code>tournament_size</code> is given
as an integer, the arguments <code>evals</code> and <code>objective_sense</code> are
also required. If <code>tournament_size</code> is left as None, the first half
of <code>parents</code> will be the first set of parents, and the second half
of <code>parents</code> will be the second set of parents.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_children</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally the number of children to produce as the
result of tournament selection and cross-over, as an even integer.
If tournament selection is enabled (i.e. if <code>tournament_size</code> is
an integer) but <code>num_children</code> is omitted, the number of children
will be equal to the number of <code>parents</code>.
If there is no tournament selection (i.e. if <code>tournament_size</code> is
None), <code>num_children</code> is expected to be None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mandatory if <code>tournament_size</code> is not None.
For when there is only one objective, <code>objective_sense</code> is
expected as 'max' for when the goal of the optimization is to
maximize <code>evals</code>, 'min' for when the goal of the optimization is
to minimize <code>evals</code>. For when there are multiple objectives,
<code>objective_sense</code> is expected as a list of strings, where each
string is either 'min' or 'max'.
If <code>tournament_size</code> is None, <code>objective_sense</code> can also be left
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="k">def</span><span class="w"> </span><span class="nf">two_point_cross_over</span><span class="p">(</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>    <span class="n">parents</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>    <span class="n">evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>    <span class="n">tournament_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>    <span class="n">num_children</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a><span class="sd">    Apply two-point cross-over on the given `parents`.</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><span class="sd">    Let us assume that we have the following two parent solutions:</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="sd">             ________________________</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">    parentA | a1  a2  a3  a4  a5  a6 |</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><span class="sd">    parentB | b1  b2  b3  b4  b5  b6 |</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><span class="sd">            |________________________|</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">    This cross-over operation will first randomly decide two cutting points:</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a><span class="sd">             ________|____________|____</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><span class="sd">    parentA | a1  a2 | a3  a4  a5 | a6 |</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><span class="sd">    parentB | b1  b2 | b3  b4  b5 | b6 |</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><span class="sd">            |________|____________|____|</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="sd">                     |            |</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">    ...and then form the following child solutions by recombining the decision</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">    values of the parents:</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">             ________|____________|____</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">    child1  | a1  a2 | b3  b4  b5 | a6 |</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">    child2  | b1  b2 | a3  a4  a5 | b6 |</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="sd">            |________|____________|____|</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">                     |            |</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">    If `tournament_size` is given, parents for the cross-over operation will</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a><span class="sd">    be picked with the help of a tournament. Otherwise, the first half of the</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">    given `parents` will be the first set of parents, and the second half</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">    of the given `parents` will be the second set of parents.</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">    The return value of this function is a new tensor containing the decision</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">    values of the child solutions.</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a><span class="sd">        parents: A tensor with at least 2 dimensions, representing the decision</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a><span class="sd">            values of the parent solutions. If this tensor has more than 2</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a><span class="sd">            dimensions, the extra leftmost dimension(s) will be considered as</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a><span class="sd">            batch dimensions.</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a><span class="sd">        evals: A tensor with at least 1 dimension, representing the evaluation</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="sd">            results (i.e. fitnesses) of the parent solutions. If this tensor</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="sd">            has more than 1 dimension, the extra leftmost dimension(s) will be</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a><span class="sd">            considered as batch dimensions. If `tournament_size` is not given,</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a><span class="sd">            `evals` can be left as None.</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><span class="sd">        tournament_size: If given as an integer that is greater than or equal</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a><span class="sd">            to 1, the parents for the cross-over operation will be picked</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a><span class="sd">            with the help of a tournament. In more details, each parent will</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a><span class="sd">            be picked as the result of comparing multiple competing solutions,</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><span class="sd">            the number of these competing solutions being equal to this</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a><span class="sd">            `tournament_size`. Please note that, if `tournament_size` is given</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a><span class="sd">            as an integer, the arguments `evals` and `objective_sense` are</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><span class="sd">            also required. If `tournament_size` is left as None, the first half</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><span class="sd">            of `parents` will be the first set of parents, and the second half</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a><span class="sd">            of `parents` will be the second set of parents.</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a><span class="sd">        num_children: Optionally the number of children to produce as the</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="sd">            result of tournament selection and cross-over, as an even integer.</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a><span class="sd">            If tournament selection is enabled (i.e. if `tournament_size` is</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a><span class="sd">            an integer) but `num_children` is omitted, the number of children</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a><span class="sd">            will be equal to the number of `parents`.</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">            If there is no tournament selection (i.e. if `tournament_size` is</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="sd">            None), `num_children` is expected to be None.</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">        objective_sense: Mandatory if `tournament_size` is not None.</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">            For when there is only one objective, `objective_sense` is</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a><span class="sd">            expected as &#39;max&#39; for when the goal of the optimization is to</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><span class="sd">            maximize `evals`, &#39;min&#39; for when the goal of the optimization is</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="sd">            to minimize `evals`. For when there are multiple objectives,</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a><span class="sd">            `objective_sense` is expected as a list of strings, where each</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a><span class="sd">            string is either &#39;min&#39; or &#39;max&#39;.</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a><span class="sd">            If `tournament_size` is None, `objective_sense` can also be left</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a><span class="sd">        Decision values of the child solutions, as a new tensor.</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>    <span class="k">return</span> <span class="n">multi_point_cross_over</span><span class="p">(</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>        <span class="n">parents</span><span class="p">,</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>        <span class="n">evals</span><span class="p">,</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>        <span class="n">num_points</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>        <span class="n">num_children</span><span class="o">=</span><span class="n">num_children</span><span class="p">,</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>        <span class="n">tournament_size</span><span class="o">=</span><span class="n">tournament_size</span><span class="p">,</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>        <span class="n">objective_sense</span><span class="o">=</span><span class="n">objective_sense</span><span class="p">,</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.operators.functional.utility" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">utility</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="s1">&#39;centered&#39;</span><span class="p">)</span></code>

<a href="#evotorch.operators.functional.utility" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return utility values representing how good the evaluation results are.</p>
<p>A utility number is different from <code>evals</code> in the sense that, worst
solution has the lowest utility, and the best solution has the highest
utility, regardless of the objective sense ('min' or 'max').
On the other hand, the lowest number within <code>evals</code> could represent
the fitness of the best solution or of the worst solution, depending
on the objective sense.</p>
<p>The "centered" ranking is the same ranking method that was used within:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Tim Salimans, Jonathan Ho, Xi Chen, Szymon Sidor, Ilya Sutskever (2017).
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Evolution Strategies as a Scalable Alternative to Reinforcement Learning
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An at least 1-dimensional tensor that stores evaluation results
(i.e. fitness values). Extra leftmost dimensions will be taken as
batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string whose value is either 'min' or 'max', which
represents the goal of the optimization (minimization or
maximization).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ranking_method</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ranking method according to which the utilities will
be computed. Currently, this function supports:
'centered' (worst one gets -0.5, best one gets 0.5);
'linear' (worst one gets 0.0, best one gets 1.0);
'raw' (evaluation results themselves are returned, with the
additional behavior of flipping the signs if <code>objective_sense</code>
is 'min', ensuring that the worst evaluation result gets the
lowest value, and the best evaluation result gets the highest
value). None also means 'raw'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;centered&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/operators/functional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="k">def</span><span class="w"> </span><span class="nf">utility</span><span class="p">(</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>    <span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>    <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;centered&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a><span class="sd">    Return utility values representing how good the evaluation results are.</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a><span class="sd">    A utility number is different from `evals` in the sense that, worst</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a><span class="sd">    solution has the lowest utility, and the best solution has the highest</span>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a><span class="sd">    utility, regardless of the objective sense (&#39;min&#39; or &#39;max&#39;).</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a><span class="sd">    On the other hand, the lowest number within `evals` could represent</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a><span class="sd">    the fitness of the best solution or of the worst solution, depending</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a><span class="sd">    on the objective sense.</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a><span class="sd">    The &quot;centered&quot; ranking is the same ranking method that was used within:</span>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a><span class="sd">    Tim Salimans, Jonathan Ho, Xi Chen, Szymon Sidor, Ilya Sutskever (2017).</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a><span class="sd">    Evolution Strategies as a Scalable Alternative to Reinforcement Learning</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a><span class="sd">        evals: An at least 1-dimensional tensor that stores evaluation results</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a><span class="sd">            (i.e. fitness values). Extra leftmost dimensions will be taken as</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a><span class="sd">            batch dimensions.</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a><span class="sd">        objective_sense: A string whose value is either &#39;min&#39; or &#39;max&#39;, which</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a><span class="sd">            represents the goal of the optimization (minimization or</span>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a><span class="sd">            maximization).</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a><span class="sd">        ranking_method: Ranking method according to which the utilities will</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a><span class="sd">            be computed. Currently, this function supports:</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a><span class="sd">            &#39;centered&#39; (worst one gets -0.5, best one gets 0.5);</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a><span class="sd">            &#39;linear&#39; (worst one gets 0.0, best one gets 1.0);</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a><span class="sd">            &#39;raw&#39; (evaluation results themselves are returned, with the</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a><span class="sd">            additional behavior of flipping the signs if `objective_sense`</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a><span class="sd">            is &#39;min&#39;, ensuring that the worst evaluation result gets the</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a><span class="sd">            lowest value, and the best evaluation result gets the highest</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a><span class="sd">            value). None also means &#39;raw&#39;.</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a><span class="sd">        Utility values, as a tensor whose shape is the same with the shape of</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a><span class="sd">        `evals`.</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>        <span class="k">return</span> <span class="n">_utility</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">ranking_method</span><span class="p">)</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>            <span class="s2">&quot;The argument `objective_sense` was received as an iterable other than string,&quot;</span>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>            <span class="s2">&quot; implying that the problem at hand has multiple objectives.&quot;</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a>            <span class="s2">&quot; However, this `utility(...)` function does not support multiple objectives.&quot;</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>            <span class="s2">&quot; Consider using `pareto_utility(...)`.&quot;</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>        <span class="p">)</span>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized `objective_sense`: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 NNAISENSE SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>