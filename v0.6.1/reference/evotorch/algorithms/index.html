
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="EvoTorch is an open source evolutionary computation library developed at NNAISENSE, built on top of PyTorch.">
      
      
      
      
        <link rel="prev" href="../testing/">
      
      
        <link rel="next" href="cmaes/">
      
      
      <link rel="icon" href="../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Index - EvoTorch</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#evotorch.algorithms" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-header__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EvoTorch
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../quickstart/" class="md-tabs__link">
        
  
  
    
  
  Quickstart

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../user_guide/general_usage/" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../advanced_usage/solution_batch/" class="md-tabs__link">
          
  
  
    
  
  Advanced Usage

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-nav__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EvoTorch
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/general_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/algorithm_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithm Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/algorithms_tour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms Tour
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/problems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Defining Problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/problem_parallelization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Problem Parallelization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/neuroevolution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/gym/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution for Gym
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/supervised_ne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervised Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/solution_batch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manipulating Solutions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/dist_based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributed Evolution Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/custom_ea/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Searchers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/custom_logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Loggers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/ray_cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Ray Clusters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Brax_Experiments_Visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization of the brax Experiment Results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Brax_Experiments_with_PGPE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving a Brax environment using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Evolving_Objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Feature_Space_Illumination_with_MAPElites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Space Illumination with MAPElites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Genetic_Programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic Programming using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Gym_Experiments_with_PGPE_and_CoSyNE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gym Experiments with PGPE and CoSyNE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Minimizing_Lennard-Jones_Atom_Cluster_Potentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimising Lennard-Jones Atom Cluster Potentials with Evolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Training_MNIST30K/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training MNIST30K
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Variational_Quantum_Eigensolvers_with_SNES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variational Quantum Eigensolvers with SNES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/batched_searches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maintaining a batch of populations using the functional EvoTorch API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/constrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving constrained optimization problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/func_rl_ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving objects using the functional operators API of EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/functional_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic algorithm with the help of functional operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/multiobj_batched_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multiobjective optimization via functional operators API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving reinforcement learning tasks using functional evolutionary algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/reacher_mpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Predictive Control (MPC) with EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Evotorch
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Evotorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimizers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_6_1_8" id="__nav_6_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1_8">
            <span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ga
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mapelites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mapelites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="pycmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pycmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="searchalgorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Searchalgorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="distributed/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Distributed
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_7" id="__nav_6_1_8_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_7">
            <span class="md-nav__icon md-icon"></span>
            Distributed
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="distributed/gaussian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="functional/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_8" id="__nav_6_1_8_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_8">
            <span class="md-nav__icon md-icon"></span>
            Functional
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="functional/funcadam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcadam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="functional/funccem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funccem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="functional/funcclipup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcclipup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="functional/funcpgpe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcpgpe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="functional/funcsgd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcsgd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="functional/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="restarter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Restarter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_9" id="__nav_6_1_8_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_9">
            <span class="md-nav__icon md-icon"></span>
            Restarter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="restarter/modify_restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modify restart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="restarter/restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../neuroevolution/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9" id="__nav_6_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9">
            <span class="md-nav__icon md-icon"></span>
            Neuroevolution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/baseneproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Baseneproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/gymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/neproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/supervisedne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervisedne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/vecgymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecgymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../neuroevolution/net/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Net
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9_7" id="__nav_6_1_9_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_9_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9_7">
            <span class="md-nav__icon md-icon"></span>
            Net
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/layers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/multilayered/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multilayered
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/rl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rl
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/runningnorm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningnorm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/runningstat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningstat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/statefulmodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statefulmodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/vecrl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecrl
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../operators/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_10" id="__nav_6_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_10">
            <span class="md-nav__icon md-icon"></span>
            Operators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/real/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Real
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sequence
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../tools/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_11" id="__nav_6_1_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_11">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/cloning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/hook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/immutable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Immutable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/objectarray/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Objectarray
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/ranking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ranking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/readonlytensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Readonlytensor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/recursiveprintable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recursiveprintable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/structures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/tensorframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensorframe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/tensormaker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensormaker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      algorithms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.CEM" class="md-nav__link">
    <span class="md-ellipsis">
      CEM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CEM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CEM.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES" class="md-nav__link">
    <span class="md-ellipsis">
      CMAES
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CMAES">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.obj_index" class="md-nav__link">
    <span class="md-ellipsis">
      obj_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.population" class="md-nav__link">
    <span class="md-ellipsis">
      population
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.decompose_C" class="md-nav__link">
    <span class="md-ellipsis">
      decompose_C
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.get_population_weights" class="md-nav__link">
    <span class="md-ellipsis">
      get_population_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.sample_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      sample_distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.update_C" class="md-nav__link">
    <span class="md-ellipsis">
      update_C
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.update_m" class="md-nav__link">
    <span class="md-ellipsis">
      update_m
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.update_p_c" class="md-nav__link">
    <span class="md-ellipsis">
      update_p_c
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.update_p_sigma" class="md-nav__link">
    <span class="md-ellipsis">
      update_p_sigma
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.CMAES.update_sigma" class="md-nav__link">
    <span class="md-ellipsis">
      update_sigma
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.Cosyne" class="md-nav__link">
    <span class="md-ellipsis">
      Cosyne
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cosyne">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.Cosyne.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.GeneticAlgorithm" class="md-nav__link">
    <span class="md-ellipsis">
      GeneticAlgorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GeneticAlgorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.GeneticAlgorithm.population" class="md-nav__link">
    <span class="md-ellipsis">
      population
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.GeneticAlgorithm.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.MAPElites" class="md-nav__link">
    <span class="md-ellipsis">
      MAPElites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MAPElites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.MAPElites.filled" class="md-nav__link">
    <span class="md-ellipsis">
      filled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.MAPElites.population" class="md-nav__link">
    <span class="md-ellipsis">
      population
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.MAPElites.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.MAPElites.make_feature_grid" class="md-nav__link">
    <span class="md-ellipsis">
      make_feature_grid
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.PGPE" class="md-nav__link">
    <span class="md-ellipsis">
      PGPE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PGPE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.PGPE.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.PyCMAES" class="md-nav__link">
    <span class="md-ellipsis">
      PyCMAES
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PyCMAES">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.PyCMAES.obj_index" class="md-nav__link">
    <span class="md-ellipsis">
      obj_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.PyCMAES.population" class="md-nav__link">
    <span class="md-ellipsis">
      population
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.PyCMAES.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.SNES" class="md-nav__link">
    <span class="md-ellipsis">
      SNES
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SNES">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SNES.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm" class="md-nav__link">
    <span class="md-ellipsis">
      SearchAlgorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SearchAlgorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.after_step_hook" class="md-nav__link">
    <span class="md-ellipsis">
      after_step_hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.before_step_hook" class="md-nav__link">
    <span class="md-ellipsis">
      before_step_hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.end_of_run_hook" class="md-nav__link">
    <span class="md-ellipsis">
      end_of_run_hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.first_step_datetime" class="md-nav__link">
    <span class="md-ellipsis">
      first_step_datetime
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.is_terminated" class="md-nav__link">
    <span class="md-ellipsis">
      is_terminated
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.log_hook" class="md-nav__link">
    <span class="md-ellipsis">
      log_hook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.problem" class="md-nav__link">
    <span class="md-ellipsis">
      problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.step_count" class="md-nav__link">
    <span class="md-ellipsis">
      step_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.steps_count" class="md-nav__link">
    <span class="md-ellipsis">
      steps_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.reset_first_step_datetime" class="md-nav__link">
    <span class="md-ellipsis">
      reset_first_step_datetime
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SearchAlgorithm.step" class="md-nav__link">
    <span class="md-ellipsis">
      step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.SteadyStateGA" class="md-nav__link">
    <span class="md-ellipsis">
      SteadyStateGA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SteadyStateGA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SteadyStateGA.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.SteadyStateGA.use" class="md-nav__link">
    <span class="md-ellipsis">
      use
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.XNES" class="md-nav__link">
    <span class="md-ellipsis">
      XNES
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XNES">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.algorithms.XNES.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Index</h1>

<div class="doc doc-object doc-module">



<a id="evotorch.algorithms"></a>
    <div class="doc doc-contents first">

        <p>This namespace contains the implementations of various
evolutionary algorithms.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.CEM" class="doc doc-heading">
            <code>CEM</code>


<a href="#evotorch.algorithms.CEM" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="GaussianSearchAlgorithm (evotorch.algorithms.distributed.gaussian.GaussianSearchAlgorithm)" href="distributed/gaussian/#evotorch.algorithms.distributed.gaussian.GaussianSearchAlgorithm">GaussianSearchAlgorithm</a></code></p>


        <p>The cross-entropy method (CEM) (Rubinstein, 1999).</p>
<p>This CEM implementation is focused on continuous optimization,
and follows the variant explained in Duan et al. (2016).</p>
<p>The adaptive population size mechanism explained in Toklu et al. (2020)
(and previously used in the accompanying source code of the study
Salimans et al. (2017)) is supported, where the population size in an
iteration keeps increasing until a certain numberof interactions with
the simulator of the reinforcement learning environment is made.
See the initialization arguments <code>num_interactions</code>, <code>popsize_max</code>.</p>
<p>References:</p>
<div class="highlight"><pre><span></span><code>Rubinstein, R. (1999). The cross-entropy method for combinatorial
and continuous optimization.
Methodology and computing in applied probability, 1(2), 127-190.

Duan, Y., Chen, X., Houthooft, R., Schulman, J., Abbeel, P. (2016).
Benchmarking deep reinforcement learning for continuous control.
International conference on machine learning. PMLR, 2016.

Salimans, T., Ho, J., Chen, X., Sidor, S. and Sutskever, I. (2017).
Evolution Strategies as a Scalable Alternative to
Reinforcement Learning.

Toklu, N.E., Liskowski, P., Srivastava, R.K. (2020).
ClipUp: A Simple and Powerful Optimizer
for Distribution-based Policy Evolution.
Parallel Problem Solving from Nature (PPSN 2020).
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/distributed/gaussian.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="k">class</span><span class="w"> </span><span class="nc">CEM</span><span class="p">(</span><span class="n">GaussianSearchAlgorithm</span><span class="p">):</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">    The cross-entropy method (CEM) (Rubinstein, 1999).</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">    This CEM implementation is focused on continuous optimization,</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">    and follows the variant explained in Duan et al. (2016).</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">    The adaptive population size mechanism explained in Toklu et al. (2020)</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">    (and previously used in the accompanying source code of the study</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">    Salimans et al. (2017)) is supported, where the population size in an</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">    iteration keeps increasing until a certain numberof interactions with</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">    the simulator of the reinforcement learning environment is made.</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">    See the initialization arguments `num_interactions`, `popsize_max`.</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">    References:</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">        Rubinstein, R. (1999). The cross-entropy method for combinatorial</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="sd">        and continuous optimization.</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">        Methodology and computing in applied probability, 1(2), 127-190.</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">        Duan, Y., Chen, X., Houthooft, R., Schulman, J., Abbeel, P. (2016).</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">        Benchmarking deep reinforcement learning for continuous control.</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">        International conference on machine learning. PMLR, 2016.</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="sd">        Salimans, T., Ho, J., Chen, X., Sidor, S. and Sutskever, I. (2017).</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">        Evolution Strategies as a Scalable Alternative to</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">        Reinforcement Learning.</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">        Toklu, N.E., Liskowski, P., Srivastava, R.K. (2020).</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">        ClipUp: A Simple and Powerful Optimizer</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">        for Distribution-based Policy Evolution.</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">        Parallel Problem Solving from Nature (PPSN 2020).</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>    <span class="n">DISTRIBUTION_TYPE</span> <span class="o">=</span> <span class="n">SeparableGaussian</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>    <span class="n">DISTRIBUTION_PARAMS</span> <span class="o">=</span> <span class="bp">NotImplemented</span>  <span class="c1"># To be filled by the CEM instance</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>        <span class="n">parenthood_ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>        <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>        <span class="n">radius_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>        <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>        <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>        <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>        <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>        <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>        <span class="n">stdev_max_change</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">RealOrVector</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>        <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>        <span class="n">distributed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>        <span class="n">popsize_weighted_grad_avg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>    <span class="p">):</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">        `__init__(...)`: Initialize the search algorithm.</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">            problem: The problem object to work on.</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">            popsize: The population size.</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">            parenthood_ratio: Expected as a float larger than 0 and smaller</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">                than 1. For example, setting this value to 0.1 means that</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">                the top 10% of the population will be declared as the parents,</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">                and those parents will be used for updating the population.</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">                The amount of parents is always computed according to the</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">                specified `popsize`, not according to the adapted population</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">                size, and not according to `popsize_max`.</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">            stdev_init: The initial standard deviation of the search</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">                distribution, expressed as a scalar or as an array.</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">                Determines the initial coverage area of the search</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">                If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">                argument `radius_init` instead, then `stdev_init` is expected</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">                as None.</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">            radius_init: The initial radius of the search distribution,</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">                expressed as a scalar.</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">                Determines the initial coverage area of the search</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">                Here, &quot;radius&quot; is defined as the norm of the search</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">                If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">                argument `stdev_init` instead, then `radius_init` is expected</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">                as None.</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">            num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">                it is ensured that a population has interacted with</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">                the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">                has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">                too small, and gets extended with more samples,</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">                until n amount of interactions is reached.</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">                When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">                affecting the size of a population.</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">            popsize_max: Having `num_interactions` set as an integer</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">                might cause the effective population size jump to</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">                unnecesarily large numbers. To prevent this,</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">                one can set `popsize_max` to specify an upper</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">                bound for the effective population size.</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">            center_init: The initial center solution.</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">                Can be left as None.</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">            stdev_min: The minimum value for the standard deviation</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">                values of the Gaussian search distribution.</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">                Can be left as None (which is the default),</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">                or can be given as a scalar or as a 1-dimensional array.</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">            stdev_max: The maximum value for the standard deviation</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="sd">                values of the Gaussian search distribution.</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="sd">                Can be left as None (which is the default),</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">                or can be given as a scalar or as a 1-dimensional array.</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">            stdev_max_change: The maximum update ratio allowed on the</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">                standard deviation. Expected as None if no such limiter</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">                is needed, or as a real number within 0.0 and 1.0 otherwise.</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">                In the PGPE implementation of Ha (2017, 2018), a value of</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">                0.2 (20%) was used.</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">                For this CEM implementation, the default is None.</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">            obj_index: Index of the objective according to which the</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">                gradient estimations will be done.</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">                For single-objective problems, this can be left as None.</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">            distributed: Whether or not the gradient computation will</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">                be distributed. If `distributed` is given as False and</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">                the problem is not parallelized, then everything will</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">                be centralized (i.e. the entire computation will happen</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">                in the main process).</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">                If `distributed` is given as False, and the problem</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">                is parallelized, then the population will be created</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">                in the main process and then sent to remote workers</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">                for parallelized evaluation, and then the remote fitnesses</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">                will be collected by the main process again for computing</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">                the search gradients.</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">                If `distributed` is given as True, and the problem</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">                is parallelized, then the search algorithm itself will</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">                be distributed, in the sense that each remote actor will</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">                generate its own population (such that the total population</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">                size across all these actors becomes equal to `popsize`)</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">                and will compute its own gradient, and then the main process</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">                will collect these gradients, compute the averaged gradients</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">                and update the main search distribution.</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">                Non-distributed mode has the advantage of keeping the</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">                population in the main process, which is good when one wishes</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">                to do detailed monitoring during the evolutionary process,</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">                but has the disadvantage of having to pass the solutions to</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">                the remote actors and having to collect fitnesses, which</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">                might result in increased interprocess communication traffic.</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">                On the other hand, while it is not possible to monitor the</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">                population in distributed mode, the distributed mode has the</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">                advantage of significantly reducing the interprocess</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">                communication traffic, since the only things communicated</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">                with the remote actors are the search distributions (not the</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">                solutions) and the gradients.</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">            popsize_weighted_grad_avg: Only to be used in distributed mode.</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">                (where being in distributed mode means `distributed` is given</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">                as True). In distributed mode, each actor remotely samples</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">                its own solution batches and computes its own gradients.</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">                These gradients are then collected, and a final average</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">                gradient is computed.</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">                If `popsize_weighted_grad_avg` is True, then, while averaging</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">                over the gradients, each gradient will have its own weight</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">                that is computed according to how many solutions were sampled</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">                by the actor that produced the gradient.</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">                If `popsize_weighted_grad_avg` is False, then, there will not</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">                be weighted averaging (or, each gradient will have equal</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">                weight).</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">                If `popsize_weighted_grad_avg` is None, then, the gradient</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">                weights will be equal a value for `num_interactions` is given</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">                (because `num_interactions` affects the number of solutions</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">                according to the episode lengths, and popsize-weighting the</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">                gradients could be misleading); and the gradient weights will</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">                be weighted according to the sub-population (i.e. sub-batch)</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">                sizes if `num_interactions` is left as None.</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">                The default value for `popsize_weighted_grad_avg` is None.</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">                When the distributed mode is disabled (i.e. when `distributed`</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">                is False), then the argument `popsize_weighted_grad_avg` is</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">                expected as None.</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DISTRIBUTION_PARAMS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;parenthood_ratio&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">parenthood_ratio</span><span class="p">)}</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>            <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>            <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>            <span class="n">center_learning_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>            <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>            <span class="n">stdev_init</span><span class="o">=</span><span class="n">stdev_init</span><span class="p">,</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>            <span class="n">radius_init</span><span class="o">=</span><span class="n">radius_init</span><span class="p">,</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>            <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>            <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>            <span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>            <span class="n">optimizer_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>            <span class="n">ranking_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>            <span class="n">center_init</span><span class="o">=</span><span class="n">center_init</span><span class="p">,</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>            <span class="n">stdev_min</span><span class="o">=</span><span class="n">stdev_min</span><span class="p">,</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>            <span class="n">stdev_max</span><span class="o">=</span><span class="n">stdev_max</span><span class="p">,</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>            <span class="n">stdev_max_change</span><span class="o">=</span><span class="n">stdev_max_change</span><span class="p">,</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>            <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>            <span class="n">distributed</span><span class="o">=</span><span class="n">distributed</span><span class="p">,</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>            <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="n">popsize_weighted_grad_avg</span><span class="p">,</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.CEM.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="n">parenthood_ratio</span><span class="p">,</span> <span class="n">stdev_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">radius_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_interactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">popsize_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_max_change</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distributed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.CEM.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the search algorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem object to work on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The population size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parenthood_ratio</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expected as a float larger than 0 and smaller
than 1. For example, setting this value to 0.1 means that
the top 10% of the population will be declared as the parents,
and those parents will be used for updating the population.
The amount of parents is always computed according to the
specified <code>popsize</code>, not according to the adapted population
size, and not according to <code>popsize_max</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial standard deviation of the search
distribution, expressed as a scalar or as an array.
Determines the initial coverage area of the search
distribution.
If one wishes to configure the coverage area via the
argument <code>radius_init</code> instead, then <code>stdev_init</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radius_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial radius of the search distribution,
expressed as a scalar.
Determines the initial coverage area of the search
distribution.
Here, "radius" is defined as the norm of the search
distribution.
If one wishes to configure the coverage area via the
argument <code>stdev_init</code> instead, then <code>radius_init</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_interactions</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When given as an integer n,
it is ensured that a population has interacted with
the GymProblem's environment n times. If this target
has not been reached yet, then the population is declared
too small, and gets extended with more samples,
until n amount of interactions is reached.
When given as None, popsize is the only configuration
affecting the size of a population.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Having <code>num_interactions</code> set as an integer
might cause the effective population size jump to
unnecesarily large numbers. To prevent this,
one can set <code>popsize_max</code> to specify an upper
bound for the effective population size.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial center solution.
Can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_min</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum value for the standard deviation
values of the Gaussian search distribution.
Can be left as None (which is the default),
or can be given as a scalar or as a 1-dimensional array.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum value for the standard deviation
values of the Gaussian search distribution.
Can be left as None (which is the default),
or can be given as a scalar or as a 1-dimensional array.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_max_change</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="evotorch.tools.RealOrVector">RealOrVector</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum update ratio allowed on the
standard deviation. Expected as None if no such limiter
is needed, or as a real number within 0.0 and 1.0 otherwise.
In the PGPE implementation of Ha (2017, 2018), a value of
0.2 (20%) was used.
For this CEM implementation, the default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj_index</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the objective according to which the
gradient estimations will be done.
For single-objective problems, this can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distributed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the gradient computation will
be distributed. If <code>distributed</code> is given as False and
the problem is not parallelized, then everything will
be centralized (i.e. the entire computation will happen
in the main process).
If <code>distributed</code> is given as False, and the problem
is parallelized, then the population will be created
in the main process and then sent to remote workers
for parallelized evaluation, and then the remote fitnesses
will be collected by the main process again for computing
the search gradients.
If <code>distributed</code> is given as True, and the problem
is parallelized, then the search algorithm itself will
be distributed, in the sense that each remote actor will
generate its own population (such that the total population
size across all these actors becomes equal to <code>popsize</code>)
and will compute its own gradient, and then the main process
will collect these gradients, compute the averaged gradients
and update the main search distribution.
Non-distributed mode has the advantage of keeping the
population in the main process, which is good when one wishes
to do detailed monitoring during the evolutionary process,
but has the disadvantage of having to pass the solutions to
the remote actors and having to collect fitnesses, which
might result in increased interprocess communication traffic.
On the other hand, while it is not possible to monitor the
population in distributed mode, the distributed mode has the
advantage of significantly reducing the interprocess
communication traffic, since the only things communicated
with the remote actors are the search distributions (not the
solutions) and the gradients.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize_weighted_grad_avg</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Only to be used in distributed mode.
(where being in distributed mode means <code>distributed</code> is given
as True). In distributed mode, each actor remotely samples
its own solution batches and computes its own gradients.
These gradients are then collected, and a final average
gradient is computed.
If <code>popsize_weighted_grad_avg</code> is True, then, while averaging
over the gradients, each gradient will have its own weight
that is computed according to how many solutions were sampled
by the actor that produced the gradient.
If <code>popsize_weighted_grad_avg</code> is False, then, there will not
be weighted averaging (or, each gradient will have equal
weight).
If <code>popsize_weighted_grad_avg</code> is None, then, the gradient
weights will be equal a value for <code>num_interactions</code> is given
(because <code>num_interactions</code> affects the number of solutions
according to the episode lengths, and popsize-weighting the
gradients could be misleading); and the gradient weights will
be weighted according to the sub-population (i.e. sub-batch)
sizes if <code>num_interactions</code> is left as None.
The default value for <code>popsize_weighted_grad_avg</code> is None.
When the distributed mode is disabled (i.e. when <code>distributed</code>
is False), then the argument <code>popsize_weighted_grad_avg</code> is
expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/distributed/gaussian.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>    <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>    <span class="n">parenthood_ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>    <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>    <span class="n">radius_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>    <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>    <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>    <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>    <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>    <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>    <span class="n">stdev_max_change</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">RealOrVector</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>    <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>    <span class="n">distributed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>    <span class="n">popsize_weighted_grad_avg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="p">):</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">    `__init__(...)`: Initialize the search algorithm.</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">        problem: The problem object to work on.</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">        popsize: The population size.</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">        parenthood_ratio: Expected as a float larger than 0 and smaller</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">            than 1. For example, setting this value to 0.1 means that</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">            the top 10% of the population will be declared as the parents,</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">            and those parents will be used for updating the population.</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">            The amount of parents is always computed according to the</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">            specified `popsize`, not according to the adapted population</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">            size, and not according to `popsize_max`.</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">        stdev_init: The initial standard deviation of the search</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">            distribution, expressed as a scalar or as an array.</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">            Determines the initial coverage area of the search</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">            If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">            argument `radius_init` instead, then `stdev_init` is expected</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">        radius_init: The initial radius of the search distribution,</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">            expressed as a scalar.</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">            Determines the initial coverage area of the search</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">            Here, &quot;radius&quot; is defined as the norm of the search</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">            If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">            argument `stdev_init` instead, then `radius_init` is expected</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">        num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">            it is ensured that a population has interacted with</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">            the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">            has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">            too small, and gets extended with more samples,</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">            until n amount of interactions is reached.</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">            When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">            affecting the size of a population.</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">        popsize_max: Having `num_interactions` set as an integer</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">            might cause the effective population size jump to</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">            unnecesarily large numbers. To prevent this,</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">            one can set `popsize_max` to specify an upper</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">            bound for the effective population size.</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">        center_init: The initial center solution.</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">            Can be left as None.</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">        stdev_min: The minimum value for the standard deviation</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">            values of the Gaussian search distribution.</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">            Can be left as None (which is the default),</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">            or can be given as a scalar or as a 1-dimensional array.</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">        stdev_max: The maximum value for the standard deviation</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="sd">            values of the Gaussian search distribution.</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="sd">            Can be left as None (which is the default),</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">            or can be given as a scalar or as a 1-dimensional array.</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">        stdev_max_change: The maximum update ratio allowed on the</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">            standard deviation. Expected as None if no such limiter</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">            is needed, or as a real number within 0.0 and 1.0 otherwise.</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">            In the PGPE implementation of Ha (2017, 2018), a value of</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">            0.2 (20%) was used.</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">            For this CEM implementation, the default is None.</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">        obj_index: Index of the objective according to which the</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">            gradient estimations will be done.</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">            For single-objective problems, this can be left as None.</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">        distributed: Whether or not the gradient computation will</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">            be distributed. If `distributed` is given as False and</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">            the problem is not parallelized, then everything will</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">            be centralized (i.e. the entire computation will happen</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">            in the main process).</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">            If `distributed` is given as False, and the problem</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">            is parallelized, then the population will be created</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">            in the main process and then sent to remote workers</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">            for parallelized evaluation, and then the remote fitnesses</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">            will be collected by the main process again for computing</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">            the search gradients.</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">            If `distributed` is given as True, and the problem</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">            is parallelized, then the search algorithm itself will</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">            be distributed, in the sense that each remote actor will</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">            generate its own population (such that the total population</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">            size across all these actors becomes equal to `popsize`)</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">            and will compute its own gradient, and then the main process</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">            will collect these gradients, compute the averaged gradients</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">            and update the main search distribution.</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">            Non-distributed mode has the advantage of keeping the</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">            population in the main process, which is good when one wishes</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">            to do detailed monitoring during the evolutionary process,</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">            but has the disadvantage of having to pass the solutions to</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">            the remote actors and having to collect fitnesses, which</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">            might result in increased interprocess communication traffic.</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">            On the other hand, while it is not possible to monitor the</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">            population in distributed mode, the distributed mode has the</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">            advantage of significantly reducing the interprocess</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">            communication traffic, since the only things communicated</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">            with the remote actors are the search distributions (not the</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">            solutions) and the gradients.</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">        popsize_weighted_grad_avg: Only to be used in distributed mode.</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">            (where being in distributed mode means `distributed` is given</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">            as True). In distributed mode, each actor remotely samples</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">            its own solution batches and computes its own gradients.</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">            These gradients are then collected, and a final average</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">            gradient is computed.</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">            If `popsize_weighted_grad_avg` is True, then, while averaging</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">            over the gradients, each gradient will have its own weight</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">            that is computed according to how many solutions were sampled</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">            by the actor that produced the gradient.</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">            If `popsize_weighted_grad_avg` is False, then, there will not</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">            be weighted averaging (or, each gradient will have equal</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">            weight).</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">            If `popsize_weighted_grad_avg` is None, then, the gradient</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">            weights will be equal a value for `num_interactions` is given</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">            (because `num_interactions` affects the number of solutions</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">            according to the episode lengths, and popsize-weighting the</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">            gradients could be misleading); and the gradient weights will</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">            be weighted according to the sub-population (i.e. sub-batch)</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">            sizes if `num_interactions` is left as None.</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">            The default value for `popsize_weighted_grad_avg` is None.</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">            When the distributed mode is disabled (i.e. when `distributed`</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">            is False), then the argument `popsize_weighted_grad_avg` is</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">            expected as None.</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">DISTRIBUTION_PARAMS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;parenthood_ratio&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">parenthood_ratio</span><span class="p">)}</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>        <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>        <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>        <span class="n">center_learning_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>        <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>        <span class="n">stdev_init</span><span class="o">=</span><span class="n">stdev_init</span><span class="p">,</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>        <span class="n">radius_init</span><span class="o">=</span><span class="n">radius_init</span><span class="p">,</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>        <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>        <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>        <span class="n">optimizer_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>        <span class="n">ranking_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>        <span class="n">center_init</span><span class="o">=</span><span class="n">center_init</span><span class="p">,</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>        <span class="n">stdev_min</span><span class="o">=</span><span class="n">stdev_min</span><span class="p">,</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>        <span class="n">stdev_max</span><span class="o">=</span><span class="n">stdev_max</span><span class="p">,</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>        <span class="n">stdev_max_change</span><span class="o">=</span><span class="n">stdev_max_change</span><span class="p">,</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>        <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>        <span class="n">distributed</span><span class="o">=</span><span class="n">distributed</span><span class="p">,</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>        <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="n">popsize_weighted_grad_avg</span><span class="p">,</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.CMAES" class="doc doc-heading">
            <code>CMAES</code>


<a href="#evotorch.algorithms.CMAES" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SearchAlgorithm (evotorch.algorithms.searchalgorithm.SearchAlgorithm)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.SearchAlgorithm">SearchAlgorithm</a></code>, <code><a class="autorefs autorefs-internal" title="SinglePopulationAlgorithmMixin (evotorch.algorithms.searchalgorithm.SinglePopulationAlgorithmMixin)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.SinglePopulationAlgorithmMixin">SinglePopulationAlgorithmMixin</a></code></p>


        <p>This is a GPU-accelerated and vectorized implementation, based on pycma (version r3.2.2)
and the below references.</p>
<p>References:</p>
<div class="highlight"><pre><span></span><code>Nikolaus Hansen, Youhei Akimoto, and Petr Baudis.
CMA-ES/pycma on Github. Zenodo, DOI:10.5281/zenodo.2559634,
February 2019.
&lt;https://github.com/CMA-ES/pycma&gt;

Nikolaus Hansen, Andreas Ostermeier (2001).
Completely Derandomized Self-Adaptation in Evolution Strategies.

Nikolaus Hansen (2016).
The CMA Evolution Strategy: A Tutorial.
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/cmaes.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="k">class</span><span class="w"> </span><span class="nc">CMAES</span><span class="p">(</span><span class="n">SearchAlgorithm</span><span class="p">,</span> <span class="n">SinglePopulationAlgorithmMixin</span><span class="p">):</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    CMAES: Covariance Matrix Adaptation Evolution Strategy.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    This is a GPU-accelerated and vectorized implementation, based on pycma (version r3.2.2)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    and the below references.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    References:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        Nikolaus Hansen, Youhei Akimoto, and Petr Baudis.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        CMA-ES/pycma on Github. Zenodo, DOI:10.5281/zenodo.2559634,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        February 2019.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        &lt;https://github.com/CMA-ES/pycma&gt;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        Nikolaus Hansen, Andreas Ostermeier (2001).</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        Completely Derandomized Self-Adaptation in Evolution Strategies.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        Nikolaus Hansen (2016).</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        The CMA Evolution Strategy: A Tutorial.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Real</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Vector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">c_m</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">c_sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">c_sigma_ratio</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">damp_sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">damp_sigma_ratio</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">c_c</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">c_c_ratio</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">c_1</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">c_1_ratio</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">c_mu</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">c_mu_ratio</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">csa_squared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="n">separable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">limit_C_decomposition</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="p">):</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        `__init__(...)`: Initialize the CMAES solver.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            problem (Problem): The problem object which is being worked on.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            stdev_init (Real): Initial step-size</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            popsize: Population size. Can be specified as an int,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">                or can be left as None in which case the CMA-ES rule of thumb is applied:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">                popsize = 4 + floor(3 log d) where d is the dimension</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            center_init: Initial center point of the search distribution.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">                Can be given as a Solution or as a 1-D array.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">                If left as None, an initial center point is generated</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">                with the help of the problem object&#39;s `generate_values(...)`</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">                method.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            c_m (Real): Learning rate for updating the mean</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">                of the search distribution. By default the value is 1.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            c_sigma (Optional[Real]): Learning rate for updating the step size. If None,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">                then the CMA-ES rules of thumb will be applied.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            c_sigma_ratio (Real): Multiplier on the learning rate for the step size.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">                if c_sigma has been left as None, can be used to rescale the default c_sigma value.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            damp_sigma (Optional[Real]): Damping factor for updating the step size. If None,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">                then the CMA-ES rules of thumb will be applied.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            damp_sigma_ratio (Real): Multiplier on the damping factor for the step size.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">                if damp_sigma has been left as None, can be used to rescale the default damp_sigma value.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            c_c (Optional[Real]): Learning rate for updating the rank-1 evolution path.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">                If None, then the CMA-ES rules of thumb will be applied.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            c_c_ratio (Real): Multiplier on the learning rate for the rank-1 evolution path.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">                if c_c has been left as None, can be used to rescale the default c_c value.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            c_1 (Optional[Real]): Learning rate for the rank-1 update to the covariance matrix.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">                If None, then the CMA-ES rules of thumb will be applied.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            c_1_ratio (Real): Multiplier on the learning rate for the rank-1 update to the covariance matrix.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">                if c_1 has been left as None, can be used to rescale the default c_1 value.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            c_mu (Optional[Real]): Learning rate for the rank-mu update to the covariance matrix.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">                If None, then the CMA-ES rules of thumb will be applied.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            c_mu_ratio (Real): Multiplier on the learning rate for the rank-mu update to the covariance matrix.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                if c_mu has been left as None, can be used to rescale the default c_mu value.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            active (bool): Whether to use Active CMA-ES. Defaults to True, consistent with the tutorial paper and pycma.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            csa_squared (bool): Whether to use the squared rule (&quot;CSA_squared&quot; in pycma) for the step-size adapation.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">                This effectively corresponds to taking the natural gradient for the evolution path on the step size,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">                rather than the default CMA-ES rule of thumb.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            stdev_min (Optional[Real]): Minimum allowed standard deviation of the search</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">                distribution. Leaving this as None means that no such</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">                boundary is to be used.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">                Can be given as None or as a scalar.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            stdev_max (Optional[Real]): Maximum allowed standard deviation of the search</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">                distribution. Leaving this as None means that no such</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">                boundary is to be used.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">                Can be given as None or as a scalar.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            separable (bool): Provide this as True if you would like the problem</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">                to be treated as a separable one. Treating a problem</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">                as separable means to adapt only the diagonal parts</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">                of the covariance matrix and to keep the non-diagonal</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">                parts 0. High dimensional problems result in large</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">                covariance matrices on which operating is computationally</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">                expensive. Therefore, for such high dimensional problems,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">                setting `separable` as True might be useful.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            limit_C_decomposition (bool): Whether to limit the frequency of decomposition of the shape matrix C</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">                Setting this to True (default) means that C will not be decomposed every generation</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">                This degrades the quality of the sampling and updates, but provides a guarantee of O(d^2) time complexity.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">                This option can be used with separable=True (e.g. for experimental reasons) but the performance will only degrade</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">                without time-complexity benefits.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            obj_index (Optional[int]): Objective index according to which evaluation</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">                of the solution will be done.</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="c1"># Initialize the base class</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_center</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_sigma</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="c1"># Ensure that the problem is numeric</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="n">problem</span><span class="o">.</span><span class="n">ensure_numeric</span><span class="p">()</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="c1"># CMAES can&#39;t handle problem bounds. Ensure that it is unbounded</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">problem</span><span class="o">.</span><span class="n">ensure_unbounded</span><span class="p">()</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="c1"># Store the objective index</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obj_index</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="c1"># Track d = solution length for reference in initialization of hyperparameters</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="c1"># === Initialize population ===</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">popsize</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="c1"># Default value used in CMA-ES literature 4 + floor(3 log n)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="n">popsize</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">popsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">popsize</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="c1"># Half popsize, referred to as mu in CMA-ES literature</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">popsize</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">generate_batch</span><span class="p">(</span><span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="c1"># === Initialize search distribution ===</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">separable</span> <span class="o">=</span> <span class="n">separable</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="c1"># If `center_init` is not given, generate an initial solution</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="c1"># with the help of the problem object.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="c1"># If it is given as a Solution, then clone the solution&#39;s values</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="c1"># as a PyTorch tensor.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="c1"># Otherwise, use the given initial solution as the starting</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="c1"># point in the search space.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">if</span> <span class="n">center_init</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="n">center_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">generate_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">center_init</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>            <span class="n">center_init</span> <span class="o">=</span> <span class="n">center_init</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="c1"># Store the center</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_tensor</span><span class="p">(</span><span class="n">center_init</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">valid_shaped_m</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_shaped_m</span><span class="p">:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>                <span class="sa">f</span><span class="s2">&quot;The initial center point was expected as a vector of length </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>                <span class="s2">&quot; However, the provided `center_init` has (or implies) a different shape.&quot;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="c1"># Store the initial step size</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_tensor</span><span class="p">(</span><span class="n">stdev_init</span><span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="k">if</span> <span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="c1"># Initialize C as the diagonal vector. Note that when separable, the eigendecomposition is not needed</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_ones</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="c1"># In this case A is simply the square root of elements of C</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_ones</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="c1"># Initialize C = AA^T all diagonal.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_I</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="c1"># === Initialize raw weights ===</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="c1"># Conditioned on popsize</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="c1"># w_i = log((lambda + 1) / 2) - log(i) for i = 1 ... lambda</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">raw_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">make_tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">popsize</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">popsize</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="c1"># positive valued weights are the first mu</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="n">positive_weights</span> <span class="o">=</span> <span class="n">raw_weights</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">]</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="n">negative_weights</span> <span class="o">=</span> <span class="n">raw_weights</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="p">:]</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="c1"># Variance effective selection mass of positive weights</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="c1"># Not affected by future updates to raw_weights</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">positive_weights</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">positive_weights</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="c1"># === Initialize search parameters ===</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="c1"># Conditioned on weights</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="c1"># Store fixed information</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_m</span> <span class="o">=</span> <span class="n">c_m</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="n">active</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">csa_squared</span> <span class="o">=</span> <span class="n">csa_squared</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdev_min</span> <span class="o">=</span> <span class="n">stdev_min</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdev_max</span> <span class="o">=</span> <span class="n">stdev_max</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="c1"># Learning rate for step-size adaption</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">if</span> <span class="n">c_sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="n">c_sigma</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span> <span class="o">=</span> <span class="n">c_sigma_ratio</span> <span class="o">*</span> <span class="n">c_sigma</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="c1"># Damping factor for step-size adapation</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">if</span> <span class="n">damp_sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="n">damp_sigma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">damp_sigma</span> <span class="o">=</span> <span class="n">damp_sigma_ratio</span> <span class="o">*</span> <span class="n">damp_sigma</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="c1"># Learning rate for evolution path for rank-1 update</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="k">if</span> <span class="n">c_c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>            <span class="c1"># Branches on separability</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="k">if</span> <span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>                <span class="n">c_c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="n">d</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="n">d</span><span class="p">))</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>                <span class="n">c_c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="n">d</span><span class="p">))</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_c</span> <span class="o">=</span> <span class="n">c_c_ratio</span> <span class="o">*</span> <span class="n">c_c</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="c1"># Learning rate for rank-1 update to covariance matrix</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="k">if</span> <span class="n">c_1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="c1"># Branches on separability</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="k">if</span> <span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                <span class="n">c_1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                <span class="n">c_1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">popsize</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">((</span><span class="n">d</span> <span class="o">+</span> <span class="mf">1.3</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_1</span> <span class="o">=</span> <span class="n">c_1_ratio</span> <span class="o">*</span> <span class="n">c_1</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="c1"># Learning rate for rank-mu update to covariance matrix</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="k">if</span> <span class="n">c_mu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="c1"># Branches on separability</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="k">if</span> <span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                <span class="n">c_mu</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>                <span class="n">c_mu</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>                    <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="mf">0.25</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">d</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">))</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>                <span class="p">)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span> <span class="o">=</span> <span class="n">c_mu_ratio</span> <span class="o">*</span> <span class="n">c_mu</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="c1"># The &#39;variance aware&#39; coefficient used for the additive component of the evolution path for sigma</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variance_discount_sigma</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="c1"># The &#39;variance aware&#39; coefficient used for the additive component of the evolution path for rank-1 updates</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">variance_discount_c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_c</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="c1"># === Finalize weights ===</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="c1"># Conditioned on search parameters and raw weights</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="c1"># Positive weights always sum to 1</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="n">positive_weights</span> <span class="o">=</span> <span class="n">positive_weights</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">positive_weights</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="c1"># Active CMA-ES: negative weights sum to alpha</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="c1"># Get the variance effective selection mass of negative weights</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="n">mu_eff_neg</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">negative_weights</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">negative_weights</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="c1"># Alpha is the minimum of the following 3 terms</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="n">alpha_mu</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="n">alpha_mu_eff</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mu_eff_neg</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="n">alpha_pos_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="n">alpha</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">alpha_mu</span><span class="p">,</span> <span class="n">alpha_mu_eff</span><span class="p">,</span> <span class="n">alpha_pos_def</span><span class="p">])</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="c1"># Rescale negative weights</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="n">negative_weights</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">negative_weights</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">negative_weights</span><span class="p">))</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="c1"># Negative weights are simply zero</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="n">negative_weights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">negative_weights</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="c1"># Concatenate final weights</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">positive_weights</span><span class="p">,</span> <span class="n">negative_weights</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="c1"># === Some final setup ===</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="c1"># Initialize the evolution paths</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p_c</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="c1"># Hansen&#39;s approximation to the expectation of ||x|| x ~ N(0, I_d).</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="c1"># Note that we could use the exact formulation with Gamma functions, but we&#39;ll retain this form for consistency</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unbiased_expectation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">d</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">21</span> <span class="o">*</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_ex</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="c1"># How often to decompose C</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">if</span> <span class="n">limit_C_decomposition</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decompose_C_freq</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">_safe_divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_1</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span><span class="o">.</span><span class="n">cpu</span><span class="p">())))))</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decompose_C_freq</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="c1"># Use the SinglePopulationAlgorithmMixin to enable additional status reports regarding the population.</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">SinglePopulationAlgorithmMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">population</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Population generated by the CMA-ES algorithm&quot;&quot;&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_population</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_center</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the center of search distribution, m&quot;&quot;&quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the step-size of the search distribution, sigma&quot;&quot;&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">obj_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Index of the objective being focused on&quot;&quot;&quot;</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_index</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sample_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample the population. All 3 representations of solutions are returned for easy calculations of updates.</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        Note that the computation time of this operation of O(d^2 num_samples) unless separable, in which case O(d num_samples)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">            num_samples (Optional[int]): The number of samples to draw. If None, then the population size is used</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">            zs (torch.Tensor): A tensor of shape [num_samples, d] of samples from the local coordinate space e.g. z_i ~ N(0, I_d)</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            ys (torch.Tensor): A tensor of shape [num_samples, d] of samples from the shaped coordinate space e.g. y_i ~ N(0, C)</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            xs (torch.Tensor): A tensor of shape [num_samples, d] of samples from the search space e.g. x_i ~ N(m, sigma^2 C)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="k">if</span> <span class="n">num_samples</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="n">num_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popsize</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="c1"># Generate z values</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="n">zs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_gaussian</span><span class="p">(</span><span class="n">num_solutions</span><span class="o">=</span><span class="n">num_samples</span><span class="p">)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="c1"># Construct ys = A zs</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="c1"># In the separable case A is diagonal so is represented as a single vector</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zs</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>            <span class="n">ys</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">@</span> <span class="n">zs</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="c1"># Construct xs = m + sigma ys</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="n">xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">*</span> <span class="n">ys</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="k">return</span> <span class="n">zs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">xs</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_population_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the assigned weights of the population (e.g. evaluate, rank and return)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">            xs (torch.Tensor): The population samples drawn from N(mu, sigma^2 C)</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">            assigned_weights (torch.Tensor): A [popsize, ] dimensional tensor of ordered weights</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="c1"># Computation is O(popsize * F_time) where F_time is the evalutation time per sample</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="c1"># Fill the population</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="c1"># Evaluate the current population</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="c1"># Sort the population</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">obj_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="c1"># Invert the sorting of the population to obtain the ranks</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="c1"># Note that these ranks start at zero, but this is fine as we are just using them for indexing</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="n">ranks</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="n">ranks</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">popsize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">indices</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">indices</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="c1"># Get weights corresponding to each rank</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="n">assigned_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">ranks</span><span class="p">]</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">return</span> <span class="n">assigned_weights</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ys</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">assigned_weights</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the center of the search distribution m</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        With zs and ys retained from sampling, this operation is O(popsize d), as it involves summing across popsize d-dimensional vectors.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">            zs (torch.Tensor): A tensor of shape [popsize, d] of samples from the local coordinate space e.g. z_i ~ N(0, I_d)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            ys (torch.Tensor): A tensor of shape [popsize, d] of samples from the shaped coordinate space e.g. y_i ~ N(0, C)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">            assigned_weights (torch.Tensor): A [popsize, ] dimensional tensor of ordered weights</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            local_m_displacement (torch.Tensor): A tensor of shape [d], corresponding to the local transformation of m,</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">                (1/sigma) (C^-1/2) (m&#39; - m) where m&#39; is the updated m</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">            shaped_m_displacement (torch.Tensor): A tensor of shape [d], corresponding to the shaped transformation of m,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">                (1/sigma) (m&#39; - m) where m&#39; is the updated m</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="c1"># Get the top-mu weights</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="n">top_mu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="n">assigned_weights</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="n">top_mu_weights</span> <span class="o">=</span> <span class="n">top_mu</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="n">top_mu_indices</span> <span class="o">=</span> <span class="n">top_mu</span><span class="o">.</span><span class="n">indices</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="c1"># Compute the weighted recombination in local coordinate space</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">local_m_displacement</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">top_mu_weights</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">zs</span><span class="p">[</span><span class="n">top_mu_indices</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="c1"># Compute the weighted recombination in shaped coordinate space</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="n">shaped_m_displacement</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">top_mu_weights</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ys</span><span class="p">[</span><span class="n">top_mu_indices</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="c1"># Update m</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_m</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">*</span> <span class="n">shaped_m_displacement</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="c1"># Return the weighted recombinations</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="k">return</span> <span class="n">local_m_displacement</span><span class="p">,</span> <span class="n">shaped_m_displacement</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_p_sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_m_displacement</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the evolution path for sigma, p_sigma</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">        This operation is bounded O(d), as is simply the sum of vectors</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">            local_m_displacement (torch.Tensor): The weighted recombination of local samples zs, corresponding to</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">                (1/sigma) (C^-1/2) (m&#39; - m) where m&#39; is the updated m</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">variance_discount_sigma</span> <span class="o">*</span> <span class="n">local_m_displacement</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the step size sigma according to its evolution path p_sigma</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        This operation is bounded O(d), with the most expensive component being the norm of the evolution path, a d-dimensional vector.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="c1"># Compute the exponential update</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">csa_squared</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="c1"># Exponential update based on natural gradient maximizing squared norm of p_sigma</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="n">exponential_update</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="c1"># Exponential update increasing likelihood p_sigma having expected norm</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="n">exponential_update</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">unbiased_expectation</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="c1"># Rescale exponential update based on learning rate + damping factor</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="n">exponential_update</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">damp_sigma</span><span class="p">)</span> <span class="o">*</span> <span class="n">exponential_update</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="c1"># Multiplicative update to sigma</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exponential_update</span><span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_p_c</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shaped_m_displacement</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">h_sig</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the evolution path for rank-1 update, p_c</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        This operation is bounded O(d), as is simply the sum of vectors</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">            local_m_displacement (torch.Tensor): The weighted recombination of shaped samples ys, corresponding to</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">                (1/sigma) (m&#39; - m) where m&#39; is the updated m</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">            h_sig (torch.Tensor): Whether to stall the update based on the evolution path on sigma, p_sigma, expressed as a torch float</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p_c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_c</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_c</span> <span class="o">+</span> <span class="n">h_sig</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">variance_discount_c</span> <span class="o">*</span> <span class="n">shaped_m_displacement</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_C</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ys</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">assigned_weights</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">h_sig</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the covariance shape matrix C based on rank-1 and rank-mu updates</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        This operation is bounded O(d^2 popsize), which is associated with computing the rank-mu update (summing across popsize d*d matrices)</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            zs (torch.Tensor): A tensor of shape [popsize, d] of samples from the local coordinate space e.g. z_i ~ N(0, I_d)</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">            ys (torch.Tensor): A tensor of shape [popsize, d] of samples from the shaped coordinate space e.g. y_i ~ N(0, C)</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">            assigned_weights (torch.Tensor): A [popsize, ] dimensional tensor of ordered weights</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            h_sig (torch.Tensor): Whether to stall the update based on the evolution path on sigma, p_sigma, expressed as a torch float</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="c1"># If using Active CMA-ES, reweight negative weights</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>            <span class="n">assigned_weights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                <span class="n">assigned_weights</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">assigned_weights</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="n">assigned_weights</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>            <span class="p">)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="n">c1a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">h_sig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_c</span><span class="p">))</span>  <span class="c1"># adjust for variance loss</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>        <span class="n">weighted_pc</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_1</span> <span class="o">/</span> <span class="p">(</span><span class="n">c1a</span> <span class="o">+</span> <span class="mf">1e-23</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.5</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>            <span class="c1"># Rank-1 update</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>            <span class="n">r1_update</span> <span class="o">=</span> <span class="n">c1a</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_c</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>            <span class="c1"># Rank-mu update</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="n">rmu_update</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>                <span class="n">assigned_weights</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ys</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>            <span class="p">)</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>            <span class="c1"># Rank-1 update</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>            <span class="n">r1_update</span> <span class="o">=</span> <span class="n">c1a</span> <span class="o">*</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">weighted_pc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_c</span><span class="p">,</span> <span class="n">weighted_pc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_c</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>            <span class="c1"># Rank-mu update</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>            <span class="n">rmu_update</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span> <span class="o">*</span> <span class="p">(</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>                <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">assigned_weights</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ys</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ys</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="c1"># Update C</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">+</span> <span class="n">r1_update</span> <span class="o">+</span> <span class="n">rmu_update</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decompose_C</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform the decomposition C = AA^T using a cholesky decomposition</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">        Note that traditionally CMA-ES uses the eigendecomposition C = BDDB^-1. In our case,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">        we keep track of zs, ys and xs when sampling, so we never need C^-1/2.</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">        Therefore, a cholesky decomposition is all that is necessary. This generally requires</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">        O(d^3/3) operations, rather than the more costly O(d^3) operations associated with the eigendecomposition.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform a step of the CMA-ES solver&quot;&quot;&quot;</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="c1"># === Sampling, evaluation and ranking ===</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="c1"># Sample the search distribution</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="n">zs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_distribution</span><span class="p">()</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="c1"># Get the weights assigned to each solution</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="n">assigned_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_population_weights</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="c1"># === Center adaption ===</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="n">local_m_displacement</span><span class="p">,</span> <span class="n">shaped_m_displacement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_m</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">assigned_weights</span><span class="p">)</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="c1"># === Step size adaption ===</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="c1"># Update evolution path p_sigma</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_p_sigma</span><span class="p">(</span><span class="n">local_m_displacement</span><span class="p">)</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="c1"># Update sigma</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_sigma</span><span class="p">()</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="c1"># Compute h_sig, a boolean flag for stalling the update to p_c</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="n">h_sig</span> <span class="o">=</span> <span class="n">_h_sig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_steps_count</span><span class="p">)</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="c1"># === Unscaled covariance adapation ===</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="c1"># Update evolution path p_c</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_p_c</span><span class="p">(</span><span class="n">shaped_m_displacement</span><span class="p">,</span> <span class="n">h_sig</span><span class="p">)</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="c1"># Update the covariance shape C</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_C</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">assigned_weights</span><span class="p">,</span> <span class="n">h_sig</span><span class="p">)</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="c1"># === Post-step corrections ===</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="c1"># Limit element-wise standard deviation of sigma^2 C</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdev_min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdev_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">_limit_stdev</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdev_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdev_max</span><span class="p">)</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="c1"># Decompose C</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_steps_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">decompose_C_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">decompose_C</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.CMAES.obj_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">obj_index</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.CMAES.obj_index" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Index of the objective being focused on</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.CMAES.population" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">population</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.CMAES.population" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Population generated by the CMA-ES algorithm</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.CMAES.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">stdev_init</span><span class="p">,</span> <span class="n">popsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_m</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c_sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_sigma_ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">damp_sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">damp_sigma_ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c_c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_c_ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c_1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_1_ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c_mu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_mu_ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">csa_squared</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stdev_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">separable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">limit_C_decomposition</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.CMAES.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the CMAES solver.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem object which is being worked on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_init</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Real">Real</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial step-size</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Population size. Can be specified as an int,
or can be left as None in which case the CMA-ES rule of thumb is applied:
popsize = 4 + floor(3 log d) where d is the dimension</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Vector">Vector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial center point of the search distribution.
Can be given as a Solution or as a 1-D array.
If left as None, an initial center point is generated
with the help of the problem object's <code>generate_values(...)</code>
method.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_m</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Real">Real</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for updating the mean
of the search distribution. By default the value is 1.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_sigma</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Real">Real</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for updating the step size. If None,
then the CMA-ES rules of thumb will be applied.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_sigma_ratio</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Real">Real</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplier on the learning rate for the step size.
if c_sigma has been left as None, can be used to rescale the default c_sigma value.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>damp_sigma</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Real">Real</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Damping factor for updating the step size. If None,
then the CMA-ES rules of thumb will be applied.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>damp_sigma_ratio</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Real">Real</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplier on the damping factor for the step size.
if damp_sigma has been left as None, can be used to rescale the default damp_sigma value.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_c</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Real">Real</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for updating the rank-1 evolution path.
If None, then the CMA-ES rules of thumb will be applied.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_c_ratio</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Real">Real</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplier on the learning rate for the rank-1 evolution path.
if c_c has been left as None, can be used to rescale the default c_c value.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_1</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Real">Real</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for the rank-1 update to the covariance matrix.
If None, then the CMA-ES rules of thumb will be applied.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_1_ratio</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Real">Real</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplier on the learning rate for the rank-1 update to the covariance matrix.
if c_1 has been left as None, can be used to rescale the default c_1 value.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mu</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Real">Real</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for the rank-mu update to the covariance matrix.
If None, then the CMA-ES rules of thumb will be applied.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>c_mu_ratio</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Real">Real</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplier on the learning rate for the rank-mu update to the covariance matrix.
if c_mu has been left as None, can be used to rescale the default c_mu value.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>active</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use Active CMA-ES. Defaults to True, consistent with the tutorial paper and pycma.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>csa_squared</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use the squared rule ("CSA_squared" in pycma) for the step-size adapation.
This effectively corresponds to taking the natural gradient for the evolution path on the step size,
rather than the default CMA-ES rule of thumb.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_min</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Real">Real</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum allowed standard deviation of the search
distribution. Leaving this as None means that no such
boundary is to be used.
Can be given as None or as a scalar.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Real">Real</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum allowed standard deviation of the search
distribution. Leaving this as None means that no such
boundary is to be used.
Can be given as None or as a scalar.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>separable</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Provide this as True if you would like the problem
to be treated as a separable one. Treating a problem
as separable means to adapt only the diagonal parts
of the covariance matrix and to keep the non-diagonal
parts 0. High dimensional problems result in large
covariance matrices on which operating is computationally
expensive. Therefore, for such high dimensional problems,
setting <code>separable</code> as True might be useful.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>limit_C_decomposition</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to limit the frequency of decomposition of the shape matrix C
Setting this to True (default) means that C will not be decomposed every generation
This degrades the quality of the sampling and updates, but provides a guarantee of O(d^2) time complexity.
This option can be used with separable=True (e.g. for experimental reasons) but the performance will only degrade
without time-complexity benefits.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj_index</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Objective index according to which evaluation
of the solution will be done.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/cmaes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Real</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Vector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">c_m</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">c_sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">c_sigma_ratio</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">damp_sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">damp_sigma_ratio</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">c_c</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">c_c_ratio</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">c_1</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">c_1_ratio</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">c_mu</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">c_mu_ratio</span><span class="p">:</span> <span class="n">Real</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="n">active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">csa_squared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Real</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">separable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="n">limit_C_decomposition</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="p">):</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    `__init__(...)`: Initialize the CMAES solver.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        problem (Problem): The problem object which is being worked on.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        stdev_init (Real): Initial step-size</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        popsize: Population size. Can be specified as an int,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            or can be left as None in which case the CMA-ES rule of thumb is applied:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            popsize = 4 + floor(3 log d) where d is the dimension</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        center_init: Initial center point of the search distribution.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            Can be given as a Solution or as a 1-D array.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            If left as None, an initial center point is generated</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            with the help of the problem object&#39;s `generate_values(...)`</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            method.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        c_m (Real): Learning rate for updating the mean</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            of the search distribution. By default the value is 1.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        c_sigma (Optional[Real]): Learning rate for updating the step size. If None,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            then the CMA-ES rules of thumb will be applied.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        c_sigma_ratio (Real): Multiplier on the learning rate for the step size.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            if c_sigma has been left as None, can be used to rescale the default c_sigma value.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        damp_sigma (Optional[Real]): Damping factor for updating the step size. If None,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            then the CMA-ES rules of thumb will be applied.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        damp_sigma_ratio (Real): Multiplier on the damping factor for the step size.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            if damp_sigma has been left as None, can be used to rescale the default damp_sigma value.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        c_c (Optional[Real]): Learning rate for updating the rank-1 evolution path.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            If None, then the CMA-ES rules of thumb will be applied.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        c_c_ratio (Real): Multiplier on the learning rate for the rank-1 evolution path.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            if c_c has been left as None, can be used to rescale the default c_c value.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        c_1 (Optional[Real]): Learning rate for the rank-1 update to the covariance matrix.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            If None, then the CMA-ES rules of thumb will be applied.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        c_1_ratio (Real): Multiplier on the learning rate for the rank-1 update to the covariance matrix.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            if c_1 has been left as None, can be used to rescale the default c_1 value.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        c_mu (Optional[Real]): Learning rate for the rank-mu update to the covariance matrix.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            If None, then the CMA-ES rules of thumb will be applied.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        c_mu_ratio (Real): Multiplier on the learning rate for the rank-mu update to the covariance matrix.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            if c_mu has been left as None, can be used to rescale the default c_mu value.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        active (bool): Whether to use Active CMA-ES. Defaults to True, consistent with the tutorial paper and pycma.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        csa_squared (bool): Whether to use the squared rule (&quot;CSA_squared&quot; in pycma) for the step-size adapation.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            This effectively corresponds to taking the natural gradient for the evolution path on the step size,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            rather than the default CMA-ES rule of thumb.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        stdev_min (Optional[Real]): Minimum allowed standard deviation of the search</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            distribution. Leaving this as None means that no such</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            boundary is to be used.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            Can be given as None or as a scalar.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        stdev_max (Optional[Real]): Maximum allowed standard deviation of the search</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            distribution. Leaving this as None means that no such</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            boundary is to be used.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">            Can be given as None or as a scalar.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        separable (bool): Provide this as True if you would like the problem</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">            to be treated as a separable one. Treating a problem</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            as separable means to adapt only the diagonal parts</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            of the covariance matrix and to keep the non-diagonal</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">            parts 0. High dimensional problems result in large</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            covariance matrices on which operating is computationally</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            expensive. Therefore, for such high dimensional problems,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            setting `separable` as True might be useful.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        limit_C_decomposition (bool): Whether to limit the frequency of decomposition of the shape matrix C</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            Setting this to True (default) means that C will not be decomposed every generation</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            This degrades the quality of the sampling and updates, but provides a guarantee of O(d^2) time complexity.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            This option can be used with separable=True (e.g. for experimental reasons) but the performance will only degrade</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            without time-complexity benefits.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        obj_index (Optional[int]): Objective index according to which evaluation</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            of the solution will be done.</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="c1"># Initialize the base class</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_center</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_sigma</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="c1"># Ensure that the problem is numeric</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">problem</span><span class="o">.</span><span class="n">ensure_numeric</span><span class="p">()</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="c1"># CMAES can&#39;t handle problem bounds. Ensure that it is unbounded</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">problem</span><span class="o">.</span><span class="n">ensure_unbounded</span><span class="p">()</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="c1"># Store the objective index</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obj_index</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="c1"># Track d = solution length for reference in initialization of hyperparameters</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="c1"># === Initialize population ===</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">popsize</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="c1"># Default value used in CMA-ES literature 4 + floor(3 log n)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">popsize</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">popsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">popsize</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="c1"># Half popsize, referred to as mu in CMA-ES literature</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">popsize</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">generate_batch</span><span class="p">(</span><span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="c1"># === Initialize search distribution ===</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">separable</span> <span class="o">=</span> <span class="n">separable</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="c1"># If `center_init` is not given, generate an initial solution</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="c1"># with the help of the problem object.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="c1"># If it is given as a Solution, then clone the solution&#39;s values</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="c1"># as a PyTorch tensor.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="c1"># Otherwise, use the given initial solution as the starting</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="c1"># point in the search space.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="k">if</span> <span class="n">center_init</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="n">center_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">generate_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">center_init</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="n">center_init</span> <span class="o">=</span> <span class="n">center_init</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="c1"># Store the center</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_tensor</span><span class="p">(</span><span class="n">center_init</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">valid_shaped_m</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_shaped_m</span><span class="p">:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="sa">f</span><span class="s2">&quot;The initial center point was expected as a vector of length </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="s2">&quot; However, the provided `center_init` has (or implies) a different shape.&quot;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="c1"># Store the initial step size</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_tensor</span><span class="p">(</span><span class="n">stdev_init</span><span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">if</span> <span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="c1"># Initialize C as the diagonal vector. Note that when separable, the eigendecomposition is not needed</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_ones</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="c1"># In this case A is simply the square root of elements of C</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_ones</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="c1"># Initialize C = AA^T all diagonal.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_I</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="c1"># === Initialize raw weights ===</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="c1"># Conditioned on popsize</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="c1"># w_i = log((lambda + 1) / 2) - log(i) for i = 1 ... lambda</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="n">raw_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">make_tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">popsize</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">popsize</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="c1"># positive valued weights are the first mu</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">positive_weights</span> <span class="o">=</span> <span class="n">raw_weights</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">]</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="n">negative_weights</span> <span class="o">=</span> <span class="n">raw_weights</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="p">:]</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="c1"># Variance effective selection mass of positive weights</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="c1"># Not affected by future updates to raw_weights</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">positive_weights</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">positive_weights</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="c1"># === Initialize search parameters ===</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="c1"># Conditioned on weights</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="c1"># Store fixed information</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_m</span> <span class="o">=</span> <span class="n">c_m</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="n">active</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">csa_squared</span> <span class="o">=</span> <span class="n">csa_squared</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stdev_min</span> <span class="o">=</span> <span class="n">stdev_min</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stdev_max</span> <span class="o">=</span> <span class="n">stdev_max</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="c1"># Learning rate for step-size adaption</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="k">if</span> <span class="n">c_sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">c_sigma</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span> <span class="o">=</span> <span class="n">c_sigma_ratio</span> <span class="o">*</span> <span class="n">c_sigma</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="c1"># Damping factor for step-size adapation</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="k">if</span> <span class="n">damp_sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="n">damp_sigma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">damp_sigma</span> <span class="o">=</span> <span class="n">damp_sigma_ratio</span> <span class="o">*</span> <span class="n">damp_sigma</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="c1"># Learning rate for evolution path for rank-1 update</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="k">if</span> <span class="n">c_c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="c1"># Branches on separability</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="k">if</span> <span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="n">c_c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="n">d</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="n">d</span><span class="p">))</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="n">c_c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="n">d</span><span class="p">))</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_c</span> <span class="o">=</span> <span class="n">c_c_ratio</span> <span class="o">*</span> <span class="n">c_c</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="c1"># Learning rate for rank-1 update to covariance matrix</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">if</span> <span class="n">c_1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="c1"># Branches on separability</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="k">if</span> <span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="n">c_1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="n">c_1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">popsize</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">((</span><span class="n">d</span> <span class="o">+</span> <span class="mf">1.3</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_1</span> <span class="o">=</span> <span class="n">c_1_ratio</span> <span class="o">*</span> <span class="n">c_1</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="c1"># Learning rate for rank-mu update to covariance matrix</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="k">if</span> <span class="n">c_mu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="c1"># Branches on separability</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="k">if</span> <span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="n">c_mu</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="n">c_mu</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>                <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="mf">0.25</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">d</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">))</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="p">)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span> <span class="o">=</span> <span class="n">c_mu_ratio</span> <span class="o">*</span> <span class="n">c_mu</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="c1"># The &#39;variance aware&#39; coefficient used for the additive component of the evolution path for sigma</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">variance_discount_sigma</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="c1"># The &#39;variance aware&#39; coefficient used for the additive component of the evolution path for rank-1 updates</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">variance_discount_c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_c</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span><span class="p">)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="c1"># === Finalize weights ===</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="c1"># Conditioned on search parameters and raw weights</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="c1"># Positive weights always sum to 1</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="n">positive_weights</span> <span class="o">=</span> <span class="n">positive_weights</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">positive_weights</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="c1"># Active CMA-ES: negative weights sum to alpha</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="c1"># Get the variance effective selection mass of negative weights</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="n">mu_eff_neg</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">negative_weights</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">negative_weights</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="c1"># Alpha is the minimum of the following 3 terms</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="n">alpha_mu</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="n">alpha_mu_eff</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mu_eff_neg</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_eff</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">alpha_pos_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="n">alpha</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">alpha_mu</span><span class="p">,</span> <span class="n">alpha_mu_eff</span><span class="p">,</span> <span class="n">alpha_pos_def</span><span class="p">])</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="c1"># Rescale negative weights</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="n">negative_weights</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">negative_weights</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">negative_weights</span><span class="p">))</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="c1"># Negative weights are simply zero</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="n">negative_weights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">negative_weights</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="c1"># Concatenate final weights</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">positive_weights</span><span class="p">,</span> <span class="n">negative_weights</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="c1"># === Some final setup ===</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="c1"># Initialize the evolution paths</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_c</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="c1"># Hansen&#39;s approximation to the expectation of ||x|| x ~ N(0, I_d).</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="c1"># Note that we could use the exact formulation with Gamma functions, but we&#39;ll retain this form for consistency</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">unbiased_expectation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">d</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">21</span> <span class="o">*</span> <span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_ex</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="c1"># How often to decompose C</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="k">if</span> <span class="n">limit_C_decomposition</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">decompose_C_freq</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">_safe_divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_1</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span><span class="o">.</span><span class="n">cpu</span><span class="p">())))))</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">decompose_C_freq</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="c1"># Use the SinglePopulationAlgorithmMixin to enable additional status reports regarding the population.</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="n">SinglePopulationAlgorithmMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.CMAES.decompose_C" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">decompose_C</span><span class="p">()</span></code>

<a href="#evotorch.algorithms.CMAES.decompose_C" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Perform the decomposition C = AA^T using a cholesky decomposition
Note that traditionally CMA-ES uses the eigendecomposition C = BDDB^-1. In our case,
we keep track of zs, ys and xs when sampling, so we never need C^-&frac12;.
Therefore, a cholesky decomposition is all that is necessary. This generally requires
O(d^3/3) operations, rather than the more costly O(d^3) operations associated with the eigendecomposition.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/cmaes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="k">def</span><span class="w"> </span><span class="nf">decompose_C</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform the decomposition C = AA^T using a cholesky decomposition</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">    Note that traditionally CMA-ES uses the eigendecomposition C = BDDB^-1. In our case,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">    we keep track of zs, ys and xs when sampling, so we never need C^-1/2.</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">    Therefore, a cholesky decomposition is all that is necessary. This generally requires</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">    O(d^3/3) operations, rather than the more costly O(d^3) operations associated with the eigendecomposition.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.CMAES.get_population_weights" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_population_weights</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.CMAES.get_population_weights" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the assigned weights of the population (e.g. evaluate, rank and return)
Args:
    xs (torch.Tensor): The population samples drawn from N(mu, sigma^2 C)
Returns:
    assigned_weights (torch.Tensor): A [popsize, ] dimensional tensor of ordered weights</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/cmaes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_population_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the assigned weights of the population (e.g. evaluate, rank and return)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        xs (torch.Tensor): The population samples drawn from N(mu, sigma^2 C)</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        assigned_weights (torch.Tensor): A [popsize, ] dimensional tensor of ordered weights</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="c1"># Computation is O(popsize * F_time) where F_time is the evalutation time per sample</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="c1"># Fill the population</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="c1"># Evaluate the current population</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="c1"># Sort the population</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">obj_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="c1"># Invert the sorting of the population to obtain the ranks</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="c1"># Note that these ranks start at zero, but this is fine as we are just using them for indexing</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="n">ranks</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="n">ranks</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">popsize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">indices</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">indices</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="c1"># Get weights corresponding to each rank</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="n">assigned_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">ranks</span><span class="p">]</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="k">return</span> <span class="n">assigned_weights</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.CMAES.sample_distribution" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample_distribution</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.CMAES.sample_distribution" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Sample the population. All 3 representations of solutions are returned for easy calculations of updates.
Note that the computation time of this operation of O(d^2 num_samples) unless separable, in which case O(d num_samples)
Args:
    num_samples (Optional[int]): The number of samples to draw. If None, then the population size is used
Returns:
    zs (torch.Tensor): A tensor of shape [num_samples, d] of samples from the local coordinate space e.g. z_i ~ N(0, I_d)
    ys (torch.Tensor): A tensor of shape [num_samples, d] of samples from the shaped coordinate space e.g. y_i ~ N(0, C)
    xs (torch.Tensor): A tensor of shape [num_samples, d] of samples from the search space e.g. x_i ~ N(m, sigma^2 C)</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/cmaes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="k">def</span><span class="w"> </span><span class="nf">sample_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sample the population. All 3 representations of solutions are returned for easy calculations of updates.</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    Note that the computation time of this operation of O(d^2 num_samples) unless separable, in which case O(d num_samples)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        num_samples (Optional[int]): The number of samples to draw. If None, then the population size is used</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        zs (torch.Tensor): A tensor of shape [num_samples, d] of samples from the local coordinate space e.g. z_i ~ N(0, I_d)</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        ys (torch.Tensor): A tensor of shape [num_samples, d] of samples from the shaped coordinate space e.g. y_i ~ N(0, C)</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        xs (torch.Tensor): A tensor of shape [num_samples, d] of samples from the search space e.g. x_i ~ N(m, sigma^2 C)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="k">if</span> <span class="n">num_samples</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="n">num_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">popsize</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="c1"># Generate z values</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="n">zs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_gaussian</span><span class="p">(</span><span class="n">num_solutions</span><span class="o">=</span><span class="n">num_samples</span><span class="p">)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="c1"># Construct ys = A zs</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="c1"># In the separable case A is diagonal so is represented as a single vector</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zs</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">ys</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">@</span> <span class="n">zs</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="c1"># Construct xs = m + sigma ys</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="n">xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">*</span> <span class="n">ys</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="k">return</span> <span class="n">zs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">xs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.CMAES.update_C" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_C</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">assigned_weights</span><span class="p">,</span> <span class="n">h_sig</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.CMAES.update_C" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the covariance shape matrix C based on rank-1 and rank-mu updates
This operation is bounded O(d^2 popsize), which is associated with computing the rank-mu update (summing across popsize d*d matrices)
Args:
    zs (torch.Tensor): A tensor of shape [popsize, d] of samples from the local coordinate space e.g. z_i ~ N(0, I_d)
    ys (torch.Tensor): A tensor of shape [popsize, d] of samples from the shaped coordinate space e.g. y_i ~ N(0, C)
    assigned_weights (torch.Tensor): A [popsize, ] dimensional tensor of ordered weights
    h_sig (torch.Tensor): Whether to stall the update based on the evolution path on sigma, p_sigma, expressed as a torch float</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/cmaes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_C</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ys</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">assigned_weights</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">h_sig</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the covariance shape matrix C based on rank-1 and rank-mu updates</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    This operation is bounded O(d^2 popsize), which is associated with computing the rank-mu update (summing across popsize d*d matrices)</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        zs (torch.Tensor): A tensor of shape [popsize, d] of samples from the local coordinate space e.g. z_i ~ N(0, I_d)</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        ys (torch.Tensor): A tensor of shape [popsize, d] of samples from the shaped coordinate space e.g. y_i ~ N(0, C)</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        assigned_weights (torch.Tensor): A [popsize, ] dimensional tensor of ordered weights</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        h_sig (torch.Tensor): Whether to stall the update based on the evolution path on sigma, p_sigma, expressed as a torch float</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>    <span class="c1"># If using Active CMA-ES, reweight negative weights</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="n">assigned_weights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>            <span class="n">assigned_weights</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">assigned_weights</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="n">assigned_weights</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="p">)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="n">c1a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">h_sig</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_c</span><span class="p">))</span>  <span class="c1"># adjust for variance loss</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="n">weighted_pc</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_1</span> <span class="o">/</span> <span class="p">(</span><span class="n">c1a</span> <span class="o">+</span> <span class="mf">1e-23</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.5</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="c1"># Rank-1 update</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="n">r1_update</span> <span class="o">=</span> <span class="n">c1a</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_c</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="c1"># Rank-mu update</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>        <span class="n">rmu_update</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>            <span class="n">assigned_weights</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ys</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="p">)</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="c1"># Rank-1 update</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="n">r1_update</span> <span class="o">=</span> <span class="n">c1a</span> <span class="o">*</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">weighted_pc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_c</span><span class="p">,</span> <span class="n">weighted_pc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_c</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="c1"># Rank-mu update</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="n">rmu_update</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_mu</span> <span class="o">*</span> <span class="p">(</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>            <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">assigned_weights</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ys</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ys</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>            <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="c1"># Update C</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">+</span> <span class="n">r1_update</span> <span class="o">+</span> <span class="n">rmu_update</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.CMAES.update_m" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_m</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">assigned_weights</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.CMAES.update_m" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the center of the search distribution m
With zs and ys retained from sampling, this operation is O(popsize d), as it involves summing across popsize d-dimensional vectors.
Args:
    zs (torch.Tensor): A tensor of shape [popsize, d] of samples from the local coordinate space e.g. z_i ~ N(0, I_d)
    ys (torch.Tensor): A tensor of shape [popsize, d] of samples from the shaped coordinate space e.g. y_i ~ N(0, C)
    assigned_weights (torch.Tensor): A [popsize, ] dimensional tensor of ordered weights
Returns:
    local_m_displacement (torch.Tensor): A tensor of shape [d], corresponding to the local transformation of m,
        (1/sigma) (C^-&frac12;) (m' - m) where m' is the updated m
    shaped_m_displacement (torch.Tensor): A tensor of shape [d], corresponding to the shaped transformation of m,
        (1/sigma) (m' - m) where m' is the updated m</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/cmaes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ys</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">assigned_weights</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the center of the search distribution m</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">    With zs and ys retained from sampling, this operation is O(popsize d), as it involves summing across popsize d-dimensional vectors.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        zs (torch.Tensor): A tensor of shape [popsize, d] of samples from the local coordinate space e.g. z_i ~ N(0, I_d)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        ys (torch.Tensor): A tensor of shape [popsize, d] of samples from the shaped coordinate space e.g. y_i ~ N(0, C)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        assigned_weights (torch.Tensor): A [popsize, ] dimensional tensor of ordered weights</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        local_m_displacement (torch.Tensor): A tensor of shape [d], corresponding to the local transformation of m,</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">            (1/sigma) (C^-1/2) (m&#39; - m) where m&#39; is the updated m</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        shaped_m_displacement (torch.Tensor): A tensor of shape [d], corresponding to the shaped transformation of m,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">            (1/sigma) (m&#39; - m) where m&#39; is the updated m</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="c1"># Get the top-mu weights</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="n">top_mu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="n">assigned_weights</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">top_mu_weights</span> <span class="o">=</span> <span class="n">top_mu</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="n">top_mu_indices</span> <span class="o">=</span> <span class="n">top_mu</span><span class="o">.</span><span class="n">indices</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="c1"># Compute the weighted recombination in local coordinate space</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">local_m_displacement</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">top_mu_weights</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">zs</span><span class="p">[</span><span class="n">top_mu_indices</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="c1"># Compute the weighted recombination in shaped coordinate space</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="n">shaped_m_displacement</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">top_mu_weights</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ys</span><span class="p">[</span><span class="n">top_mu_indices</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="c1"># Update m</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_m</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">*</span> <span class="n">shaped_m_displacement</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="c1"># Return the weighted recombinations</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>    <span class="k">return</span> <span class="n">local_m_displacement</span><span class="p">,</span> <span class="n">shaped_m_displacement</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.CMAES.update_p_c" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_p_c</span><span class="p">(</span><span class="n">shaped_m_displacement</span><span class="p">,</span> <span class="n">h_sig</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.CMAES.update_p_c" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the evolution path for rank-1 update, p_c
This operation is bounded O(d), as is simply the sum of vectors
Args:
    local_m_displacement (torch.Tensor): The weighted recombination of shaped samples ys, corresponding to
        (1/sigma) (m' - m) where m' is the updated m
    h_sig (torch.Tensor): Whether to stall the update based on the evolution path on sigma, p_sigma, expressed as a torch float</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/cmaes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_p_c</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shaped_m_displacement</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">h_sig</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the evolution path for rank-1 update, p_c</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    This operation is bounded O(d), as is simply the sum of vectors</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        local_m_displacement (torch.Tensor): The weighted recombination of shaped samples ys, corresponding to</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">            (1/sigma) (m&#39; - m) where m&#39; is the updated m</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        h_sig (torch.Tensor): Whether to stall the update based on the evolution path on sigma, p_sigma, expressed as a torch float</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_c</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_c</span> <span class="o">+</span> <span class="n">h_sig</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">variance_discount_c</span> <span class="o">*</span> <span class="n">shaped_m_displacement</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.CMAES.update_p_sigma" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_p_sigma</span><span class="p">(</span><span class="n">local_m_displacement</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.CMAES.update_p_sigma" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the evolution path for sigma, p_sigma
This operation is bounded O(d), as is simply the sum of vectors
Args:
    local_m_displacement (torch.Tensor): The weighted recombination of local samples zs, corresponding to
        (1/sigma) (C^-&frac12;) (m' - m) where m' is the updated m</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/cmaes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_p_sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_m_displacement</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the evolution path for sigma, p_sigma</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    This operation is bounded O(d), as is simply the sum of vectors</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">        local_m_displacement (torch.Tensor): The weighted recombination of local samples zs, corresponding to</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">            (1/sigma) (C^-1/2) (m&#39; - m) where m&#39; is the updated m</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">variance_discount_sigma</span> <span class="o">*</span> <span class="n">local_m_displacement</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.CMAES.update_sigma" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_sigma</span><span class="p">()</span></code>

<a href="#evotorch.algorithms.CMAES.update_sigma" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the step size sigma according to its evolution path p_sigma
This operation is bounded O(d), with the most expensive component being the norm of the evolution path, a d-dimensional vector.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/cmaes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the step size sigma according to its evolution path p_sigma</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">    This operation is bounded O(d), with the most expensive component being the norm of the evolution path, a d-dimensional vector.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="c1"># Compute the exponential update</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">csa_squared</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="c1"># Exponential update based on natural gradient maximizing squared norm of p_sigma</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="n">exponential_update</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="c1"># Exponential update increasing likelihood p_sigma having expected norm</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="n">exponential_update</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_sigma</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">unbiased_expectation</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="c1"># Rescale exponential update based on learning rate + damping factor</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="n">exponential_update</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_sigma</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">damp_sigma</span><span class="p">)</span> <span class="o">*</span> <span class="n">exponential_update</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="c1"># Multiplicative update to sigma</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exponential_update</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.Cosyne" class="doc doc-heading">
            <code>Cosyne</code>


<a href="#evotorch.algorithms.Cosyne" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SearchAlgorithm (evotorch.algorithms.searchalgorithm.SearchAlgorithm)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.SearchAlgorithm">SearchAlgorithm</a></code>, <code><a class="autorefs autorefs-internal" title="SinglePopulationAlgorithmMixin (evotorch.algorithms.searchalgorithm.SinglePopulationAlgorithmMixin)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.SinglePopulationAlgorithmMixin">SinglePopulationAlgorithmMixin</a></code></p>


        <p>Implementation of the CoSyNE algorithm.</p>
<p>References:</p>
<div class="highlight"><pre><span></span><code>F.Gomez, J.Schmidhuber, R.Miikkulainen, M.Mitchell (2008).
Accelerated Neural Evolution through Cooperatively Coevolved Synapses.
Journal of Machine Learning Research 9 (5).
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/ga.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="k">class</span><span class="w"> </span><span class="nc">Cosyne</span><span class="p">(</span><span class="n">SearchAlgorithm</span><span class="p">,</span> <span class="n">SinglePopulationAlgorithmMixin</span><span class="p">):</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">    Implementation of the CoSyNE algorithm.</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">    References:</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">        F.Gomez, J.Schmidhuber, R.Miikkulainen, M.Mitchell (2008).</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">        Accelerated Neural Evolution through Cooperatively Coevolved Synapses.</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">        Journal of Machine Learning Research 9 (5).</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>        <span class="n">tournament_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="n">mutation_stdev</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>        <span class="n">mutation_probability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>        <span class="n">permute_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>        <span class="n">num_elites</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>        <span class="n">elitism_ratio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>        <span class="n">eta</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>        <span class="n">num_children</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>    <span class="p">):</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">        `__init__(...)`: Initialize the Cosyne instance.</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">            problem: The problem object to work on.</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">            popsize: Population size, as an integer.</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">            tournament_size: Tournament size, for tournament selection.</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">            mutation_stdev: Standard deviation of the Gaussian mutation.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">                See [GaussianMutation][evotorch.operators.real.GaussianMutation] for more information.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">            mutation_probability: Elementwise Gaussian mutation probability.</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">                Defaults to None.</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">                See [GaussianMutation][evotorch.operators.real.GaussianMutation] for more information.</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">            permute_all: If given as True, all solutions are subject to</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">                permutation. If given as False (which is the default),</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">                there will be a selection procedure for each decision</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">                variable.</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            num_elites: Optionally expected as an integer, specifying the</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">                number of elites to pass to the next generation.</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">                Cannot be used together with the argument `elitism_ratio`.</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            elitism_ratio: Optionally expected as a real number between</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">                0 and 1, specifying the amount of elites to pass to the</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">                next generation. For example, 0.1 means that the best 10%</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">                of the population are accepted as elites and passed onto</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">                the next generation.</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">                Cannot be used together with the argument `num_elites`.</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">            eta: Optionally expected as an integer, specifying the eta</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">                hyperparameter for the simulated binary cross-over (SBX).</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">                If left as None, one-point cross-over will be used instead.</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">            num_children: Number of children to generate at each iteration.</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">                If left as None, then this number is half of the population</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">                size.</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>        <span class="n">problem</span><span class="o">.</span><span class="n">ensure_numeric</span><span class="p">()</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">)</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="k">if</span> <span class="n">mutation_stdev</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>            <span class="k">if</span> <span class="n">mutation_probability</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>                    <span class="sa">f</span><span class="s2">&quot;`mutation_probability` was set to </span><span class="si">{</span><span class="n">mutation_probability</span><span class="si">}</span><span class="s2">, but `mutation_stdev` is None, &quot;</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>                    <span class="s2">&quot;which means, mutation is disabled. If you want to enable the mutation, be sure to provide &quot;</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>                    <span class="s2">&quot;`mutation_stdev` as well.&quot;</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>                <span class="p">)</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mutation_op</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mutation_op</span> <span class="o">=</span> <span class="n">GaussianMutation</span><span class="p">(</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="p">,</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>                <span class="n">stdev</span><span class="o">=</span><span class="n">mutation_stdev</span><span class="p">,</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>                <span class="n">mutation_probability</span><span class="o">=</span><span class="n">mutation_probability</span><span class="p">,</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>            <span class="p">)</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>        <span class="n">cross_over_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;tournament_size&quot;</span><span class="p">:</span> <span class="n">tournament_size</span><span class="p">}</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>        <span class="k">if</span> <span class="n">num_children</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>            <span class="n">cross_over_kwargs</span><span class="p">[</span><span class="s2">&quot;cross_over_rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>            <span class="n">cross_over_kwargs</span><span class="p">[</span><span class="s2">&quot;num_children&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_children</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>        <span class="k">if</span> <span class="n">eta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span> <span class="o">=</span> <span class="n">OnePointCrossOver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="p">,</span> <span class="o">**</span><span class="n">cross_over_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span> <span class="o">=</span> <span class="n">SimulatedBinaryCrossOver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">,</span> <span class="o">**</span><span class="n">cross_over_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_permutation_op</span> <span class="o">=</span> <span class="n">CosynePermutation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="p">,</span> <span class="n">permute_all</span><span class="o">=</span><span class="n">permute_all</span><span class="p">)</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">popsize</span><span class="p">)</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>        <span class="k">if</span> <span class="n">num_elites</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">elitism_ratio</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_elites</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_elites</span><span class="p">)</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>        <span class="k">elif</span> <span class="n">num_elites</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">elitism_ratio</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_elites</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span> <span class="o">*</span> <span class="n">elitism_ratio</span><span class="p">)</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>        <span class="k">elif</span> <span class="n">num_elites</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">elitism_ratio</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_elites</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>                <span class="s2">&quot;Received both `num_elites` and `elitism_ratio`. Please provide only one of them, or none of them.&quot;</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>            <span class="p">)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">popsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span><span class="p">)</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_first_generation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>        <span class="c1"># GAStatusMixin.__init__(self)</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>        <span class="n">SinglePopulationAlgorithmMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">population</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_population</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_generation</span><span class="p">:</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_first_generation</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="p">)</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="n">to_merge</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>        <span class="n">num_elites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_elites</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>        <span class="n">num_parents</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>        <span class="n">num_relevant</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="mi">0</span> <span class="k">if</span> <span class="n">num_elites</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">num_elites</span><span class="p">),</span> <span class="n">num_parents</span><span class="p">)</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>        <span class="n">sorted_relevant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">take_best</span><span class="p">(</span><span class="n">num_relevant</span><span class="p">)</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_elites</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_elites</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>            <span class="n">to_merge</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sorted_relevant</span><span class="p">[:</span><span class="n">num_elites</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">())</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>        <span class="n">parents</span> <span class="o">=</span> <span class="n">sorted_relevant</span><span class="p">[:</span><span class="n">num_parents</span><span class="p">]</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>        <span class="n">children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span><span class="p">(</span><span class="n">parents</span><span class="p">)</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutation_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>            <span class="n">children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutation_op</span><span class="p">(</span><span class="n">children</span><span class="p">)</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>        <span class="n">permuted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_permutation_op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="p">)</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>        <span class="n">to_merge</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">children</span><span class="p">,</span> <span class="n">permuted</span><span class="p">])</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>        <span class="n">extended_population</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="n">merging_of</span><span class="o">=</span><span class="n">to_merge</span><span class="p">)</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">extended_population</span><span class="p">)</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">extended_population</span><span class="o">.</span><span class="n">take_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.Cosyne.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="n">tournament_size</span><span class="p">,</span> <span class="n">mutation_stdev</span><span class="p">,</span> <span class="n">mutation_probability</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">permute_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_elites</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elitism_ratio</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_children</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.Cosyne.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the Cosyne instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem object to work on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Population size, as an integer.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tournament_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tournament size, for tournament selection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mutation_stdev</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard deviation of the Gaussian mutation.
See <a class="autorefs autorefs-internal" href="../operators/real/#evotorch.operators.real.GaussianMutation">GaussianMutation</a> for more information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mutation_probability</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Elementwise Gaussian mutation probability.
Defaults to None.
See <a class="autorefs autorefs-internal" href="../operators/real/#evotorch.operators.real.GaussianMutation">GaussianMutation</a> for more information.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>permute_all</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as True, all solutions are subject to
permutation. If given as False (which is the default),
there will be a selection procedure for each decision
variable.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_elites</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally expected as an integer, specifying the
number of elites to pass to the next generation.
Cannot be used together with the argument <code>elitism_ratio</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>elitism_ratio</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally expected as a real number between
0 and 1, specifying the amount of elites to pass to the
next generation. For example, 0.1 means that the best 10%
of the population are accepted as elites and passed onto
the next generation.
Cannot be used together with the argument <code>num_elites</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eta</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally expected as an integer, specifying the eta
hyperparameter for the simulated binary cross-over (SBX).
If left as None, one-point cross-over will be used instead.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_children</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of children to generate at each iteration.
If left as None, then this number is half of the population
size.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/ga.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>    <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>    <span class="n">tournament_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>    <span class="n">mutation_stdev</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>    <span class="n">mutation_probability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="n">permute_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>    <span class="n">num_elites</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>    <span class="n">elitism_ratio</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>    <span class="n">eta</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>    <span class="n">num_children</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="p">):</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">    `__init__(...)`: Initialize the Cosyne instance.</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">        problem: The problem object to work on.</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">        popsize: Population size, as an integer.</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        tournament_size: Tournament size, for tournament selection.</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">        mutation_stdev: Standard deviation of the Gaussian mutation.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            See [GaussianMutation][evotorch.operators.real.GaussianMutation] for more information.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">        mutation_probability: Elementwise Gaussian mutation probability.</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">            See [GaussianMutation][evotorch.operators.real.GaussianMutation] for more information.</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">        permute_all: If given as True, all solutions are subject to</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">            permutation. If given as False (which is the default),</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            there will be a selection procedure for each decision</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            variable.</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">        num_elites: Optionally expected as an integer, specifying the</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">            number of elites to pass to the next generation.</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            Cannot be used together with the argument `elitism_ratio`.</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">        elitism_ratio: Optionally expected as a real number between</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">            0 and 1, specifying the amount of elites to pass to the</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">            next generation. For example, 0.1 means that the best 10%</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">            of the population are accepted as elites and passed onto</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">            the next generation.</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">            Cannot be used together with the argument `num_elites`.</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">        eta: Optionally expected as an integer, specifying the eta</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">            hyperparameter for the simulated binary cross-over (SBX).</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">            If left as None, one-point cross-over will be used instead.</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">        num_children: Number of children to generate at each iteration.</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">            If left as None, then this number is half of the population</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">            size.</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>    <span class="n">problem</span><span class="o">.</span><span class="n">ensure_numeric</span><span class="p">()</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">)</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>    <span class="k">if</span> <span class="n">mutation_stdev</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="k">if</span> <span class="n">mutation_probability</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>                <span class="sa">f</span><span class="s2">&quot;`mutation_probability` was set to </span><span class="si">{</span><span class="n">mutation_probability</span><span class="si">}</span><span class="s2">, but `mutation_stdev` is None, &quot;</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>                <span class="s2">&quot;which means, mutation is disabled. If you want to enable the mutation, be sure to provide &quot;</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>                <span class="s2">&quot;`mutation_stdev` as well.&quot;</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>            <span class="p">)</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mutation_op</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mutation_op</span> <span class="o">=</span> <span class="n">GaussianMutation</span><span class="p">(</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="p">,</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>            <span class="n">stdev</span><span class="o">=</span><span class="n">mutation_stdev</span><span class="p">,</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>            <span class="n">mutation_probability</span><span class="o">=</span><span class="n">mutation_probability</span><span class="p">,</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>        <span class="p">)</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>    <span class="n">cross_over_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;tournament_size&quot;</span><span class="p">:</span> <span class="n">tournament_size</span><span class="p">}</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>    <span class="k">if</span> <span class="n">num_children</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>        <span class="n">cross_over_kwargs</span><span class="p">[</span><span class="s2">&quot;cross_over_rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>        <span class="n">cross_over_kwargs</span><span class="p">[</span><span class="s2">&quot;num_children&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_children</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>    <span class="k">if</span> <span class="n">eta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span> <span class="o">=</span> <span class="n">OnePointCrossOver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="p">,</span> <span class="o">**</span><span class="n">cross_over_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span> <span class="o">=</span> <span class="n">SimulatedBinaryCrossOver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">,</span> <span class="o">**</span><span class="n">cross_over_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_permutation_op</span> <span class="o">=</span> <span class="n">CosynePermutation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="p">,</span> <span class="n">permute_all</span><span class="o">=</span><span class="n">permute_all</span><span class="p">)</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">popsize</span><span class="p">)</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>    <span class="k">if</span> <span class="n">num_elites</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">elitism_ratio</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_elites</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_elites</span><span class="p">)</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>    <span class="k">elif</span> <span class="n">num_elites</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">elitism_ratio</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_elites</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span> <span class="o">*</span> <span class="n">elitism_ratio</span><span class="p">)</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>    <span class="k">elif</span> <span class="n">num_elites</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">elitism_ratio</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_elites</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>            <span class="s2">&quot;Received both `num_elites` and `elitism_ratio`. Please provide only one of them, or none of them.&quot;</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>        <span class="p">)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">popsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span><span class="p">)</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_first_generation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>    <span class="c1"># GAStatusMixin.__init__(self)</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>    <span class="n">SinglePopulationAlgorithmMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.GeneticAlgorithm" class="doc doc-heading">
            <code>GeneticAlgorithm</code>


<a href="#evotorch.algorithms.GeneticAlgorithm" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SearchAlgorithm (evotorch.algorithms.searchalgorithm.SearchAlgorithm)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.SearchAlgorithm">SearchAlgorithm</a></code>, <code><a class="autorefs autorefs-internal" title="SinglePopulationAlgorithmMixin (evotorch.algorithms.searchalgorithm.SinglePopulationAlgorithmMixin)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.SinglePopulationAlgorithmMixin">SinglePopulationAlgorithmMixin</a></code>, <code><a class="autorefs autorefs-internal" title="ExtendedPopulationMixin (evotorch.algorithms.ga.ExtendedPopulationMixin)" href="ga/#evotorch.algorithms.ga.ExtendedPopulationMixin">ExtendedPopulationMixin</a></code></p>


        <p>A genetic algorithm implementation.</p>
<p><strong>Basic usage.</strong>
Let us consider a single-objective optimization problem where the goal is to
minimize the L2 norm of a continuous tensor of length 10:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">Problem</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeneticAlgorithm</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch.operators</span><span class="w"> </span><span class="kn">import</span> <span class="n">OnePointCrossOver</span><span class="p">,</span> <span class="n">GaussianMutation</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">problem</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">(</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="s2">&quot;min&quot;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">f</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">initial_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">solution_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="p">)</span>
</code></pre></div>
<p>For solving this problem, a genetic algorithm could be instantiated as
follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">ga</span> <span class="o">=</span> <span class="n">GeneticAlgorithm</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">popsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="n">operators</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>        <span class="n">OnePointCrossOver</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">tournament_size</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>        <span class="n">GaussianMutation</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">stdev</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="p">],</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="p">)</span>
</code></pre></div>
<p>The genetic algorithm instantiated above is configured to have a population
size of 100, and is configured to perform the following operations on the
population at each generation:
(i) select solutions with a tournament of size 4, and produce children from
the selected solutions by applying one-point cross-over;
(ii) apply a gaussian mutation on the values of the solutions produced by
the previous step, the amount of the mutation being sampled according to a
standard deviation of 0.1.
Once instantiated, this GeneticAlgorithm instance can be used with an API
compatible with other search algorithms, as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch.logging</span><span class="w"> </span><span class="kn">import</span> <span class="n">StdOutLogger</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">_</span> <span class="o">=</span> <span class="n">StdOutLogger</span><span class="p">(</span><span class="n">ga</span><span class="p">)</span>  <span class="c1"># Report the evolution&#39;s progress to standard output</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">ga</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Run the algorithm for 100 generations</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Solution with best fitness ever:&quot;</span><span class="p">,</span> <span class="n">ga</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s2">&quot;best&quot;</span><span class="p">])</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current population&#39;s best:&quot;</span><span class="p">,</span> <span class="n">ga</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s2">&quot;pop_best&quot;</span><span class="p">])</span>
</code></pre></div>
<p>Please also note:</p>
<ul>
<li>The operators are always executed according to the order specified within
  the <code>operators</code> argument.</li>
<li>There are more operators available in the namespace
  <a class="autorefs autorefs-internal" href="../operators/#evotorch.operators">evotorch.operators</a>.</li>
<li>By default, GeneticAlgorithm is elitist. In the elitist mode, an extended
  population is formed from parent solutions and child solutions, and the
  best n solutions of this extended population are accepted as the next
  generation. If you wish to switch to a non-elitist mode (where children
  unconditionally replace the worst-performing parents), you can use the
  initialization argument <code>elitist=False</code>.</li>
<li>It is not mandatory to specify a cross-over operator. When a cross-over
  operator is missing, the GeneticAlgorithm will work like a simple
  evolution strategy implementation which produces children by mutating
  the parents, and then replaces the parents (where the criteria for
  replacing the parents depend on whether or not elitism is enabled).</li>
<li>To be able to deal with stochastic fitness functions correctly,
  GeneticAlgorithm re-evaluates previously evaluated parents as well.
  When you are sure that the fitness function is deterministic,
  you can pass the initialization argument <code>re_evaluate=False</code> to prevent
  unnecessary computations.</li>
</ul>
<p><strong>Integer decision variables.</strong>
GeneticAlgorithm can be used on problems with <code>dtype</code> declared as integer
(e.g. <code>torch.int32</code>, <code>torch.int64</code>, etc.).
Within the field of discrete optimization, it is common to encounter
one or more of these scenarios:</p>
<ul>
<li>The search space of the problem has a special structure that one will
  wish to exploit (within the cross-over and/or mutation operators) to
  be able to reach the (near-)optimum within a reasonable amount of time.</li>
<li>The problem is partially or fully combinatorial.</li>
<li>The problem is constrained in such a way that arbitrarily sampling
  discrete values for its decision variables might cause infeasibility.</li>
</ul>
<p>Considering all these scenarios, it is difficult to come up with general
cross-over and mutation operators that will work across various discrete
optimization problems, and it is common to design problem-specific
operators. In EvoTorch, it is possible to define custom operators and
use them with GeneticAlgorithm, which is required when using
GeneticAlgorithm on a problem with a non-float dtype.</p>
<p>As an example, let us consider the following discrete optimization
problem:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">problem</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">(</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="s2">&quot;min&quot;</span><span class="p">,</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">f</span><span class="p">,</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="n">solution_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="p">)</span>
</code></pre></div>
<p>Although EvoTorch does provide a very simple and generic (usable with float
and int dtypes) cross-over named
<a class="autorefs autorefs-internal" href="../operators/real/#evotorch.operators.real.OnePointCrossOver">OnePointCrossOver</a>
(a cross-over which randomly decides a cutting point for each pair of
parents, cuts them from those points and recombines them), it can be
desirable and necessary to implement a custom cross-over operator.
One can inherit from <a class="autorefs autorefs-internal" href="../operators/base/#evotorch.operators.base.CrossOver">CrossOver</a> to
define a custom cross-over operator, as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">SolutionBatch</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch.operators</span><span class="w"> </span><span class="kn">import</span> <span class="n">CrossOver</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomCrossOver</span><span class="p">(</span><span class="n">CrossOver</span><span class="p">):</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_do_cross_over</span><span class="p">(</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>        <span class="n">parents1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>        <span class="n">parents2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        <span class="c1"># parents1 is a tensor storing the decision values of the first</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>        <span class="c1"># half of the chosen parents.</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>        <span class="c1"># parents2 is a tensor storing the decision values of the second</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>        <span class="c1"># half of the chosen parents.</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>        <span class="c1"># We expect that the lengths of parents1 and parents2 are equal.</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">parents1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">parents2</span><span class="p">)</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>        <span class="c1"># Allocate an empty SolutionBatch that will store the children</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>        <span class="n">childpop</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">popsize</span><span class="o">=</span><span class="n">num_parents</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>        <span class="c1"># Gain access to the decision values tensor of the newly allocated</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>        <span class="c1"># childpop</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>        <span class="n">childpop_values</span> <span class="o">=</span> <span class="n">childpop</span><span class="o">.</span><span class="n">access_values</span><span class="p">()</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>        <span class="c1"># Here we somehow fill `childpop_values` by recombining the parents.</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>        <span class="c1"># The most common thing to do is to produce two children by</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>        <span class="c1"># combining parents1[0] and parents2[0], to produce the next two</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>        <span class="c1"># children parents1[1] and parents2[1], and so on.</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>        <span class="n">childpop_values</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>        <span class="c1"># Return the child population</span>
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>        <span class="k">return</span> <span class="n">childpop</span>
</code></pre></div>
<p>One can define a custom mutation operator by inheriting from
<a class="autorefs autorefs-internal" href="../operators/base/#evotorch.operators.base.Operator">Operator</a>, as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomMutation</span><span class="p">(</span><span class="n">Operator</span><span class="p">):</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_do</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>        <span class="c1"># Get the decision values tensor of the solutions</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>        <span class="n">sln_values</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">access_values</span><span class="p">()</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>        <span class="c1"># do in-place modifications to the decision values</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>        <span class="n">sln_values</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
</code></pre></div>
<p>Alternatively, you could define the mutation operator as a function:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_mutation_function</span><span class="p">(</span><span class="n">original_values</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="c1"># Somehow produce mutated copies of the original values</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="n">mutated_values</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="c1"># Return the mutated values</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="k">return</span> <span class="n">mutated_values</span>
</code></pre></div>
<p>With these defined operators, we are now ready to instantiate our
GeneticAlgorithm:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">ga</span> <span class="o">=</span> <span class="n">GeneticAlgorithm</span><span class="p">(</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="n">popsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="n">operators</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>        <span class="n">CustomCrossOver</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">tournament_size</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>        <span class="n">CustomMutation</span><span class="p">(</span><span class="n">problem</span><span class="p">),</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>        <span class="c1"># -- or, if you chose to define the mutation as a function: --</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>        <span class="c1"># my_mutation_function,</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>    <span class="p">],</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Non-numeric or variable-length solutions.</strong>
GeneticAlgorithm can also work on problems whose <code>dtype</code> is declared
as <code>object</code>, where <code>dtype=object</code> means that a solution's value(s) can be
expressed via a tensor, a numpy array, a scalar, a tuple, a list, a
dictionary.</p>
<p>Like in the previously discussed case (where dtype is an integer type),
one has to define custom operators when working on problems with
<code>dtype=object</code>. A custom cross-over definition specialized for
<code>dtype=object</code> looks like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObjectArray</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">CrossOverForObjectDType</span><span class="p">(</span><span class="n">CrossOver</span><span class="p">):</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_do_cross_over</span><span class="p">(</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>        <span class="n">parents1</span><span class="p">:</span> <span class="n">ObjectArray</span><span class="p">,</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>        <span class="n">parents2</span><span class="p">:</span> <span class="n">ObjectArray</span><span class="p">,</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>        <span class="c1"># Allocate an empty SolutionBatch that will store the children</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>        <span class="n">childpop</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">,</span> <span class="n">popsize</span><span class="o">=</span><span class="n">num_parents</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>        <span class="c1"># Gain access to the decision values ObjectArray of the newly allocated</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>        <span class="c1"># childpop</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>        <span class="n">childpop_values</span> <span class="o">=</span> <span class="n">childpop</span><span class="o">.</span><span class="n">access_values</span><span class="p">()</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>        <span class="c1"># Here we somehow fill `childpop_values` by recombining the parents.</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>        <span class="c1"># The most common thing to do is to produce two children by</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>        <span class="c1"># combining parents1[0] and parents2[0], to produce the next two</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>        <span class="c1"># children parents1[1] and parents2[1], and so on.</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>        <span class="n">childpop_values</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>        <span class="c1"># Return the child population</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>        <span class="k">return</span> <span class="n">childpop</span>
</code></pre></div>
<p>A custom mutation operator specialized for <code>dtype=object</code> looks like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MutationForObjectDType</span><span class="p">(</span><span class="n">Operator</span><span class="p">):</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_do</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutions</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>        <span class="c1"># Get the decision values ObjectArray of the solutions</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>        <span class="n">sln_values</span> <span class="o">=</span> <span class="n">solutions</span><span class="o">.</span><span class="n">access_values</span><span class="p">()</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>        <span class="c1"># do in-place modifications to the decision values</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>        <span class="n">sln_values</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">...</span>
</code></pre></div>
<p>A custom mutation function specialized for <code>dtype=object</code> looks like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">mutation_for_object_dtype</span><span class="p">(</span><span class="n">original_values</span><span class="p">:</span> <span class="n">ObjectArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectArray</span><span class="p">:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="c1"># Somehow produce mutated copies of the original values</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    <span class="n">mutated_values</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="c1"># Return the mutated values</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="k">return</span> <span class="n">mutated_values</span>
</code></pre></div>
<p>With these operators defined, one can instantiate the GeneticAlgorithm:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">ga</span> <span class="o">=</span> <span class="n">GeneticAlgorithm</span><span class="p">(</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    <span class="n">problem_with_object_dtype</span><span class="p">,</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="n">popsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    <span class="n">operators</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>        <span class="n">CrossOverForObjectDType</span><span class="p">(</span><span class="n">problem_with_object_dtype</span><span class="p">,</span> <span class="n">tournament_size</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>        <span class="n">MutationForObjectDType</span><span class="p">(</span><span class="n">problem_with_object_dtype</span><span class="p">),</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>        <span class="c1"># -- or, if you chose to define the mutation as a function: --</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>        <span class="c1"># mutation_for_object_dtype,</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    <span class="p">],</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Multiple objectives.</strong>
GeneticAlgorithm can work on problems with multiple objectives.
When there are multiple objectives, GeneticAlgorithm will compare the
solutions according to their pareto-ranks and their crowding distances,
like done by the NSGA-II algorithm (Deb, 2002).</p>
<p>References:</p>
<div class="highlight"><pre><span></span><code>Sean Luke, 2013, Essentials of Metaheuristics, Lulu, second edition
available for free at http://cs.gmu.edu/~sean/book/metaheuristics/

Kalyanmoy Deb, Amrit Pratap, Sameer Agarwal, T. Meyarivan (2002).
A Fast and Elitist Multiobjective Genetic Algorithm: NSGA-II.
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/ga.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="k">class</span><span class="w"> </span><span class="nc">GeneticAlgorithm</span><span class="p">(</span><span class="n">SearchAlgorithm</span><span class="p">,</span> <span class="n">SinglePopulationAlgorithmMixin</span><span class="p">,</span> <span class="n">ExtendedPopulationMixin</span><span class="p">):</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    A genetic algorithm implementation.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    **Basic usage.**</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">    Let us consider a single-objective optimization problem where the goal is to</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    minimize the L2 norm of a continuous tensor of length 10:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    from evotorch import Problem</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    from evotorch.algorithms import GeneticAlgorithm</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">    from evotorch.operators import OnePointCrossOver, GaussianMutation</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    def f(x: torch.Tensor) -&gt; torch.Tensor:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        return torch.linalg.norm(x)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    problem = Problem(</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        &quot;min&quot;,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        f,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        initial_bounds=(-10.0, 10.0),</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        solution_length=10,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    )</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    ```</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    For solving this problem, a genetic algorithm could be instantiated as</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    follows:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    ga = GeneticAlgorithm(</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        problem,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        popsize=100,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        operators=[</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            OnePointCrossOver(problem, tournament_size=4),</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">            GaussianMutation(problem, stdev=0.1),</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        ],</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    )</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    ```</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    The genetic algorithm instantiated above is configured to have a population</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    size of 100, and is configured to perform the following operations on the</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    population at each generation:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    (i) select solutions with a tournament of size 4, and produce children from</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    the selected solutions by applying one-point cross-over;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    (ii) apply a gaussian mutation on the values of the solutions produced by</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    the previous step, the amount of the mutation being sampled according to a</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    standard deviation of 0.1.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    Once instantiated, this GeneticAlgorithm instance can be used with an API</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    compatible with other search algorithms, as shown below:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    from evotorch.logging import StdOutLogger</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    _ = StdOutLogger(ga)  # Report the evolution&#39;s progress to standard output</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    ga.run(100)  # Run the algorithm for 100 generations</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    print(&quot;Solution with best fitness ever:&quot;, ga.status[&quot;best&quot;])</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    print(&quot;Current population&#39;s best:&quot;, ga.status[&quot;pop_best&quot;])</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    ```</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    Please also note:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    - The operators are always executed according to the order specified within</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">      the `operators` argument.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    - There are more operators available in the namespace</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">      [evotorch.operators][evotorch.operators].</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    - By default, GeneticAlgorithm is elitist. In the elitist mode, an extended</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">      population is formed from parent solutions and child solutions, and the</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">      best n solutions of this extended population are accepted as the next</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">      generation. If you wish to switch to a non-elitist mode (where children</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">      unconditionally replace the worst-performing parents), you can use the</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">      initialization argument `elitist=False`.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    - It is not mandatory to specify a cross-over operator. When a cross-over</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">      operator is missing, the GeneticAlgorithm will work like a simple</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">      evolution strategy implementation which produces children by mutating</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">      the parents, and then replaces the parents (where the criteria for</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">      replacing the parents depend on whether or not elitism is enabled).</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    - To be able to deal with stochastic fitness functions correctly,</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">      GeneticAlgorithm re-evaluates previously evaluated parents as well.</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">      When you are sure that the fitness function is deterministic,</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">      you can pass the initialization argument `re_evaluate=False` to prevent</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">      unnecessary computations.</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">    **Integer decision variables.**</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">    GeneticAlgorithm can be used on problems with `dtype` declared as integer</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">    (e.g. `torch.int32`, `torch.int64`, etc.).</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">    Within the field of discrete optimization, it is common to encounter</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">    one or more of these scenarios:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">    - The search space of the problem has a special structure that one will</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">      wish to exploit (within the cross-over and/or mutation operators) to</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">      be able to reach the (near-)optimum within a reasonable amount of time.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    - The problem is partially or fully combinatorial.</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">    - The problem is constrained in such a way that arbitrarily sampling</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">      discrete values for its decision variables might cause infeasibility.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    Considering all these scenarios, it is difficult to come up with general</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    cross-over and mutation operators that will work across various discrete</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">    optimization problems, and it is common to design problem-specific</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">    operators. In EvoTorch, it is possible to define custom operators and</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    use them with GeneticAlgorithm, which is required when using</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">    GeneticAlgorithm on a problem with a non-float dtype.</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    As an example, let us consider the following discrete optimization</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    problem:</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    def f(x: torch.Tensor) -&gt; torch.Tensor:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        return torch.sum(x)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    problem = Problem(</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        &quot;min&quot;,</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        f,</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        bounds=(-10, 10),</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        solution_length=10,</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">        dtype=torch.int64,</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    )</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">    ```</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">    Although EvoTorch does provide a very simple and generic (usable with float</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">    and int dtypes) cross-over named</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">    [OnePointCrossOver][evotorch.operators.real.OnePointCrossOver]</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">    (a cross-over which randomly decides a cutting point for each pair of</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">    parents, cuts them from those points and recombines them), it can be</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">    desirable and necessary to implement a custom cross-over operator.</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">    One can inherit from [CrossOver][evotorch.operators.base.CrossOver] to</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">    define a custom cross-over operator, as shown below:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">    from evotorch import SolutionBatch</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">    from evotorch.operators import CrossOver</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">    class CustomCrossOver(CrossOver):</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        def _do_cross_over(</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">            self,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">            parents1: torch.Tensor,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            parents2: torch.Tensor,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        ) -&gt; SolutionBatch:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">            # parents1 is a tensor storing the decision values of the first</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">            # half of the chosen parents.</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">            # parents2 is a tensor storing the decision values of the second</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">            # half of the chosen parents.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">            # We expect that the lengths of parents1 and parents2 are equal.</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">            assert len(parents1) == len(parents2)</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            # Allocate an empty SolutionBatch that will store the children</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">            childpop = SolutionBatch(self.problem, popsize=num_parents, empty=True)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">            # Gain access to the decision values tensor of the newly allocated</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            # childpop</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            childpop_values = childpop.access_values()</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">            # Here we somehow fill `childpop_values` by recombining the parents.</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">            # The most common thing to do is to produce two children by</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">            # combining parents1[0] and parents2[0], to produce the next two</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">            # children parents1[1] and parents2[1], and so on.</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">            childpop_values[:] = ...</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">            # Return the child population</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">            return childpop</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    ```</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    One can define a custom mutation operator by inheriting from</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">    [Operator][evotorch.operators.base.Operator], as shown below:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">    class CustomMutation(Operator):</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        def _do(self, solutions: SolutionBatch):</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">            # Get the decision values tensor of the solutions</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            sln_values = solutions.access_values()</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">            # do in-place modifications to the decision values</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">            sln_values[:] = ...</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">    ```</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">    Alternatively, you could define the mutation operator as a function:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">    def my_mutation_function(original_values: torch.Tensor) -&gt; torch.Tensor:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        # Somehow produce mutated copies of the original values</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">        mutated_values = ...</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        # Return the mutated values</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        return mutated_values</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">    ```</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">    With these defined operators, we are now ready to instantiate our</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    GeneticAlgorithm:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    ga = GeneticAlgorithm(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        problem,</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">        popsize=100,</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        operators=[</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">            CustomCrossOver(problem, tournament_size=4),</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">            CustomMutation(problem),</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">            # -- or, if you chose to define the mutation as a function: --</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">            # my_mutation_function,</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">        ],</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">    )</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">    ```</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    **Non-numeric or variable-length solutions.**</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">    GeneticAlgorithm can also work on problems whose `dtype` is declared</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">    as `object`, where `dtype=object` means that a solution&#39;s value(s) can be</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">    expressed via a tensor, a numpy array, a scalar, a tuple, a list, a</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">    dictionary.</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    Like in the previously discussed case (where dtype is an integer type),</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">    one has to define custom operators when working on problems with</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    `dtype=object`. A custom cross-over definition specialized for</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">    `dtype=object` looks like this:</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    from evotorch.tools import ObjectArray</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">    class CrossOverForObjectDType(CrossOver):</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">        def _do_cross_over(</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">            self,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">            parents1: ObjectArray,</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">            parents2: ObjectArray,</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        ) -&gt; SolutionBatch:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">            # Allocate an empty SolutionBatch that will store the children</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">            childpop = SolutionBatch(self.problem, popsize=num_parents, empty=True)</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">            # Gain access to the decision values ObjectArray of the newly allocated</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">            # childpop</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">            childpop_values = childpop.access_values()</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">            # Here we somehow fill `childpop_values` by recombining the parents.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">            # The most common thing to do is to produce two children by</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">            # combining parents1[0] and parents2[0], to produce the next two</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">            # children parents1[1] and parents2[1], and so on.</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">            childpop_values[:] = ...</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">            # Return the child population</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">            return childpop</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    ```</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    A custom mutation operator specialized for `dtype=object` looks like this:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    class MutationForObjectDType(Operator):</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        def _do(self, solutions: SolutionBatch):</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">            # Get the decision values ObjectArray of the solutions</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">            sln_values = solutions.access_values()</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">            # do in-place modifications to the decision values</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">            sln_values[:] = ...</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    ```</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">    A custom mutation function specialized for `dtype=object` looks like this:</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">    def mutation_for_object_dtype(original_values: ObjectArray) -&gt; ObjectArray:</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        # Somehow produce mutated copies of the original values</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        mutated_values = ...</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        # Return the mutated values</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">        return mutated_values</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">    ```</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    With these operators defined, one can instantiate the GeneticAlgorithm:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">    ga = GeneticAlgorithm(</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">        problem_with_object_dtype,</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">        popsize=100,</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">        operators=[</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">            CrossOverForObjectDType(problem_with_object_dtype, tournament_size=4),</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            MutationForObjectDType(problem_with_object_dtype),</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">            # -- or, if you chose to define the mutation as a function: --</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">            # mutation_for_object_dtype,</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        ],</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">    )</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">    ```</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">    **Multiple objectives.**</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">    GeneticAlgorithm can work on problems with multiple objectives.</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">    When there are multiple objectives, GeneticAlgorithm will compare the</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">    solutions according to their pareto-ranks and their crowding distances,</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">    like done by the NSGA-II algorithm (Deb, 2002).</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">    References:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">        Sean Luke, 2013, Essentials of Metaheuristics, Lulu, second edition</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">        available for free at http://cs.gmu.edu/~sean/book/metaheuristics/</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">        Kalyanmoy Deb, Amrit Pratap, Sameer Agarwal, T. Meyarivan (2002).</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">        A Fast and Elitist Multiobjective Genetic Algorithm: NSGA-II.</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="n">operators</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="n">elitist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="n">re_evaluate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="n">re_evaluate_parents_first</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="n">_allow_empty_operator_list</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>    <span class="p">):</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">        `__init__(...)`: Initialize the GeneticAlgorithm.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">            problem: The problem to optimize.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">            operators: Operators to be used by the genetic algorithm.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">                Expected as an iterable, such as a list or a tuple.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">                Each item within this iterable object is expected either</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">                as an instance of [Operator][evotorch.operators.base.Operator],</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">                or as a function which receives the decision values of</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">                multiple solutions in a PyTorch tensor (or in an</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">                [ObjectArray][evotorch.tools.objectarray.ObjectArray]</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">                for when dtype is `object`) and returns a modified copy.</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">            popsize: Population size.</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">            elitist: Whether or not this genetic algorithm will behave in an</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">                elitist manner. This argument controls how the genetic</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">                algorithm will form the next generation from the parents</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">                and the children. In elitist mode (i.e. with `elitist=True`),</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">                the procedure to be followed by this genetic algorithm is:</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">                (i) form an extended population which consists of</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">                both the parents and the children,</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">                (ii) sort the extended population from best to worst,</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">                (iii) select the best `n` solutions as the new generation where</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">                `n` is `popsize`.</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">                In non-elitist mode (i.e. with `elitist=False`), the worst `m`</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">                solutions within the parent population are replaced with</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">                the children, `m` being the number of produced children.</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">            re_evaluate: Whether or not to evaluate the solutions</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">                that were already evaluated in the previous generations.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">                By default, this is set as True.</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">                The reason behind this default setting is that,</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">                in problems where the evaluation procedure is noisy,</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">                by re-evaluating the already-evaluated solutions,</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">                we prevent the bad solutions that were luckily evaluated</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">                from hanging onto the population.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">                Instead, at every generation, each solution must go through</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">                the evaluation procedure again and prove their worth.</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">                For problems whose evaluation procedures are NOT noisy,</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">                the user might consider turning re_evaluate to False</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">                for saving computational cycles.</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">            re_evaluate_parents_first: This is to be specified only when</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">                `re_evaluate` is True (otherwise to be left as None).</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">                If this is given as True, then it will be assumed that the</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">                provided operators require the parents to be evaluated.</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">                If this is given as False, then it will be assumed that the</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">                provided operators work without looking at the parents&#39;</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">                fitnesses (in which case both parents and children can be</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">                evaluated in a single vectorized computation cycle).</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">                If this is left as None, then whether or not the operators</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">                need to know the parent evaluations will be determined</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">                automatically as follows:</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">                if the operators contain at least one cross-over operator</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">                then `re_evaluate_parents_first` will be internally set as</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">                True; otherwise `re_evaluate_parents_first` will be internally</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">                set as False.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">)</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">popsize</span><span class="p">)</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_elitist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">elitist</span><span class="p">)</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">generate_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span><span class="p">)</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="n">ExtendedPopulationMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>            <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="n">re_evaluate</span><span class="o">=</span><span class="n">re_evaluate</span><span class="p">,</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>            <span class="n">re_evaluate_parents_first</span><span class="o">=</span><span class="n">re_evaluate_parents_first</span><span class="p">,</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>            <span class="n">operators</span><span class="o">=</span><span class="n">operators</span><span class="p">,</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>            <span class="n">allow_empty_operators_list</span><span class="o">=</span><span class="n">_allow_empty_operator_list</span><span class="p">,</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>        <span class="p">)</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>        <span class="n">SinglePopulationAlgorithmMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">population</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the population&quot;&quot;&quot;</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_population</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="c1"># Get the population size</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="n">popsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elitist</span><span class="p">:</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>            <span class="c1"># This is where we handle the elitist mode.</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="c1"># Produce and get an extended population in a single SolutionBatch</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>            <span class="n">extended_population</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_extended_population</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>            <span class="c1"># From the extended population, take the best n solutions, n being the popsize.</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">extended_population</span><span class="o">.</span><span class="n">take_best</span><span class="p">(</span><span class="n">popsize</span><span class="p">)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>            <span class="c1"># This is where we handle the non-elitist mode.</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>            <span class="c1"># Take the parent solutions (ensured to be evaluated) and the children separately.</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="n">parents</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_extended_population</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="c1"># Get the number of children</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="n">num_children</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">children</span><span class="p">)</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>            <span class="k">if</span> <span class="n">num_children</span> <span class="o">&lt;</span> <span class="n">popsize</span><span class="p">:</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                <span class="c1"># If the number of children is less than the population size, then we keep the best m solutions from</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="c1"># the parents, m being `popsize - num_children`.</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                <span class="n">chosen_parents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">take_best</span><span class="p">(</span><span class="n">popsize</span> <span class="o">-</span> <span class="n">num_children</span><span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                <span class="c1"># Combine the children with the chosen parents, and declare them as the new population.</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">chosen_parents</span><span class="p">,</span> <span class="n">children</span><span class="p">])</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="k">elif</span> <span class="n">num_children</span> <span class="o">==</span> <span class="n">popsize</span><span class="p">:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>                <span class="c1"># If the number of children is the same with the population size, then these children are declared as</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>                <span class="c1"># the new population.</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">children</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                <span class="c1"># If the number of children is more than the population size, then we take the best n solutions from</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>                <span class="c1"># these children, n being the population size. These chosen children are then declared as the new</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>                <span class="c1"># population.</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">children</span><span class="o">.</span><span class="n">take_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.GeneticAlgorithm.population" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">population</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.GeneticAlgorithm.population" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the population</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.GeneticAlgorithm.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">operators</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="n">elitist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">re_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">re_evaluate_parents_first</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_allow_empty_operator_list</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.GeneticAlgorithm.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the GeneticAlgorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem to optimize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operators</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Operators to be used by the genetic algorithm.
Expected as an iterable, such as a list or a tuple.
Each item within this iterable object is expected either
as an instance of <a class="autorefs autorefs-internal" href="../operators/base/#evotorch.operators.base.Operator">Operator</a>,
or as a function which receives the decision values of
multiple solutions in a PyTorch tensor (or in an
<a class="autorefs autorefs-internal" href="../tools/objectarray/#evotorch.tools.objectarray.ObjectArray">ObjectArray</a>
for when dtype is <code>object</code>) and returns a modified copy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Population size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>elitist</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this genetic algorithm will behave in an
elitist manner. This argument controls how the genetic
algorithm will form the next generation from the parents
and the children. In elitist mode (i.e. with <code>elitist=True</code>),
the procedure to be followed by this genetic algorithm is:
(i) form an extended population which consists of
both the parents and the children,
(ii) sort the extended population from best to worst,
(iii) select the best <code>n</code> solutions as the new generation where
<code>n</code> is <code>popsize</code>.
In non-elitist mode (i.e. with <code>elitist=False</code>), the worst <code>m</code>
solutions within the parent population are replaced with
the children, <code>m</code> being the number of produced children.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>re_evaluate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to evaluate the solutions
that were already evaluated in the previous generations.
By default, this is set as True.
The reason behind this default setting is that,
in problems where the evaluation procedure is noisy,
by re-evaluating the already-evaluated solutions,
we prevent the bad solutions that were luckily evaluated
from hanging onto the population.
Instead, at every generation, each solution must go through
the evaluation procedure again and prove their worth.
For problems whose evaluation procedures are NOT noisy,
the user might consider turning re_evaluate to False
for saving computational cycles.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>re_evaluate_parents_first</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This is to be specified only when
<code>re_evaluate</code> is True (otherwise to be left as None).
If this is given as True, then it will be assumed that the
provided operators require the parents to be evaluated.
If this is given as False, then it will be assumed that the
provided operators work without looking at the parents'
fitnesses (in which case both parents and children can be
evaluated in a single vectorized computation cycle).
If this is left as None, then whether or not the operators
need to know the parent evaluations will be determined
automatically as follows:
if the operators contain at least one cross-over operator
then <code>re_evaluate_parents_first</code> will be internally set as
True; otherwise <code>re_evaluate_parents_first</code> will be internally
set as False.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/ga.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="n">operators</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="n">elitist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="n">re_evaluate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="n">re_evaluate_parents_first</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="n">_allow_empty_operator_list</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="p">):</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">    `__init__(...)`: Initialize the GeneticAlgorithm.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        problem: The problem to optimize.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        operators: Operators to be used by the genetic algorithm.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">            Expected as an iterable, such as a list or a tuple.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">            Each item within this iterable object is expected either</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">            as an instance of [Operator][evotorch.operators.base.Operator],</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">            or as a function which receives the decision values of</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">            multiple solutions in a PyTorch tensor (or in an</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">            [ObjectArray][evotorch.tools.objectarray.ObjectArray]</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">            for when dtype is `object`) and returns a modified copy.</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">        popsize: Population size.</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">        elitist: Whether or not this genetic algorithm will behave in an</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">            elitist manner. This argument controls how the genetic</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">            algorithm will form the next generation from the parents</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">            and the children. In elitist mode (i.e. with `elitist=True`),</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">            the procedure to be followed by this genetic algorithm is:</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">            (i) form an extended population which consists of</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">            both the parents and the children,</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">            (ii) sort the extended population from best to worst,</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">            (iii) select the best `n` solutions as the new generation where</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">            `n` is `popsize`.</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">            In non-elitist mode (i.e. with `elitist=False`), the worst `m`</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">            solutions within the parent population are replaced with</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">            the children, `m` being the number of produced children.</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">        re_evaluate: Whether or not to evaluate the solutions</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">            that were already evaluated in the previous generations.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">            By default, this is set as True.</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">            The reason behind this default setting is that,</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">            in problems where the evaluation procedure is noisy,</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">            by re-evaluating the already-evaluated solutions,</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">            we prevent the bad solutions that were luckily evaluated</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">            from hanging onto the population.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">            Instead, at every generation, each solution must go through</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">            the evaluation procedure again and prove their worth.</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">            For problems whose evaluation procedures are NOT noisy,</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">            the user might consider turning re_evaluate to False</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">            for saving computational cycles.</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">        re_evaluate_parents_first: This is to be specified only when</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">            `re_evaluate` is True (otherwise to be left as None).</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">            If this is given as True, then it will be assumed that the</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">            provided operators require the parents to be evaluated.</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">            If this is given as False, then it will be assumed that the</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">            provided operators work without looking at the parents&#39;</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">            fitnesses (in which case both parents and children can be</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">            evaluated in a single vectorized computation cycle).</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">            If this is left as None, then whether or not the operators</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">            need to know the parent evaluations will be determined</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">            automatically as follows:</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">            if the operators contain at least one cross-over operator</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">            then `re_evaluate_parents_first` will be internally set as</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">            True; otherwise `re_evaluate_parents_first` will be internally</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">            set as False.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>    <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">)</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">popsize</span><span class="p">)</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_elitist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">elitist</span><span class="p">)</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">generate_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span><span class="p">)</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>    <span class="n">ExtendedPopulationMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>        <span class="n">re_evaluate</span><span class="o">=</span><span class="n">re_evaluate</span><span class="p">,</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>        <span class="n">re_evaluate_parents_first</span><span class="o">=</span><span class="n">re_evaluate_parents_first</span><span class="p">,</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>        <span class="n">operators</span><span class="o">=</span><span class="n">operators</span><span class="p">,</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>        <span class="n">allow_empty_operators_list</span><span class="o">=</span><span class="n">_allow_empty_operator_list</span><span class="p">,</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="p">)</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>    <span class="n">SinglePopulationAlgorithmMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.MAPElites" class="doc doc-heading">
            <code>MAPElites</code>


<a href="#evotorch.algorithms.MAPElites" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SearchAlgorithm (evotorch.algorithms.searchalgorithm.SearchAlgorithm)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.SearchAlgorithm">SearchAlgorithm</a></code>, <code><a class="autorefs autorefs-internal" title="SinglePopulationAlgorithmMixin (evotorch.algorithms.searchalgorithm.SinglePopulationAlgorithmMixin)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.SinglePopulationAlgorithmMixin">SinglePopulationAlgorithmMixin</a></code>, <code><a class="autorefs autorefs-internal" title="ExtendedPopulationMixin (evotorch.algorithms.ga.ExtendedPopulationMixin)" href="ga/#evotorch.algorithms.ga.ExtendedPopulationMixin">ExtendedPopulationMixin</a></code></p>


        <p>Implementation of the MAPElites algorithm.</p>
<p>In MAPElites, we deal with optimization problems where, in addition
to the fitness, there are additional evaluation data ("features") that
are computed during the phase of evaluation. To ensure a diversity
of the solutions, the population is organized into cells of features.</p>
<p>Reference:</p>
<div class="highlight"><pre><span></span><code>Jean-Baptiste Mouret and Jeff Clune (2015).
Illuminating search spaces by mapping elites.
arXiv preprint arXiv:1504.04909 (2015).
</code></pre></div>
<p>As an example, let us imagine that our problem has two features.
Let us call these features <code>feat0</code> and <code>feat1</code>.
Let us also imagine that we wish to organize <code>feat0</code> according to
the boundaries <code>[(-inf, 0), (0, 10), (10, 20), (20, +inf)]</code> and <code>feat1</code>
according to the boundaries <code>[(-inf, 0), (0, 50), (50, +inf)]</code>.
Our population gets organized into:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>     +inf
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>          ^
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>          |
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>  f       |           |        |         |
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>  e       |    pop[0] | pop[1] | pop[ 2] | pop[ 3]
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>  a   50 -|-  --------+--------+---------+---------
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>  t       |    pop[4] | pop[5] | pop[ 6] | pop[ 7]
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>  1    0 -|-  --------+--------|---------+---------
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>          |    pop[8] | pop[9] | pop[10] | pop[11]
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>          |           |        |         |
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    &lt;-----------------|--------|---------|-----------&gt;
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a> -inf     |           0       10        20            +inf
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>          |                  feat0
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>          |
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>          v
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>      -inf
</code></pre></div>
<p>where <code>pop[i]</code> is short for <code>population[i]</code>, that is, the i-th solution
of the population.</p>
<p><strong>Which problems can be solved by MAPElites?</strong>
The problems that can be addressed by MAPElites are the problems with
one objective, and with its <code>eval_data_length</code> (additional evaluation
data length) set as an integer greater than or equal to 1.
For example, let us imagine an optimization problem where we handle
2 features. The evaluation function for such a problem could look like:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="c1"># Somehow compute the fitness</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">fitness</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="c1"># Somehow compute the value for the first feature</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="n">feat0</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="c1"># Somehow compute the value for the second feature</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="n">feat1</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    <span class="c1"># Prepare an evaluation result tensor for the solution</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="n">eval_result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">fitness</span><span class="p">,</span> <span class="n">feat0</span><span class="p">,</span> <span class="n">feat1</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="c1"># Here, we return the eval_result.</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    <span class="c1"># Notice that `eval_result` is a 1-dimensional tensor of length 3,</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>    <span class="c1"># where the item with index 0 is the fitness, and the items with</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>    <span class="c1"># indices 1 and 2 represent the two features of the solution.</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>    <span class="c1"># Please also note that, in vectorized mode, we would receive `n`</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    <span class="c1"># solutions, and the evaluation result tensor would have to be of shape</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    <span class="c1"># (n, 3).</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>    <span class="k">return</span> <span class="n">eval_result</span>
</code></pre></div>
<p>The problem definition then would look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">Problem</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">problem</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">(</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="s2">&quot;min&quot;</span><span class="p">,</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">f</span><span class="p">,</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    <span class="n">initial_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="n">solution_length</span><span class="o">=...</span><span class="p">,</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    <span class="n">eval_data_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># we have 2 features</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Using MAPElites.</strong>
Let us continue using the example <code>problem</code> shown above, where we have
two features.
The first step towards configuring MAPElites is to come up with a
hypergrid tensor, from in the lower and upper bound for each
feature on each cell will be expressed. The hypergrid tensor is structured
like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">hypergrid</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="p">[</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>        <span class="p">[</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>            <span class="p">[</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>                <span class="n">feat0_lower_bound_for_cell0</span><span class="p">,</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>                <span class="n">feat0_upper_bound_for_cell0</span><span class="p">,</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>            <span class="p">],</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>            <span class="p">[</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>                <span class="n">feat1_lower_bound_for_cell0</span><span class="p">,</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>                <span class="n">feat1_upper_bound_for_cell0</span><span class="p">,</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>            <span class="p">],</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>        <span class="p">],</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>        <span class="p">[</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>            <span class="p">[</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>                <span class="n">feat0_lower_bound_for_cell1</span><span class="p">,</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>                <span class="n">feat0_upper_bound_for_cell1</span><span class="p">,</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>            <span class="p">],</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>            <span class="p">[</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>                <span class="n">feat1_lower_bound_for_cell1</span><span class="p">,</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>                <span class="n">feat1_upper_bound_for_cell1</span><span class="p">,</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>            <span class="p">],</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>        <span class="p">],</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>        <span class="p">[</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>            <span class="p">[</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>                <span class="n">feat0_lower_bound_for_cell2</span><span class="p">,</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>                <span class="n">feat0_upper_bound_for_cell2</span><span class="p">,</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>            <span class="p">],</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>            <span class="p">[</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>                <span class="n">feat1_lower_bound_for_cell2</span><span class="p">,</span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>                <span class="n">feat1_upper_bound_for_cell2</span><span class="p">,</span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>            <span class="p">],</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>        <span class="p">],</span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>        <span class="o">...</span><span class="p">,</span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>    <span class="p">],</span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>    <span class="n">dtype</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">eval_dtype</span><span class="p">,</span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>    <span class="n">device</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="p">)</span>
</code></pre></div>
<p>that is, the item with index <code>i,j,0</code> represents the lower bound for the
j-th feature in i-th cell, and the item with index <code>i,j,1</code> represents the
upper bound for the j-th feature in i-th cell.</p>
<p>Specifying lower and upper bounds for each feature and for each cell can
be tedious. MAPElites provides a static helper function named
<a class="autorefs autorefs-internal" title="make_feature_grid(lower_bounds, upper_bounds, num_bins, *, device=None, dtype=None)

  
      staticmethod
  " href="mapelites/#evotorch.algorithms.mapelites.MAPElites.make_feature_grid">make_feature_grid</a>
which asks for how many bins are desired for each feature, and then
produces a hypergrid tensor. For example, if we want 10 bins for feature
<code>feat0</code> and 5 bins for feature <code>feat1</code>, then, we could do:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">hypergrid</span> <span class="o">=</span> <span class="n">MAPElites</span><span class="o">.</span><span class="n">make_feature_grid</span><span class="p">(</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="n">lower_bounds</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>        <span class="n">global_lower_bound_for_feat0</span><span class="p">,</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>        <span class="n">global_lower_bound_for_feat1</span><span class="p">,</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="p">],</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="n">upper_bounds</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>        <span class="n">global_upper_bound_for_feat0</span><span class="p">,</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>        <span class="n">global_upper_bound_for_feat1</span><span class="p">,</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="p">],</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="n">num_bins</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    <span class="n">dtype</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">eval_dtype</span><span class="p">,</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    <span class="n">device</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="p">)</span>
</code></pre></div>
<p>Now that <code>hypergrid</code> is prepared, one can instantiate <code>MAPElites</code> like
this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">searcher</span> <span class="o">=</span> <span class="n">MAPElites</span><span class="p">(</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="n">operators</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span>  <span class="c1"># list of operators like in GeneticAlgorithm</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="n">feature_grid</span><span class="o">=</span><span class="n">hypergrid</span><span class="p">,</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="p">)</span>
</code></pre></div>
<p>where the keyword argument <code>operators</code> is a list that contains functions
or instances of <a class="autorefs autorefs-internal" href="../operators/base/#evotorch.operators.base.Operator">Operator</a>, like expected
by <a class="autorefs autorefs-internal" href="ga/#evotorch.algorithms.ga.GeneticAlgorithm">GeneticAlgorithm</a>.</p>
<p>Once <code>MAPElites</code> is instantiated, it can be run like most of the search
algorithm implementations provided by EvoTorch, as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch.logging</span><span class="w"> </span><span class="kn">import</span> <span class="n">StdOutLogger</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">_</span> <span class="o">=</span> <span class="n">StdOutLogger</span><span class="p">(</span><span class="n">ga</span><span class="p">)</span>  <span class="c1"># Report the evolution&#39;s progress to standard output</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">searcher</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Run MAPElites for 100 generations</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="nb">print</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">searcher</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>  <span class="c1"># Show the final status dictionary</span>
</code></pre></div>
<p><strong>Vectorization capabilities.</strong>
According to the basic definition of the MAPElites algorithm, a cell is
first chosen, then mutated, and then the mutated solution is placed back
into the most suitable cell (if the cell is not filled yet or if the
fitness of the newly mutated solution is better than the existing solution
in that cell). When vectorization, and especially GPU-based parallelization
is available, picking and mutating solutions one by one can be wasteful in
terms of performance. Therefore, this MAPElites implementation mutates the
entire population, evaluates all of the mutated solutions, and places all
of them back into the most suitable cells, all in such a way that the
vectorization and/or GPU-based parallelization can be exploited.</p>







              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/mapelites.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="k">class</span><span class="w"> </span><span class="nc">MAPElites</span><span class="p">(</span><span class="n">SearchAlgorithm</span><span class="p">,</span> <span class="n">SinglePopulationAlgorithmMixin</span><span class="p">,</span> <span class="n">ExtendedPopulationMixin</span><span class="p">):</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    Implementation of the MAPElites algorithm.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    In MAPElites, we deal with optimization problems where, in addition</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    to the fitness, there are additional evaluation data (&quot;features&quot;) that</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    are computed during the phase of evaluation. To ensure a diversity</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    of the solutions, the population is organized into cells of features.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Reference:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        Jean-Baptiste Mouret and Jeff Clune (2015).</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        Illuminating search spaces by mapping elites.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        arXiv preprint arXiv:1504.04909 (2015).</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    As an example, let us imagine that our problem has two features.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    Let us call these features `feat0` and `feat1`.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    Let us also imagine that we wish to organize `feat0` according to</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    the boundaries `[(-inf, 0), (0, 10), (10, 20), (20, +inf)]` and `feat1`</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    according to the boundaries `[(-inf, 0), (0, 50), (50, +inf)]`.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Our population gets organized into:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">         +inf</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">              ^</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">              |</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">      f       |           |        |         |</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">      e       |    pop[0] | pop[1] | pop[ 2] | pop[ 3]</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">      a   50 -|-  --------+--------+---------+---------</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">      t       |    pop[4] | pop[5] | pop[ 6] | pop[ 7]</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">      1    0 -|-  --------+--------|---------+---------</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">              |    pop[8] | pop[9] | pop[10] | pop[11]</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">              |           |        |         |</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        &lt;-----------------|--------|---------|-----------&gt;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">     -inf     |           0       10        20            +inf</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">              |                  feat0</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">              |</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">              v</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">          -inf</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    ```</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    where `pop[i]` is short for `population[i]`, that is, the i-th solution</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    of the population.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    **Which problems can be solved by MAPElites?**</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    The problems that can be addressed by MAPElites are the problems with</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    one objective, and with its `eval_data_length` (additional evaluation</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    data length) set as an integer greater than or equal to 1.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    For example, let us imagine an optimization problem where we handle</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    2 features. The evaluation function for such a problem could look like:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    def f(x: torch.Tensor) -&gt; torch.Tensor:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        # Somehow compute the fitness</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        fitness = ...</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        # Somehow compute the value for the first feature</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        feat0 = ...</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        # Somehow compute the value for the second feature</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        feat1 = ...</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        # Prepare an evaluation result tensor for the solution</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        eval_result = torch.tensor([fitness, feat0, feat1], device=x.device)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        # Here, we return the eval_result.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        # Notice that `eval_result` is a 1-dimensional tensor of length 3,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        # where the item with index 0 is the fitness, and the items with</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        # indices 1 and 2 represent the two features of the solution.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        # Please also note that, in vectorized mode, we would receive `n`</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        # solutions, and the evaluation result tensor would have to be of shape</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        # (n, 3).</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        return eval_result</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    ```</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    The problem definition then would look like this:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    from evotorch import Problem</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    problem = Problem(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        &quot;min&quot;,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        f,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        initial_bounds=(..., ...),</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        solution_length=...,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        eval_data_length=2,  # we have 2 features</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    )</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    ```</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    **Using MAPElites.**</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    Let us continue using the example `problem` shown above, where we have</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    two features.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    The first step towards configuring MAPElites is to come up with a</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    hypergrid tensor, from in the lower and upper bound for each</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    feature on each cell will be expressed. The hypergrid tensor is structured</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    like this:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    hypergrid = torch.tensor(</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        [</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            [</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">                [</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">                    feat0_lower_bound_for_cell0,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">                    feat0_upper_bound_for_cell0,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">                ],</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">                [</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">                    feat1_lower_bound_for_cell0,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                    feat1_upper_bound_for_cell0,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">                ],</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            ],</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            [</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">                [</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">                    feat0_lower_bound_for_cell1,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">                    feat0_upper_bound_for_cell1,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">                ],</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">                [</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">                    feat1_lower_bound_for_cell1,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">                    feat1_upper_bound_for_cell1,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">                ],</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            ],</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            [</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">                [</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">                    feat0_lower_bound_for_cell2,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">                    feat0_upper_bound_for_cell2,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">                ],</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">                [</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">                    feat1_lower_bound_for_cell2,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">                    feat1_upper_bound_for_cell2,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">                ],</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            ],</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            ...,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        ],</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        dtype=problem.eval_dtype,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        device=problem.device,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    )</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    ```</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    that is, the item with index `i,j,0` represents the lower bound for the</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    j-th feature in i-th cell, and the item with index `i,j,1` represents the</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    upper bound for the j-th feature in i-th cell.</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    Specifying lower and upper bounds for each feature and for each cell can</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    be tedious. MAPElites provides a static helper function named</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    [make_feature_grid][evotorch.algorithms.mapelites.MAPElites.make_feature_grid]</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    which asks for how many bins are desired for each feature, and then</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    produces a hypergrid tensor. For example, if we want 10 bins for feature</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    `feat0` and 5 bins for feature `feat1`, then, we could do:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    hypergrid = MAPElites.make_feature_grid(</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        lower_bounds=[</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            global_lower_bound_for_feat0,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            global_lower_bound_for_feat1,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        ],</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        upper_bounds=[</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">            global_upper_bound_for_feat0,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            global_upper_bound_for_feat1,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        ],</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        num_bins=[10, 5],</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        dtype=problem.eval_dtype,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        device=problem.device,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    )</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    ```</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    Now that `hypergrid` is prepared, one can instantiate `MAPElites` like</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    this:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    searcher = MAPElites(</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        problem,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        operators=[...],  # list of operators like in GeneticAlgorithm</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        feature_grid=hypergrid,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    )</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    ```</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    where the keyword argument `operators` is a list that contains functions</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    or instances of [Operator][evotorch.operators.base.Operator], like expected</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    by [GeneticAlgorithm][evotorch.algorithms.ga.GeneticAlgorithm].</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    Once `MAPElites` is instantiated, it can be run like most of the search</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    algorithm implementations provided by EvoTorch, as shown below:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    from evotorch.logging import StdOutLogger</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    _ = StdOutLogger(ga)  # Report the evolution&#39;s progress to standard output</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    searcher.run(100)  # Run MAPElites for 100 generations</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    print(dict(searcher.status))  # Show the final status dictionary</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    ```</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    **Vectorization capabilities.**</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    According to the basic definition of the MAPElites algorithm, a cell is</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    first chosen, then mutated, and then the mutated solution is placed back</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    into the most suitable cell (if the cell is not filled yet or if the</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    fitness of the newly mutated solution is better than the existing solution</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    in that cell). When vectorization, and especially GPU-based parallelization</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">    is available, picking and mutating solutions one by one can be wasteful in</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    terms of performance. Therefore, this MAPElites implementation mutates the</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    entire population, evaluates all of the mutated solutions, and places all</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    of them back into the most suitable cells, all in such a way that the</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">    vectorization and/or GPU-based parallelization can be exploited.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">operators</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">feature_grid</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="n">re_evaluate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="n">re_evaluate_parents_first</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="p">):</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        `__init__(...)`: Initialize the MAPElites algorithm.</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            problem: The problem object to work on. This problem object</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">                is expected to have one objective, and also have its</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">                `eval_data_length` set as an integer that is greater than</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">                or equal to 1.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">            operators: Operators to be used by the MAPElites algorithm.</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">                Expected as an iterable, such as a list or a tuple.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">                Each item within this iterable object is expected either</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">                as an instance of [Operator][evotorch.operators.base.Operator],</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">                or as a function which receives the decision values of</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">                multiple solutions in a PyTorch tensor and returns a modified</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">                copy.</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            re_evaluate: Whether or not to evaluate the solutions</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">                that were already evaluated in the previous generations.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">                By default, this is set as True.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">                The reason behind this default setting is that,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">                in problems where the evaluation procedure is noisy,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">                by re-evaluating the already-evaluated solutions,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">                we prevent the bad solutions that were luckily evaluated</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">                from hanging onto the population.</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">                Instead, at every generation, each solution must go through</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">                the evaluation procedure again and prove their worth.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">                For problems whose evaluation procedures are NOT noisy,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">                the user might consider turning re_evaluate to False</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">                for saving computational cycles.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            re_evaluate_parents_first: This is to be specified only when</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">                `re_evaluate` is True (otherwise to be left as None).</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">                If this is given as True, then it will be assumed that the</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">                provided operators require the parents to be evaluated.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">                If this is given as False, then it will be assumed that the</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">                provided operators work without looking at the parents&#39;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">                fitnesses (in which case both parents and children can be</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">                evaluated in a single vectorized computation cycle).</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">                If this is left as None, then whether or not the operators</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">                need to know the parent evaluations will be determined</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">                automatically as follows:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">                if the operators contain at least one cross-over operator</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">                then `re_evaluate_parents_first` will be internally set as</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">                True; otherwise `re_evaluate_parents_first` will be internally</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">                set as False.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="n">problem</span><span class="o">.</span><span class="n">ensure_single_objective</span><span class="p">()</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="n">problem</span><span class="o">.</span><span class="n">ensure_numeric</span><span class="p">()</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_grid</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">feature_grid</span><span class="p">,</span> <span class="n">use_eval_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sense</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">senses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_feature_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">generate_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span><span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_filled</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="n">ExtendedPopulationMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">re_evaluate</span><span class="o">=</span><span class="n">re_evaluate</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">re_evaluate_parents_first</span><span class="o">=</span><span class="n">re_evaluate_parents_first</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="n">operators</span><span class="o">=</span><span class="n">operators</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="n">allow_empty_operators_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="n">SinglePopulationAlgorithmMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">population</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        Get the population as a SolutionBatch object</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        In this MAP-Elites implementation, i-th solution corresponds to the</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        solution belonging to the i-th cell of the MAP-Elites hypergrid.</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        If `filled[i]` is True, then this means that the i-th cell is filled,</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        and therefore `population[i]` will get the solution belonging to the</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        i-th cell.</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_population</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">filled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        Get a boolean tensor specifying whether or not the i-th cell is filled.</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        In this MAP-Elites implementation, i-th solution within the population</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        corresponds to the solution belonging to the i-th cell of the MAP-Elites</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        hypergrid. If `filled[i]` is True, then the solution stored in the i-th</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        cell satisfies the feature boundaries imposed by that cell.</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        If `filled[i]` is False, then the solution stored in the i-th cell</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        does not satisfy those boundaries, and therefore does not really belong</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        in that cell.</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">..tools.readonlytensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">as_read_only_tensor</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="k">return</span> <span class="n">as_read_only_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filled</span><span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="c1"># Form an extended population from the parents and from the children</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">extended_population</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_extended_population</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="c1"># Get the most suitable solutions for each cell of the hypergrid.</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="c1"># values[i, :] stores the decision values most suitable for the i-th cell.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="c1"># evals[i, :] stores the evaluation results most suitable for the i-th cell.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="c1"># if the suggested i-th solution completely satisfies the boundaries imposed by the i-th cell,</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="c1"># then suitable_mask[i] will be True.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="n">values</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="n">suitable</span> <span class="o">=</span> <span class="n">_best_solution_considering_all_features</span><span class="p">(</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sense</span><span class="p">,</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="n">extended_population</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">as_subclass</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">),</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="n">extended_population</span><span class="o">.</span><span class="n">evals</span><span class="o">.</span><span class="n">as_subclass</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">),</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_feature_grid</span><span class="p">,</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="c1"># Place the most suitable decision values and evaluation results into the current population.</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">access_values</span><span class="p">(</span><span class="n">keep_evals</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:]</span> <span class="o">=</span> <span class="n">values</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">access_evals</span><span class="p">()[:]</span> <span class="o">=</span> <span class="n">evals</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="c1"># If there was a suitable solution for the i-th cell, fill[i] is to be set as True.</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_filled</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">suitable</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">make_feature_grid</span><span class="p">(</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="n">lower_bounds</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="n">upper_bounds</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="n">num_bins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        Make a hypergrid for the MAPElites algorithm.</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        The [MAPElites][evotorch.algorithms.mapelites.MAPElites] organizes its</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        population not only according to the fitness, but also according to the</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        additional evaluation data which are interpreted as the additional features</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        of the solutions. To organize the current population according to these</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        [MAPElites][evotorch.algorithms.mapelites.MAPElites] requires &quot;cells&quot;,</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        each cell having a lower and an upper bound for each feature.</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        `make_map_elites_grid(...)` is a helper function which generates the</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        required hypergrid of features in such a way that each cell, for each</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        feature, has the same interval.</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">        The result of this function is a PyTorch tensor, which can be passed to</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        the `feature_grid` keyword argument of</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        [MAPElites][evotorch.algorithms.mapelites.MAPElites].</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">            lower_bounds: The lower bounds, as a 1-dimensional sequence of numbers.</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">                The length of this sequence must be equal to the number of</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">                features, and the i-th element must express the lower bound</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">                of the i-th feature.</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">            upper_bounds: The upper bounds, as a 1-dimensional sequence of numbers.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">                The length of this sequence must be equal to the number of</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">                features, and the i-th element must express the upper bound</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">                of the i-th feature.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">            num_bins: Can be given as an integer or as a sequence of integers.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">                If given as an integer `n`, then there will be `n` bins for each</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">                feature on the hypergrid. If given as a sequence of integers,</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">                then the i-th element of the sequence will express the number of</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">                bins for the i-th feature.</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">            The hypergrid, as a PyTorch tensor.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="n">cast_args</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>            <span class="n">cast_args</span><span class="p">[</span><span class="s2">&quot;device&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>            <span class="n">cast_args</span><span class="p">[</span><span class="s2">&quot;dtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="n">has_casting</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cast_args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="k">if</span> <span class="n">has_casting</span><span class="p">:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>            <span class="n">lower_bounds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">lower_bounds</span><span class="p">,</span> <span class="o">**</span><span class="n">cast_args</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="n">upper_bounds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">upper_bounds</span><span class="p">,</span> <span class="o">**</span><span class="n">cast_args</span><span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lower_bounds</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">upper_bounds</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)):</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>                <span class="sa">f</span><span class="s2">&quot;While preparing the map elites hypergrid with device=</span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2"> and dtype=</span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s2">,&quot;</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                <span class="sa">f</span><span class="s2">&quot;`lower_bounds` and `upper_bounds` were expected as tensors, but their types are different.&quot;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                <span class="sa">f</span><span class="s2">&quot; The type of `lower_bounds` is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lower_bounds</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                <span class="sa">f</span><span class="s2">&quot; The type of `upper_bounds` is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">upper_bounds</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>            <span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="k">if</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">device</span> <span class="o">!=</span> <span class="n">upper_bounds</span><span class="o">.</span><span class="n">device</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                <span class="sa">f</span><span class="s2">&quot;Cannot determine on which device to place the map elites grid,&quot;</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                <span class="sa">f</span><span class="s2">&quot; because `lower_bounds` and `upper_bounds` are on different devices.&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                <span class="sa">f</span><span class="s2">&quot; The device of `lower_bounds` is </span><span class="si">{</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>                <span class="sa">f</span><span class="s2">&quot; The device of `upper_bounds` is </span><span class="si">{</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>            <span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="k">if</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">upper_bounds</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                <span class="sa">f</span><span class="s2">&quot;Cannot determine the dtype of the map elites grid,&quot;</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>                <span class="sa">f</span><span class="s2">&quot; because `lower_bounds` and `upper_bounds` have different dtypes.&quot;</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                <span class="sa">f</span><span class="s2">&quot; The dtype of `lower_bounds` is </span><span class="si">{</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>                <span class="sa">f</span><span class="s2">&quot; The dtype of `upper_bounds` is </span><span class="si">{</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="k">if</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="n">upper_bounds</span><span class="o">.</span><span class="n">size</span><span class="p">():</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`lower_bounds` and `upper_bounds` have incompatible shapes&quot;</span><span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="k">if</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only 1D tensors are supported for `lower_bounds` and for `upper_bounds`&quot;</span><span class="p">)</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="n">dtype</span> <span class="o">=</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="n">device</span> <span class="o">=</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="n">num_bins</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="k">if</span> <span class="n">num_bins</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="n">num_bins</span> <span class="o">=</span> <span class="n">num_bins</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">p_inf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="n">n_inf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_make_feature_grid</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">):</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="n">sp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">num_bins</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="n">sp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">n_inf</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="n">p_inf</span><span class="p">))</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="k">return</span> <span class="n">sp</span><span class="o">.</span><span class="n">unfold</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="n">f_grids</span> <span class="o">=</span> <span class="p">[</span><span class="n">_make_feature_grid</span><span class="p">(</span><span class="o">*</span><span class="n">bounds</span><span class="p">)</span> <span class="k">for</span> <span class="n">bounds</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">)]</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">f_grids</span><span class="p">)])</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.MAPElites.filled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filled</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.MAPElites.filled" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get a boolean tensor specifying whether or not the i-th cell is filled.</p>
<p>In this MAP-Elites implementation, i-th solution within the population
corresponds to the solution belonging to the i-th cell of the MAP-Elites
hypergrid. If <code>filled[i]</code> is True, then the solution stored in the i-th
cell satisfies the feature boundaries imposed by that cell.
If <code>filled[i]</code> is False, then the solution stored in the i-th cell
does not satisfy those boundaries, and therefore does not really belong
in that cell.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.MAPElites.population" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">population</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.MAPElites.population" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the population as a SolutionBatch object</p>
<p>In this MAP-Elites implementation, i-th solution corresponds to the
solution belonging to the i-th cell of the MAP-Elites hypergrid.
If <code>filled[i]</code> is True, then this means that the i-th cell is filled,
and therefore <code>population[i]</code> will get the solution belonging to the
i-th cell.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.MAPElites.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">operators</span><span class="p">,</span> <span class="n">feature_grid</span><span class="p">,</span> <span class="n">re_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">re_evaluate_parents_first</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.MAPElites.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the MAPElites algorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem object to work on. This problem object
is expected to have one objective, and also have its
<code>eval_data_length</code> set as an integer that is greater than
or equal to 1.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operators</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Operators to be used by the MAPElites algorithm.
Expected as an iterable, such as a list or a tuple.
Each item within this iterable object is expected either
as an instance of <a class="autorefs autorefs-internal" href="../operators/base/#evotorch.operators.base.Operator">Operator</a>,
or as a function which receives the decision values of
multiple solutions in a PyTorch tensor and returns a modified
copy.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>re_evaluate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to evaluate the solutions
that were already evaluated in the previous generations.
By default, this is set as True.
The reason behind this default setting is that,
in problems where the evaluation procedure is noisy,
by re-evaluating the already-evaluated solutions,
we prevent the bad solutions that were luckily evaluated
from hanging onto the population.
Instead, at every generation, each solution must go through
the evaluation procedure again and prove their worth.
For problems whose evaluation procedures are NOT noisy,
the user might consider turning re_evaluate to False
for saving computational cycles.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>re_evaluate_parents_first</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This is to be specified only when
<code>re_evaluate</code> is True (otherwise to be left as None).
If this is given as True, then it will be assumed that the
provided operators require the parents to be evaluated.
If this is given as False, then it will be assumed that the
provided operators work without looking at the parents'
fitnesses (in which case both parents and children can be
evaluated in a single vectorized computation cycle).
If this is left as None, then whether or not the operators
need to know the parent evaluations will be determined
automatically as follows:
if the operators contain at least one cross-over operator
then <code>re_evaluate_parents_first</code> will be internally set as
True; otherwise <code>re_evaluate_parents_first</code> will be internally
set as False.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/mapelites.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="n">operators</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="n">feature_grid</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="n">re_evaluate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">re_evaluate_parents_first</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="p">):</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    `__init__(...)`: Initialize the MAPElites algorithm.</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        problem: The problem object to work on. This problem object</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            is expected to have one objective, and also have its</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            `eval_data_length` set as an integer that is greater than</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">            or equal to 1.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        operators: Operators to be used by the MAPElites algorithm.</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">            Expected as an iterable, such as a list or a tuple.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            Each item within this iterable object is expected either</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">            as an instance of [Operator][evotorch.operators.base.Operator],</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">            or as a function which receives the decision values of</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">            multiple solutions in a PyTorch tensor and returns a modified</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">            copy.</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        re_evaluate: Whether or not to evaluate the solutions</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            that were already evaluated in the previous generations.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">            By default, this is set as True.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            The reason behind this default setting is that,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            in problems where the evaluation procedure is noisy,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">            by re-evaluating the already-evaluated solutions,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            we prevent the bad solutions that were luckily evaluated</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            from hanging onto the population.</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">            Instead, at every generation, each solution must go through</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            the evaluation procedure again and prove their worth.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            For problems whose evaluation procedures are NOT noisy,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            the user might consider turning re_evaluate to False</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">            for saving computational cycles.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        re_evaluate_parents_first: This is to be specified only when</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            `re_evaluate` is True (otherwise to be left as None).</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">            If this is given as True, then it will be assumed that the</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">            provided operators require the parents to be evaluated.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            If this is given as False, then it will be assumed that the</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            provided operators work without looking at the parents&#39;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            fitnesses (in which case both parents and children can be</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            evaluated in a single vectorized computation cycle).</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            If this is left as None, then whether or not the operators</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            need to know the parent evaluations will be determined</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            automatically as follows:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            if the operators contain at least one cross-over operator</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            then `re_evaluate_parents_first` will be internally set as</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            True; otherwise `re_evaluate_parents_first` will be internally</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            set as False.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="n">problem</span><span class="o">.</span><span class="n">ensure_single_objective</span><span class="p">()</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="n">problem</span><span class="o">.</span><span class="n">ensure_numeric</span><span class="p">()</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_feature_grid</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">feature_grid</span><span class="p">,</span> <span class="n">use_eval_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_sense</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">senses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_feature_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_population</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">generate_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span><span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_filled</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_popsize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="n">ExtendedPopulationMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="n">re_evaluate</span><span class="o">=</span><span class="n">re_evaluate</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">re_evaluate_parents_first</span><span class="o">=</span><span class="n">re_evaluate_parents_first</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">operators</span><span class="o">=</span><span class="n">operators</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="n">allow_empty_operators_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="n">SinglePopulationAlgorithmMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.MAPElites.make_feature_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_feature_grid</span><span class="p">(</span><span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#evotorch.algorithms.MAPElites.make_feature_grid" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Make a hypergrid for the MAPElites algorithm.</p>
<p>The <a class="autorefs autorefs-internal" href="mapelites/#evotorch.algorithms.mapelites.MAPElites">MAPElites</a> organizes its
population not only according to the fitness, but also according to the
additional evaluation data which are interpreted as the additional features
of the solutions. To organize the current population according to these
<a class="autorefs autorefs-internal" href="mapelites/#evotorch.algorithms.mapelites.MAPElites">MAPElites</a> requires "cells",
each cell having a lower and an upper bound for each feature.
<code>make_map_elites_grid(...)</code> is a helper function which generates the
required hypergrid of features in such a way that each cell, for each
feature, has the same interval.</p>
<p>The result of this function is a PyTorch tensor, which can be passed to
the <code>feature_grid</code> keyword argument of
<a class="autorefs autorefs-internal" href="mapelites/#evotorch.algorithms.mapelites.MAPElites">MAPElites</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lower_bounds</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lower bounds, as a 1-dimensional sequence of numbers.
The length of this sequence must be equal to the number of
features, and the i-th element must express the lower bound
of the i-th feature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upper_bounds</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The upper bounds, as a 1-dimensional sequence of numbers.
The length of this sequence must be equal to the number of
features, and the i-th element must express the upper bound
of the i-th feature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_bins</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Can be given as an integer or as a sequence of integers.
If given as an integer <code>n</code>, then there will be <code>n</code> bins for each
feature on the hypergrid. If given as a sequence of integers,
then the i-th element of the sequence will express the number of
bins for the i-th feature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/mapelites.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_feature_grid</span><span class="p">(</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="n">lower_bounds</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="n">upper_bounds</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="n">num_bins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    Make a hypergrid for the MAPElites algorithm.</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">    The [MAPElites][evotorch.algorithms.mapelites.MAPElites] organizes its</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">    population not only according to the fitness, but also according to the</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">    additional evaluation data which are interpreted as the additional features</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">    of the solutions. To organize the current population according to these</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">    [MAPElites][evotorch.algorithms.mapelites.MAPElites] requires &quot;cells&quot;,</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">    each cell having a lower and an upper bound for each feature.</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">    `make_map_elites_grid(...)` is a helper function which generates the</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">    required hypergrid of features in such a way that each cell, for each</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">    feature, has the same interval.</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">    The result of this function is a PyTorch tensor, which can be passed to</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    the `feature_grid` keyword argument of</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">    [MAPElites][evotorch.algorithms.mapelites.MAPElites].</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        lower_bounds: The lower bounds, as a 1-dimensional sequence of numbers.</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">            The length of this sequence must be equal to the number of</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">            features, and the i-th element must express the lower bound</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">            of the i-th feature.</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">        upper_bounds: The upper bounds, as a 1-dimensional sequence of numbers.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">            The length of this sequence must be equal to the number of</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">            features, and the i-th element must express the upper bound</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">            of the i-th feature.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        num_bins: Can be given as an integer or as a sequence of integers.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">            If given as an integer `n`, then there will be `n` bins for each</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            feature on the hypergrid. If given as a sequence of integers,</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            then the i-th element of the sequence will express the number of</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">            bins for the i-th feature.</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">        The hypergrid, as a PyTorch tensor.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="n">cast_args</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="n">cast_args</span><span class="p">[</span><span class="s2">&quot;device&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="n">cast_args</span><span class="p">[</span><span class="s2">&quot;dtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="n">has_casting</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cast_args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="k">if</span> <span class="n">has_casting</span><span class="p">:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="n">lower_bounds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">lower_bounds</span><span class="p">,</span> <span class="o">**</span><span class="n">cast_args</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="n">upper_bounds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">upper_bounds</span><span class="p">,</span> <span class="o">**</span><span class="n">cast_args</span><span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lower_bounds</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">upper_bounds</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)):</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="sa">f</span><span class="s2">&quot;While preparing the map elites hypergrid with device=</span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2"> and dtype=</span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s2">,&quot;</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>            <span class="sa">f</span><span class="s2">&quot;`lower_bounds` and `upper_bounds` were expected as tensors, but their types are different.&quot;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>            <span class="sa">f</span><span class="s2">&quot; The type of `lower_bounds` is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lower_bounds</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="sa">f</span><span class="s2">&quot; The type of `upper_bounds` is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">upper_bounds</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="k">if</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">device</span> <span class="o">!=</span> <span class="n">upper_bounds</span><span class="o">.</span><span class="n">device</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="sa">f</span><span class="s2">&quot;Cannot determine on which device to place the map elites grid,&quot;</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="sa">f</span><span class="s2">&quot; because `lower_bounds` and `upper_bounds` are on different devices.&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>            <span class="sa">f</span><span class="s2">&quot; The device of `lower_bounds` is </span><span class="si">{</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="sa">f</span><span class="s2">&quot; The device of `upper_bounds` is </span><span class="si">{</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="k">if</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">upper_bounds</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>            <span class="sa">f</span><span class="s2">&quot;Cannot determine the dtype of the map elites grid,&quot;</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="sa">f</span><span class="s2">&quot; because `lower_bounds` and `upper_bounds` have different dtypes.&quot;</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>            <span class="sa">f</span><span class="s2">&quot; The dtype of `lower_bounds` is </span><span class="si">{</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="sa">f</span><span class="s2">&quot; The dtype of `upper_bounds` is </span><span class="si">{</span><span class="n">upper_bounds</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="k">if</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="n">upper_bounds</span><span class="o">.</span><span class="n">size</span><span class="p">():</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`lower_bounds` and `upper_bounds` have incompatible shapes&quot;</span><span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="k">if</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only 1D tensors are supported for `lower_bounds` and for `upper_bounds`&quot;</span><span class="p">)</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="n">dtype</span> <span class="o">=</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="n">device</span> <span class="o">=</span> <span class="n">lower_bounds</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="n">num_bins</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="k">if</span> <span class="n">num_bins</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="n">num_bins</span> <span class="o">=</span> <span class="n">num_bins</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">lower_bounds</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="n">p_inf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="n">n_inf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_feature_grid</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">):</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="n">sp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">num_bins</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">sp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">n_inf</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="n">p_inf</span><span class="p">))</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="k">return</span> <span class="n">sp</span><span class="o">.</span><span class="n">unfold</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="n">f_grids</span> <span class="o">=</span> <span class="p">[</span><span class="n">_make_feature_grid</span><span class="p">(</span><span class="o">*</span><span class="n">bounds</span><span class="p">)</span> <span class="k">for</span> <span class="n">bounds</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">)]</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">f_grids</span><span class="p">)])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.PGPE" class="doc doc-heading">
            <code>PGPE</code>


<a href="#evotorch.algorithms.PGPE" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="GaussianSearchAlgorithm (evotorch.algorithms.distributed.gaussian.GaussianSearchAlgorithm)" href="distributed/gaussian/#evotorch.algorithms.distributed.gaussian.GaussianSearchAlgorithm">GaussianSearchAlgorithm</a></code></p>


        <p>This implementation is the symmetric-sampling variant proposed
in the paper Sehnke et al. (2010).</p>
<p>Inspired by the PGPE implementations used in the studies
of Ha (2017, 2019), and by the evolution strategy variant of
Salimans et al. (2017), this PGPE implementation uses 0-centered
ranking by default.
The default optimizer for this PGPE implementation is ClipUp
(Toklu et al., 2020).</p>
<p>References:</p>
<div class="highlight"><pre><span></span><code>Frank Sehnke, Christian Osendorfer, Thomas Ruckstiess,
Alex Graves, Jan Peters, Jurgen Schmidhuber (2010).
Parameter-exploring Policy Gradients.
Neural Networks 23(4), 551-559.

David Ha (2017). Evolving Stable Strategies.
&lt;http://blog.otoro.net/2017/11/12/evolving-stable-strategies/&gt;

Salimans, T., Ho, J., Chen, X., Sidor, S. and Sutskever, I. (2017).
Evolution Strategies as a Scalable Alternative to
Reinforcement Learning.

David Ha (2019). Reinforcement Learning for Improving Agent Design.
Artificial life 25 (4), 352-365.

Toklu, N.E., Liskowski, P., Srivastava, R.K. (2020).
ClipUp: A Simple and Powerful Optimizer
for Distribution-based Policy Evolution.
Parallel Problem Solving from Nature (PPSN 2020).
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/distributed/gaussian.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="k">class</span><span class="w"> </span><span class="nc">PGPE</span><span class="p">(</span><span class="n">GaussianSearchAlgorithm</span><span class="p">):</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">    PGPE: Policy gradient with parameter-based exploration.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">    This implementation is the symmetric-sampling variant proposed</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">    in the paper Sehnke et al. (2010).</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">    Inspired by the PGPE implementations used in the studies</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    of Ha (2017, 2019), and by the evolution strategy variant of</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">    Salimans et al. (2017), this PGPE implementation uses 0-centered</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">    ranking by default.</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    The default optimizer for this PGPE implementation is ClipUp</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    (Toklu et al., 2020).</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">    References:</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        Frank Sehnke, Christian Osendorfer, Thomas Ruckstiess,</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">        Alex Graves, Jan Peters, Jurgen Schmidhuber (2010).</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        Parameter-exploring Policy Gradients.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        Neural Networks 23(4), 551-559.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        David Ha (2017). Evolving Stable Strategies.</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        &lt;http://blog.otoro.net/2017/11/12/evolving-stable-strategies/&gt;</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        Salimans, T., Ho, J., Chen, X., Sidor, S. and Sutskever, I. (2017).</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        Evolution Strategies as a Scalable Alternative to</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">        Reinforcement Learning.</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">        David Ha (2019). Reinforcement Learning for Improving Agent Design.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">        Artificial life 25 (4), 352-365.</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        Toklu, N.E., Liskowski, P., Srivastava, R.K. (2020).</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">        ClipUp: A Simple and Powerful Optimizer</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        for Distribution-based Policy Evolution.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">        Parallel Problem Solving from Nature (PPSN 2020).</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="n">DISTRIBUTION_TYPE</span> <span class="o">=</span> <span class="bp">NotImplemented</span>  <span class="c1"># To be filled by the PGPE instance</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="n">DISTRIBUTION_PARAMS</span> <span class="o">=</span> <span class="bp">NotImplemented</span>  <span class="c1"># To be filled by the PGPE instance</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">center_learning_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="n">stdev_learning_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="n">radius_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;clipup&quot;</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="n">optimizer_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;centered&quot;</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="n">stdev_max_change</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="n">symmetric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="n">distributed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="n">popsize_weighted_grad_avg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>    <span class="p">):</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">        `__init__(...)`: Initialize the PGPE algorithm.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">            problem: The problem object which is being worked on.</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">                The problem must have its dtype defined</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">                (which means it works on Solution objects,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">                not with custom Solution objects).</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">                Also, the problem must be single-objective.</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">            popsize: The population size.</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">                In the case of PGPE, `popsize` is expected as an even number</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">                in non-distributed mode. In distributed mode, PGPE will</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">                ensure that each sub-population size assigned to a remote</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">                actor is an even number.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">                This behavior is because PGPE does symmetric sampling</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">                (i.e. solutions are sampled in pairs).</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">            center_learning_rate: The learning rate for the center</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">                of the search distribution.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">            stdev_learning_rate: The learning rate for the standard</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">                deviation values of the search distribution.</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">            stdev_init: The initial standard deviation of the search</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">                distribution, expressed as a scalar or as an array.</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">                Determines the initial coverage area of the search</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">                If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">                argument `radius_init` instead, then `stdev_init` is expected</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">                as None.</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">            radius_init: The initial radius of the search distribution,</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">                expressed as a scalar.</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">                Determines the initial coverage area of the search</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">                Here, &quot;radius&quot; is defined as the norm of the search</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">                If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">                argument `stdev_init` instead, then `radius_init` is expected</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">                as None.</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">            num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">                it is ensured that a population has interacted with</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">                the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">                has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">                too small, and gets extended with more samples,</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">                until n amount of interactions is reached.</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">                When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">                affecting the size of a population.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">            popsize_max: Having `num_interactions` set as an integer</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">                might cause the effective population size jump to</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">                unnecesarily large numbers. To prevent this,</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">                one can set `popsize_max` to specify an upper</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">                bound for the effective population size.</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">            optimizer: The optimizer to be used while following the</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">                estimated the gradients.</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">                Can be given as None if a momentum-based optimizer</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">                is not required.</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">                Otherwise, can be given as a str containing the name</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">                of the optimizer (e.g. &#39;adam&#39;, &#39;clipup&#39;);</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">                or as an instance of evotorch.optimizers.TorchOptimizer</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">                or evotorch.optimizers.ClipUp.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">                The default is &#39;clipup&#39;.</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">                Note that, for ClipUp, the default maximum speed is set</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">                as twice the given `center_learning_rate`.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">                This maximum speed can be configured by passing</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">                `{&quot;max_speed&quot;: ...}` to `optimizer_config`.</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">            optimizer_config: Configuration which will be passed</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">                to the optimizer as keyword arguments.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">                See `evotorch.optimizers` for details about</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">                which optimizer accepts which keyword arguments.</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">            ranking_method: Which ranking method will be used for</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">                fitness shaping. See the documentation of</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">                `evotorch.ranking.rank(...)` for details.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">                As in the study of Salimans et al. (2017),</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">                the default is &#39;centered&#39;.</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">                Can be given as None if no such ranking is required.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">            center_init: The initial center solution.</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">                Can be left as None.</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">            stdev_min: Lower bound for the standard deviation value/array.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">                Can be given as a real number, or as an array of real numbers.</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            stdev_max: Upper bound for the standard deviation value/array.</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">                Can be given as a real number, or as an array of real numbers.</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">            stdev_max_change: The maximum update ratio allowed on the</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">                standard deviation. Expected as None if no such limiter</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">                is needed, or as a real number within 0.0 and 1.0 otherwise.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">                Like in the implementation of Ha (2017, 2018),</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">                the default value for this setting is 0.2, meaning that</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">                the update on the standard deviation values can not be</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">                more than 20% of their original values.</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">            symmetric: Whether or not the solutions will be sampled</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">                in a symmetric/mirrored/antithetic manner.</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">                The default is True.</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">            obj_index: Index of the objective according to which the</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">                gradient estimations will be done.</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">                For single-objective problems, this can be left as None.</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">            distributed: Whether or not the gradient computation will</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">                be distributed. If `distributed` is given as False and</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">                the problem is not parallelized, then everything will</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">                be centralized (i.e. the entire computation will happen</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">                in the main process).</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">                If `distributed` is given as False, and the problem</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">                is parallelized, then the population will be created</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">                in the main process and then sent to remote workers</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">                for parallelized evaluation, and then the remote fitnesses</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">                will be collected by the main process again for computing</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">                the search gradients.</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">                If `distributed` is given as True, and the problem</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">                is parallelized, then the search algorithm itself will</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">                be distributed, in the sense that each remote actor will</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">                generate its own population (such that the total population</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">                size across all these actors becomes equal to `popsize`)</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">                and will compute its own gradient, and then the main process</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">                will collect these gradients, compute the averaged gradients</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">                and update the main search distribution.</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">                Non-distributed mode has the advantage of keeping the</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">                population in the main process, which is good when one wishes</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">                to do detailed monitoring during the evolutionary process,</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">                but has the disadvantage of having to pass the solutions to</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">                the remote actors and having to collect fitnesses, which</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">                might result in increased interprocess communication traffic.</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">                On the other hand, while it is not possible to monitor the</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">                population in distributed mode, the distributed mode has the</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">                advantage of significantly reducing the interprocess</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">                communication traffic, since the only things communicated</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">                with the remote actors are the search distributions (not the</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="sd">                solutions) and the gradients.</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">            popsize_weighted_grad_avg: Only to be used in distributed mode.</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="sd">                (where being in distributed mode means `distributed` is given</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">                as True). In distributed mode, each actor remotely samples</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">                its own solution batches and computes its own gradients.</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">                These gradients are then collected, and a final average</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">                gradient is computed.</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="sd">                If `popsize_weighted_grad_avg` is True, then, while averaging</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">                over the gradients, each gradient will have its own weight</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">                that is computed according to how many solutions were sampled</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">                by the actor that produced the gradient.</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">                If `popsize_weighted_grad_avg` is False, then, there will not</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">                be weighted averaging (or, each gradient will have equal</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">                weight).</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">                If `popsize_weighted_grad_avg` is None, then, the gradient</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">                weights will be equal a value for `num_interactions` is given</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">                (because `num_interactions` affects the number of solutions</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">                according to the episode lengths, and popsize-weighting the</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">                gradients could be misleading); and the gradient weights will</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">                be weighted according to the sub-population (i.e. sub-batch)</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">                sizes if `num_interactions` is left as None.</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">                The default value for `popsize_weighted_grad_avg` is None.</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">                When the distributed mode is disabled (i.e. when `distributed`</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">                is False), then the argument `popsize_weighted_grad_avg` is</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">                expected as None.</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="k">if</span> <span class="n">symmetric</span><span class="p">:</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">DISTRIBUTION_TYPE</span> <span class="o">=</span> <span class="n">SymmetricSeparableGaussian</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>            <span class="n">divide_by</span> <span class="o">=</span> <span class="s2">&quot;num_directions&quot;</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">DISTRIBUTION_TYPE</span> <span class="o">=</span> <span class="n">SeparableGaussian</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>            <span class="n">divide_by</span> <span class="o">=</span> <span class="s2">&quot;num_solutions&quot;</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DISTRIBUTION_PARAMS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;divide_mu_grad_by&quot;</span><span class="p">:</span> <span class="n">divide_by</span><span class="p">,</span> <span class="s2">&quot;divide_sigma_grad_by&quot;</span><span class="p">:</span> <span class="n">divide_by</span><span class="p">}</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>            <span class="n">center_learning_rate</span><span class="o">=</span><span class="n">center_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>            <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="n">stdev_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>            <span class="n">stdev_init</span><span class="o">=</span><span class="n">stdev_init</span><span class="p">,</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="n">radius_init</span><span class="o">=</span><span class="n">radius_init</span><span class="p">,</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>            <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>            <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="n">optimizer_config</span><span class="o">=</span><span class="n">optimizer_config</span><span class="p">,</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="n">center_init</span><span class="o">=</span><span class="n">center_init</span><span class="p">,</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="n">stdev_min</span><span class="o">=</span><span class="n">stdev_min</span><span class="p">,</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="n">stdev_max</span><span class="o">=</span><span class="n">stdev_max</span><span class="p">,</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="n">stdev_max_change</span><span class="o">=</span><span class="n">stdev_max_change</span><span class="p">,</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>            <span class="n">distributed</span><span class="o">=</span><span class="n">distributed</span><span class="p">,</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>            <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="n">popsize_weighted_grad_avg</span><span class="p">,</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>            <span class="n">ensure_even_popsize</span><span class="o">=</span><span class="n">symmetric</span><span class="p">,</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.PGPE.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="n">center_learning_rate</span><span class="p">,</span> <span class="n">stdev_learning_rate</span><span class="p">,</span> <span class="n">stdev_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">radius_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_interactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">popsize_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;clipup&#39;</span><span class="p">,</span> <span class="n">optimizer_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="s1">&#39;centered&#39;</span><span class="p">,</span> <span class="n">center_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_max_change</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distributed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.PGPE.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the PGPE algorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem object which is being worked on.
The problem must have its dtype defined
(which means it works on Solution objects,
not with custom Solution objects).
Also, the problem must be single-objective.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The population size.
In the case of PGPE, <code>popsize</code> is expected as an even number
in non-distributed mode. In distributed mode, PGPE will
ensure that each sub-population size assigned to a remote
actor is an even number.
This behavior is because PGPE does symmetric sampling
(i.e. solutions are sampled in pairs).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_learning_rate</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The learning rate for the center
of the search distribution.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_learning_rate</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The learning rate for the standard
deviation values of the search distribution.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial standard deviation of the search
distribution, expressed as a scalar or as an array.
Determines the initial coverage area of the search
distribution.
If one wishes to configure the coverage area via the
argument <code>radius_init</code> instead, then <code>stdev_init</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radius_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial radius of the search distribution,
expressed as a scalar.
Determines the initial coverage area of the search
distribution.
Here, "radius" is defined as the norm of the search
distribution.
If one wishes to configure the coverage area via the
argument <code>stdev_init</code> instead, then <code>radius_init</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_interactions</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When given as an integer n,
it is ensured that a population has interacted with
the GymProblem's environment n times. If this target
has not been reached yet, then the population is declared
too small, and gets extended with more samples,
until n amount of interactions is reached.
When given as None, popsize is the only configuration
affecting the size of a population.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Having <code>num_interactions</code> set as an integer
might cause the effective population size jump to
unnecesarily large numbers. To prevent this,
one can set <code>popsize_max</code> to specify an upper
bound for the effective population size.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimizer to be used while following the
estimated the gradients.
Can be given as None if a momentum-based optimizer
is not required.
Otherwise, can be given as a str containing the name
of the optimizer (e.g. 'adam', 'clipup');
or as an instance of evotorch.optimizers.TorchOptimizer
or evotorch.optimizers.ClipUp.
The default is 'clipup'.
Note that, for ClipUp, the default maximum speed is set
as twice the given <code>center_learning_rate</code>.
This maximum speed can be configured by passing
<code>{"max_speed": ...}</code> to <code>optimizer_config</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;clipup&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration which will be passed
to the optimizer as keyword arguments.
See <code>evotorch.optimizers</code> for details about
which optimizer accepts which keyword arguments.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ranking_method</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which ranking method will be used for
fitness shaping. See the documentation of
<code>evotorch.ranking.rank(...)</code> for details.
As in the study of Salimans et al. (2017),
the default is 'centered'.
Can be given as None if no such ranking is required.</p>
              </div>
            </td>
            <td>
                  <code>&#39;centered&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial center solution.
Can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_min</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bound for the standard deviation value/array.
Can be given as a real number, or as an array of real numbers.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bound for the standard deviation value/array.
Can be given as a real number, or as an array of real numbers.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_max_change</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum update ratio allowed on the
standard deviation. Expected as None if no such limiter
is needed, or as a real number within 0.0 and 1.0 otherwise.
Like in the implementation of Ha (2017, 2018),
the default value for this setting is 0.2, meaning that
the update on the standard deviation values can not be
more than 20% of their original values.</p>
              </div>
            </td>
            <td>
                  <code>0.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>symmetric</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the solutions will be sampled
in a symmetric/mirrored/antithetic manner.
The default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj_index</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the objective according to which the
gradient estimations will be done.
For single-objective problems, this can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distributed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the gradient computation will
be distributed. If <code>distributed</code> is given as False and
the problem is not parallelized, then everything will
be centralized (i.e. the entire computation will happen
in the main process).
If <code>distributed</code> is given as False, and the problem
is parallelized, then the population will be created
in the main process and then sent to remote workers
for parallelized evaluation, and then the remote fitnesses
will be collected by the main process again for computing
the search gradients.
If <code>distributed</code> is given as True, and the problem
is parallelized, then the search algorithm itself will
be distributed, in the sense that each remote actor will
generate its own population (such that the total population
size across all these actors becomes equal to <code>popsize</code>)
and will compute its own gradient, and then the main process
will collect these gradients, compute the averaged gradients
and update the main search distribution.
Non-distributed mode has the advantage of keeping the
population in the main process, which is good when one wishes
to do detailed monitoring during the evolutionary process,
but has the disadvantage of having to pass the solutions to
the remote actors and having to collect fitnesses, which
might result in increased interprocess communication traffic.
On the other hand, while it is not possible to monitor the
population in distributed mode, the distributed mode has the
advantage of significantly reducing the interprocess
communication traffic, since the only things communicated
with the remote actors are the search distributions (not the
solutions) and the gradients.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize_weighted_grad_avg</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Only to be used in distributed mode.
(where being in distributed mode means <code>distributed</code> is given
as True). In distributed mode, each actor remotely samples
its own solution batches and computes its own gradients.
These gradients are then collected, and a final average
gradient is computed.
If <code>popsize_weighted_grad_avg</code> is True, then, while averaging
over the gradients, each gradient will have its own weight
that is computed according to how many solutions were sampled
by the actor that produced the gradient.
If <code>popsize_weighted_grad_avg</code> is False, then, there will not
be weighted averaging (or, each gradient will have equal
weight).
If <code>popsize_weighted_grad_avg</code> is None, then, the gradient
weights will be equal a value for <code>num_interactions</code> is given
(because <code>num_interactions</code> affects the number of solutions
according to the episode lengths, and popsize-weighting the
gradients could be misleading); and the gradient weights will
be weighted according to the sub-population (i.e. sub-batch)
sizes if <code>num_interactions</code> is left as None.
The default value for <code>popsize_weighted_grad_avg</code> is None.
When the distributed mode is disabled (i.e. when <code>distributed</code>
is False), then the argument <code>popsize_weighted_grad_avg</code> is
expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/distributed/gaussian.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="n">center_learning_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="n">stdev_learning_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="n">radius_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;clipup&quot;</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="n">optimizer_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>    <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;centered&quot;</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>    <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>    <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>    <span class="n">stdev_max_change</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="n">symmetric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="n">distributed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="n">popsize_weighted_grad_avg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="p">):</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">    `__init__(...)`: Initialize the PGPE algorithm.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        problem: The problem object which is being worked on.</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">            The problem must have its dtype defined</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">            (which means it works on Solution objects,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">            not with custom Solution objects).</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">            Also, the problem must be single-objective.</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">        popsize: The population size.</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">            In the case of PGPE, `popsize` is expected as an even number</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">            in non-distributed mode. In distributed mode, PGPE will</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">            ensure that each sub-population size assigned to a remote</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">            actor is an even number.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">            This behavior is because PGPE does symmetric sampling</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">            (i.e. solutions are sampled in pairs).</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        center_learning_rate: The learning rate for the center</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">            of the search distribution.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">        stdev_learning_rate: The learning rate for the standard</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">            deviation values of the search distribution.</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">        stdev_init: The initial standard deviation of the search</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">            distribution, expressed as a scalar or as an array.</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">            Determines the initial coverage area of the search</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">            If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">            argument `radius_init` instead, then `stdev_init` is expected</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">        radius_init: The initial radius of the search distribution,</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">            expressed as a scalar.</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">            Determines the initial coverage area of the search</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">            Here, &quot;radius&quot; is defined as the norm of the search</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">            If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">            argument `stdev_init` instead, then `radius_init` is expected</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">        num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">            it is ensured that a population has interacted with</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">            the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">            has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">            too small, and gets extended with more samples,</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">            until n amount of interactions is reached.</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">            When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">            affecting the size of a population.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">        popsize_max: Having `num_interactions` set as an integer</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">            might cause the effective population size jump to</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">            unnecesarily large numbers. To prevent this,</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">            one can set `popsize_max` to specify an upper</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">            bound for the effective population size.</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">        optimizer: The optimizer to be used while following the</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">            estimated the gradients.</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">            Can be given as None if a momentum-based optimizer</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">            is not required.</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">            Otherwise, can be given as a str containing the name</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">            of the optimizer (e.g. &#39;adam&#39;, &#39;clipup&#39;);</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">            or as an instance of evotorch.optimizers.TorchOptimizer</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">            or evotorch.optimizers.ClipUp.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">            The default is &#39;clipup&#39;.</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">            Note that, for ClipUp, the default maximum speed is set</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">            as twice the given `center_learning_rate`.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">            This maximum speed can be configured by passing</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">            `{&quot;max_speed&quot;: ...}` to `optimizer_config`.</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">        optimizer_config: Configuration which will be passed</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">            to the optimizer as keyword arguments.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">            See `evotorch.optimizers` for details about</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">            which optimizer accepts which keyword arguments.</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">        ranking_method: Which ranking method will be used for</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">            fitness shaping. See the documentation of</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">            `evotorch.ranking.rank(...)` for details.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">            As in the study of Salimans et al. (2017),</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">            the default is &#39;centered&#39;.</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">            Can be given as None if no such ranking is required.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">        center_init: The initial center solution.</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">            Can be left as None.</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">        stdev_min: Lower bound for the standard deviation value/array.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">            Can be given as a real number, or as an array of real numbers.</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">        stdev_max: Upper bound for the standard deviation value/array.</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">            Can be given as a real number, or as an array of real numbers.</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">        stdev_max_change: The maximum update ratio allowed on the</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">            standard deviation. Expected as None if no such limiter</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">            is needed, or as a real number within 0.0 and 1.0 otherwise.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">            Like in the implementation of Ha (2017, 2018),</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">            the default value for this setting is 0.2, meaning that</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">            the update on the standard deviation values can not be</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">            more than 20% of their original values.</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">        symmetric: Whether or not the solutions will be sampled</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">            in a symmetric/mirrored/antithetic manner.</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">            The default is True.</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        obj_index: Index of the objective according to which the</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">            gradient estimations will be done.</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">            For single-objective problems, this can be left as None.</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        distributed: Whether or not the gradient computation will</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">            be distributed. If `distributed` is given as False and</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">            the problem is not parallelized, then everything will</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">            be centralized (i.e. the entire computation will happen</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">            in the main process).</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">            If `distributed` is given as False, and the problem</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">            is parallelized, then the population will be created</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">            in the main process and then sent to remote workers</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">            for parallelized evaluation, and then the remote fitnesses</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">            will be collected by the main process again for computing</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">            the search gradients.</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">            If `distributed` is given as True, and the problem</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">            is parallelized, then the search algorithm itself will</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">            be distributed, in the sense that each remote actor will</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">            generate its own population (such that the total population</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">            size across all these actors becomes equal to `popsize`)</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">            and will compute its own gradient, and then the main process</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">            will collect these gradients, compute the averaged gradients</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">            and update the main search distribution.</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">            Non-distributed mode has the advantage of keeping the</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">            population in the main process, which is good when one wishes</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">            to do detailed monitoring during the evolutionary process,</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">            but has the disadvantage of having to pass the solutions to</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">            the remote actors and having to collect fitnesses, which</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">            might result in increased interprocess communication traffic.</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">            On the other hand, while it is not possible to monitor the</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">            population in distributed mode, the distributed mode has the</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">            advantage of significantly reducing the interprocess</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">            communication traffic, since the only things communicated</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">            with the remote actors are the search distributions (not the</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="sd">            solutions) and the gradients.</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">        popsize_weighted_grad_avg: Only to be used in distributed mode.</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="sd">            (where being in distributed mode means `distributed` is given</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">            as True). In distributed mode, each actor remotely samples</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">            its own solution batches and computes its own gradients.</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">            These gradients are then collected, and a final average</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">            gradient is computed.</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="sd">            If `popsize_weighted_grad_avg` is True, then, while averaging</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">            over the gradients, each gradient will have its own weight</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">            that is computed according to how many solutions were sampled</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">            by the actor that produced the gradient.</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">            If `popsize_weighted_grad_avg` is False, then, there will not</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">            be weighted averaging (or, each gradient will have equal</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">            weight).</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">            If `popsize_weighted_grad_avg` is None, then, the gradient</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">            weights will be equal a value for `num_interactions` is given</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">            (because `num_interactions` affects the number of solutions</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">            according to the episode lengths, and popsize-weighting the</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">            gradients could be misleading); and the gradient weights will</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">            be weighted according to the sub-population (i.e. sub-batch)</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">            sizes if `num_interactions` is left as None.</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">            The default value for `popsize_weighted_grad_avg` is None.</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">            When the distributed mode is disabled (i.e. when `distributed`</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">            is False), then the argument `popsize_weighted_grad_avg` is</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">            expected as None.</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="k">if</span> <span class="n">symmetric</span><span class="p">:</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DISTRIBUTION_TYPE</span> <span class="o">=</span> <span class="n">SymmetricSeparableGaussian</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="n">divide_by</span> <span class="o">=</span> <span class="s2">&quot;num_directions&quot;</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">DISTRIBUTION_TYPE</span> <span class="o">=</span> <span class="n">SeparableGaussian</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="n">divide_by</span> <span class="o">=</span> <span class="s2">&quot;num_solutions&quot;</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">DISTRIBUTION_PARAMS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;divide_mu_grad_by&quot;</span><span class="p">:</span> <span class="n">divide_by</span><span class="p">,</span> <span class="s2">&quot;divide_sigma_grad_by&quot;</span><span class="p">:</span> <span class="n">divide_by</span><span class="p">}</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>        <span class="n">center_learning_rate</span><span class="o">=</span><span class="n">center_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="n">stdev_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="n">stdev_init</span><span class="o">=</span><span class="n">stdev_init</span><span class="p">,</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>        <span class="n">radius_init</span><span class="o">=</span><span class="n">radius_init</span><span class="p">,</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>        <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="n">optimizer_config</span><span class="o">=</span><span class="n">optimizer_config</span><span class="p">,</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="n">center_init</span><span class="o">=</span><span class="n">center_init</span><span class="p">,</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>        <span class="n">stdev_min</span><span class="o">=</span><span class="n">stdev_min</span><span class="p">,</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="n">stdev_max</span><span class="o">=</span><span class="n">stdev_max</span><span class="p">,</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="n">stdev_max_change</span><span class="o">=</span><span class="n">stdev_max_change</span><span class="p">,</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>        <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>        <span class="n">distributed</span><span class="o">=</span><span class="n">distributed</span><span class="p">,</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>        <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="n">popsize_weighted_grad_avg</span><span class="p">,</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>        <span class="n">ensure_even_popsize</span><span class="o">=</span><span class="n">symmetric</span><span class="p">,</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.PyCMAES" class="doc doc-heading">
            <code>PyCMAES</code>


<a href="#evotorch.algorithms.PyCMAES" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SearchAlgorithm (evotorch.algorithms.searchalgorithm.SearchAlgorithm)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.SearchAlgorithm">SearchAlgorithm</a></code>, <code><a class="autorefs autorefs-internal" title="SinglePopulationAlgorithmMixin (evotorch.algorithms.searchalgorithm.SinglePopulationAlgorithmMixin)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.SinglePopulationAlgorithmMixin">SinglePopulationAlgorithmMixin</a></code></p>


        <p>This is an interface class between the CMAES implementation
within the <code>cma</code> package developed within the GitHub repository
CMA-ES/pycma.</p>
<p>References:</p>
<div class="highlight"><pre><span></span><code>Nikolaus Hansen, Youhei Akimoto, and Petr Baudis.
CMA-ES/pycma on Github. Zenodo, DOI:10.5281/zenodo.2559634,
February 2019.
&lt;https://github.com/CMA-ES/pycma&gt;

Nikolaus Hansen, Andreas Ostermeier (2001).
Completely Derandomized Self-Adaptation in Evolution Strategies.
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/pycmaes.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="k">class</span><span class="w"> </span><span class="nc">PyCMAES</span><span class="p">(</span><span class="n">SearchAlgorithm</span><span class="p">,</span> <span class="n">SinglePopulationAlgorithmMixin</span><span class="p">):</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    PyCMAES: Covariance Matrix Adaptation Evolution Strategy.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    This is an interface class between the CMAES implementation</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    within the `cma` package developed within the GitHub repository</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    CMA-ES/pycma.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    References:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        Nikolaus Hansen, Youhei Akimoto, and Petr Baudis.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        CMA-ES/pycma on Github. Zenodo, DOI:10.5281/zenodo.2559634,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        February 2019.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        &lt;https://github.com/CMA-ES/pycma&gt;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        Nikolaus Hansen, Andreas Ostermeier (2001).</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        Completely Derandomized Self-Adaptation in Evolution Strategies.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">stdev_init</span><span class="p">:</span> <span class="n">RealOrVector</span><span class="p">,</span>  <span class="c1"># sigma0</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># popsize</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Vector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># x0</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">center_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># CMA_cmean</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">cov_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># CMA_on</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">rankmu_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># CMA_rankmu</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">rankone_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># CMA_rankone</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># minstd</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># maxstd</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">separable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># CMA_diagonal</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">cma_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="p">):</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        `__init__(...)`: Initialize the PyCMAES solver.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">            problem: The problem object which is being worked on.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            stdev_init: Initial standard deviation as a scalar or</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">                as a 1-dimensional array.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            popsize: Population size. Can be specified as an int,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">                or can be left as None to let the CMAES solver</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">                decide the population size according to the length</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">                of a solution.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            center_init: Initial center point of the search distribution.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">                Can be given as a Solution or as a 1-D array.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">                If left as None, an initial center point is generated</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">                with the help of the problem object&#39;s `generate_values(...)`</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">                method.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">            center_learning_rate: Learning rate for updating the mean</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">                of the search distribution. Leaving this as None</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">                means that the CMAES solver is to use its own default,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">                which is documented as 1.0.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            cov_learning_rate: Learning rate for updating the covariance</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">                matrix of the search distribution. This hyperparameter</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">                acts as a common multiplier for rank_one update and rank_mu</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">                update of the covariance matrix. Leaving this as None</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">                means that the CMAES solver is to use its own default,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">                which is documented as 1.0.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            rankmu_learning_rate: Learning rate for the rank_mu update</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">                of the covariance matrix of the search distribution.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">                Leaving this as None means that the CMAES solver is to use</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">                its own default, which is documented as 1.0.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            rankone_learning_rate: Learning rate for the rank_one update</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">                of the covariance matrix of the search distribution.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">                Leaving this as None means that the CMAES solver is to use</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">                its own default, which is documented as 1.0.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            stdev_min: Minimum allowed standard deviation of the search</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">                distribution. Leaving this as None means that no such</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">                boundary is to be used.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">                Can be given as None, as a scalar, or as a 1-dimensional</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">                array.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            stdev_max: Maximum allowed standard deviation of the search</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">                distribution. Leaving this as None means that no such</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">                boundary is to be used.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">                Can be given as None, as a scalar, or as a 1-dimensional</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">                array.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            separable: Provide this as True if you would like the problem</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">                to be treated as a separable one. Treating a problem</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">                as separable means to adapt only the diagonal parts</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">                of the covariance matrix and to keep the non-diagonal</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">                parts 0. High dimensional problems result in large</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">                covariance matrices on which operating is computationally</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">                expensive. Therefore, for such high dimensional problems,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">                setting `separable` as True might be useful.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">                If, instead, you would like to configure on which</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">                iterations the diagonal parts of the covariance matrix</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">                are to be adapted, then it is recommended to leave</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">                `separable` as False and set a new value for the key</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">                &quot;CMA_diagonal&quot; via `cma_options` (see the official</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                documentation of pycma for details regarding the</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">                &quot;CMA_diagonal&quot; setting).</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            obj_index: Objective index according to which evaluation</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">                of the solution will be done.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            cma_options: Any other configuration for the CMAES solver</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">                can be passed via the cma_options dictionary.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="c1"># Make sure that the cma module is installed</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="k">if</span> <span class="n">cma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The class </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is only available if the package `cma` is installed.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="c1"># Initialize the base class</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_center</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="c1"># Ensure that the problem is numeric</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">problem</span><span class="o">.</span><span class="n">ensure_numeric</span><span class="p">()</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="c1"># Store the objective index</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obj_index</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="c1"># If `center_init` is not given, generate an initial solution</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="c1"># with the help of the problem object.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="c1"># Otherwise, use the given initial solution as the starting</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="c1"># point in the search space.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">if</span> <span class="n">center_init</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">generate_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">x0</span> <span class="o">=</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="n">center_init</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="c1"># Store the initial standard deviations</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">sigma0</span> <span class="o">=</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="n">stdev_init</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="c1"># Generate an options dictionary to pass to the cma solver.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">inopts</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cma_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                <span class="n">v</span> <span class="o">=</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="n">inopts</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="c1"># Remove the number of iterations boundary</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="k">if</span> <span class="s2">&quot;maxiter&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inopts</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="n">inopts</span><span class="p">[</span><span class="s2">&quot;maxiter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="c1"># Below is a temporary helper function for safely storing the configuration items.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="c1"># This inner function updates the `inopts` variable.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">store_opt</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">long_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">converter</span><span class="p">:</span> <span class="n">Callable</span><span class="p">):</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="c1"># Here, `key` represents the configuration key used by pycma</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="c1"># `long_name` represents the configuration&#39;s long name used by this class</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="c1"># `value` is the configuration value associated with `key`.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="c1"># Declare that this inner function accesses the `inopts` variable.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="k">nonlocal</span> <span class="n">inopts</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                <span class="c1"># If the provided `value` is None, then there is no configuration to store.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                <span class="c1"># So, we just leave this inner function.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="k">return</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">inopts</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                <span class="c1"># If the given `key` already exists within `inopts`, this means that the configuration was specified</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                <span class="c1"># twice: via the keyword argument `cma_options` AND via a keyword argument.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="c1"># We raise an error and inform the user about this redundancy.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                    <span class="sa">f</span><span class="s2">&quot;The configuration </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2"> was redundantly provided&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                    <span class="sa">f</span><span class="s2">&quot; both via the initialization argument </span><span class="si">{</span><span class="n">long_name</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                    <span class="sa">f</span><span class="s2">&quot; and via the cma_options dictionary.&quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">long_name</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                    <span class="sa">f</span><span class="s2">&quot; cma_options[</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">]=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">inopts</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                <span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="n">inopts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">converter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="c1"># Temporary helper function which makes sure that `x` is a numpy array or a float.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">array_or_float</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="k">return</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="c1"># Store the cma configuration received through the initialization arguments (and raise error if there is</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="c1"># redundancy with the cma_options dictionary).</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;popsize&quot;</span><span class="p">,</span> <span class="s2">&quot;popsize&quot;</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;CMA_cmean&quot;</span><span class="p">,</span> <span class="s2">&quot;center_learning_rate&quot;</span><span class="p">,</span> <span class="n">center_learning_rate</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;CMA_on&quot;</span><span class="p">,</span> <span class="s2">&quot;cov_learning_rate&quot;</span><span class="p">,</span> <span class="n">cov_learning_rate</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;CMA_rankmu&quot;</span><span class="p">,</span> <span class="s2">&quot;rankmu_learning_rate&quot;</span><span class="p">,</span> <span class="n">rankmu_learning_rate</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;CMA_rankone&quot;</span><span class="p">,</span> <span class="s2">&quot;rankone_learning_rate&quot;</span><span class="p">,</span> <span class="n">rankone_learning_rate</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;minstd&quot;</span><span class="p">,</span> <span class="s2">&quot;stdev_min&quot;</span><span class="p">,</span> <span class="n">stdev_min</span><span class="p">,</span> <span class="n">array_or_float</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;maxstd&quot;</span><span class="p">,</span> <span class="s2">&quot;stdev_max&quot;</span><span class="p">,</span> <span class="n">stdev_max</span><span class="p">,</span> <span class="n">array_or_float</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="k">if</span> <span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;CMA_diagonal&quot;</span><span class="p">,</span> <span class="s2">&quot;separable&quot;</span><span class="p">,</span> <span class="n">separable</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="c1"># If the problem defines lower and upper bounds, pass these into the options dict.</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">process_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">:</span> <span class="n">RealOrVector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">bounds</span><span class="p">):</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                    <span class="n">bounds</span> <span class="o">=</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                    <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">bounds</span><span class="p">))</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                <span class="k">return</span> <span class="n">bounds</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">lb</span> <span class="o">=</span> <span class="n">process_bounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">ub</span> <span class="o">=</span> <span class="n">process_bounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">register_bounds</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="k">if</span> <span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="n">register_bounds</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="k">elif</span> <span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="n">register_bounds</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="k">elif</span> <span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="n">register_bounds</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="k">if</span> <span class="n">register_bounds</span><span class="p">:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="n">inopts</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">]</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="c1"># Generate a random seed using the problem object for the sake of reproducibility.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="k">if</span> <span class="s2">&quot;seed&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inopts</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="n">inopts</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_randint</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(),</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="c1"># Instantiate the CMAEvolutionStrategy with the prepared configuration items.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_es</span> <span class="o">=</span> <span class="n">cma</span><span class="o">.</span><span class="n">CMAEvolutionStrategy</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">sigma0</span><span class="p">,</span> <span class="n">inopts</span><span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="c1"># Initialize the population.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="p">:</span> <span class="n">SolutionBatch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">generate_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_es</span><span class="o">.</span><span class="n">popsize</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="c1"># Use the SinglePopulationAlgorithmMixin to enable additional status reports regarding the population.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">SinglePopulationAlgorithmMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">population</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Population generated by the CMA-ES algorithm&quot;&quot;&quot;</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_population</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform a step of the CMA-ES solver&quot;&quot;&quot;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">asked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_es</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">access_values</span><span class="p">()[:]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">asked</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="p">)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">utility</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj_index</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_es</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">asked</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">scores</span><span class="p">)</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_center</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_es</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">obj_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Index of the objective being focused on&quot;&quot;&quot;</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_index</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.PyCMAES.obj_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">obj_index</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.PyCMAES.obj_index" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Index of the objective being focused on</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.PyCMAES.population" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">population</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.PyCMAES.population" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Population generated by the CMA-ES algorithm</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.PyCMAES.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">stdev_init</span><span class="p">,</span> <span class="n">popsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center_learning_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cov_learning_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rankmu_learning_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rankone_learning_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">separable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cma_options</span><span class="o">=</span><span class="p">{})</span></code>

<a href="#evotorch.algorithms.PyCMAES.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the PyCMAES solver.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem object which is being worked on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_init</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.RealOrVector">RealOrVector</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial standard deviation as a scalar or
as a 1-dimensional array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Population size. Can be specified as an int,
or can be left as None to let the CMAES solver
decide the population size according to the length
of a solution.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Vector">Vector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial center point of the search distribution.
Can be given as a Solution or as a 1-D array.
If left as None, an initial center point is generated
with the help of the problem object's <code>generate_values(...)</code>
method.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_learning_rate</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for updating the mean
of the search distribution. Leaving this as None
means that the CMAES solver is to use its own default,
which is documented as 1.0.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cov_learning_rate</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for updating the covariance
matrix of the search distribution. This hyperparameter
acts as a common multiplier for rank_one update and rank_mu
update of the covariance matrix. Leaving this as None
means that the CMAES solver is to use its own default,
which is documented as 1.0.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rankmu_learning_rate</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for the rank_mu update
of the covariance matrix of the search distribution.
Leaving this as None means that the CMAES solver is to use
its own default, which is documented as 1.0.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rankone_learning_rate</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for the rank_one update
of the covariance matrix of the search distribution.
Leaving this as None means that the CMAES solver is to use
its own default, which is documented as 1.0.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_min</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum allowed standard deviation of the search
distribution. Leaving this as None means that no such
boundary is to be used.
Can be given as None, as a scalar, or as a 1-dimensional
array.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum allowed standard deviation of the search
distribution. Leaving this as None means that no such
boundary is to be used.
Can be given as None, as a scalar, or as a 1-dimensional
array.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>separable</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Provide this as True if you would like the problem
to be treated as a separable one. Treating a problem
as separable means to adapt only the diagonal parts
of the covariance matrix and to keep the non-diagonal
parts 0. High dimensional problems result in large
covariance matrices on which operating is computationally
expensive. Therefore, for such high dimensional problems,
setting <code>separable</code> as True might be useful.
If, instead, you would like to configure on which
iterations the diagonal parts of the covariance matrix
are to be adapted, then it is recommended to leave
<code>separable</code> as False and set a new value for the key
"CMA_diagonal" via <code>cma_options</code> (see the official
documentation of pycma for details regarding the
"CMA_diagonal" setting).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj_index</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Objective index according to which evaluation
of the solution will be done.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cma_options</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any other configuration for the CMAES solver
can be passed via the cma_options dictionary.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/pycmaes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">stdev_init</span><span class="p">:</span> <span class="n">RealOrVector</span><span class="p">,</span>  <span class="c1"># sigma0</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># popsize</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Vector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># x0</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">center_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># CMA_cmean</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">cov_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># CMA_on</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">rankmu_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># CMA_rankmu</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">rankone_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># CMA_rankone</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># minstd</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># maxstd</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">separable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># CMA_diagonal</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">cma_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="p">):</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    `__init__(...)`: Initialize the PyCMAES solver.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        problem: The problem object which is being worked on.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        stdev_init: Initial standard deviation as a scalar or</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">            as a 1-dimensional array.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        popsize: Population size. Can be specified as an int,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">            or can be left as None to let the CMAES solver</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            decide the population size according to the length</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            of a solution.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        center_init: Initial center point of the search distribution.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            Can be given as a Solution or as a 1-D array.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            If left as None, an initial center point is generated</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            with the help of the problem object&#39;s `generate_values(...)`</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            method.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        center_learning_rate: Learning rate for updating the mean</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            of the search distribution. Leaving this as None</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            means that the CMAES solver is to use its own default,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            which is documented as 1.0.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        cov_learning_rate: Learning rate for updating the covariance</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            matrix of the search distribution. This hyperparameter</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            acts as a common multiplier for rank_one update and rank_mu</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            update of the covariance matrix. Leaving this as None</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            means that the CMAES solver is to use its own default,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            which is documented as 1.0.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        rankmu_learning_rate: Learning rate for the rank_mu update</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            of the covariance matrix of the search distribution.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            Leaving this as None means that the CMAES solver is to use</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            its own default, which is documented as 1.0.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        rankone_learning_rate: Learning rate for the rank_one update</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            of the covariance matrix of the search distribution.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">            Leaving this as None means that the CMAES solver is to use</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            its own default, which is documented as 1.0.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        stdev_min: Minimum allowed standard deviation of the search</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            distribution. Leaving this as None means that no such</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">            boundary is to be used.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">            Can be given as None, as a scalar, or as a 1-dimensional</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">            array.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        stdev_max: Maximum allowed standard deviation of the search</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            distribution. Leaving this as None means that no such</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">            boundary is to be used.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            Can be given as None, as a scalar, or as a 1-dimensional</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">            array.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        separable: Provide this as True if you would like the problem</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            to be treated as a separable one. Treating a problem</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            as separable means to adapt only the diagonal parts</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            of the covariance matrix and to keep the non-diagonal</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            parts 0. High dimensional problems result in large</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            covariance matrices on which operating is computationally</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            expensive. Therefore, for such high dimensional problems,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            setting `separable` as True might be useful.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            If, instead, you would like to configure on which</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            iterations the diagonal parts of the covariance matrix</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            are to be adapted, then it is recommended to leave</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            `separable` as False and set a new value for the key</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            &quot;CMA_diagonal&quot; via `cma_options` (see the official</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            documentation of pycma for details regarding the</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            &quot;CMA_diagonal&quot; setting).</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        obj_index: Objective index according to which evaluation</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            of the solution will be done.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        cma_options: Any other configuration for the CMAES solver</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            can be passed via the cma_options dictionary.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="c1"># Make sure that the cma module is installed</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="k">if</span> <span class="n">cma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The class </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is only available if the package `cma` is installed.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="c1"># Initialize the base class</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_center</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="c1"># Ensure that the problem is numeric</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">problem</span><span class="o">.</span><span class="n">ensure_numeric</span><span class="p">()</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="c1"># Store the objective index</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obj_index</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="c1"># If `center_init` is not given, generate an initial solution</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="c1"># with the help of the problem object.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="c1"># Otherwise, use the given initial solution as the starting</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="c1"># point in the search space.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">if</span> <span class="n">center_init</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">generate_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">x0</span> <span class="o">=</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="n">center_init</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="c1"># Store the initial standard deviations</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="n">sigma0</span> <span class="o">=</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="n">stdev_init</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="c1"># Generate an options dictionary to pass to the cma solver.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">inopts</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cma_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="n">v</span> <span class="o">=</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">inopts</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="c1"># Remove the number of iterations boundary</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">if</span> <span class="s2">&quot;maxiter&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inopts</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">inopts</span><span class="p">[</span><span class="s2">&quot;maxiter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="c1"># Below is a temporary helper function for safely storing the configuration items.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="c1"># This inner function updates the `inopts` variable.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">store_opt</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">long_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">converter</span><span class="p">:</span> <span class="n">Callable</span><span class="p">):</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="c1"># Here, `key` represents the configuration key used by pycma</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="c1"># `long_name` represents the configuration&#39;s long name used by this class</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="c1"># `value` is the configuration value associated with `key`.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="c1"># Declare that this inner function accesses the `inopts` variable.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">nonlocal</span> <span class="n">inopts</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="c1"># If the provided `value` is None, then there is no configuration to store.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="c1"># So, we just leave this inner function.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="k">return</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">inopts</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="c1"># If the given `key` already exists within `inopts`, this means that the configuration was specified</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="c1"># twice: via the keyword argument `cma_options` AND via a keyword argument.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="c1"># We raise an error and inform the user about this redundancy.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="sa">f</span><span class="s2">&quot;The configuration </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2"> was redundantly provided&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                <span class="sa">f</span><span class="s2">&quot; both via the initialization argument </span><span class="si">{</span><span class="n">long_name</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span class="sa">f</span><span class="s2">&quot; and via the cma_options dictionary.&quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">long_name</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                <span class="sa">f</span><span class="s2">&quot; cma_options[</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">]=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">inopts</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="n">inopts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">converter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="c1"># Temporary helper function which makes sure that `x` is a numpy array or a float.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">array_or_float</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="k">return</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="c1"># Store the cma configuration received through the initialization arguments (and raise error if there is</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="c1"># redundancy with the cma_options dictionary).</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;popsize&quot;</span><span class="p">,</span> <span class="s2">&quot;popsize&quot;</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;CMA_cmean&quot;</span><span class="p">,</span> <span class="s2">&quot;center_learning_rate&quot;</span><span class="p">,</span> <span class="n">center_learning_rate</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;CMA_on&quot;</span><span class="p">,</span> <span class="s2">&quot;cov_learning_rate&quot;</span><span class="p">,</span> <span class="n">cov_learning_rate</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;CMA_rankmu&quot;</span><span class="p">,</span> <span class="s2">&quot;rankmu_learning_rate&quot;</span><span class="p">,</span> <span class="n">rankmu_learning_rate</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;CMA_rankone&quot;</span><span class="p">,</span> <span class="s2">&quot;rankone_learning_rate&quot;</span><span class="p">,</span> <span class="n">rankone_learning_rate</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;minstd&quot;</span><span class="p">,</span> <span class="s2">&quot;stdev_min&quot;</span><span class="p">,</span> <span class="n">stdev_min</span><span class="p">,</span> <span class="n">array_or_float</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;maxstd&quot;</span><span class="p">,</span> <span class="s2">&quot;stdev_max&quot;</span><span class="p">,</span> <span class="n">stdev_max</span><span class="p">,</span> <span class="n">array_or_float</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="k">if</span> <span class="n">separable</span><span class="p">:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">store_opt</span><span class="p">(</span><span class="s2">&quot;CMA_diagonal&quot;</span><span class="p">,</span> <span class="s2">&quot;separable&quot;</span><span class="p">,</span> <span class="n">separable</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="c1"># If the problem defines lower and upper bounds, pass these into the options dict.</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">:</span> <span class="n">RealOrVector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">bounds</span><span class="p">):</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                <span class="n">bounds</span> <span class="o">=</span> <span class="n">numpy_copy</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">bounds</span><span class="p">))</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="k">return</span> <span class="n">bounds</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">lb</span> <span class="o">=</span> <span class="n">process_bounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">lower_bounds</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">ub</span> <span class="o">=</span> <span class="n">process_bounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">upper_bounds</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">register_bounds</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="k">if</span> <span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">register_bounds</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="k">elif</span> <span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="n">register_bounds</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="k">elif</span> <span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">register_bounds</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="k">if</span> <span class="n">register_bounds</span><span class="p">:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">inopts</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">]</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="c1"># Generate a random seed using the problem object for the sake of reproducibility.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">if</span> <span class="s2">&quot;seed&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inopts</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">inopts</span><span class="p">[</span><span class="s2">&quot;seed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">make_randint</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(),</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="c1"># Instantiate the CMAEvolutionStrategy with the prepared configuration items.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_es</span> <span class="o">=</span> <span class="n">cma</span><span class="o">.</span><span class="n">CMAEvolutionStrategy</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">sigma0</span><span class="p">,</span> <span class="n">inopts</span><span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="c1"># Initialize the population.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_population</span><span class="p">:</span> <span class="n">SolutionBatch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">generate_batch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_es</span><span class="o">.</span><span class="n">popsize</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="c1"># Use the SinglePopulationAlgorithmMixin to enable additional status reports regarding the population.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">SinglePopulationAlgorithmMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.SNES" class="doc doc-heading">
            <code>SNES</code>


<a href="#evotorch.algorithms.SNES" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="GaussianSearchAlgorithm (evotorch.algorithms.distributed.gaussian.GaussianSearchAlgorithm)" href="distributed/gaussian/#evotorch.algorithms.distributed.gaussian.GaussianSearchAlgorithm">GaussianSearchAlgorithm</a></code></p>


        <p>Inspired by the implementation at: <a href="http://schaul.site44.com/code/snes.py">http://schaul.site44.com/code/snes.py</a></p>
<p>Reference:</p>
<div class="highlight"><pre><span></span><code>Schaul, T., Glasmachers, T., Schmidhuber, J. (2011).
High Dimensions and Heavy Tails for Natural Evolution Strategies.
Proceedings of the 13th annual conference on Genetic and evolutionary
computation (GECCO 2011).
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/distributed/gaussian.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="k">class</span><span class="w"> </span><span class="nc">SNES</span><span class="p">(</span><span class="n">GaussianSearchAlgorithm</span><span class="p">):</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">    SNES: Separable Natural Evolution Strategies</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">    Inspired by the implementation at: http://schaul.site44.com/code/snes.py</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">    Reference:</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">        Schaul, T., Glasmachers, T., Schmidhuber, J. (2011).</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">        High Dimensions and Heavy Tails for Natural Evolution Strategies.</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a><span class="sd">        Proceedings of the 13th annual conference on Genetic and evolutionary</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">        computation (GECCO 2011).</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>    <span class="n">DISTRIBUTION_TYPE</span> <span class="o">=</span> <span class="n">ExpSeparableGaussian</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>    <span class="n">DISTRIBUTION_PARAMS</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>        <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>        <span class="n">radius_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>        <span class="n">center_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>        <span class="n">stdev_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>        <span class="n">scale_learning_rate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>        <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>        <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="n">optimizer_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>        <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nes&quot;</span><span class="p">,</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>        <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>        <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>        <span class="n">stdev_max_change</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="n">distributed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="n">popsize_weighted_grad_avg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="p">):</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">        `__init__(...)`: Initialize the SNES algorithm.</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">            problem: The problem object which is being worked on.</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">            stdev_init: The initial standard deviation of the search</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">                distribution, expressed as a scalar or as an array.</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">                Determines the initial coverage area of the search</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">                If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">                argument `radius_init` instead, then `stdev_init` is expected</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">                as None.</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">            radius_init: The initial radius of the search distribution,</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">                expressed as a scalar.</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">                Determines the initial coverage area of the search</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">                Here, &quot;radius&quot; is defined as the norm of the search</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">                If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">                argument `stdev_init` instead, then `radius_init` is expected</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">                as None.</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">            popsize: Population size. Can be specified as an int,</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">                or can be left as None to let the solver decide.</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">                In the case of SNES, `popsize` can be left as None,</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">                in which case the default `popsize` will be computed</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">                as `4 + floor(3 * log(n))` where `n` is the length</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">                of a solution.</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">            center_learning_rate: Learning rate for updating the mean</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">                of the search distribution. Default value is 1.0</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">            stdev_learning_rate: Learning rate for updating the covariance</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">                matrix of the search distribution.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">                The default value is `0.2 * (3 + log(n)) / sqrt(n)`</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">                where `n` is the length of a solution.</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">            scale_learning_rate: For SNES, there is a default standard</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">                deviation learning rate value which is computed as</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">                `0.2 * (3 + log(n)) / sqrt(n)` (where `n` is the solution</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">                length).</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">                If scale_learning_rate is True (which is the default),</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">                then the effective learning rate for the standard deviation</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">                becomes the provided `stdev_learning_rate` multiplied by this</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">                default value. If `scale_learning_rate` is False, then the</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">                effective standard deviation learning rate becomes</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">                equal to the provided `stdev_learning_rate` value.</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">            num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">                it is ensured that a population has interacted with</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">                the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">                has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">                too small, and gets extended with more samples,</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">                until n amount of interactions is reached.</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">                When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">                affecting the size of a population.</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">            popsize_max: Having `num_interactions` set as an integer</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">                might cause the effective population size jump to</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">                unnecesarily large numbers. To prevent this,</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">                one can set `popsize_max` to specify an upper</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">                bound for the effective population size.</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">            num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">                it is ensured that a population has interacted with</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">                the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">                has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">                too small, and gets extended with more samples,</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">                until n amount of interactions is reached.</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">                When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">                affecting the size of a population.</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">            popsize_max: Having `num_interactions` set as an integer</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">                might cause the effective population size jump to</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">                unnecesarily large numbers. To prevent this,</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">                one can set `popsize_max` to specify an upper</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">                bound for the effective population size.</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">            optimizer: The optimizer to be used while following the</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">                estimated the gradients.</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">                Can be given as None if a momentum-based optimizer</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">                is not required.</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">                Otherwise, can be given as a str containing the name</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">                of the optimizer (e.g. &#39;adam&#39;, &#39;clipup&#39;);</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">                or as an instance of evotorch.optimizers.TorchOptimizer</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">                or evotorch.optimizers.ClipUp.</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">                The default is None.</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">                Note that, for ClipUp, the default maximum speed is set</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">                as twice the given `center_learning_rate`.</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">                This maximum speed can be configured by passing</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">                `{&quot;max_speed&quot;: ...}` to `optimizer_config`.</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">            optimizer_config: Configuration which will be passed</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">                to the optimizer as keyword arguments.</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">                See `evotorch.optimizers` for details about</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">                which optimizer accepts which keyword arguments.</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">            ranking_method: Which ranking method will be used for</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">                fitness shaping. See the documentation of</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">                `evotorch.ranking.rank(...)` for details.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">                The default is &#39;nes&#39;.</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">                Can be given as None if no such ranking is required.</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">            center_init: The initial center solution.</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">                Can be left as None.</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">            stdev_min: Minimum values for the standard deviation.</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">                Expected as a 1-dimensional array to serve as a limiter</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">                to the diagonals of the covariance matrix&#39;s square root.</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">            stdev_max: Maximum values for the standard deviation.</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">                Expected as a 1-dimensional array to serve as a limiter</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">                to the diagonals of the covariance matrix&#39;s square root.</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">            stdev_max_change: Maximum change allowed for when updating</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">                the square roort of the covariance matrix.</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">            obj_index: Index of the objective according to which the</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">                gradient estimations will be done.</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">                For single-objective problems, this can be left as None.</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">            distributed: Whether or not the gradient computation will</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">                be distributed. If `distributed` is given as False and</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">                the problem is not parallelized, then everything will</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">                be centralized (i.e. the entire computation will happen</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">                in the main process).</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">                If `distributed` is given as False, and the problem</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">                is parallelized, then the population will be created</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">                in the main process and then sent to remote workers</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">                for parallelized evaluation, and then the remote fitnesses</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">                will be collected by the main process again for computing</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">                the search gradients.</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">                If `distributed` is given as True, and the problem</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">                is parallelized, then the search algorithm itself will</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">                be distributed, in the sense that each remote actor will</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">                generate its own population (such that the total population</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">                size across all these actors becomes equal to `popsize`)</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">                and will compute its own gradient, and then the main process</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">                will collect these gradients, compute the averaged gradients</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">                and update the main search distribution.</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">                Non-distributed mode has the advantage of keeping the</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">                population in the main process, which is good when one wishes</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">                to do detailed monitoring during the evolutionary process,</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">                but has the disadvantage of having to pass the solutions to</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">                the remote actors and having to collect fitnesses, which</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">                might result in increased interprocess communication traffic.</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">                On the other hand, while it is not possible to monitor the</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">                population in distributed mode, the distributed mode has the</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">                advantage of significantly reducing the interprocess</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">                communication traffic, since the only things communicated</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">                with the remote actors are the search distributions (not the</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">                solutions) and the gradients.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">            popsize_weighted_grad_avg: Only to be used in distributed mode.</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">                (where being in distributed mode means `distributed` is given</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">                as True). In distributed mode, each actor remotely samples</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">                its own solution batches and computes its own gradients.</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">                These gradients are then collected, and a final average</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">                gradient is computed.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">                If `popsize_weighted_grad_avg` is True, then, while averaging</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">                over the gradients, each gradient will have its own weight</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">                that is computed according to how many solutions were sampled</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">                by the actor that produced the gradient.</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">                If `popsize_weighted_grad_avg` is False, then, there will not</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">                be weighted averaging (or, each gradient will have equal</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">                weight).</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">                If `popsize_weighted_grad_avg` is None, then, the gradient</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">                weights will be equal a value for `num_interactions` is given</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">                (because `num_interactions` affects the number of solutions</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">                according to the episode lengths, and popsize-weighting the</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">                gradients could be misleading); and the gradient weights will</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">                be weighted according to the sub-population (i.e. sub-batch)</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">                sizes if `num_interactions` is left as None.</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">                The default value for `popsize_weighted_grad_avg` is None.</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">                When the distributed mode is disabled (i.e. when `distributed`</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">                is False), then the argument `popsize_weighted_grad_avg` is</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">                expected as None.</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="k">if</span> <span class="n">popsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>            <span class="n">popsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)))</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="k">if</span> <span class="n">center_learning_rate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>            <span class="n">center_learning_rate</span> <span class="o">=</span> <span class="mf">1.0</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">default_stdev_lr</span><span class="p">():</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solution_length</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>            <span class="k">return</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>        <span class="k">if</span> <span class="n">stdev_learning_rate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>            <span class="n">stdev_learning_rate</span> <span class="o">=</span> <span class="n">default_stdev_lr</span><span class="p">()</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>            <span class="n">stdev_learning_rate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stdev_learning_rate</span><span class="p">)</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>            <span class="k">if</span> <span class="n">scale_learning_rate</span><span class="p">:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>                <span class="n">stdev_learning_rate</span> <span class="o">*=</span> <span class="n">default_stdev_lr</span><span class="p">()</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>            <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>            <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>            <span class="n">center_learning_rate</span><span class="o">=</span><span class="n">center_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>            <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="n">stdev_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>            <span class="n">stdev_init</span><span class="o">=</span><span class="n">stdev_init</span><span class="p">,</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>            <span class="n">radius_init</span><span class="o">=</span><span class="n">radius_init</span><span class="p">,</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>            <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>            <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>            <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>            <span class="n">optimizer_config</span><span class="o">=</span><span class="n">optimizer_config</span><span class="p">,</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>            <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>            <span class="n">center_init</span><span class="o">=</span><span class="n">center_init</span><span class="p">,</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>            <span class="n">stdev_min</span><span class="o">=</span><span class="n">stdev_min</span><span class="p">,</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>            <span class="n">stdev_max</span><span class="o">=</span><span class="n">stdev_max</span><span class="p">,</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>            <span class="n">stdev_max_change</span><span class="o">=</span><span class="n">stdev_max_change</span><span class="p">,</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>            <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>            <span class="n">distributed</span><span class="o">=</span><span class="n">distributed</span><span class="p">,</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>            <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="n">popsize_weighted_grad_avg</span><span class="p">,</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.SNES.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">stdev_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">radius_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">popsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center_learning_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale_learning_rate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_interactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">popsize_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimizer_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="s1">&#39;nes&#39;</span><span class="p">,</span> <span class="n">center_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_max_change</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distributed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.SNES.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the SNES algorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem object which is being worked on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial standard deviation of the search
distribution, expressed as a scalar or as an array.
Determines the initial coverage area of the search
distribution.
If one wishes to configure the coverage area via the
argument <code>radius_init</code> instead, then <code>stdev_init</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radius_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial radius of the search distribution,
expressed as a scalar.
Determines the initial coverage area of the search
distribution.
Here, "radius" is defined as the norm of the search
distribution.
If one wishes to configure the coverage area via the
argument <code>stdev_init</code> instead, then <code>radius_init</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Population size. Can be specified as an int,
or can be left as None to let the solver decide.
In the case of SNES, <code>popsize</code> can be left as None,
in which case the default <code>popsize</code> will be computed
as <code>4 + floor(3 * log(n))</code> where <code>n</code> is the length
of a solution.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_learning_rate</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for updating the mean
of the search distribution. Default value is 1.0</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_learning_rate</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for updating the covariance
matrix of the search distribution.
The default value is <code>0.2 * (3 + log(n)) / sqrt(n)</code>
where <code>n</code> is the length of a solution.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scale_learning_rate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For SNES, there is a default standard
deviation learning rate value which is computed as
<code>0.2 * (3 + log(n)) / sqrt(n)</code> (where <code>n</code> is the solution
length).
If scale_learning_rate is True (which is the default),
then the effective learning rate for the standard deviation
becomes the provided <code>stdev_learning_rate</code> multiplied by this
default value. If <code>scale_learning_rate</code> is False, then the
effective standard deviation learning rate becomes
equal to the provided <code>stdev_learning_rate</code> value.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_interactions</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When given as an integer n,
it is ensured that a population has interacted with
the GymProblem's environment n times. If this target
has not been reached yet, then the population is declared
too small, and gets extended with more samples,
until n amount of interactions is reached.
When given as None, popsize is the only configuration
affecting the size of a population.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Having <code>num_interactions</code> set as an integer
might cause the effective population size jump to
unnecesarily large numbers. To prevent this,
one can set <code>popsize_max</code> to specify an upper
bound for the effective population size.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_interactions</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When given as an integer n,
it is ensured that a population has interacted with
the GymProblem's environment n times. If this target
has not been reached yet, then the population is declared
too small, and gets extended with more samples,
until n amount of interactions is reached.
When given as None, popsize is the only configuration
affecting the size of a population.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Having <code>num_interactions</code> set as an integer
might cause the effective population size jump to
unnecesarily large numbers. To prevent this,
one can set <code>popsize_max</code> to specify an upper
bound for the effective population size.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimizer to be used while following the
estimated the gradients.
Can be given as None if a momentum-based optimizer
is not required.
Otherwise, can be given as a str containing the name
of the optimizer (e.g. 'adam', 'clipup');
or as an instance of evotorch.optimizers.TorchOptimizer
or evotorch.optimizers.ClipUp.
The default is None.
Note that, for ClipUp, the default maximum speed is set
as twice the given <code>center_learning_rate</code>.
This maximum speed can be configured by passing
<code>{"max_speed": ...}</code> to <code>optimizer_config</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration which will be passed
to the optimizer as keyword arguments.
See <code>evotorch.optimizers</code> for details about
which optimizer accepts which keyword arguments.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ranking_method</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which ranking method will be used for
fitness shaping. See the documentation of
<code>evotorch.ranking.rank(...)</code> for details.
The default is 'nes'.
Can be given as None if no such ranking is required.</p>
              </div>
            </td>
            <td>
                  <code>&#39;nes&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial center solution.
Can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_min</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum values for the standard deviation.
Expected as a 1-dimensional array to serve as a limiter
to the diagonals of the covariance matrix's square root.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum values for the standard deviation.
Expected as a 1-dimensional array to serve as a limiter
to the diagonals of the covariance matrix's square root.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_max_change</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum change allowed for when updating
the square roort of the covariance matrix.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj_index</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the objective according to which the
gradient estimations will be done.
For single-objective problems, this can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distributed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the gradient computation will
be distributed. If <code>distributed</code> is given as False and
the problem is not parallelized, then everything will
be centralized (i.e. the entire computation will happen
in the main process).
If <code>distributed</code> is given as False, and the problem
is parallelized, then the population will be created
in the main process and then sent to remote workers
for parallelized evaluation, and then the remote fitnesses
will be collected by the main process again for computing
the search gradients.
If <code>distributed</code> is given as True, and the problem
is parallelized, then the search algorithm itself will
be distributed, in the sense that each remote actor will
generate its own population (such that the total population
size across all these actors becomes equal to <code>popsize</code>)
and will compute its own gradient, and then the main process
will collect these gradients, compute the averaged gradients
and update the main search distribution.
Non-distributed mode has the advantage of keeping the
population in the main process, which is good when one wishes
to do detailed monitoring during the evolutionary process,
but has the disadvantage of having to pass the solutions to
the remote actors and having to collect fitnesses, which
might result in increased interprocess communication traffic.
On the other hand, while it is not possible to monitor the
population in distributed mode, the distributed mode has the
advantage of significantly reducing the interprocess
communication traffic, since the only things communicated
with the remote actors are the search distributions (not the
solutions) and the gradients.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize_weighted_grad_avg</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Only to be used in distributed mode.
(where being in distributed mode means <code>distributed</code> is given
as True). In distributed mode, each actor remotely samples
its own solution batches and computes its own gradients.
These gradients are then collected, and a final average
gradient is computed.
If <code>popsize_weighted_grad_avg</code> is True, then, while averaging
over the gradients, each gradient will have its own weight
that is computed according to how many solutions were sampled
by the actor that produced the gradient.
If <code>popsize_weighted_grad_avg</code> is False, then, there will not
be weighted averaging (or, each gradient will have equal
weight).
If <code>popsize_weighted_grad_avg</code> is None, then, the gradient
weights will be equal a value for <code>num_interactions</code> is given
(because <code>num_interactions</code> affects the number of solutions
according to the episode lengths, and popsize-weighting the
gradients could be misleading); and the gradient weights will
be weighted according to the sub-population (i.e. sub-batch)
sizes if <code>num_interactions</code> is left as None.
The default value for <code>popsize_weighted_grad_avg</code> is None.
When the distributed mode is disabled (i.e. when <code>distributed</code>
is False), then the argument <code>popsize_weighted_grad_avg</code> is
expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/distributed/gaussian.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>    <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>    <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>    <span class="n">radius_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>    <span class="n">center_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>    <span class="n">stdev_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>    <span class="n">scale_learning_rate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>    <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>    <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>    <span class="n">optimizer_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>    <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nes&quot;</span><span class="p">,</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>    <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>    <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>    <span class="n">stdev_max_change</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>    <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="n">distributed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>    <span class="n">popsize_weighted_grad_avg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="p">):</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">    `__init__(...)`: Initialize the SNES algorithm.</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">        problem: The problem object which is being worked on.</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">        stdev_init: The initial standard deviation of the search</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">            distribution, expressed as a scalar or as an array.</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">            Determines the initial coverage area of the search</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">            If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">            argument `radius_init` instead, then `stdev_init` is expected</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">        radius_init: The initial radius of the search distribution,</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">            expressed as a scalar.</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">            Determines the initial coverage area of the search</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">            Here, &quot;radius&quot; is defined as the norm of the search</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">            If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">            argument `stdev_init` instead, then `radius_init` is expected</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">        popsize: Population size. Can be specified as an int,</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">            or can be left as None to let the solver decide.</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">            In the case of SNES, `popsize` can be left as None,</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">            in which case the default `popsize` will be computed</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">            as `4 + floor(3 * log(n))` where `n` is the length</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">            of a solution.</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">        center_learning_rate: Learning rate for updating the mean</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">            of the search distribution. Default value is 1.0</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">        stdev_learning_rate: Learning rate for updating the covariance</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">            matrix of the search distribution.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">            The default value is `0.2 * (3 + log(n)) / sqrt(n)`</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">            where `n` is the length of a solution.</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        scale_learning_rate: For SNES, there is a default standard</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">            deviation learning rate value which is computed as</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">            `0.2 * (3 + log(n)) / sqrt(n)` (where `n` is the solution</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">            length).</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">            If scale_learning_rate is True (which is the default),</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">            then the effective learning rate for the standard deviation</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">            becomes the provided `stdev_learning_rate` multiplied by this</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">            default value. If `scale_learning_rate` is False, then the</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">            effective standard deviation learning rate becomes</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">            equal to the provided `stdev_learning_rate` value.</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">        num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">            it is ensured that a population has interacted with</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">            the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">            has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">            too small, and gets extended with more samples,</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">            until n amount of interactions is reached.</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">            When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">            affecting the size of a population.</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">        popsize_max: Having `num_interactions` set as an integer</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">            might cause the effective population size jump to</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">            unnecesarily large numbers. To prevent this,</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">            one can set `popsize_max` to specify an upper</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">            bound for the effective population size.</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">            it is ensured that a population has interacted with</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">            the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">            has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">            too small, and gets extended with more samples,</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">            until n amount of interactions is reached.</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">            When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">            affecting the size of a population.</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">        popsize_max: Having `num_interactions` set as an integer</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">            might cause the effective population size jump to</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">            unnecesarily large numbers. To prevent this,</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">            one can set `popsize_max` to specify an upper</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">            bound for the effective population size.</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">        optimizer: The optimizer to be used while following the</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">            estimated the gradients.</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">            Can be given as None if a momentum-based optimizer</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">            is not required.</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">            Otherwise, can be given as a str containing the name</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">            of the optimizer (e.g. &#39;adam&#39;, &#39;clipup&#39;);</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">            or as an instance of evotorch.optimizers.TorchOptimizer</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">            or evotorch.optimizers.ClipUp.</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">            The default is None.</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">            Note that, for ClipUp, the default maximum speed is set</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">            as twice the given `center_learning_rate`.</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">            This maximum speed can be configured by passing</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">            `{&quot;max_speed&quot;: ...}` to `optimizer_config`.</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">        optimizer_config: Configuration which will be passed</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">            to the optimizer as keyword arguments.</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">            See `evotorch.optimizers` for details about</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">            which optimizer accepts which keyword arguments.</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">        ranking_method: Which ranking method will be used for</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">            fitness shaping. See the documentation of</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">            `evotorch.ranking.rank(...)` for details.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">            The default is &#39;nes&#39;.</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">            Can be given as None if no such ranking is required.</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">        center_init: The initial center solution.</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">            Can be left as None.</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">        stdev_min: Minimum values for the standard deviation.</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">            Expected as a 1-dimensional array to serve as a limiter</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">            to the diagonals of the covariance matrix&#39;s square root.</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">        stdev_max: Maximum values for the standard deviation.</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">            Expected as a 1-dimensional array to serve as a limiter</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">            to the diagonals of the covariance matrix&#39;s square root.</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">        stdev_max_change: Maximum change allowed for when updating</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">            the square roort of the covariance matrix.</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">        obj_index: Index of the objective according to which the</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">            gradient estimations will be done.</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">            For single-objective problems, this can be left as None.</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">        distributed: Whether or not the gradient computation will</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">            be distributed. If `distributed` is given as False and</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">            the problem is not parallelized, then everything will</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">            be centralized (i.e. the entire computation will happen</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">            in the main process).</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">            If `distributed` is given as False, and the problem</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">            is parallelized, then the population will be created</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">            in the main process and then sent to remote workers</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">            for parallelized evaluation, and then the remote fitnesses</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">            will be collected by the main process again for computing</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">            the search gradients.</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">            If `distributed` is given as True, and the problem</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">            is parallelized, then the search algorithm itself will</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">            be distributed, in the sense that each remote actor will</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">            generate its own population (such that the total population</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">            size across all these actors becomes equal to `popsize`)</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">            and will compute its own gradient, and then the main process</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">            will collect these gradients, compute the averaged gradients</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">            and update the main search distribution.</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">            Non-distributed mode has the advantage of keeping the</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">            population in the main process, which is good when one wishes</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">            to do detailed monitoring during the evolutionary process,</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">            but has the disadvantage of having to pass the solutions to</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">            the remote actors and having to collect fitnesses, which</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">            might result in increased interprocess communication traffic.</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">            On the other hand, while it is not possible to monitor the</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">            population in distributed mode, the distributed mode has the</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">            advantage of significantly reducing the interprocess</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">            communication traffic, since the only things communicated</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">            with the remote actors are the search distributions (not the</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">            solutions) and the gradients.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        popsize_weighted_grad_avg: Only to be used in distributed mode.</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">            (where being in distributed mode means `distributed` is given</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">            as True). In distributed mode, each actor remotely samples</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">            its own solution batches and computes its own gradients.</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">            These gradients are then collected, and a final average</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            gradient is computed.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">            If `popsize_weighted_grad_avg` is True, then, while averaging</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">            over the gradients, each gradient will have its own weight</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">            that is computed according to how many solutions were sampled</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">            by the actor that produced the gradient.</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">            If `popsize_weighted_grad_avg` is False, then, there will not</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            be weighted averaging (or, each gradient will have equal</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            weight).</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            If `popsize_weighted_grad_avg` is None, then, the gradient</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">            weights will be equal a value for `num_interactions` is given</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            (because `num_interactions` affects the number of solutions</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            according to the episode lengths, and popsize-weighting the</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">            gradients could be misleading); and the gradient weights will</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">            be weighted according to the sub-population (i.e. sub-batch)</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">            sizes if `num_interactions` is left as None.</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">            The default value for `popsize_weighted_grad_avg` is None.</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">            When the distributed mode is disabled (i.e. when `distributed`</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">            is False), then the argument `popsize_weighted_grad_avg` is</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">            expected as None.</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>    <span class="k">if</span> <span class="n">popsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="n">popsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)))</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>    <span class="k">if</span> <span class="n">center_learning_rate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>        <span class="n">center_learning_rate</span> <span class="o">=</span> <span class="mf">1.0</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">default_stdev_lr</span><span class="p">():</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solution_length</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="k">return</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="k">if</span> <span class="n">stdev_learning_rate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>        <span class="n">stdev_learning_rate</span> <span class="o">=</span> <span class="n">default_stdev_lr</span><span class="p">()</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>        <span class="n">stdev_learning_rate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stdev_learning_rate</span><span class="p">)</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>        <span class="k">if</span> <span class="n">scale_learning_rate</span><span class="p">:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>            <span class="n">stdev_learning_rate</span> <span class="o">*=</span> <span class="n">default_stdev_lr</span><span class="p">()</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>        <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>        <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="n">center_learning_rate</span><span class="o">=</span><span class="n">center_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>        <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="n">stdev_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="n">stdev_init</span><span class="o">=</span><span class="n">stdev_init</span><span class="p">,</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>        <span class="n">radius_init</span><span class="o">=</span><span class="n">radius_init</span><span class="p">,</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>        <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>        <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>        <span class="n">optimizer_config</span><span class="o">=</span><span class="n">optimizer_config</span><span class="p">,</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>        <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>        <span class="n">center_init</span><span class="o">=</span><span class="n">center_init</span><span class="p">,</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>        <span class="n">stdev_min</span><span class="o">=</span><span class="n">stdev_min</span><span class="p">,</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>        <span class="n">stdev_max</span><span class="o">=</span><span class="n">stdev_max</span><span class="p">,</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>        <span class="n">stdev_max_change</span><span class="o">=</span><span class="n">stdev_max_change</span><span class="p">,</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>        <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>        <span class="n">distributed</span><span class="o">=</span><span class="n">distributed</span><span class="p">,</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>        <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="n">popsize_weighted_grad_avg</span><span class="p">,</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.SearchAlgorithm" class="doc doc-heading">
            <code>SearchAlgorithm</code>


<a href="#evotorch.algorithms.SearchAlgorithm" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="LazyReporter (evotorch.algorithms.searchalgorithm.LazyReporter)" href="searchalgorithm/#evotorch.algorithms.searchalgorithm.LazyReporter">LazyReporter</a></code></p>


        <p>Base class for all evolutionary search algorithms.</p>
<p>An algorithm developer is expected to inherit from this base class,
and override the method named <code>_step()</code> to define how a single
step of this new algorithm is performed.</p>
<p>For each core status dictionary element, a new method is expected
to exist within the inheriting class. These status reporting
methods are then registered via the keyword arguments of the
<code>__init__(...)</code> method of <code>SearchAlgorithm</code>.</p>
<p>To sum up, a newly developed algorithm inheriting from this base
class is expected in this structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">Problem</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyNewAlgorithm</span><span class="p">(</span><span class="n">SearchAlgorithm</span><span class="p">):</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="n">SearchAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">,</span> <span class="n">status1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_status1</span><span class="p">,</span> <span class="n">status2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_status2</span><span class="p">,</span> <span class="o">...</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="c1"># Code that defines how a step of this algorithm</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        <span class="c1"># should work goes here.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="o">...</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_status1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="c1"># The value returned by this function will be shown</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        <span class="c1"># in the status dictionary, associated with the key</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="c1"># &#39;status1&#39;.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="k">return</span> <span class="o">...</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_status2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        <span class="c1"># The value returned by this function will be shown</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>        <span class="c1"># in the status dictionary, associated with the key</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="c1"># &#39;status2&#39;.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>        <span class="k">return</span> <span class="o">...</span>
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/searchalgorithm.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="k">class</span><span class="w"> </span><span class="nc">SearchAlgorithm</span><span class="p">(</span><span class="n">LazyReporter</span><span class="p">):</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Base class for all evolutionary search algorithms.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    An algorithm developer is expected to inherit from this base class,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    and override the method named `_step()` to define how a single</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    step of this new algorithm is performed.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    For each core status dictionary element, a new method is expected</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    to exist within the inheriting class. These status reporting</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    methods are then registered via the keyword arguments of the</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    `__init__(...)` method of `SearchAlgorithm`.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    To sum up, a newly developed algorithm inheriting from this base</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    class is expected in this structure:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    from evotorch import Problem</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    class MyNewAlgorithm(SearchAlgorithm):</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        def __init__(self, problem: Problem):</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            SearchAlgorithm.__init__(</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">                self, problem, status1=self._get_status1, status2=self._get_status2, ...</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            )</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        def _step(self):</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            # Code that defines how a step of this algorithm</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">            # should work goes here.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            ...</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        def _get_status1(self):</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">            # The value returned by this function will be shown</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">            # in the status dictionary, associated with the key</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            # &#39;status1&#39;.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            return ...</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        def _get_status2(self):</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            # The value returned by this function will be shown</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            # in the status dictionary, associated with the key</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            # &#39;status2&#39;.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            return ...</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    ```</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        Initialize the SearchAlgorithm instance.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">            problem: Problem to work with.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">            kwargs: Any additional keyword argument, in the form of `k=f`,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">                is accepted in this manner: for each pair of `k` and `f`,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">                `k` is accepted as the status key (i.e. a status variable</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">                name), and `f` is accepted as a function (probably a method</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">                of the inheriting class) that will generate the value of that</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">                status variable.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span> <span class="o">=</span> <span class="n">problem</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_before_step_hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_after_step_hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_log_hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_end_of_run_hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_steps_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_first_step_datetime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">problem</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Problem</span><span class="p">:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        The problem object which is being worked on.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">before_step_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hook</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        Use this Hook to add more behavior to the search algorithm</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        to be performed just before executing a step.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before_step_hook</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">after_step_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hook</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        Use this Hook to add more behavior to the search algorithm</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        to be performed just after executing a step.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        The dictionaries returned by the functions registered into</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        this Hook will be accumulated and added into the status</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        dictionary of the search algorithm.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_step_hook</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">log_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hook</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        Use this Hook to add more behavior to the search algorithm</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        at the moment of logging the constructed status dictionary.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        This Hook is executed after the execution of `after_step_hook`</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        is complete.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        The functions in this Hook are assumed to expect a single</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        argument, that is the status dictionary of the search algorithm.</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_hook</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_of_run_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hook</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        Use this Hook to add more behavior to the search algorithm</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        at the end of a run.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        This Hook is executed after all the generations of a run</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        are done.</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        The functions in this Hook are assumed to expect a single</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        argument, that is the status dictionary of the search algorithm.</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_end_of_run_hook</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">step_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        Number of search steps performed.</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        This is equivalent to the number of generations, or to the</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        number of iterations.</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_steps_count</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">steps_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        Deprecated alias for the `step_count` property.</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        It is recommended to use the `step_count` property instead.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_steps_count</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        Perform a step of the search algorithm.</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_before_step_hook</span><span class="p">()</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_status</span><span class="p">()</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_step_datetime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_first_step_datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_step</span><span class="p">()</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_steps_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_status</span><span class="p">({</span><span class="s2">&quot;iter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_steps_count</span><span class="p">})</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="n">extra_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_step_hook</span><span class="o">.</span><span class="n">accumulate_dict</span><span class="p">()</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">extra_status</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_log_hook</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_log_hook</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        Algorithm developers are expected to override this method</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        in an inheriting subclass.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        The code which defines how a step of the evolutionary algorithm</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        is performed goes here.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_generations</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">reset_first_step_datetime</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        Run the algorithm for the given number of generations</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        (i.e. iterations).</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            num_generations: Number of generations.</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            reset_first_step_datetime: If this argument is given as True,</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">                then, the datetime of the first search step will be forgotten.</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">                Forgetting the first step&#39;s datetime means that the first step</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">                taken by this new run will be the new first step datetime.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="k">if</span> <span class="n">reset_first_step_datetime</span><span class="p">:</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reset_first_step_datetime</span><span class="p">()</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_generations</span><span class="p">)):</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_end_of_run_hook</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_end_of_run_hook</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">first_step_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]:</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">        Get the datetime when the algorithm took the first search step.</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">        If a step is not taken at all, then the result will be None.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_step_datetime</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reset_first_step_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        Reset (or forget) the first step&#39;s datetime.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_first_step_datetime</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_terminated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the algorithm is in a terminal state&quot;&quot;&quot;</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.SearchAlgorithm.after_step_hook" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">after_step_hook</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.SearchAlgorithm.after_step_hook" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Use this Hook to add more behavior to the search algorithm
to be performed just after executing a step.</p>
<p>The dictionaries returned by the functions registered into
this Hook will be accumulated and added into the status
dictionary of the search algorithm.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.SearchAlgorithm.before_step_hook" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">before_step_hook</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.SearchAlgorithm.before_step_hook" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Use this Hook to add more behavior to the search algorithm
to be performed just before executing a step.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.SearchAlgorithm.end_of_run_hook" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">end_of_run_hook</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.SearchAlgorithm.end_of_run_hook" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Use this Hook to add more behavior to the search algorithm
at the end of a run.</p>
<p>This Hook is executed after all the generations of a run
are done.</p>
<p>The functions in this Hook are assumed to expect a single
argument, that is the status dictionary of the search algorithm.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.SearchAlgorithm.first_step_datetime" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">first_step_datetime</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.SearchAlgorithm.first_step_datetime" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the datetime when the algorithm took the first search step.
If a step is not taken at all, then the result will be None.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.SearchAlgorithm.is_terminated" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_terminated</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.SearchAlgorithm.is_terminated" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Whether the algorithm is in a terminal state</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.SearchAlgorithm.log_hook" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_hook</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.SearchAlgorithm.log_hook" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Use this Hook to add more behavior to the search algorithm
at the moment of logging the constructed status dictionary.</p>
<p>This Hook is executed after the execution of <code>after_step_hook</code>
is complete.</p>
<p>The functions in this Hook are assumed to expect a single
argument, that is the status dictionary of the search algorithm.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.SearchAlgorithm.problem" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">problem</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.SearchAlgorithm.problem" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The problem object which is being worked on.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.SearchAlgorithm.step_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">step_count</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.SearchAlgorithm.step_count" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Number of search steps performed.</p>
<p>This is equivalent to the number of generations, or to the
number of iterations.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.algorithms.SearchAlgorithm.steps_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">steps_count</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.algorithms.SearchAlgorithm.steps_count" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Deprecated alias for the <code>step_count</code> property.
It is recommended to use the <code>step_count</code> property instead.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.SearchAlgorithm.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.SearchAlgorithm.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the SearchAlgorithm instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Problem to work with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any additional keyword argument, in the form of <code>k=f</code>,
is accepted in this manner: for each pair of <code>k</code> and <code>f</code>,
<code>k</code> is accepted as the status key (i.e. a status variable
name), and <code>f</code> is accepted as a function (probably a method
of the inheriting class) that will generate the value of that
status variable.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/searchalgorithm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    Initialize the SearchAlgorithm instance.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        problem: Problem to work with.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        kwargs: Any additional keyword argument, in the form of `k=f`,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">            is accepted in this manner: for each pair of `k` and `f`,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            `k` is accepted as the status key (i.e. a status variable</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">            name), and `f` is accepted as a function (probably a method</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">            of the inheriting class) that will generate the value of that</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">            status variable.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_problem</span> <span class="o">=</span> <span class="n">problem</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_before_step_hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_after_step_hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_log_hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_end_of_run_hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_steps_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_first_step_datetime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.SearchAlgorithm.reset_first_step_datetime" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset_first_step_datetime</span><span class="p">()</span></code>

<a href="#evotorch.algorithms.SearchAlgorithm.reset_first_step_datetime" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Reset (or forget) the first step's datetime.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/searchalgorithm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="k">def</span><span class="w"> </span><span class="nf">reset_first_step_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">    Reset (or forget) the first step&#39;s datetime.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_first_step_datetime</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.SearchAlgorithm.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">num_generations</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">reset_first_step_datetime</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.SearchAlgorithm.run" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Run the algorithm for the given number of generations
(i.e. iterations).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num_generations</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of generations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reset_first_step_datetime</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If this argument is given as True,
then, the datetime of the first search step will be forgotten.
Forgetting the first step's datetime means that the first step
taken by this new run will be the new first step datetime.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/searchalgorithm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_generations</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">reset_first_step_datetime</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    Run the algorithm for the given number of generations</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">    (i.e. iterations).</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        num_generations: Number of generations.</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        reset_first_step_datetime: If this argument is given as True,</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">            then, the datetime of the first search step will be forgotten.</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">            Forgetting the first step&#39;s datetime means that the first step</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">            taken by this new run will be the new first step datetime.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="k">if</span> <span class="n">reset_first_step_datetime</span><span class="p">:</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset_first_step_datetime</span><span class="p">()</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_generations</span><span class="p">)):</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_end_of_run_hook</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_end_of_run_hook</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.SearchAlgorithm.step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">step</span><span class="p">()</span></code>

<a href="#evotorch.algorithms.SearchAlgorithm.step" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Perform a step of the search algorithm.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/searchalgorithm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    Perform a step of the search algorithm.</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_before_step_hook</span><span class="p">()</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">clear_status</span><span class="p">()</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_step_datetime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_first_step_datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_step</span><span class="p">()</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_steps_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">update_status</span><span class="p">({</span><span class="s2">&quot;iter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_steps_count</span><span class="p">})</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_problem</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="n">extra_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_step_hook</span><span class="o">.</span><span class="n">accumulate_dict</span><span class="p">()</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">extra_status</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_log_hook</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_log_hook</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.SteadyStateGA" class="doc doc-heading">
            <code>SteadyStateGA</code>


<a href="#evotorch.algorithms.SteadyStateGA" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="GeneticAlgorithm (evotorch.algorithms.ga.GeneticAlgorithm)" href="ga/#evotorch.algorithms.ga.GeneticAlgorithm">GeneticAlgorithm</a></code></p>


        <p>Thin wrapper around GeneticAlgorithm for compatibility with old code.</p>
<p>This <code>SteadyStateGA</code> class is equivalent to
<a class="autorefs autorefs-internal" href="ga/#evotorch.algorithms.ga.GeneticAlgorithm">GeneticAlgorithm</a> except that
<code>SteadyStateGA</code> provides an additional method named <code>use(...)</code> for
specifying a cross-over and/or a mutation operator.
The method <code>use(...)</code> exists only for API compatibility with the previous
versions of EvoTorch. It is recommended to specify the operators via
the keyword argument <code>operators</code> instead.</p>







              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/ga.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="k">class</span><span class="w"> </span><span class="nc">SteadyStateGA</span><span class="p">(</span><span class="n">GeneticAlgorithm</span><span class="p">):</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">    Thin wrapper around GeneticAlgorithm for compatibility with old code.</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">    This `SteadyStateGA` class is equivalent to</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">    [GeneticAlgorithm][evotorch.algorithms.ga.GeneticAlgorithm] except that</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">    `SteadyStateGA` provides an additional method named `use(...)` for</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">    specifying a cross-over and/or a mutation operator.</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">    The method `use(...)` exists only for API compatibility with the previous</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">    versions of EvoTorch. It is recommended to specify the operators via</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">    the keyword argument `operators` instead.</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="n">operators</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>        <span class="n">elitist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>        <span class="n">re_evaluate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="n">re_evaluate_parents_first</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="p">):</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">        `__init__(...)`: Initialize the SteadyStateGA.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">            problem: The problem to optimize.</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="sd">            operators: Optionally, an iterable of operators to be used by the</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="sd">                genetic algorithm. Each item within this iterable object is</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="sd">                expected either as an instance of</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="sd">                [Operator][evotorch.operators.base.Operator],</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">                or as a function which receives the decision values of</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">                multiple solutions in a PyTorch tensor (or in an</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">                [ObjectArray][evotorch.tools.objectarray.ObjectArray]</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">                for when dtype is `object`) and returns a modified copy.</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">                If this is omitted, then it will be required to specify the</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">                operators via the `use(...)` method.</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">            popsize: Population size.</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">            elitist: Whether or not this genetic algorithm will behave in an</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">                elitist manner. This argument controls how the genetic</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">                algorithm will form the next generation from the parents</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">                and the children. In elitist mode (i.e. with `elitist=True`),</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">                the procedure to be followed by this genetic algorithm is:</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">                (i) form an extended population which consists of</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="sd">                both the parents and the children,</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">                (ii) sort the extended population from best to worst,</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">                (iii) select the best `n` solutions as the new generation where</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">                `n` is `popsize`.</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">                In non-elitist mode (i.e. with `elitist=False`), the worst `m`</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">                solutions within the parent population are replaced with</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">                the children, `m` being the number of produced children.</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">            re_evaluate: Whether or not to evaluate the solutions</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">                that were already evaluated in the previous generations.</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">                By default, this is set as True.</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">                The reason behind this default setting is that,</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">                in problems where the evaluation procedure is noisy,</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">                by re-evaluating the already-evaluated solutions,</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">                we prevent the bad solutions that were luckily evaluated</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">                from hanging onto the population.</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">                Instead, at every generation, each solution must go through</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">                the evaluation procedure again and prove their worth.</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">                For problems whose evaluation procedures are NOT noisy,</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">                the user might consider turning re_evaluate to False</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">                for saving computational cycles.</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a><span class="sd">            re_evaluate_parents_first: This is to be specified only when</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">                `re_evaluate` is True (otherwise to be left as None).</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">                If this is given as True, then it will be assumed that the</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">                provided operators require the parents to be evaluated.</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">                If this is given as False, then it will be assumed that the</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">                provided operators work without looking at the parents&#39;</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">                fitnesses (in which case both parents and children can be</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">                evaluated in a single vectorized computation cycle).</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">                If this is left as None, then whether or not the operators</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">                need to know the parent evaluations will be determined</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">                automatically as follows:</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">                if the operators contain at least one cross-over operator</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">                then `re_evaluate_parents_first` will be internally set as</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">                True; otherwise `re_evaluate_parents_first` will be internally</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">                set as False.</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">                Additional note specific to `SteadyStateGA`: if the argument</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">                `operators` is not given (or is given as an empty list), and</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">                also `re_evaluate_parents_first` is left as None, then</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="sd">                `SteadyStateGA` will assume that the operators will be later</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">                given via the `use(...)` method, and that these operators will</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">                require the parents to be evaluated first (equivalent to</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">                setting `re_evaluate_parents_first` as True).</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="k">if</span> <span class="n">operators</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>            <span class="n">operators</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_forbid_use_method</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ops</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">operators</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">re_evaluate</span> <span class="ow">and</span> <span class="p">(</span><span class="n">re_evaluate_parents_first</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>            <span class="n">re_evaluate_parents_first</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>            <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>            <span class="n">operators</span><span class="o">=</span><span class="n">operators</span><span class="p">,</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>            <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>            <span class="n">elitist</span><span class="o">=</span><span class="n">elitist</span><span class="p">,</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>            <span class="n">re_evaluate</span><span class="o">=</span><span class="n">re_evaluate</span><span class="p">,</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>            <span class="n">re_evaluate_parents_first</span><span class="o">=</span><span class="n">re_evaluate_parents_first</span><span class="p">,</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>            <span class="n">_allow_empty_operator_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>        <span class="p">)</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">use</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="p">:</span> <span class="n">Callable</span><span class="p">):</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">        Specify the cross-over or the mutation operator to use.</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">        This method exists for compatibility with previous EvoTorch code.</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">        Instead of using this method, it is recommended to specify the</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">        operators via the `operators` keyword argument while initializing</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">        this class.</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">        Using this method, one can specify one cross-over operator and one</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">        mutation operator that will be used during the evolutionary search.</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">        Specifying multiple cross-over operators or multiple mutation operators</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">        is not allowed. When the cross-over and mutation operators are</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">        specified via `use(...)`, the order of execution will always be</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">        arranged such that the cross-over comes first and the mutation comes</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">        comes second. If desired, one can specify only the cross-over operator</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">        or only the mutation operator.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">        Please note that the `operators` keyword argument works differently,</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        and offers more flexibility for defining the procedure to follow at</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">        each generation. In more details, the `operators` keyword argument</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">        allows one to specify multiple cross-over and/or multiple mutation</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        operators, and those operators will be executed in the specified</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">        order.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">            operator: The operator to be registered to SteadyStateGA.</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">                If the specified operator is cross-over (i.e. an instance</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">                of [CrossOver][evotorch.operators.base.CrossOver]),</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">                then this operator will be registered for the cross-over</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">                phase. If the specified operator is an operator that is</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">                not of the cross-over type (i.e. any instance of</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">                [Operator][evotorch.operators.base.Operator] that is not</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">                [CrossOver][evotorch.operators.base.CrossOver]) or if it is</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">                just a function which receives the decision values as a PyTorch</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">                tensor (or, in the case where `dtype` of the problem is</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">                `object` as an instance of</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">                [ObjectArray][evotorch.tools.objectarray.ObjectArray]) and</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">                returns a modified copy, then that operator will be registered</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">                for the mutation phase of the genetic algorithm.</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forbid_use_method</span><span class="p">:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>                <span class="s2">&quot;The method `use(...)` cannot be called anymore, because the evolutionary search has started.&quot;</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>            <span class="p">)</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>                <span class="sa">f</span><span class="s2">&quot;The method `use(...)` cannot be called&quot;</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>                <span class="sa">f</span><span class="s2">&quot; because an operator list was provided while initializing this </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> instance.&quot;</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>            <span class="p">)</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">CrossOver</span><span class="p">):</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `use(...)` received this cross-over operator as its argument:&quot;</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">operator</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>                    <span class="sa">f</span><span class="s2">&quot; However, a cross-over operator was already set:&quot;</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>                <span class="p">)</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span> <span class="o">=</span> <span class="n">operator</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ops</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `use(...)` received this mutation operator as its argument:&quot;</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">operator</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                    <span class="sa">f</span><span class="s2">&quot; However, a mutation operator was already set:&quot;</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>                <span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span> <span class="o">=</span> <span class="n">operator</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ops</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_forbid_use_method</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ops</span><span class="p">:</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ops</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span><span class="p">)</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span><span class="p">)</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>                    <span class="sa">f</span><span class="s2">&quot;This </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> instance does not know how to proceed, &quot;</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>                    <span class="sa">f</span><span class="s2">&quot; because neither the `operators` keyword argument was used during initialization&quot;</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>                    <span class="sa">f</span><span class="s2">&quot; nor was the `use(...)` method called later.&quot;</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>                <span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_step</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.SteadyStateGA.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="n">operators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elitist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">re_evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">re_evaluate_parents_first</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.SteadyStateGA.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the SteadyStateGA.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem to optimize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operators</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Iterable">Iterable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally, an iterable of operators to be used by the
genetic algorithm. Each item within this iterable object is
expected either as an instance of
<a class="autorefs autorefs-internal" href="../operators/base/#evotorch.operators.base.Operator">Operator</a>,
or as a function which receives the decision values of
multiple solutions in a PyTorch tensor (or in an
<a class="autorefs autorefs-internal" href="../tools/objectarray/#evotorch.tools.objectarray.ObjectArray">ObjectArray</a>
for when dtype is <code>object</code>) and returns a modified copy.
If this is omitted, then it will be required to specify the
operators via the <code>use(...)</code> method.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Population size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>elitist</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this genetic algorithm will behave in an
elitist manner. This argument controls how the genetic
algorithm will form the next generation from the parents
and the children. In elitist mode (i.e. with <code>elitist=True</code>),
the procedure to be followed by this genetic algorithm is:
(i) form an extended population which consists of
both the parents and the children,
(ii) sort the extended population from best to worst,
(iii) select the best <code>n</code> solutions as the new generation where
<code>n</code> is <code>popsize</code>.
In non-elitist mode (i.e. with <code>elitist=False</code>), the worst <code>m</code>
solutions within the parent population are replaced with
the children, <code>m</code> being the number of produced children.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>re_evaluate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to evaluate the solutions
that were already evaluated in the previous generations.
By default, this is set as True.
The reason behind this default setting is that,
in problems where the evaluation procedure is noisy,
by re-evaluating the already-evaluated solutions,
we prevent the bad solutions that were luckily evaluated
from hanging onto the population.
Instead, at every generation, each solution must go through
the evaluation procedure again and prove their worth.
For problems whose evaluation procedures are NOT noisy,
the user might consider turning re_evaluate to False
for saving computational cycles.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>re_evaluate_parents_first</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This is to be specified only when
<code>re_evaluate</code> is True (otherwise to be left as None).
If this is given as True, then it will be assumed that the
provided operators require the parents to be evaluated.
If this is given as False, then it will be assumed that the
provided operators work without looking at the parents'
fitnesses (in which case both parents and children can be
evaluated in a single vectorized computation cycle).
If this is left as None, then whether or not the operators
need to know the parent evaluations will be determined
automatically as follows:
if the operators contain at least one cross-over operator
then <code>re_evaluate_parents_first</code> will be internally set as
True; otherwise <code>re_evaluate_parents_first</code> will be internally
set as False.
Additional note specific to <code>SteadyStateGA</code>: if the argument
<code>operators</code> is not given (or is given as an empty list), and
also <code>re_evaluate_parents_first</code> is left as None, then
<code>SteadyStateGA</code> will assume that the operators will be later
given via the <code>use(...)</code> method, and that these operators will
require the parents to be evaluated first (equivalent to
setting <code>re_evaluate_parents_first</code> as True).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/ga.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>    <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>    <span class="n">operators</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>    <span class="n">elitist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="n">re_evaluate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="n">re_evaluate_parents_first</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="p">):</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">    `__init__(...)`: Initialize the SteadyStateGA.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">        problem: The problem to optimize.</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="sd">        operators: Optionally, an iterable of operators to be used by the</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="sd">            genetic algorithm. Each item within this iterable object is</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="sd">            expected either as an instance of</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="sd">            [Operator][evotorch.operators.base.Operator],</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">            or as a function which receives the decision values of</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">            multiple solutions in a PyTorch tensor (or in an</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">            [ObjectArray][evotorch.tools.objectarray.ObjectArray]</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">            for when dtype is `object`) and returns a modified copy.</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">            If this is omitted, then it will be required to specify the</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">            operators via the `use(...)` method.</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">        popsize: Population size.</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">        elitist: Whether or not this genetic algorithm will behave in an</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">            elitist manner. This argument controls how the genetic</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">            algorithm will form the next generation from the parents</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">            and the children. In elitist mode (i.e. with `elitist=True`),</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">            the procedure to be followed by this genetic algorithm is:</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">            (i) form an extended population which consists of</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="sd">            both the parents and the children,</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">            (ii) sort the extended population from best to worst,</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">            (iii) select the best `n` solutions as the new generation where</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">            `n` is `popsize`.</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">            In non-elitist mode (i.e. with `elitist=False`), the worst `m`</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">            solutions within the parent population are replaced with</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">            the children, `m` being the number of produced children.</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">        re_evaluate: Whether or not to evaluate the solutions</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">            that were already evaluated in the previous generations.</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">            By default, this is set as True.</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">            The reason behind this default setting is that,</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">            in problems where the evaluation procedure is noisy,</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">            by re-evaluating the already-evaluated solutions,</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">            we prevent the bad solutions that were luckily evaluated</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">            from hanging onto the population.</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">            Instead, at every generation, each solution must go through</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">            the evaluation procedure again and prove their worth.</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">            For problems whose evaluation procedures are NOT noisy,</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">            the user might consider turning re_evaluate to False</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">            for saving computational cycles.</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a><span class="sd">        re_evaluate_parents_first: This is to be specified only when</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">            `re_evaluate` is True (otherwise to be left as None).</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">            If this is given as True, then it will be assumed that the</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">            provided operators require the parents to be evaluated.</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">            If this is given as False, then it will be assumed that the</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">            provided operators work without looking at the parents&#39;</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">            fitnesses (in which case both parents and children can be</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">            evaluated in a single vectorized computation cycle).</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">            If this is left as None, then whether or not the operators</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">            need to know the parent evaluations will be determined</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">            automatically as follows:</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">            if the operators contain at least one cross-over operator</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">            then `re_evaluate_parents_first` will be internally set as</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">            True; otherwise `re_evaluate_parents_first` will be internally</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">            set as False.</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">            Additional note specific to `SteadyStateGA`: if the argument</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">            `operators` is not given (or is given as an empty list), and</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">            also `re_evaluate_parents_first` is left as None, then</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="sd">            `SteadyStateGA` will assume that the operators will be later</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">            given via the `use(...)` method, and that these operators will</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">            require the parents to be evaluated first (equivalent to</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">            setting `re_evaluate_parents_first` as True).</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>    <span class="k">if</span> <span class="n">operators</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>        <span class="n">operators</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_forbid_use_method</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ops</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">operators</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">re_evaluate</span> <span class="ow">and</span> <span class="p">(</span><span class="n">re_evaluate_parents_first</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="n">re_evaluate_parents_first</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>        <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="n">operators</span><span class="o">=</span><span class="n">operators</span><span class="p">,</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>        <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>        <span class="n">elitist</span><span class="o">=</span><span class="n">elitist</span><span class="p">,</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>        <span class="n">re_evaluate</span><span class="o">=</span><span class="n">re_evaluate</span><span class="p">,</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>        <span class="n">re_evaluate_parents_first</span><span class="o">=</span><span class="n">re_evaluate_parents_first</span><span class="p">,</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>        <span class="n">_allow_empty_operator_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.SteadyStateGA.use" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">use</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.SteadyStateGA.use" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Specify the cross-over or the mutation operator to use.</p>
<p>This method exists for compatibility with previous EvoTorch code.
Instead of using this method, it is recommended to specify the
operators via the <code>operators</code> keyword argument while initializing
this class.</p>
<p>Using this method, one can specify one cross-over operator and one
mutation operator that will be used during the evolutionary search.
Specifying multiple cross-over operators or multiple mutation operators
is not allowed. When the cross-over and mutation operators are
specified via <code>use(...)</code>, the order of execution will always be
arranged such that the cross-over comes first and the mutation comes
comes second. If desired, one can specify only the cross-over operator
or only the mutation operator.</p>
<p>Please note that the <code>operators</code> keyword argument works differently,
and offers more flexibility for defining the procedure to follow at
each generation. In more details, the <code>operators</code> keyword argument
allows one to specify multiple cross-over and/or multiple mutation
operators, and those operators will be executed in the specified
order.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>operator</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The operator to be registered to SteadyStateGA.
If the specified operator is cross-over (i.e. an instance
of <a class="autorefs autorefs-internal" href="../operators/base/#evotorch.operators.base.CrossOver">CrossOver</a>),
then this operator will be registered for the cross-over
phase. If the specified operator is an operator that is
not of the cross-over type (i.e. any instance of
<a class="autorefs autorefs-internal" href="../operators/base/#evotorch.operators.base.Operator">Operator</a> that is not
<a class="autorefs autorefs-internal" href="../operators/base/#evotorch.operators.base.CrossOver">CrossOver</a>) or if it is
just a function which receives the decision values as a PyTorch
tensor (or, in the case where <code>dtype</code> of the problem is
<code>object</code> as an instance of
<a class="autorefs autorefs-internal" href="../tools/objectarray/#evotorch.tools.objectarray.ObjectArray">ObjectArray</a>) and
returns a modified copy, then that operator will be registered
for the mutation phase of the genetic algorithm.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/ga.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="k">def</span><span class="w"> </span><span class="nf">use</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="p">:</span> <span class="n">Callable</span><span class="p">):</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">    Specify the cross-over or the mutation operator to use.</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">    This method exists for compatibility with previous EvoTorch code.</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">    Instead of using this method, it is recommended to specify the</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">    operators via the `operators` keyword argument while initializing</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">    this class.</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">    Using this method, one can specify one cross-over operator and one</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">    mutation operator that will be used during the evolutionary search.</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">    Specifying multiple cross-over operators or multiple mutation operators</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">    is not allowed. When the cross-over and mutation operators are</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">    specified via `use(...)`, the order of execution will always be</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">    arranged such that the cross-over comes first and the mutation comes</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">    comes second. If desired, one can specify only the cross-over operator</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">    or only the mutation operator.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">    Please note that the `operators` keyword argument works differently,</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">    and offers more flexibility for defining the procedure to follow at</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">    each generation. In more details, the `operators` keyword argument</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">    allows one to specify multiple cross-over and/or multiple mutation</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">    operators, and those operators will be executed in the specified</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">    order.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">        operator: The operator to be registered to SteadyStateGA.</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">            If the specified operator is cross-over (i.e. an instance</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">            of [CrossOver][evotorch.operators.base.CrossOver]),</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">            then this operator will be registered for the cross-over</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">            phase. If the specified operator is an operator that is</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">            not of the cross-over type (i.e. any instance of</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">            [Operator][evotorch.operators.base.Operator] that is not</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">            [CrossOver][evotorch.operators.base.CrossOver]) or if it is</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">            just a function which receives the decision values as a PyTorch</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">            tensor (or, in the case where `dtype` of the problem is</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">            `object` as an instance of</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">            [ObjectArray][evotorch.tools.objectarray.ObjectArray]) and</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">            returns a modified copy, then that operator will be registered</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">            for the mutation phase of the genetic algorithm.</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forbid_use_method</span><span class="p">:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>            <span class="s2">&quot;The method `use(...)` cannot be called anymore, because the evolutionary search has started.&quot;</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="p">)</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>            <span class="sa">f</span><span class="s2">&quot;The method `use(...)` cannot be called&quot;</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>            <span class="sa">f</span><span class="s2">&quot; because an operator list was provided while initializing this </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> instance.&quot;</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="p">)</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">CrossOver</span><span class="p">):</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>                <span class="sa">f</span><span class="s2">&quot;The method `use(...)` received this cross-over operator as its argument:&quot;</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">operator</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>                <span class="sa">f</span><span class="s2">&quot; However, a cross-over operator was already set:&quot;</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="p">)</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cross_over_op</span> <span class="o">=</span> <span class="n">operator</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ops</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                <span class="sa">f</span><span class="s2">&quot;The method `use(...)` received this mutation operator as its argument:&quot;</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">operator</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                <span class="sa">f</span><span class="s2">&quot; However, a mutation operator was already set:&quot;</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span><span class="si">}</span><span class="s2"> (of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>            <span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_op</span> <span class="o">=</span> <span class="n">operator</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ops</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.algorithms.XNES" class="doc doc-heading">
            <code>XNES</code>


<a href="#evotorch.algorithms.XNES" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="GaussianSearchAlgorithm (evotorch.algorithms.distributed.gaussian.GaussianSearchAlgorithm)" href="distributed/gaussian/#evotorch.algorithms.distributed.gaussian.GaussianSearchAlgorithm">GaussianSearchAlgorithm</a></code></p>


        <p>Inspired by the implementation at:
<a href="http://schaul.site44.com/code/xnes.py">http://schaul.site44.com/code/xnes.py</a>
<a href="https://github.com/pybrain/pybrain/blob/master/pybrain/optimization/distributionbased/xnes.py">https://github.com/pybrain/pybrain/blob/master/pybrain/optimization/distributionbased/xnes.py</a></p>


<details class="reference" open>
  <summary>Reference</summary>
  <p>Glasmachers, Tobias, et al.
Exponential natural evolution strategies.
Proceedings of the 12<sup>th</sup> annual conference on Genetic and evolutionary
computation (GECCO 2010).</p>
</details>






              <details class="quote">
                <summary>Source code in <code>evotorch/algorithms/distributed/gaussian.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><span class="k">class</span><span class="w"> </span><span class="nc">XNES</span><span class="p">(</span><span class="n">GaussianSearchAlgorithm</span><span class="p">):</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="sd">    XNES: Exponential Natural Evolution Strategies</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><span class="sd">    Inspired by the implementation at:</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">    http://schaul.site44.com/code/xnes.py</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="sd">    https://github.com/pybrain/pybrain/blob/master/pybrain/optimization/distributionbased/xnes.py</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">    Reference:</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">        Glasmachers, Tobias, et al.</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">        Exponential natural evolution strategies.</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">        Proceedings of the 12th annual conference on Genetic and evolutionary</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><span class="sd">        computation (GECCO 2010).</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>    <span class="n">DISTRIBUTION_TYPE</span> <span class="o">=</span> <span class="n">ExpGaussian</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>    <span class="n">DISTRIBUTION_PARAMS</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>        <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>        <span class="n">radius_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>        <span class="n">center_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>        <span class="n">stdev_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>        <span class="n">scale_learning_rate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>        <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>        <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>        <span class="n">optimizer_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>        <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nes&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>        <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>        <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>        <span class="n">distributed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>        <span class="n">popsize_weighted_grad_avg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>    <span class="p">):</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">        `__init__(...)`: Initialize the XNES algorithm.</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><span class="sd">            problem: The problem object which is being worked on.</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><span class="sd">            stdev_init: The initial standard deviation of the search</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="sd">                distribution, expressed as a scalar or as an array.</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">                Determines the initial coverage area of the search</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><span class="sd">                If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">                argument `radius_init` instead, then `stdev_init` is expected</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">                as None.</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">            radius_init: The initial radius of the search distribution,</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">                expressed as a scalar.</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">                Determines the initial coverage area of the search</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">                Here, &quot;radius&quot; is defined as the norm of the search</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><span class="sd">                distribution.</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">                If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a><span class="sd">                argument `stdev_init` instead, then `radius_init` is expected</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">                as None.</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">            popsize: Population size. Can be specified as an int,</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">                or can be left as None to let the solver decide.</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">                In the case of SNES, `popsize` can be left as None,</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">                in which case the default `popsize` will be computed</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">                as `4 + floor(3 * log(n))` where `n` is the length</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">                of a solution.</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">            center_learning_rate: Learning rate for updating the mean</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">                of the search distribution. Default value is 1.0</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">            stdev_learning_rate: Learning rate for updating the covariance</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">                matrix of the search distribution.</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">                The default value is `0.6 * (3 + log(n)) / (n * sqrt(n))`</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">                where `n` is the length of a solution.</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">            scale_learning_rate: For SNES, there is a default standard</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">                deviation learning rate value which is computed as</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">                `0.6 * (3 + log(n)) / (n * sqrt(n))` (where `n` is the solution</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">                length).</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">                If scale_learning_rate is True (which is the default),</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">                then the effective learning rate for the standard deviation</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">                becomes the provided `stdev_learning_rate` multiplied by this</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">                default value. If `scale_learning_rate` is False, then the</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">                effective standard deviation learning rate becomes</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">                equal to the provided `stdev_learning_rate` value.</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">            num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">                it is ensured that a population has interacted with</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">                the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">                has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">                too small, and gets extended with more samples,</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">                until n amount of interactions is reached.</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">                When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">                affecting the size of a population.</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">            popsize_max: Having `num_interactions` set as an integer</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">                might cause the effective population size jump to</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">                unnecesarily large numbers. To prevent this,</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="sd">                one can set `popsize_max` to specify an upper</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">                bound for the effective population size.</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">            num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><span class="sd">                it is ensured that a population has interacted with</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">                the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><span class="sd">                has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">                too small, and gets extended with more samples,</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">                until n amount of interactions is reached.</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">                When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">                affecting the size of a population.</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">            optimizer: The optimizer to be used while following the</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">                estimated the gradients.</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">                Can be given as None if a momentum-based optimizer</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a><span class="sd">                is not required.</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a><span class="sd">                Otherwise, can be given as a str containing the name</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="sd">                of the optimizer (e.g. &#39;adam&#39;, &#39;clipup&#39;);</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="sd">                or as an instance of evotorch.optimizers.TorchOptimizer</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="sd">                or evotorch.optimizers.ClipUp.</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">                The default is None.</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><span class="sd">                Note that, for ClipUp, the default maximum speed is set</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">                as twice the given `center_learning_rate`.</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><span class="sd">                This maximum speed can be configured by passing</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a><span class="sd">                `{&quot;max_speed&quot;: ...}` to `optimizer_config`.</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a><span class="sd">            optimizer_config: Configuration which will be passed</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a><span class="sd">                to the optimizer as keyword arguments.</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="sd">                See `evotorch.optimizers` for details about</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><span class="sd">                which optimizer accepts which keyword arguments.</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><span class="sd">            ranking_method: Which ranking method will be used for</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a><span class="sd">                fitness shaping. See the documentation of</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="sd">                `evotorch.ranking.rank(...)` for details.</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">                The default is &#39;nes&#39;.</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><span class="sd">                Can be given as None if no such ranking is required.</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><span class="sd">            center_init: The initial center solution.</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><span class="sd">                Can be left as None.</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="sd">            obj_index: Index of the objective according to which the</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">                gradient estimations will be done.</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><span class="sd">                For single-objective problems, this can be left as None.</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><span class="sd">            distributed: Whether or not the gradient computation will</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a><span class="sd">                be distributed. If `distributed` is given as False and</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><span class="sd">                the problem is not parallelized, then everything will</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><span class="sd">                be centralized (i.e. the entire computation will happen</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><span class="sd">                in the main process).</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="sd">                If `distributed` is given as False, and the problem</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">                is parallelized, then the population will be created</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><span class="sd">                in the main process and then sent to remote workers</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">                for parallelized evaluation, and then the remote fitnesses</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">                will be collected by the main process again for computing</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">                the search gradients.</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a><span class="sd">                If `distributed` is given as True, and the problem</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">                is parallelized, then the search algorithm itself will</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">                be distributed, in the sense that each remote actor will</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">                generate its own population (such that the total population</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="sd">                size across all these actors becomes equal to `popsize`)</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">                and will compute its own gradient, and then the main process</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">                will collect these gradients, compute the averaged gradients</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">                and update the main search distribution.</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">                Non-distributed mode has the advantage of keeping the</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a><span class="sd">                population in the main process, which is good when one wishes</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">                to do detailed monitoring during the evolutionary process,</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">                but has the disadvantage of having to pass the solutions to</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a><span class="sd">                the remote actors and having to collect fitnesses, which</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">                might result in increased interprocess communication traffic.</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">                On the other hand, while it is not possible to monitor the</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a><span class="sd">                population in distributed mode, the distributed mode has the</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a><span class="sd">                advantage of significantly reducing the interprocess</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a><span class="sd">                communication traffic, since the only things communicated</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a><span class="sd">                with the remote actors are the search distributions (not the</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a><span class="sd">                solutions) and the gradients.</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a><span class="sd">            popsize_weighted_grad_avg: Only to be used in distributed mode.</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a><span class="sd">                (where being in distributed mode means `distributed` is given</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="sd">                as True). In distributed mode, each actor remotely samples</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="sd">                its own solution batches and computes its own gradients.</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a><span class="sd">                These gradients are then collected, and a final average</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a><span class="sd">                gradient is computed.</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><span class="sd">                If `popsize_weighted_grad_avg` is True, then, while averaging</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a><span class="sd">                over the gradients, each gradient will have its own weight</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a><span class="sd">                that is computed according to how many solutions were sampled</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a><span class="sd">                by the actor that produced the gradient.</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><span class="sd">                If `popsize_weighted_grad_avg` is False, then, there will not</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a><span class="sd">                be weighted averaging (or, each gradient will have equal</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a><span class="sd">                weight).</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><span class="sd">                If `popsize_weighted_grad_avg` is None, then, the gradient</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><span class="sd">                weights will be equal a value for `num_interactions` is given</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a><span class="sd">                (because `num_interactions` affects the number of solutions</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a><span class="sd">                according to the episode lengths, and popsize-weighting the</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="sd">                gradients could be misleading); and the gradient weights will</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a><span class="sd">                be weighted according to the sub-population (i.e. sub-batch)</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a><span class="sd">                sizes if `num_interactions` is left as None.</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a><span class="sd">                The default value for `popsize_weighted_grad_avg` is None.</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">                When the distributed mode is disabled (i.e. when `distributed`</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="sd">                is False), then the argument `popsize_weighted_grad_avg` is</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">                expected as None.</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>        <span class="k">if</span> <span class="n">popsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>            <span class="n">popsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)))</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>        <span class="k">if</span> <span class="n">center_learning_rate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>            <span class="n">center_learning_rate</span> <span class="o">=</span> <span class="mf">1.0</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">default_stdev_lr</span><span class="p">():</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solution_length</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>            <span class="k">return</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>        <span class="k">if</span> <span class="n">stdev_learning_rate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>            <span class="n">stdev_learning_rate</span> <span class="o">=</span> <span class="n">default_stdev_lr</span><span class="p">()</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>            <span class="n">stdev_learning_rate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stdev_learning_rate</span><span class="p">)</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>            <span class="k">if</span> <span class="n">scale_learning_rate</span><span class="p">:</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>                <span class="n">stdev_learning_rate</span> <span class="o">*=</span> <span class="n">default_stdev_lr</span><span class="p">()</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>            <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>            <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>            <span class="n">center_learning_rate</span><span class="o">=</span><span class="n">center_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>            <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="n">stdev_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>            <span class="n">stdev_init</span><span class="o">=</span><span class="n">stdev_init</span><span class="p">,</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>            <span class="n">radius_init</span><span class="o">=</span><span class="n">radius_init</span><span class="p">,</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>            <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>            <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>            <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>            <span class="n">optimizer_config</span><span class="o">=</span><span class="n">optimizer_config</span><span class="p">,</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a>            <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>            <span class="n">center_init</span><span class="o">=</span><span class="n">center_init</span><span class="p">,</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>            <span class="n">stdev_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>            <span class="n">stdev_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>            <span class="n">stdev_max_change</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>            <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>            <span class="n">distributed</span><span class="o">=</span><span class="n">distributed</span><span class="p">,</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>            <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="n">popsize_weighted_grad_avg</span><span class="p">,</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="evotorch.algorithms.XNES.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">stdev_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">radius_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">popsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center_learning_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale_learning_rate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_interactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">popsize_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimizer_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="s1">&#39;nes&#39;</span><span class="p">,</span> <span class="n">center_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distributed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.XNES.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the XNES algorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Problem (evotorch.core.Problem)" href="../core/#evotorch.core.Problem">Problem</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem object which is being worked on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial standard deviation of the search
distribution, expressed as a scalar or as an array.
Determines the initial coverage area of the search
distribution.
If one wishes to configure the coverage area via the
argument <code>radius_init</code> instead, then <code>stdev_init</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radius_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial radius of the search distribution,
expressed as a scalar.
Determines the initial coverage area of the search
distribution.
Here, "radius" is defined as the norm of the search
distribution.
If one wishes to configure the coverage area via the
argument <code>stdev_init</code> instead, then <code>radius_init</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Population size. Can be specified as an int,
or can be left as None to let the solver decide.
In the case of SNES, <code>popsize</code> can be left as None,
in which case the default <code>popsize</code> will be computed
as <code>4 + floor(3 * log(n))</code> where <code>n</code> is the length
of a solution.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_learning_rate</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for updating the mean
of the search distribution. Default value is 1.0</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_learning_rate</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for updating the covariance
matrix of the search distribution.
The default value is <code>0.6 * (3 + log(n)) / (n * sqrt(n))</code>
where <code>n</code> is the length of a solution.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scale_learning_rate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For SNES, there is a default standard
deviation learning rate value which is computed as
<code>0.6 * (3 + log(n)) / (n * sqrt(n))</code> (where <code>n</code> is the solution
length).
If scale_learning_rate is True (which is the default),
then the effective learning rate for the standard deviation
becomes the provided <code>stdev_learning_rate</code> multiplied by this
default value. If <code>scale_learning_rate</code> is False, then the
effective standard deviation learning rate becomes
equal to the provided <code>stdev_learning_rate</code> value.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_interactions</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When given as an integer n,
it is ensured that a population has interacted with
the GymProblem's environment n times. If this target
has not been reached yet, then the population is declared
too small, and gets extended with more samples,
until n amount of interactions is reached.
When given as None, popsize is the only configuration
affecting the size of a population.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Having <code>num_interactions</code> set as an integer
might cause the effective population size jump to
unnecesarily large numbers. To prevent this,
one can set <code>popsize_max</code> to specify an upper
bound for the effective population size.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_interactions</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When given as an integer n,
it is ensured that a population has interacted with
the GymProblem's environment n times. If this target
has not been reached yet, then the population is declared
too small, and gets extended with more samples,
until n amount of interactions is reached.
When given as None, popsize is the only configuration
affecting the size of a population.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimizer to be used while following the
estimated the gradients.
Can be given as None if a momentum-based optimizer
is not required.
Otherwise, can be given as a str containing the name
of the optimizer (e.g. 'adam', 'clipup');
or as an instance of evotorch.optimizers.TorchOptimizer
or evotorch.optimizers.ClipUp.
The default is None.
Note that, for ClipUp, the default maximum speed is set
as twice the given <code>center_learning_rate</code>.
This maximum speed can be configured by passing
<code>{"max_speed": ...}</code> to <code>optimizer_config</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration which will be passed
to the optimizer as keyword arguments.
See <code>evotorch.optimizers</code> for details about
which optimizer accepts which keyword arguments.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ranking_method</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which ranking method will be used for
fitness shaping. See the documentation of
<code>evotorch.ranking.rank(...)</code> for details.
The default is 'nes'.
Can be given as None if no such ranking is required.</p>
              </div>
            </td>
            <td>
                  <code>&#39;nes&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial center solution.
Can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj_index</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the objective according to which the
gradient estimations will be done.
For single-objective problems, this can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distributed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the gradient computation will
be distributed. If <code>distributed</code> is given as False and
the problem is not parallelized, then everything will
be centralized (i.e. the entire computation will happen
in the main process).
If <code>distributed</code> is given as False, and the problem
is parallelized, then the population will be created
in the main process and then sent to remote workers
for parallelized evaluation, and then the remote fitnesses
will be collected by the main process again for computing
the search gradients.
If <code>distributed</code> is given as True, and the problem
is parallelized, then the search algorithm itself will
be distributed, in the sense that each remote actor will
generate its own population (such that the total population
size across all these actors becomes equal to <code>popsize</code>)
and will compute its own gradient, and then the main process
will collect these gradients, compute the averaged gradients
and update the main search distribution.
Non-distributed mode has the advantage of keeping the
population in the main process, which is good when one wishes
to do detailed monitoring during the evolutionary process,
but has the disadvantage of having to pass the solutions to
the remote actors and having to collect fitnesses, which
might result in increased interprocess communication traffic.
On the other hand, while it is not possible to monitor the
population in distributed mode, the distributed mode has the
advantage of significantly reducing the interprocess
communication traffic, since the only things communicated
with the remote actors are the search distributions (not the
solutions) and the gradients.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize_weighted_grad_avg</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Only to be used in distributed mode.
(where being in distributed mode means <code>distributed</code> is given
as True). In distributed mode, each actor remotely samples
its own solution batches and computes its own gradients.
These gradients are then collected, and a final average
gradient is computed.
If <code>popsize_weighted_grad_avg</code> is True, then, while averaging
over the gradients, each gradient will have its own weight
that is computed according to how many solutions were sampled
by the actor that produced the gradient.
If <code>popsize_weighted_grad_avg</code> is False, then, there will not
be weighted averaging (or, each gradient will have equal
weight).
If <code>popsize_weighted_grad_avg</code> is None, then, the gradient
weights will be equal a value for <code>num_interactions</code> is given
(because <code>num_interactions</code> affects the number of solutions
according to the episode lengths, and popsize-weighting the
gradients could be misleading); and the gradient weights will
be weighted according to the sub-population (i.e. sub-batch)
sizes if <code>num_interactions</code> is left as None.
The default value for <code>popsize_weighted_grad_avg</code> is None.
When the distributed mode is disabled (i.e. when <code>distributed</code>
is False), then the argument <code>popsize_weighted_grad_avg</code> is
expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/distributed/gaussian.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>    <span class="n">problem</span><span class="p">:</span> <span class="n">Problem</span><span class="p">,</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>    <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>    <span class="n">radius_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>    <span class="n">center_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>    <span class="n">stdev_learning_rate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>    <span class="n">scale_learning_rate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>    <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>    <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>    <span class="n">optimizer_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>    <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nes&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>    <span class="n">center_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>    <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>    <span class="n">distributed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>    <span class="n">popsize_weighted_grad_avg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="p">):</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">    `__init__(...)`: Initialize the XNES algorithm.</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><span class="sd">        problem: The problem object which is being worked on.</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><span class="sd">        stdev_init: The initial standard deviation of the search</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="sd">            distribution, expressed as a scalar or as an array.</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">            Determines the initial coverage area of the search</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><span class="sd">            If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">            argument `radius_init` instead, then `stdev_init` is expected</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">        radius_init: The initial radius of the search distribution,</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">            expressed as a scalar.</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">            Determines the initial coverage area of the search</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">            Here, &quot;radius&quot; is defined as the norm of the search</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><span class="sd">            distribution.</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">            If one wishes to configure the coverage area via the</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a><span class="sd">            argument `stdev_init` instead, then `radius_init` is expected</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">        popsize: Population size. Can be specified as an int,</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">            or can be left as None to let the solver decide.</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">            In the case of SNES, `popsize` can be left as None,</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">            in which case the default `popsize` will be computed</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">            as `4 + floor(3 * log(n))` where `n` is the length</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">            of a solution.</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">        center_learning_rate: Learning rate for updating the mean</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">            of the search distribution. Default value is 1.0</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">        stdev_learning_rate: Learning rate for updating the covariance</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">            matrix of the search distribution.</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">            The default value is `0.6 * (3 + log(n)) / (n * sqrt(n))`</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">            where `n` is the length of a solution.</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">        scale_learning_rate: For SNES, there is a default standard</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">            deviation learning rate value which is computed as</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">            `0.6 * (3 + log(n)) / (n * sqrt(n))` (where `n` is the solution</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">            length).</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">            If scale_learning_rate is True (which is the default),</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">            then the effective learning rate for the standard deviation</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">            becomes the provided `stdev_learning_rate` multiplied by this</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">            default value. If `scale_learning_rate` is False, then the</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">            effective standard deviation learning rate becomes</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">            equal to the provided `stdev_learning_rate` value.</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">        num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">            it is ensured that a population has interacted with</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">            the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">            has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">            too small, and gets extended with more samples,</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">            until n amount of interactions is reached.</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">            When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">            affecting the size of a population.</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">        popsize_max: Having `num_interactions` set as an integer</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="sd">            might cause the effective population size jump to</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">            unnecesarily large numbers. To prevent this,</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="sd">            one can set `popsize_max` to specify an upper</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">            bound for the effective population size.</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">        num_interactions: When given as an integer n,</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><span class="sd">            it is ensured that a population has interacted with</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">            the GymProblem&#39;s environment n times. If this target</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><span class="sd">            has not been reached yet, then the population is declared</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">            too small, and gets extended with more samples,</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">            until n amount of interactions is reached.</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">            When given as None, popsize is the only configuration</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">            affecting the size of a population.</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">        optimizer: The optimizer to be used while following the</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">            estimated the gradients.</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">            Can be given as None if a momentum-based optimizer</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a><span class="sd">            is not required.</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a><span class="sd">            Otherwise, can be given as a str containing the name</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="sd">            of the optimizer (e.g. &#39;adam&#39;, &#39;clipup&#39;);</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="sd">            or as an instance of evotorch.optimizers.TorchOptimizer</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="sd">            or evotorch.optimizers.ClipUp.</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">            The default is None.</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><span class="sd">            Note that, for ClipUp, the default maximum speed is set</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">            as twice the given `center_learning_rate`.</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><span class="sd">            This maximum speed can be configured by passing</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a><span class="sd">            `{&quot;max_speed&quot;: ...}` to `optimizer_config`.</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a><span class="sd">        optimizer_config: Configuration which will be passed</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a><span class="sd">            to the optimizer as keyword arguments.</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="sd">            See `evotorch.optimizers` for details about</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><span class="sd">            which optimizer accepts which keyword arguments.</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><span class="sd">        ranking_method: Which ranking method will be used for</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a><span class="sd">            fitness shaping. See the documentation of</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="sd">            `evotorch.ranking.rank(...)` for details.</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">            The default is &#39;nes&#39;.</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><span class="sd">            Can be given as None if no such ranking is required.</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><span class="sd">        center_init: The initial center solution.</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><span class="sd">            Can be left as None.</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="sd">        obj_index: Index of the objective according to which the</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">            gradient estimations will be done.</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><span class="sd">            For single-objective problems, this can be left as None.</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><span class="sd">        distributed: Whether or not the gradient computation will</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a><span class="sd">            be distributed. If `distributed` is given as False and</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><span class="sd">            the problem is not parallelized, then everything will</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><span class="sd">            be centralized (i.e. the entire computation will happen</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><span class="sd">            in the main process).</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="sd">            If `distributed` is given as False, and the problem</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">            is parallelized, then the population will be created</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><span class="sd">            in the main process and then sent to remote workers</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">            for parallelized evaluation, and then the remote fitnesses</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">            will be collected by the main process again for computing</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">            the search gradients.</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a><span class="sd">            If `distributed` is given as True, and the problem</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">            is parallelized, then the search algorithm itself will</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">            be distributed, in the sense that each remote actor will</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">            generate its own population (such that the total population</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="sd">            size across all these actors becomes equal to `popsize`)</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">            and will compute its own gradient, and then the main process</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">            will collect these gradients, compute the averaged gradients</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">            and update the main search distribution.</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">            Non-distributed mode has the advantage of keeping the</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a><span class="sd">            population in the main process, which is good when one wishes</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">            to do detailed monitoring during the evolutionary process,</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">            but has the disadvantage of having to pass the solutions to</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a><span class="sd">            the remote actors and having to collect fitnesses, which</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">            might result in increased interprocess communication traffic.</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">            On the other hand, while it is not possible to monitor the</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a><span class="sd">            population in distributed mode, the distributed mode has the</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a><span class="sd">            advantage of significantly reducing the interprocess</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a><span class="sd">            communication traffic, since the only things communicated</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a><span class="sd">            with the remote actors are the search distributions (not the</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a><span class="sd">            solutions) and the gradients.</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a><span class="sd">        popsize_weighted_grad_avg: Only to be used in distributed mode.</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a><span class="sd">            (where being in distributed mode means `distributed` is given</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="sd">            as True). In distributed mode, each actor remotely samples</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="sd">            its own solution batches and computes its own gradients.</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a><span class="sd">            These gradients are then collected, and a final average</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a><span class="sd">            gradient is computed.</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><span class="sd">            If `popsize_weighted_grad_avg` is True, then, while averaging</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a><span class="sd">            over the gradients, each gradient will have its own weight</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a><span class="sd">            that is computed according to how many solutions were sampled</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a><span class="sd">            by the actor that produced the gradient.</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><span class="sd">            If `popsize_weighted_grad_avg` is False, then, there will not</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a><span class="sd">            be weighted averaging (or, each gradient will have equal</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a><span class="sd">            weight).</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><span class="sd">            If `popsize_weighted_grad_avg` is None, then, the gradient</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><span class="sd">            weights will be equal a value for `num_interactions` is given</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a><span class="sd">            (because `num_interactions` affects the number of solutions</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a><span class="sd">            according to the episode lengths, and popsize-weighting the</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="sd">            gradients could be misleading); and the gradient weights will</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a><span class="sd">            be weighted according to the sub-population (i.e. sub-batch)</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a><span class="sd">            sizes if `num_interactions` is left as None.</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a><span class="sd">            The default value for `popsize_weighted_grad_avg` is None.</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">            When the distributed mode is disabled (i.e. when `distributed`</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="sd">            is False), then the argument `popsize_weighted_grad_avg` is</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">            expected as None.</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>    <span class="k">if</span> <span class="n">popsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>        <span class="n">popsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">)))</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>    <span class="k">if</span> <span class="n">center_learning_rate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>        <span class="n">center_learning_rate</span> <span class="o">=</span> <span class="mf">1.0</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">default_stdev_lr</span><span class="p">():</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solution_length</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>        <span class="k">return</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>    <span class="k">if</span> <span class="n">stdev_learning_rate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>        <span class="n">stdev_learning_rate</span> <span class="o">=</span> <span class="n">default_stdev_lr</span><span class="p">()</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>        <span class="n">stdev_learning_rate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">stdev_learning_rate</span><span class="p">)</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>        <span class="k">if</span> <span class="n">scale_learning_rate</span><span class="p">:</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>            <span class="n">stdev_learning_rate</span> <span class="o">*=</span> <span class="n">default_stdev_lr</span><span class="p">()</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>        <span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>        <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>        <span class="n">center_learning_rate</span><span class="o">=</span><span class="n">center_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>        <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="n">stdev_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>        <span class="n">stdev_init</span><span class="o">=</span><span class="n">stdev_init</span><span class="p">,</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>        <span class="n">radius_init</span><span class="o">=</span><span class="n">radius_init</span><span class="p">,</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>        <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>        <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>        <span class="n">optimizer_config</span><span class="o">=</span><span class="n">optimizer_config</span><span class="p">,</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a>        <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>        <span class="n">center_init</span><span class="o">=</span><span class="n">center_init</span><span class="p">,</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>        <span class="n">stdev_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>        <span class="n">stdev_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>        <span class="n">stdev_max_change</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>        <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>        <span class="n">distributed</span><span class="o">=</span><span class="n">distributed</span><span class="p">,</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>        <span class="n">popsize_weighted_grad_avg</span><span class="o">=</span><span class="n">popsize_weighted_grad_avg</span><span class="p">,</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 NNAISENSE SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>