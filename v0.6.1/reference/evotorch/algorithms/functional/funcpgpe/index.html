
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="EvoTorch is an open source evolutionary computation library developed at NNAISENSE, built on top of PyTorch.">
      
      
      
      
        <link rel="prev" href="../funcclipup/">
      
      
        <link rel="next" href="../funcsgd/">
      
      
      <link rel="icon" href="../../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Funcpgpe - EvoTorch</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#evotorch.algorithms.functional.funcpgpe" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../../../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-header__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EvoTorch
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Funcpgpe
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../quickstart/" class="md-tabs__link">
        
  
  
    
  
  Quickstart

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../user_guide/general_usage/" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../advanced_usage/solution_batch/" class="md-tabs__link">
          
  
  
    
  
  Advanced Usage

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-nav__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EvoTorch
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../user_guide/general_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../user_guide/algorithm_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithm Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../user_guide/algorithms_tour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms Tour
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../user_guide/problems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Defining Problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../user_guide/problem_parallelization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Problem Parallelization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../user_guide/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../user_guide/neuroevolution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../user_guide/gym/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution for Gym
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../user_guide/supervised_ne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervised Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../advanced_usage/solution_batch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manipulating Solutions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../advanced_usage/hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../advanced_usage/dist_based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributed Evolution Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../advanced_usage/custom_ea/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Searchers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../advanced_usage/custom_logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Loggers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../advanced_usage/ray_cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Ray Clusters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/Brax_Experiments_Visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization of the brax Experiment Results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/Brax_Experiments_with_PGPE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving a Brax environment using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/Evolving_Objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/Feature_Space_Illumination_with_MAPElites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Space Illumination with MAPElites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/Genetic_Programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic Programming using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/Gym_Experiments_with_PGPE_and_CoSyNE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gym Experiments with PGPE and CoSyNE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/Minimizing_Lennard-Jones_Atom_Cluster_Potentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimising Lennard-Jones Atom Cluster Potentials with Evolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/Training_MNIST30K/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training MNIST30K
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/Variational_Quantum_Eigensolvers_with_SNES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variational Quantum Eigensolvers with SNES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/batched_searches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maintaining a batch of populations using the functional EvoTorch API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/constrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving constrained optimization problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/func_rl_ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving objects using the functional operators API of EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/functional_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic algorithm with the help of functional operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/multiobj_batched_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multiobjective optimization via functional operators API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving reinforcement learning tasks using functional evolutionary algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/notebooks/reacher_mpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Predictive Control (MPC) with EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Evotorch
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Evotorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../optimizers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8" id="__nav_6_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1_8">
            <span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ga
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mapelites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mapelites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pycmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pycmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../searchalgorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Searchalgorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../distributed/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Distributed
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_7" id="__nav_6_1_8_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_7">
            <span class="md-nav__icon md-icon"></span>
            Distributed
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distributed/gaussian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_8" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_8" id="__nav_6_1_8_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1_8_8">
            <span class="md-nav__icon md-icon"></span>
            Functional
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../funcadam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcadam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../funccem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funccem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../funcclipup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcclipup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Funcpgpe
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Funcpgpe
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.functional.funcpgpe" class="md-nav__link">
    <span class="md-ellipsis">
      funcpgpe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.functional.funcpgpe.pgpe" class="md-nav__link">
    <span class="md-ellipsis">
      pgpe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.functional.funcpgpe.pgpe_ask" class="md-nav__link">
    <span class="md-ellipsis">
      pgpe_ask
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.functional.funcpgpe.pgpe_tell" class="md-nav__link">
    <span class="md-ellipsis">
      pgpe_tell
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../funcsgd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcsgd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../restarter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Restarter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_9" id="__nav_6_1_8_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_9">
            <span class="md-nav__icon md-icon"></span>
            Restarter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../restarter/modify_restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modify restart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../restarter/restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../neuroevolution/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9" id="__nav_6_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9">
            <span class="md-nav__icon md-icon"></span>
            Neuroevolution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/baseneproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Baseneproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/gymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/neproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/supervisedne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervisedne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/vecgymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecgymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../neuroevolution/net/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Net
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9_7" id="__nav_6_1_9_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_9_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9_7">
            <span class="md-nav__icon md-icon"></span>
            Net
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/net/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/net/layers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/net/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/net/multilayered/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multilayered
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/net/parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/net/rl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rl
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/net/runningnorm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningnorm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/net/runningstat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningstat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/net/statefulmodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statefulmodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../neuroevolution/net/vecrl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecrl
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../operators/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_10" id="__nav_6_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_10">
            <span class="md-nav__icon md-icon"></span>
            Operators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operators/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operators/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operators/real/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Real
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../operators/sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sequence
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../tools/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_11" id="__nav_6_1_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_11">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/cloning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/hook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/immutable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Immutable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/objectarray/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Objectarray
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/ranking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ranking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/readonlytensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Readonlytensor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/recursiveprintable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recursiveprintable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/structures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/tensorframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensorframe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/tensormaker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensormaker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.functional.funcpgpe" class="md-nav__link">
    <span class="md-ellipsis">
      funcpgpe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.functional.funcpgpe.pgpe" class="md-nav__link">
    <span class="md-ellipsis">
      pgpe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.functional.funcpgpe.pgpe_ask" class="md-nav__link">
    <span class="md-ellipsis">
      pgpe_ask
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.algorithms.functional.funcpgpe.pgpe_tell" class="md-nav__link">
    <span class="md-ellipsis">
      pgpe_tell
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Funcpgpe</h1>

<div class="doc doc-object doc-module">



<a id="evotorch.algorithms.functional.funcpgpe"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="evotorch.algorithms.functional.funcpgpe.pgpe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pgpe</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">center_init</span><span class="p">,</span> <span class="n">center_learning_rate</span><span class="p">,</span> <span class="n">stdev_learning_rate</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="s1">&#39;centered&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;clipup&#39;</span><span class="p">,</span> <span class="n">optimizer_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">radius_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev_max_change</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.functional.funcpgpe.pgpe" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get an initial state for the PGPE algorithm.</p>
<p>The received initial state, a named tuple of type <code>PGPEState</code>, is to be
passed to the function <code>pgpe_ask(...)</code> to receive the solutions belonging
to the first generation of the evolutionary search.</p>
<p>Inspired by the PGPE implementations used in the studies
of Ha (2017, 2019), and by the evolution strategy variant of
Salimans et al. (2017), this PGPE implementation uses 0-centered
ranking by default.
The default optimizer for this PGPE implementation is ClipUp
(Toklu et al., 2020).</p>
<p>References:</p>
<div class="highlight"><pre><span></span><code>Frank Sehnke, Christian Osendorfer, Thomas Ruckstiess,
Alex Graves, Jan Peters, Jurgen Schmidhuber (2010).
Parameter-exploring Policy Gradients.
Neural Networks 23(4), 551-559.

David Ha (2017). Evolving Stable Strategies.
&lt;http://blog.otoro.net/2017/11/12/evolving-stable-strategies/&gt;

Salimans, T., Ho, J., Chen, X., Sidor, S. and Sutskever, I. (2017).
Evolution Strategies as a Scalable Alternative to
Reinforcement Learning.

David Ha (2019). Reinforcement Learning for Improving Agent Design.
Artificial life 25 (4), 352-365.

Toklu, N.E., Liskowski, P., Srivastava, R.K. (2020).
ClipUp: A Simple and Powerful Optimizer
for Distribution-based Policy Evolution.
Parallel Problem Solving from Nature (PPSN 2020).
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>center_init</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.BatchableVector">BatchableVector</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Center (i.e. mean) of the initial search distribution.
Expected as a PyTorch tensor with at least 1 dimension.
If the given <code>center</code> tensor has more than 1 dimensions, the extra
leftmost dimensions will be interpreted as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center_learning_rate</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.BatchableScalar">BatchableScalar</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for when updating the center of the
search distribution.
For normal cases, this is expected as a scalar. If given as an
n-dimensional tensor (where n&gt;0), the extra dimensions will be
considered as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_learning_rate</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.BatchableScalar">BatchableScalar</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Learning rate for when updating the standard
deviation of the search distribution.
For normal cases, this is expected as a scalar. If given as an
n-dimensional tensor (where n&gt;0), the extra dimensions will be
considered as batch dimensions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expected as a string, either as 'min' or as 'max'.
Determines if the goal is to minimize or is to maximize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ranking_method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Determines how the fitnesses will be ranked before
computing the gradients. Among the choices are
"centered" (a linear ranking where the worst solution gets the rank
-0.5 and the best solution gets the rank +0.5),
"linear" (a linear ranking where the worst solution gets the rank
0 and the best solution gets the rank 1),
"nes" (the ranking method that is used by the natural evolution
strategies), and
"raw" (no ranking).</p>
              </div>
            </td>
            <td>
                  <code>&#39;centered&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Functional optimizer to use when updating the center of the
search distribution. The functional optimizer can be expressed via
a string, or via a tuple.
If given as string, the valid choices are:
"clipup" (for the ClipUp optimizer),
"adam" (for the Adam optimizer),
"sgd" (for regular gradient ascent/descent).
If given as a tuple, the tuple should be in the form
<code>(optim, optim_ask, optim_tell)</code>, where the objects
<code>optim</code>, <code>optim_ask</code>, and <code>optim_tell</code> are the functions for
initializing the optimizer, asking (for the current search point),
and telling (the gradient to follow).
The function <code>optim</code> should expect keyword arguments for its
hyperparameters, and should return a state tuple of the optimizer.
The function <code>optim_ask</code> should expect the state tuple of the
optimizer, and should return the current search point as a tensor.
The function <code>optim_tell</code> should expect the state tuple of the
optimizer as a positional argument, and the gradient via the
keyword argument <code>follow_grad</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;clipup&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a dictionary, containing the
hyperparameters for the optimizer.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="evotorch.tools.BatchableVector">BatchableVector</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard deviation of the initial search distribution.
If this is given as a scalar <code>s</code>, the standard deviation for the
search distribution will be interpreted as <code>[s, s, ..., s]</code> whose
length is the same with the length of <code>center_init</code>.
If this is given as a 1-dimensional tensor, the given tensor will
be interpreted as the standard deviation vector.
If this is given as a tensor with at least 2 dimensions, the extra
leftmost dimension(s) will be interpreted as batch dimensions.
If you wish to express the coverage area of the initial search
distribution in terms of "radius" instead, you can leave
<code>stdev_init</code> as None, and provide a value for the argument
<code>radius_init</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radius_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="evotorch.tools.BatchableScalar">BatchableScalar</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radius for the initial search distribution, representing
the euclidean norm for the first standard deviation vector.
Setting this value as <code>r</code> means that the standard deviation
vector will be initialized as a vector <code>[s, s, ..., s]</code>
whose norm will be equal to <code>r</code>. In the non-batched case,
<code>radius_init</code> is expected as a scalar value.
If <code>radius_init</code> is given as a tensor with 1 or more
dimensions, those dimensions will be considered as batch
dimensions. If you wish to express the coverage are of the initial
search distribution in terms of the standard deviation values
instead, you can leave <code>radius_init</code> as None, and provide a value
for the argument <code>stdev_init</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_min</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="evotorch.tools.BatchableVector">BatchableVector</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum allowed standard deviation for the search
distribution. Can be given as a scalar or as a tensor with one or
more dimensions. When given with at least 2 dimensions, the extra
leftmost dimensions will be interpreted as batch dimensions.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_max</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="evotorch.tools.BatchableVector">BatchableVector</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum allowed standard deviation for the search
distribution. Can be given as a scalar or as a tensor with one or
more dimensions. When given with at least 2 dimensions, the extra
leftmost dimensions will be interpreted as batch dimensions.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_max_change</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="evotorch.tools.BatchableVector">BatchableVector</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum allowed change for the standard deviation
vector. If this is given as a scalar, this scalar will serve as a
limiter for the change of the entire standard deviation vector.
For example, a scalar value of 0.2 means that the elements of the
standard deviation vector cannot change more than the 20% of their
original values. If this is given as a vector (i.e. as a
1-dimensional tensor), each element of <code>stdev_max_change</code> will
serve as a limiter to its corresponding element within the standard
deviation vector. If <code>stdev_max_change</code> is given as a tensor with
at least 2 dimensions, the extra leftmost dimension(s) will be
interpreted as batch dimensions.
If you do not wish to have such a limiter, you can leave this as
None.</p>
              </div>
            </td>
            <td>
                  <code>0.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>symmetric</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not symmetric (i.e. antithetic) sampling will be
done while generating a new population.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/functional/funcpgpe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="k">def</span><span class="w"> </span><span class="nf">pgpe</span><span class="p">(</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">center_init</span><span class="p">:</span> <span class="n">BatchableVector</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">center_learning_rate</span><span class="p">:</span> <span class="n">BatchableScalar</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">stdev_learning_rate</span><span class="p">:</span> <span class="n">BatchableScalar</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">ranking_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;centered&quot;</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;clipup&quot;</span><span class="p">,</span>  <span class="c1"># or &quot;adam&quot; or &quot;sgd&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">optimizer_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">BatchableVector</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">radius_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">BatchableScalar</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">stdev_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">BatchableVector</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">stdev_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">BatchableVector</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">stdev_max_change</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">BatchableVector</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">symmetric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PGPEState</span><span class="p">:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    Get an initial state for the PGPE algorithm.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    The received initial state, a named tuple of type `PGPEState`, is to be</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    passed to the function `pgpe_ask(...)` to receive the solutions belonging</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    to the first generation of the evolutionary search.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Inspired by the PGPE implementations used in the studies</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    of Ha (2017, 2019), and by the evolution strategy variant of</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Salimans et al. (2017), this PGPE implementation uses 0-centered</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    ranking by default.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    The default optimizer for this PGPE implementation is ClipUp</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    (Toklu et al., 2020).</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    References:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        Frank Sehnke, Christian Osendorfer, Thomas Ruckstiess,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        Alex Graves, Jan Peters, Jurgen Schmidhuber (2010).</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        Parameter-exploring Policy Gradients.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        Neural Networks 23(4), 551-559.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        David Ha (2017). Evolving Stable Strategies.</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        &lt;http://blog.otoro.net/2017/11/12/evolving-stable-strategies/&gt;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        Salimans, T., Ho, J., Chen, X., Sidor, S. and Sutskever, I. (2017).</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        Evolution Strategies as a Scalable Alternative to</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        Reinforcement Learning.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        David Ha (2019). Reinforcement Learning for Improving Agent Design.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        Artificial life 25 (4), 352-365.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        Toklu, N.E., Liskowski, P., Srivastava, R.K. (2020).</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        ClipUp: A Simple and Powerful Optimizer</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        for Distribution-based Policy Evolution.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        Parallel Problem Solving from Nature (PPSN 2020).</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        center_init: Center (i.e. mean) of the initial search distribution.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            Expected as a PyTorch tensor with at least 1 dimension.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            If the given `center` tensor has more than 1 dimensions, the extra</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            leftmost dimensions will be interpreted as batch dimensions.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        center_learning_rate: Learning rate for when updating the center of the</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            search distribution.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            For normal cases, this is expected as a scalar. If given as an</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            n-dimensional tensor (where n&gt;0), the extra dimensions will be</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            considered as batch dimensions.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        stdev_learning_rate: Learning rate for when updating the standard</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            deviation of the search distribution.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            For normal cases, this is expected as a scalar. If given as an</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            n-dimensional tensor (where n&gt;0), the extra dimensions will be</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            considered as batch dimensions.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        objective_sense: Expected as a string, either as &#39;min&#39; or as &#39;max&#39;.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            Determines if the goal is to minimize or is to maximize.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        ranking_method: Determines how the fitnesses will be ranked before</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            computing the gradients. Among the choices are</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            &quot;centered&quot; (a linear ranking where the worst solution gets the rank</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            -0.5 and the best solution gets the rank +0.5),</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            &quot;linear&quot; (a linear ranking where the worst solution gets the rank</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            0 and the best solution gets the rank 1),</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            &quot;nes&quot; (the ranking method that is used by the natural evolution</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            strategies), and</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            &quot;raw&quot; (no ranking).</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        optimizer: Functional optimizer to use when updating the center of the</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            search distribution. The functional optimizer can be expressed via</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            a string, or via a tuple.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            If given as string, the valid choices are:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            &quot;clipup&quot; (for the ClipUp optimizer),</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            &quot;adam&quot; (for the Adam optimizer),</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            &quot;sgd&quot; (for regular gradient ascent/descent).</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            If given as a tuple, the tuple should be in the form</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            `(optim, optim_ask, optim_tell)`, where the objects</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            `optim`, `optim_ask`, and `optim_tell` are the functions for</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            initializing the optimizer, asking (for the current search point),</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            and telling (the gradient to follow).</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            The function `optim` should expect keyword arguments for its</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            hyperparameters, and should return a state tuple of the optimizer.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            The function `optim_ask` should expect the state tuple of the</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            optimizer, and should return the current search point as a tensor.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            The function `optim_tell` should expect the state tuple of the</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            optimizer as a positional argument, and the gradient via the</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            keyword argument `follow_grad`.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        optimizer_config: Optionally a dictionary, containing the</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            hyperparameters for the optimizer.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        stdev_init: Standard deviation of the initial search distribution.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            If this is given as a scalar `s`, the standard deviation for the</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            search distribution will be interpreted as `[s, s, ..., s]` whose</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            length is the same with the length of `center_init`.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            If this is given as a 1-dimensional tensor, the given tensor will</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            be interpreted as the standard deviation vector.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            If this is given as a tensor with at least 2 dimensions, the extra</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            leftmost dimension(s) will be interpreted as batch dimensions.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            If you wish to express the coverage area of the initial search</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            distribution in terms of &quot;radius&quot; instead, you can leave</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            `stdev_init` as None, and provide a value for the argument</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            `radius_init`.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        radius_init: Radius for the initial search distribution, representing</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            the euclidean norm for the first standard deviation vector.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            Setting this value as `r` means that the standard deviation</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            vector will be initialized as a vector `[s, s, ..., s]`</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            whose norm will be equal to `r`. In the non-batched case,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            `radius_init` is expected as a scalar value.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            If `radius_init` is given as a tensor with 1 or more</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            dimensions, those dimensions will be considered as batch</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            dimensions. If you wish to express the coverage are of the initial</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            search distribution in terms of the standard deviation values</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            instead, you can leave `radius_init` as None, and provide a value</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            for the argument `stdev_init`.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        stdev_min: Minimum allowed standard deviation for the search</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            distribution. Can be given as a scalar or as a tensor with one or</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">            more dimensions. When given with at least 2 dimensions, the extra</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            leftmost dimensions will be interpreted as batch dimensions.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        stdev_max: Maximum allowed standard deviation for the search</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">            distribution. Can be given as a scalar or as a tensor with one or</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            more dimensions. When given with at least 2 dimensions, the extra</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            leftmost dimensions will be interpreted as batch dimensions.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        stdev_max_change: Maximum allowed change for the standard deviation</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            vector. If this is given as a scalar, this scalar will serve as a</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            limiter for the change of the entire standard deviation vector.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            For example, a scalar value of 0.2 means that the elements of the</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            standard deviation vector cannot change more than the 20% of their</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            original values. If this is given as a vector (i.e. as a</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            1-dimensional tensor), each element of `stdev_max_change` will</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            serve as a limiter to its corresponding element within the standard</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            deviation vector. If `stdev_max_change` is given as a tensor with</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            at least 2 dimensions, the extra leftmost dimension(s) will be</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            interpreted as batch dimensions.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            If you do not wish to have such a limiter, you can leave this as</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            None.</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        symmetric: Whether or not symmetric (i.e. antithetic) sampling will be</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            done while generating a new population.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        A named tuple, of type `CEMState`, storing the hyperparameters and the</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        initial state of the cross entropy method.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">_get_stdev_init</span><span class="p">,</span> <span class="n">get_functional_optimizer</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="n">center_init</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">center_init</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="k">if</span> <span class="n">center_init</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="s2">&quot;The center of the search distribution for the functional PGPE was expected&quot;</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="s2">&quot; as a tensor with at least 1 dimension.&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="sa">f</span><span class="s2">&quot; However, the encountered `center` is </span><span class="si">{</span><span class="n">center_init</span><span class="si">}</span><span class="s2">, of shape </span><span class="si">{</span><span class="n">center_init</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">solution_length</span> <span class="o">=</span> <span class="n">center_init</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="k">if</span> <span class="n">solution_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Solution length cannot be 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="n">stdev_init</span> <span class="o">=</span> <span class="n">_get_stdev_init</span><span class="p">(</span><span class="n">center_init</span><span class="o">=</span><span class="n">center_init</span><span class="p">,</span> <span class="n">stdev_init</span><span class="o">=</span><span class="n">stdev_init</span><span class="p">,</span> <span class="n">radius_init</span><span class="o">=</span><span class="n">radius_init</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="n">device</span> <span class="o">=</span> <span class="n">center_init</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">dtype</span> <span class="o">=</span> <span class="n">center_init</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">as_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">as_vector_like_center</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">vector_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">as_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">solution_length</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>                    <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">vector_name</span><span class="si">}</span><span class="s2">` has an incompatible length.&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>                    <span class="sa">f</span><span class="s2">&quot; The length of `</span><span class="si">{</span><span class="n">vector_name</span><span class="si">}</span><span class="s2">`: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">,&quot;</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>                    <span class="sa">f</span><span class="s2">&quot; but the solution length implied by the provided `center_init` is </span><span class="si">{</span><span class="n">solution_length</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="n">center_learning_rate</span> <span class="o">=</span> <span class="n">as_tensor</span><span class="p">(</span><span class="n">center_learning_rate</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">stdev_learning_rate</span> <span class="o">=</span> <span class="n">as_tensor</span><span class="p">(</span><span class="n">stdev_learning_rate</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">if</span> <span class="n">objective_sense</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">maximize</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="k">elif</span> <span class="n">objective_sense</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="n">maximize</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="sa">f</span><span class="s2">&quot;`objective_sense` was expected as &#39;min&#39; or &#39;max&#39;, but it was received as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">ranking_method</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ranking_method</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">if</span> <span class="n">stdev_min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="n">stdev_min</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="n">stdev_min</span> <span class="o">=</span> <span class="n">as_vector_like_center</span><span class="p">(</span><span class="n">stdev_min</span><span class="p">,</span> <span class="s2">&quot;stdev_min&quot;</span><span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">if</span> <span class="n">stdev_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">stdev_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="n">stdev_max</span> <span class="o">=</span> <span class="n">as_vector_like_center</span><span class="p">(</span><span class="n">stdev_max</span><span class="p">,</span> <span class="s2">&quot;stdev_max&quot;</span><span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">if</span> <span class="n">stdev_max_change</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">stdev_max_change</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="n">stdev_max_change</span> <span class="o">=</span> <span class="n">as_vector_like_center</span><span class="p">(</span><span class="n">stdev_max_change</span><span class="p">,</span> <span class="s2">&quot;stdev_max_change&quot;</span><span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="k">if</span> <span class="n">optimizer_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">optimizer_config</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="n">optimizer_init_func</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_functional_optimizer</span><span class="p">(</span><span class="n">optimizer</span><span class="p">)</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">optimizer_state</span> <span class="o">=</span> <span class="n">optimizer_init_func</span><span class="p">(</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="n">center_init</span><span class="o">=</span><span class="n">center_init</span><span class="p">,</span> <span class="n">center_learning_rate</span><span class="o">=</span><span class="n">center_learning_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">optimizer_config</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">symmetric</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">symmetric</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">return</span> <span class="n">PGPEState</span><span class="p">(</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="n">optimizer_state</span><span class="o">=</span><span class="n">optimizer_state</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">stdev</span><span class="o">=</span><span class="n">stdev_init</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="n">stdev_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="n">stdev_min</span><span class="o">=</span><span class="n">stdev_min</span><span class="p">,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">stdev_max</span><span class="o">=</span><span class="n">stdev_max</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="n">stdev_max_change</span><span class="o">=</span><span class="n">stdev_max_change</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="n">maximize</span><span class="o">=</span><span class="n">maximize</span><span class="p">,</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="n">symmetric</span><span class="o">=</span><span class="n">symmetric</span><span class="p">,</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.algorithms.functional.funcpgpe.pgpe_ask" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pgpe_ask</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">popsize</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.functional.funcpgpe.pgpe_ask" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Obtain a population from the PGPE algorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="evotorch.algorithms.functional.funcpgpe.PGPEState">PGPEState</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current state of PGPE.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>popsize</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of solutions to be generated for the requested
population.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/functional/funcpgpe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="k">def</span><span class="w"> </span><span class="nf">pgpe_ask</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">PGPEState</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Obtain a population from the PGPE algorithm.</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        state: The current state of PGPE.</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        popsize: Number of solutions to be generated for the requested</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            population.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        Population, as a tensor of at least 2 dimensions.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_functional_optimizer</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="n">_</span><span class="p">,</span> <span class="n">optimizer_ask</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_functional_optimizer</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">optimizer</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">optimizer_ask</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">optimizer_state</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="n">stdev</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">stdev</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">sample_func</span> <span class="o">=</span> <span class="n">_symmetic_sample</span> <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">symmetric</span> <span class="k">else</span> <span class="n">_nonsymmetric_sample</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">return</span> <span class="n">sample_func</span><span class="p">(</span><span class="n">popsize</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">stdev</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.algorithms.functional.funcpgpe.pgpe_tell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pgpe_tell</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">evals</span><span class="p">)</span></code>

<a href="#evotorch.algorithms.functional.funcpgpe.pgpe_tell" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Given the old state and the evals (fitnesses), obtain the next state.</p>
<p>From this state tuple, the center point of the search distribution can be
obtained via the field <code>.optimizer_state.center</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="evotorch.algorithms.functional.funcpgpe.PGPEState">PGPEState</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The old state of the cross entropy method search.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The most recent population, as a PyTorch tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evals</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation results (i.e. fitnesses) for the solutions expressed
by <code>values</code>. For example, if <code>values</code> is shaped <code>(N, L)</code>, this means
that there are <code>N</code> solutions (of length <code>L</code>). So, <code>evals</code> is
expected as a 1-dimensional tensor of length <code>N</code>, where <code>evals[i]</code>
expresses the fitness of the solution <code>values[i, :]</code>.
If <code>values</code> is shaped <code>(B, N, L)</code>, then there is also a batch
dimension, so, <code>evals</code> is expected as a 2-dimensional tensor of
shape <code>(B, N)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/algorithms/functional/funcpgpe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="k">def</span><span class="w"> </span><span class="nf">pgpe_tell</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">PGPEState</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PGPEState</span><span class="p">:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    Given the old state and the evals (fitnesses), obtain the next state.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    From this state tuple, the center point of the search distribution can be</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    obtained via the field `.optimizer_state.center`.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        state: The old state of the cross entropy method search.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        values: The most recent population, as a PyTorch tensor.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        evals: Evaluation results (i.e. fitnesses) for the solutions expressed</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            by `values`. For example, if `values` is shaped `(N, L)`, this means</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">            that there are `N` solutions (of length `L`). So, `evals` is</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">            expected as a 1-dimensional tensor of length `N`, where `evals[i]`</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">            expresses the fitness of the solution `values[i, :]`.</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">            If `values` is shaped `(B, N, L)`, then there is also a batch</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">            dimension, so, `evals` is expected as a 2-dimensional tensor of</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">            shape `(B, N)`.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        The new state of PGPE.</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_functional_optimizer</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">_</span><span class="p">,</span> <span class="n">optimizer_ask</span><span class="p">,</span> <span class="n">optimizer_tell</span> <span class="o">=</span> <span class="n">get_functional_optimizer</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">optimizer</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="n">grad_func</span> <span class="o">=</span> <span class="n">_symmetric_grad</span> <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">symmetric</span> <span class="k">else</span> <span class="n">_nonsymmetric_grad</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="n">objective_sense</span> <span class="o">=</span> <span class="s2">&quot;max&quot;</span> <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">maximize</span> <span class="k">else</span> <span class="s2">&quot;min&quot;</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="n">grads</span> <span class="o">=</span> <span class="n">grad_func</span><span class="p">(</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="n">values</span><span class="p">,</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="n">evals</span><span class="p">,</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="n">mu</span><span class="o">=</span><span class="n">optimizer_ask</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">optimizer_state</span><span class="p">),</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="n">sigma</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">stdev</span><span class="p">,</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="n">objective_sense</span><span class="o">=</span><span class="n">objective_sense</span><span class="p">,</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="n">ranking_method</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="n">new_optimizer_state</span> <span class="o">=</span> <span class="n">optimizer_tell</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">optimizer_state</span><span class="p">,</span> <span class="n">follow_grad</span><span class="o">=</span><span class="n">grads</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">])</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="n">target_stdev</span> <span class="o">=</span> <span class="n">_follow_stdev_grad</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">stdev</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">stdev_learning_rate</span><span class="p">,</span> <span class="n">grads</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">])</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="n">new_stdev</span> <span class="o">=</span> <span class="n">modify_vector</span><span class="p">(</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="n">state</span><span class="o">.</span><span class="n">stdev</span><span class="p">,</span> <span class="n">target_stdev</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">stdev_min</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">stdev_max</span><span class="p">,</span> <span class="n">max_change</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">stdev_max_change</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="p">)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="k">return</span> <span class="n">PGPEState</span><span class="p">(</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="n">optimizer_state</span><span class="o">=</span><span class="n">new_optimizer_state</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="n">stdev</span><span class="o">=</span><span class="n">new_stdev</span><span class="p">,</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="n">stdev_learning_rate</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">stdev_learning_rate</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="n">stdev_min</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">stdev_min</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="n">stdev_max</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">stdev_max</span><span class="p">,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">stdev_max_change</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">stdev_max_change</span><span class="p">,</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">ranking_method</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">maximize</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">maximize</span><span class="p">,</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="n">symmetric</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">symmetric</span><span class="p">,</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 NNAISENSE SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>