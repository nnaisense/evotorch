
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="EvoTorch is an open source evolutionary computation library developed at NNAISENSE, built on top of PyTorch.">
      
      
      
      
        <link rel="prev" href="../algorithms/restarter/restart/">
      
      
        <link rel="next" href="baseneproblem/">
      
      
      <link rel="icon" href="../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Index - EvoTorch</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#evotorch.neuroevolution" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-header__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EvoTorch
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../quickstart/" class="md-tabs__link">
        
  
  
    
  
  Quickstart

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../user_guide/general_usage/" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../advanced_usage/solution_batch/" class="md-tabs__link">
          
  
  
    
  
  Advanced Usage

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-nav__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EvoTorch
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/general_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/algorithm_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithm Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/algorithms_tour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms Tour
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/problems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Defining Problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/problem_parallelization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Problem Parallelization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/neuroevolution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/gym/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution for Gym
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/supervised_ne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervised Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/solution_batch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manipulating Solutions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/dist_based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributed Evolution Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/custom_ea/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Searchers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/custom_logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Loggers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/ray_cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Ray Clusters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Brax_Experiments_Visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization of the brax Experiment Results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Brax_Experiments_with_PGPE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving a Brax environment using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Evolving_Objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Feature_Space_Illumination_with_MAPElites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Space Illumination with MAPElites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Genetic_Programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic Programming using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Gym_Experiments_with_PGPE_and_CoSyNE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gym Experiments with PGPE and CoSyNE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Minimizing_Lennard-Jones_Atom_Cluster_Potentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimising Lennard-Jones Atom Cluster Potentials with Evolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Training_MNIST30K/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training MNIST30K
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Variational_Quantum_Eigensolvers_with_SNES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variational Quantum Eigensolvers with SNES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/batched_searches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maintaining a batch of populations using the functional EvoTorch API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/constrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving constrained optimization problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/func_rl_ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving objects using the functional operators API of EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/functional_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic algorithm with the help of functional operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/multiobj_batched_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multiobjective optimization via functional operators API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving reinforcement learning tasks using functional evolutionary algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/reacher_mpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Predictive Control (MPC) with EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Evotorch
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Evotorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimizers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../algorithms/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8" id="__nav_6_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8">
            <span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/cmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ga
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/mapelites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mapelites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/pycmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pycmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/searchalgorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Searchalgorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../algorithms/distributed/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Distributed
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_7" id="__nav_6_1_8_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_7">
            <span class="md-nav__icon md-icon"></span>
            Distributed
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/distributed/gaussian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../algorithms/functional/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_8" id="__nav_6_1_8_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_8">
            <span class="md-nav__icon md-icon"></span>
            Functional
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/functional/funcadam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcadam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/functional/funccem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funccem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/functional/funcclipup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcclipup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/functional/funcpgpe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcpgpe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/functional/funcsgd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcsgd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/functional/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../algorithms/restarter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Restarter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_9" id="__nav_6_1_8_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_9">
            <span class="md-nav__icon md-icon"></span>
            Restarter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/restarter/modify_restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modify restart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/restarter/restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_6_1_9" id="__nav_6_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1_9">
            <span class="md-nav__icon md-icon"></span>
            Neuroevolution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="baseneproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Baseneproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="neproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="supervisedne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervisedne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="vecgymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecgymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="net/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Net
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9_7" id="__nav_6_1_9_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_9_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9_7">
            <span class="md-nav__icon md-icon"></span>
            Net
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="net/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="net/layers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="net/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="net/multilayered/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multilayered
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="net/parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="net/rl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rl
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="net/runningnorm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningnorm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="net/runningstat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningstat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="net/statefulmodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statefulmodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="net/vecrl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecrl
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../operators/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_10" id="__nav_6_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_10">
            <span class="md-nav__icon md-icon"></span>
            Operators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/real/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Real
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sequence
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../tools/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_11" id="__nav_6_1_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_11">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/cloning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/hook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/immutable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Immutable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/objectarray/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Objectarray
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/ranking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ranking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/readonlytensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Readonlytensor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/recursiveprintable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recursiveprintable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/structures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/tensorframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensorframe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/tensormaker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensormaker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.neuroevolution" class="md-nav__link">
    <span class="md-ellipsis">
      neuroevolution
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE" class="md-nav__link">
    <span class="md-ellipsis">
      GymNE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GymNE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.episode_count" class="md-nav__link">
    <span class="md-ellipsis">
      episode_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.interaction_count" class="md-nav__link">
    <span class="md-ellipsis">
      interaction_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.network_device" class="md-nav__link">
    <span class="md-ellipsis">
      network_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.observation_normalization" class="md-nav__link">
    <span class="md-ellipsis">
      observation_normalization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.get_env" class="md-nav__link">
    <span class="md-ellipsis">
      get_env
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.get_observation_stats" class="md-nav__link">
    <span class="md-ellipsis">
      get_observation_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.pop_observation_stats" class="md-nav__link">
    <span class="md-ellipsis">
      pop_observation_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.save_solution" class="md-nav__link">
    <span class="md-ellipsis">
      save_solution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.set_episode_count" class="md-nav__link">
    <span class="md-ellipsis">
      set_episode_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.set_interaction_count" class="md-nav__link">
    <span class="md-ellipsis">
      set_interaction_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.set_observation_stats" class="md-nav__link">
    <span class="md-ellipsis">
      set_observation_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.to_policy" class="md-nav__link">
    <span class="md-ellipsis">
      to_policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.update_observation_stats" class="md-nav__link">
    <span class="md-ellipsis">
      update_observation_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.GymNE.visualize" class="md-nav__link">
    <span class="md-ellipsis">
      visualize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.NEProblem" class="md-nav__link">
    <span class="md-ellipsis">
      NEProblem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NEProblem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.NEProblem.network_device" class="md-nav__link">
    <span class="md-ellipsis">
      network_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.NEProblem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.NEProblem.make_net" class="md-nav__link">
    <span class="md-ellipsis">
      make_net
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.NEProblem.network_constants" class="md-nav__link">
    <span class="md-ellipsis">
      network_constants
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.NEProblem.parameterize_net" class="md-nav__link">
    <span class="md-ellipsis">
      parameterize_net
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.SupervisedNE" class="md-nav__link">
    <span class="md-ellipsis">
      SupervisedNE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SupervisedNE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.SupervisedNE.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.SupervisedNE.get_minibatch" class="md-nav__link">
    <span class="md-ellipsis">
      get_minibatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.SupervisedNE.loss" class="md-nav__link">
    <span class="md-ellipsis">
      loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.SupervisedNE.make_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      make_dataloader
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE" class="md-nav__link">
    <span class="md-ellipsis">
      VecGymNE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VecGymNE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.episode_count" class="md-nav__link">
    <span class="md-ellipsis">
      episode_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.interaction_count" class="md-nav__link">
    <span class="md-ellipsis">
      interaction_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.max_num_envs" class="md-nav__link">
    <span class="md-ellipsis">
      max_num_envs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.network_device" class="md-nav__link">
    <span class="md-ellipsis">
      network_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.get_env" class="md-nav__link">
    <span class="md-ellipsis">
      get_env
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.get_observation_stats" class="md-nav__link">
    <span class="md-ellipsis">
      get_observation_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.make_net" class="md-nav__link">
    <span class="md-ellipsis">
      make_net
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.pop_observation_stats" class="md-nav__link">
    <span class="md-ellipsis">
      pop_observation_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.save_solution" class="md-nav__link">
    <span class="md-ellipsis">
      save_solution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.set_episode_count" class="md-nav__link">
    <span class="md-ellipsis">
      set_episode_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.set_interaction_count" class="md-nav__link">
    <span class="md-ellipsis">
      set_interaction_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.set_observation_stats" class="md-nav__link">
    <span class="md-ellipsis">
      set_observation_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.to_policy" class="md-nav__link">
    <span class="md-ellipsis">
      to_policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.neuroevolution.VecGymNE.update_observation_stats" class="md-nav__link">
    <span class="md-ellipsis">
      update_observation_stats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Index</h1>

<div class="doc doc-object doc-module">



<a id="evotorch.neuroevolution"></a>
    <div class="doc doc-contents first">

        <p>Problem types for neuroevolution</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="evotorch.neuroevolution.GymNE" class="doc doc-heading">
            <code>GymNE</code>


<a href="#evotorch.neuroevolution.GymNE" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="NEProblem (evotorch.neuroevolution.neproblem.NEProblem)" href="neproblem/#evotorch.neuroevolution.neproblem.NEProblem">NEProblem</a></code></p>


        <p>Representation of a NEProblem where the goal is to maximize
the total reward obtained in a <code>gym</code> environment.</p>







              <details class="quote">
                <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="k">class</span><span class="w"> </span><span class="nc">GymNE</span><span class="p">(</span><span class="n">NEProblem</span><span class="p">):</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Representation of a NEProblem where the goal is to maximize</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    the total reward obtained in a `gym` environment.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">env</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">network</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">env_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">network_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">env_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">observation_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">num_episodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">episode_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">decrease_rewards_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">alive_bonus_schedule</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">action_noise_stdev</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">num_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="n">initial_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundsPairLike</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">),</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="p">):</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        `__init__(...)`: Initialize the GymNE.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            env: The gym environment to solve. Expected as a Callable</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">                (maybe a function returning a gym.Env, or maybe a gym.Env</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">                subclass), or as a string referring to a gym environment</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">                ID (e.g. &quot;Ant-v4&quot;, &quot;Humanoid-v4&quot;, etc.).</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            network: A network structure string, or a Callable (which can be</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">                a class inheriting from `torch.nn.Module`, or a function</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">                which returns a `torch.nn.Module` instance), or an instance</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">                of `torch.nn.Module`.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">                The object provided here determines the structure of the</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">                neural network policy whose parameters will be evolved.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">                A network structure string is a string which can be processed</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">                by `evotorch.neuroevolution.net.str_to_net(...)`.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">                Please see the documentation of the function</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">                `evotorch.neuroevolution.net.str_to_net(...)` to see how such</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">                a neural network structure string looks like.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">                Note that this network can be a recurrent network.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">                When the network&#39;s `forward(...)` method can optionally accept</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">                an additional positional argument for the hidden state of the</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">                network and returns an additional value for its next state,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">                then the policy is treated as a recurrent one.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">                When the network is given as a callable object (e.g.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">                a subclass of `nn.Module` or a function) and this callable</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">                object is decorated via `evotorch.decorators.pass_info`,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">                the following keyword arguments will be passed:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">                (i) `obs_length` (the length of the observation vector),</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">                (ii) `act_length` (the length of the action vector),</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">                (iii) `obs_shape` (the shape tuple of the observation space),</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">                (iv) `act_shape` (the shape tuple of the action space),</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">                (v) `obs_space` (the Box object specifying the observation</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">                space, and</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">                (vi) `act_space` (the Box object specifying the action</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">                space). Note that `act_space` will always be given as a</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">                `gym.spaces.Box` instance, even when the actual gym</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">                environment has a discrete action space. This because `GymNE`</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">                always expects the neural network to return a tensor of</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">                floating-point numbers.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            env_name: Deprecated alias for the keyword argument `env`.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">                It is recommended to use the argument `env` instead.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            network_args: Optionally a dict-like object, storing keyword</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                arguments to be passed to the network while instantiating it.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            env_config: Keyword arguments to pass to `gym.make(...)` while</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">                creating the `gym` environment.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            observation_normalization: Whether or not to do online observation</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">                normalization.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            num_episodes: Number of episodes over which a single solution will</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">                be evaluated.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            episode_length: Maximum amount of simulator interactions allowed</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">                in a single episode. If left as None, whether or not an episode</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">                is terminated is determined only by the `gym` environment</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">                itself.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            decrease_rewards_by: Some gym env.s are defined in such a way that</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">                the agent gets a constant reward for each timestep</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">                it survives. This constant reward can also be called</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">                &quot;survival bonus&quot;. Such a rewarding scheme can lead the</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">                evolution to local optima where the agent does nothing</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">                but does not die either, just to collect the survival</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">                bonuses. To prevent this, it can be desired to</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">                remove the survival bonuses from each reward obtained.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">                If this is the case with the problem at hand,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">                the user can set the argument `decrease_rewards_by`</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">                to a positive float number, and that number will</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">                be subtracted from each reward.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            alive_bonus_schedule: Use this to add a customized amount of</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">                alive bonus.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">                If left as None (which is the default), additional alive</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">                bonus will not be added.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">                If given as a tuple `(t, b)`, an alive bonus `b` will be</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">                added onto all the rewards beyond the timestep `t`.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">                If given as a tuple `(t0, t1, b)`, a partial (linearly</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">                increasing towards `b`) alive bonus will be added onto</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">                all the rewards between the timesteps `t0` and `t1`,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">                and a full alive bonus (which equals to `b`) will be added</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">                onto all the rewards beyond the timestep `t1`.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            action_noise_stdev: If given as a real number `s`, then, for</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">                each generated action, Gaussian noise with standard</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">                deviation `s` will be sampled, and then this sampled noise</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">                will be added onto the action.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">                If action noise is not desired, then this argument can be</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">                left as None.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            num_actors: Number of actors to create for parallelized</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">                evaluation of the solutions.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">                One can also set this as &quot;max&quot;, which means that</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">                an actor will be created on each available CPU.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">                When the parallelization is enabled each actor will have its</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                own instance of the `gym` environment.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            actor_config: A dictionary, representing the keyword arguments</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">                to be passed to the options(...) used when creating the</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">                ray actor objects. To be used for explicitly allocating</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">                resources per each actor.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">                For example, for declaring that each actor is to use a GPU,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">                one can pass `actor_config=dict(num_gpus=1)`.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">                Can also be given as None (which is the default),</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">                if no such options are to be passed.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            num_subbatches: If `num_subbatches` is None (assuming that</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">                `subbatch_size` is also None), then, when evaluating a</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">                population, the population will be split into n pieces, `n`</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">                being the number of actors, and each actor will evaluate</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">                its assigned piece. If `num_subbatches` is an integer `m`,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">                then the population will be split into `m` pieces,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">                and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">                piece as they finish their current tasks.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">                The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">                be given values other than None at the same time.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            subbatch_size: If `subbatch_size` is None (assuming that</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">                `num_subbatches` is also None), then, when evaluating a</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">                population, the population will be split into `n` pieces, `n`</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">                being the number of actors, and each actor will evaluate its</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">                assigned piece. If `subbatch_size` is an integer `m`,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">                then the population will be split into pieces of size `m`,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">                and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">                piece as they finish their current tasks.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">                When there can be significant difference across the solutions</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">                in terms of computational requirements, specifying a</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">                `subbatch_size` can be beneficial, because, while one</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">                actor is busy with a subbatch containing computationally</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">                challenging solutions, other actors can accept more</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">                tasks and save time.</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">                The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">                be given values other than None at the same time.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            initial_bounds: Specifies an interval from which the values of the</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">                initial policy parameters will be drawn.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="c1"># Store various environment information</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">env</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">env_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span> <span class="o">=</span> <span class="n">env</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">env</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">env_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span> <span class="o">=</span> <span class="n">env_name</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">env</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">env_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                <span class="sa">f</span><span class="s2">&quot;Received values for both `env` (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">env</span><span class="p">)</span><span class="si">}</span><span class="s2">) and `env_name` (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">env_name</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="sa">f</span><span class="s2">&quot; Please specify the environment to solve via only one of these arguments, not both.&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Environment name is missing. Please specify it via the argument `env`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="c1"># Make sure that the network argument is not missing.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">if</span> <span class="n">network</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                <span class="s2">&quot;Received None via the argument `network`.&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span class="s2">&quot;Please provide the network as a string, or as a `Callable`, or as a `torch.nn.Module` instance.&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="c1"># Store various environment information</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">env_config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">deepcopy</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">env_config</span><span class="p">))</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_decrease_rewards_by</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="n">decrease_rewards_by</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">decrease_rewards_by</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="o">=</span> <span class="n">alive_bonus_schedule</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_action_noise_stdev</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">action_noise_stdev</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">action_noise_stdev</span><span class="p">)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_observation_normalization</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">observation_normalization</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_episodes</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_episode_length</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">episode_length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">episode_length</span><span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_info_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cumulative_reward</span><span class="o">=</span><span class="s2">&quot;avg&quot;</span><span class="p">,</span> <span class="n">interaction_count</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunningStat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunningStat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="c1"># Create a temporary environment to read its dimensions</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">tmp_env</span> <span class="o">=</span> <span class="n">_make_env</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">))</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="c1"># Store the temporary environment&#39;s dimensions</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tmp_env</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">):</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_act_length</span> <span class="o">=</span> <span class="n">tmp_env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_box_act_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">),</span> <span class="n">high</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_act_length</span><span class="p">,))</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_act_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_box_act_space</span> <span class="o">=</span> <span class="n">tmp_env</span><span class="o">.</span><span class="n">action_space</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_act_space</span> <span class="o">=</span> <span class="n">tmp_env</span><span class="o">.</span><span class="n">action_space</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_space</span> <span class="o">=</span> <span class="n">tmp_env</span><span class="o">.</span><span class="n">observation_space</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_shape</span> <span class="o">=</span> <span class="n">tmp_env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="c1"># Validate the space types of the environment</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">ensure_space_types</span><span class="p">(</span><span class="n">tmp_env</span><span class="p">)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="o">=</span> <span class="n">RunningStat</span><span class="p">()</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="o">=</span> <span class="n">RunningStat</span><span class="p">()</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="n">objective_sense</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>  <span class="c1"># RL is maximization</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>  <span class="c1"># Using the policy as the network</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="n">network_args</span><span class="o">=</span><span class="n">network_args</span><span class="p">,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="n">initial_bounds</span><span class="o">=</span><span class="n">initial_bounds</span><span class="p">,</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="n">num_actors</span><span class="o">=</span><span class="n">num_actors</span><span class="p">,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="n">actor_config</span><span class="o">=</span><span class="n">actor_config</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="n">subbatch_size</span><span class="o">=</span><span class="n">subbatch_size</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">after_eval_hook</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extra_status</span><span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_network_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="s2">&quot;obs_length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_length</span><span class="p">,</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="s2">&quot;act_length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_act_length</span><span class="p">,</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="s2">&quot;obs_space&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_space</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="s2">&quot;act_space&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_box_act_space</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="s2">&quot;obs_shape&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_space</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="s2">&quot;act_shape&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_box_act_space</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="p">}</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_str_network_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="s2">&quot;obs_space&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_space</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="s2">&quot;act_space&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_box_act_space</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="p">}</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_instantiate_new_env</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">env_config</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">)}</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="n">env</span> <span class="o">=</span> <span class="n">_make_env</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="o">**</span><span class="n">env_config</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="n">env</span> <span class="o">=</span> <span class="n">AliveBonusScheduleWrapper</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span><span class="p">)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="k">return</span> <span class="n">env</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_env</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate_new_env</span><span class="p">()</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_normalize_observation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observation</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">update_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="n">observation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="k">if</span> <span class="n">update_stats</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="k">return</span> <span class="n">observation</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_use_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observation</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action_noise_stdev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>                <span class="n">result</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_gaussian</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stdev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_action_noise_stdev</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="p">)</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">()</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">):</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_prepare</span><span class="p">()</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">()</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">network_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Device</span><span class="p">:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The device on which the problem should place data e.g. the network</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        In the case of GymNE, supported Gym environments return numpy arrays on CPU which are converted to Tensors</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        Therefore, it is almost always optimal to place the network on CPU</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_rollout</span><span class="p">(</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="n">policy</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="n">update_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="n">visualize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="n">decrease_rewards_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Peform a rollout of a network&quot;&quot;&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="k">if</span> <span class="n">decrease_rewards_by</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="n">decrease_rewards_by</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decrease_rewards_by</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="n">decrease_rewards_by</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">decrease_rewards_by</span><span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="n">policy</span> <span class="o">=</span> <span class="n">ensure_stateful</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="n">policy</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="k">if</span> <span class="n">visualize</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate_new_env</span><span class="p">(</span><span class="n">render_mode</span><span class="o">=</span><span class="s2">&quot;human&quot;</span><span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">()</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="n">observation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_observation</span><span class="p">(</span><span class="n">reset_env</span><span class="p">(</span><span class="n">env</span><span class="p">),</span> <span class="n">update_stats</span><span class="o">=</span><span class="n">update_stats</span><span class="p">)</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">if</span> <span class="n">visualize</span><span class="p">:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">cumulative_reward</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="n">observation</span><span class="p">,</span> <span class="n">raw_reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">take_step_in_env</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_policy</span><span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="n">policy</span><span class="p">))</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="n">reward</span> <span class="o">=</span> <span class="n">raw_reward</span> <span class="o">-</span> <span class="n">decrease_rewards_by</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="k">if</span> <span class="n">update_stats</span><span class="p">:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="k">if</span> <span class="n">visualize</span><span class="p">:</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>                <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="n">observation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_observation</span><span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="n">update_stats</span><span class="o">=</span><span class="n">update_stats</span><span class="p">)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="n">cumulative_reward</span> <span class="o">+=</span> <span class="n">reward</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="k">if</span> <span class="n">done</span> <span class="ow">or</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_episode_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_episode_length</span><span class="p">)):</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>                <span class="k">if</span> <span class="n">update_stats</span><span class="p">:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                <span class="n">final_info</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cumulative_reward</span><span class="o">=</span><span class="n">cumulative_reward</span><span class="p">,</span> <span class="n">interaction_count</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_keys</span><span class="p">:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">final_info</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                        <span class="n">final_info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                <span class="k">return</span> <span class="n">final_info</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_nonserialized_attribs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_nonserialized_attribs</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;_env&quot;</span><span class="p">]</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="n">policy</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">],</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="n">update_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="n">visualize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="n">num_episodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">decrease_rewards_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        Evaluate the policy on the gym environment.</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">            policy: The policy to be evaluated. This can be a torch module</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">                or a sequence of real numbers representing the parameters</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">                of a policy network.</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">            update_stats: Whether or not to update the observation</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">                normalization data while running the policy. If observation</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">                normalization is not enabled, then this argument will be</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">                ignored.</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            visualize: Whether or not to render the environment while running</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">                the policy.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">            num_episodes: Over how many episodes will the policy be evaluated.</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">                Expected as None (which is the default), or as an integer.</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">                If given as None, then the `num_episodes` value that was given</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">                while initializing this GymNE will be used.</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">            decrease_rewards_by: How much each reward value should be</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">                decreased. If left as None, the `decrease_rewards_by` value</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">                value that was given while initializing this GymNE will be</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">                used.</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">            A dictionary containing the score and the timestep count.</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>            <span class="n">policy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_net</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="k">if</span> <span class="n">num_episodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="n">num_episodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>            <span class="n">policy</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>            <span class="n">episode_results</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_rollout</span><span class="p">(</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                    <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                    <span class="n">update_stats</span><span class="o">=</span><span class="n">update_stats</span><span class="p">,</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                    <span class="n">visualize</span><span class="o">=</span><span class="n">visualize</span><span class="p">,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                    <span class="n">decrease_rewards_by</span><span class="o">=</span><span class="n">decrease_rewards_by</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                <span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_episodes</span><span class="p">)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="p">]</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">_accumulate_all_across_dicts</span><span class="p">(</span><span class="n">episode_results</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_keys</span><span class="p">)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>            <span class="k">return</span> <span class="n">results</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="n">policy</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visualize</span><span class="p">(</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="n">policy</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">],</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="n">update_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">num_episodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">decrease_rewards_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        Evaluate the policy and render its actions in the environment.</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">            policy: The policy to be evaluated. This can be a torch module</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">                or a sequence of real numbers representing the parameters</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">                of a policy network.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">            update_stats: Whether or not to update the observation</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">                normalization data while running the policy. If observation</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">                normalization is not enabled, then this argument will be</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">                ignored.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">            num_episodes: Over how many episodes will the policy be evaluated.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">                Expected as None (which is the default), or as an integer.</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">                If given as None, then the `num_episodes` value that was given</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">                while initializing this GymNE will be used.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">            decrease_rewards_by: How much each reward value should be</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">                decreased. If left as None, the `decrease_rewards_by` value</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">                value that was given while initializing this GymNE will be</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">                used.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">            A dictionary containing the score and the timestep count.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="p">,</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="n">update_stats</span><span class="o">=</span><span class="n">update_stats</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="n">visualize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="n">num_episodes</span><span class="o">=</span><span class="n">num_episodes</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="n">decrease_rewards_by</span><span class="o">=</span><span class="n">decrease_rewards_by</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>        <span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_ensure_obsnorm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This feature can only be used when observation_normalization=True.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunningStat</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_sync_data_for_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">obs_stats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_observation_stats</span><span class="p">())</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rs</span><span class="p">:</span> <span class="n">RunningStat</span><span class="p">):</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_use_sync_data_from_main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">received</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">received</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;obs_stats&quot;</span><span class="p">:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_observation_stats</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pop_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunningStat</span><span class="p">:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get and clear the collected observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="o">=</span> <span class="n">RunningStat</span><span class="p">()</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_sync_data_for_main</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="n">result</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">episode_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span><span class="p">,</span> <span class="n">interaction_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span><span class="p">)</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_stats_delta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_observation_stats</span><span class="p">()</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rs</span><span class="p">:</span> <span class="n">RunningStat</span><span class="p">):</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the observation stats via another RunningStat instance&quot;&quot;&quot;</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_use_sync_data_from_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">received</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="n">total_episode_count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="n">total_interaction_count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">received</span><span class="p">:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>            <span class="n">total_episode_count</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;episode_count&quot;</span><span class="p">]</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>            <span class="n">total_interaction_count</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;interaction_count&quot;</span><span class="p">]</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_observation_stats</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;obs_stats_delta&quot;</span><span class="p">])</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_episode_count</span><span class="p">(</span><span class="n">total_episode_count</span><span class="p">)</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_interaction_count</span><span class="p">(</span><span class="n">total_interaction_count</span><span class="p">)</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_pickle_data_for_main</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="c1"># For when the main Problem object (the non-remote one) gets pickled,</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="c1"># this function returns the counters of this remote Problem instance,</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="c1"># to be sent to the main one.</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">interaction_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span><span class="p">,</span> <span class="n">episode_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span><span class="p">)</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_use_pickle_data_from_main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="c1"># For when a newly unpickled Problem object gets (re)parallelized,</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="c1"># this function restores the inner states specific to this remote</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="c1"># worker. In the case of GymNE, those inner states are episode</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="c1"># and interaction counters.</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;episode_count&quot;</span><span class="p">:</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_episode_count</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;interaction_count&quot;</span><span class="p">:</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_interaction_count</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When restoring the inner state of a remote worker, unrecognized state key: </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_extra_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">total_interaction_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span><span class="p">,</span> <span class="n">total_episode_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span><span class="p">)</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">observation_normalization</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">        Get whether or not observation normalization is enabled.</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observation_normalization</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_episode_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">        Set the episode count manually.</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_interaction_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">        Set the interaction count manually.</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">interaction_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">        Get the total number of simulator interactions made.</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">episode_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        Get the total number of episodes completed.</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_local_episode_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_local_interaction_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_evaluate_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>            <span class="n">policy</span><span class="p">,</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="n">update_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>            <span class="n">visualize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>            <span class="n">num_episodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span><span class="p">,</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>            <span class="n">decrease_rewards_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_decrease_rewards_by</span><span class="p">,</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>        <span class="p">)</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;cumulative_reward&quot;</span><span class="p">]</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">clip_actions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">        Convert the given parameter vector to a policy as a PyTorch module.</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">        If the problem is configured to have observation normalization,</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">        the PyTorch module also contains an additional normalization layer.</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">            x: An sequence of real numbers, containing the parameters</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">                of a policy. Can be a PyTorch tensor, a numpy array,</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">                or a Solution.</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">            clip_actions: Whether or not to add an action clipping layer so</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">                that the generated actions will always be within an</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">                acceptable range for the environment.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">            The policy expressed by the parameters.</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>        <span class="n">policy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>            <span class="n">policy</span> <span class="o">=</span> <span class="n">ObsNormWrapperModule</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="p">)</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="k">if</span> <span class="n">clip_actions</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">()</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="n">policy</span> <span class="o">=</span> <span class="n">ActClipWrapperModule</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">()</span><span class="o">.</span><span class="n">action_space</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="k">return</span> <span class="n">policy</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">fname</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">        Save the solution into a pickle file.</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">        Among the saved data within the pickle file are the solution</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">        (as a PyTorch tensor), the policy (as a `torch.nn.Module` instance),</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">        and observation stats (if any).</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">            solution: The solution to be saved. This can be a PyTorch tensor,</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">                a `Solution` instance, or any `Iterable`.</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">            fname: The file name of the pickle file to be created.</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="c1"># Convert the solution to a PyTorch tensor on the cpu.</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">ReadOnlyTensor</span><span class="p">):</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">as_subclass</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="n">policy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_policy</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="c1"># Store the solution and the policy.</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>            <span class="s2">&quot;solution&quot;</span><span class="p">:</span> <span class="n">solution</span><span class="p">,</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>            <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="n">policy</span><span class="p">,</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="p">}</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="c1"># If available, store the observation stats.</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_stdev&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">stdev</span><span class="p">)</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_sum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_sum_of_squares&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">sum_of_squares</span><span class="p">)</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="c1"># Some additional data.</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;interaction_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;episode_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="c1"># If the environment is specified via a string ID, then store that ID.</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;env&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="c1"># Save the dictionary which stores the data.</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_env</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">:</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">        Get the gym environment stored by this GymNE instance</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="evotorch.neuroevolution.GymNE.episode_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">episode_count</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.neuroevolution.GymNE.episode_count" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the total number of episodes completed.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.neuroevolution.GymNE.interaction_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interaction_count</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.neuroevolution.GymNE.interaction_count" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the total number of simulator interactions made.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.neuroevolution.GymNE.network_device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">network_device</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.neuroevolution.GymNE.network_device" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The device on which the problem should place data e.g. the network
In the case of GymNE, supported Gym environments return numpy arrays on CPU which are converted to Tensors
Therefore, it is almost always optimal to place the network on CPU</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.neuroevolution.GymNE.observation_normalization" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">observation_normalization</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.neuroevolution.GymNE.observation_normalization" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get whether or not observation normalization is enabled.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">network</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">env_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">network_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">env_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">observation_normalization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_episodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">episode_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decrease_rewards_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alive_bonus_schedule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">action_noise_stdev</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_actors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">actor_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_subbatches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subbatch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1e-05</span><span class="p">,</span> <span class="mf">1e-05</span><span class="p">))</span></code>

<a href="#evotorch.neuroevolution.GymNE.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the GymNE.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>env</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Callable">Callable</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The gym environment to solve. Expected as a Callable
(maybe a function returning a gym.Env, or maybe a gym.Env
subclass), or as a string referring to a gym environment
ID (e.g. "Ant-v4", "Humanoid-v4", etc.).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>network</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="torch.nn.Module">Module</span>, <span title="typing.Callable">Callable</span>[[], <span title="torch.nn.Module">Module</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A network structure string, or a Callable (which can be
a class inheriting from <code>torch.nn.Module</code>, or a function
which returns a <code>torch.nn.Module</code> instance), or an instance
of <code>torch.nn.Module</code>.
The object provided here determines the structure of the
neural network policy whose parameters will be evolved.
A network structure string is a string which can be processed
by <code>evotorch.neuroevolution.net.str_to_net(...)</code>.
Please see the documentation of the function
<code>evotorch.neuroevolution.net.str_to_net(...)</code> to see how such
a neural network structure string looks like.
Note that this network can be a recurrent network.
When the network's <code>forward(...)</code> method can optionally accept
an additional positional argument for the hidden state of the
network and returns an additional value for its next state,
then the policy is treated as a recurrent one.
When the network is given as a callable object (e.g.
a subclass of <code>nn.Module</code> or a function) and this callable
object is decorated via <code>evotorch.decorators.pass_info</code>,
the following keyword arguments will be passed:
(i) <code>obs_length</code> (the length of the observation vector),
(ii) <code>act_length</code> (the length of the action vector),
(iii) <code>obs_shape</code> (the shape tuple of the observation space),
(iv) <code>act_shape</code> (the shape tuple of the action space),
(v) <code>obs_space</code> (the Box object specifying the observation
space, and
(vi) <code>act_space</code> (the Box object specifying the action
space). Note that <code>act_space</code> will always be given as a
<code>gym.spaces.Box</code> instance, even when the actual gym
environment has a discrete action space. This because <code>GymNE</code>
always expects the neural network to return a tensor of
floating-point numbers.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>env_name</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Callable">Callable</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Deprecated alias for the keyword argument <code>env</code>.
It is recommended to use the argument <code>env</code> instead.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>network_args</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a dict-like object, storing keyword
arguments to be passed to the network while instantiating it.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>env_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="collections.abc.Mapping">Mapping</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to <code>gym.make(...)</code> while
creating the <code>gym</code> environment.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>observation_normalization</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to do online observation
normalization.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_episodes</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of episodes over which a single solution will
be evaluated.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>episode_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum amount of simulator interactions allowed
in a single episode. If left as None, whether or not an episode
is terminated is determined only by the <code>gym</code> environment
itself.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>decrease_rewards_by</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Some gym env.s are defined in such a way that
the agent gets a constant reward for each timestep
it survives. This constant reward can also be called
"survival bonus". Such a rewarding scheme can lead the
evolution to local optima where the agent does nothing
but does not die either, just to collect the survival
bonuses. To prevent this, it can be desired to
remove the survival bonuses from each reward obtained.
If this is the case with the problem at hand,
the user can set the argument <code>decrease_rewards_by</code>
to a positive float number, and that number will
be subtracted from each reward.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alive_bonus_schedule</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Use this to add a customized amount of
alive bonus.
If left as None (which is the default), additional alive
bonus will not be added.
If given as a tuple <code>(t, b)</code>, an alive bonus <code>b</code> will be
added onto all the rewards beyond the timestep <code>t</code>.
If given as a tuple <code>(t0, t1, b)</code>, a partial (linearly
increasing towards <code>b</code>) alive bonus will be added onto
all the rewards between the timesteps <code>t0</code> and <code>t1</code>,
and a full alive bonus (which equals to <code>b</code>) will be added
onto all the rewards beyond the timestep <code>t1</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>action_noise_stdev</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as a real number <code>s</code>, then, for
each generated action, Gaussian noise with standard
deviation <code>s</code> will be sampled, and then this sampled noise
will be added onto the action.
If action noise is not desired, then this argument can be
left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_actors</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of actors to create for parallelized
evaluation of the solutions.
One can also set this as "max", which means that
an actor will be created on each available CPU.
When the parallelization is enabled each actor will have its
own instance of the <code>gym</code> environment.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary, representing the keyword arguments
to be passed to the options(...) used when creating the
ray actor objects. To be used for explicitly allocating
resources per each actor.
For example, for declaring that each actor is to use a GPU,
one can pass <code>actor_config=dict(num_gpus=1)</code>.
Can also be given as None (which is the default),
if no such options are to be passed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_subbatches</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>num_subbatches</code> is None (assuming that
<code>subbatch_size</code> is also None), then, when evaluating a
population, the population will be split into n pieces, <code>n</code>
being the number of actors, and each actor will evaluate
its assigned piece. If <code>num_subbatches</code> is an integer <code>m</code>,
then the population will be split into <code>m</code> pieces,
and actors will continually accept the next unevaluated
piece as they finish their current tasks.
The arguments <code>num_subbatches</code> and <code>subbatch_size</code> cannot
be given values other than None at the same time.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subbatch_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>subbatch_size</code> is None (assuming that
<code>num_subbatches</code> is also None), then, when evaluating a
population, the population will be split into <code>n</code> pieces, <code>n</code>
being the number of actors, and each actor will evaluate its
assigned piece. If <code>subbatch_size</code> is an integer <code>m</code>,
then the population will be split into pieces of size <code>m</code>,
and actors will continually accept the next unevaluated
piece as they finish their current tasks.
When there can be significant difference across the solutions
in terms of computational requirements, specifying a
<code>subbatch_size</code> can be beneficial, because, while one
actor is busy with a subbatch containing computationally
challenging solutions, other actors can accept more
tasks and save time.
The arguments <code>num_subbatches</code> and <code>subbatch_size</code> cannot
be given values other than None at the same time.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_bounds</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.core.BoundsPairLike">BoundsPairLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies an interval from which the values of the
initial policy parameters will be drawn.</p>
              </div>
            </td>
            <td>
                  <code>(-1e-05, 1e-05)</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">env</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">network</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">env_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">network_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">env_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">observation_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">num_episodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">episode_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">decrease_rewards_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">alive_bonus_schedule</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">action_noise_stdev</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">num_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">initial_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundsPairLike</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">),</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="p">):</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    `__init__(...)`: Initialize the GymNE.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        env: The gym environment to solve. Expected as a Callable</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            (maybe a function returning a gym.Env, or maybe a gym.Env</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            subclass), or as a string referring to a gym environment</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            ID (e.g. &quot;Ant-v4&quot;, &quot;Humanoid-v4&quot;, etc.).</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        network: A network structure string, or a Callable (which can be</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            a class inheriting from `torch.nn.Module`, or a function</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            which returns a `torch.nn.Module` instance), or an instance</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            of `torch.nn.Module`.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            The object provided here determines the structure of the</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            neural network policy whose parameters will be evolved.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            A network structure string is a string which can be processed</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            by `evotorch.neuroevolution.net.str_to_net(...)`.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            Please see the documentation of the function</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            `evotorch.neuroevolution.net.str_to_net(...)` to see how such</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">            a neural network structure string looks like.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            Note that this network can be a recurrent network.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            When the network&#39;s `forward(...)` method can optionally accept</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            an additional positional argument for the hidden state of the</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">            network and returns an additional value for its next state,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">            then the policy is treated as a recurrent one.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">            When the network is given as a callable object (e.g.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            a subclass of `nn.Module` or a function) and this callable</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            object is decorated via `evotorch.decorators.pass_info`,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">            the following keyword arguments will be passed:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            (i) `obs_length` (the length of the observation vector),</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">            (ii) `act_length` (the length of the action vector),</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            (iii) `obs_shape` (the shape tuple of the observation space),</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            (iv) `act_shape` (the shape tuple of the action space),</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            (v) `obs_space` (the Box object specifying the observation</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            space, and</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            (vi) `act_space` (the Box object specifying the action</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            space). Note that `act_space` will always be given as a</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            `gym.spaces.Box` instance, even when the actual gym</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            environment has a discrete action space. This because `GymNE`</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            always expects the neural network to return a tensor of</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            floating-point numbers.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        env_name: Deprecated alias for the keyword argument `env`.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            It is recommended to use the argument `env` instead.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        network_args: Optionally a dict-like object, storing keyword</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            arguments to be passed to the network while instantiating it.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        env_config: Keyword arguments to pass to `gym.make(...)` while</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            creating the `gym` environment.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        observation_normalization: Whether or not to do online observation</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            normalization.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        num_episodes: Number of episodes over which a single solution will</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            be evaluated.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        episode_length: Maximum amount of simulator interactions allowed</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            in a single episode. If left as None, whether or not an episode</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            is terminated is determined only by the `gym` environment</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            itself.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        decrease_rewards_by: Some gym env.s are defined in such a way that</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            the agent gets a constant reward for each timestep</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            it survives. This constant reward can also be called</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            &quot;survival bonus&quot;. Such a rewarding scheme can lead the</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            evolution to local optima where the agent does nothing</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            but does not die either, just to collect the survival</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            bonuses. To prevent this, it can be desired to</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            remove the survival bonuses from each reward obtained.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            If this is the case with the problem at hand,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            the user can set the argument `decrease_rewards_by`</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            to a positive float number, and that number will</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            be subtracted from each reward.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        alive_bonus_schedule: Use this to add a customized amount of</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            alive bonus.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            If left as None (which is the default), additional alive</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            bonus will not be added.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            If given as a tuple `(t, b)`, an alive bonus `b` will be</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            added onto all the rewards beyond the timestep `t`.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            If given as a tuple `(t0, t1, b)`, a partial (linearly</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            increasing towards `b`) alive bonus will be added onto</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            all the rewards between the timesteps `t0` and `t1`,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            and a full alive bonus (which equals to `b`) will be added</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            onto all the rewards beyond the timestep `t1`.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        action_noise_stdev: If given as a real number `s`, then, for</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            each generated action, Gaussian noise with standard</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            deviation `s` will be sampled, and then this sampled noise</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            will be added onto the action.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            If action noise is not desired, then this argument can be</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            left as None.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        num_actors: Number of actors to create for parallelized</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            evaluation of the solutions.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            One can also set this as &quot;max&quot;, which means that</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            an actor will be created on each available CPU.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            When the parallelization is enabled each actor will have its</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            own instance of the `gym` environment.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        actor_config: A dictionary, representing the keyword arguments</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            to be passed to the options(...) used when creating the</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            ray actor objects. To be used for explicitly allocating</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            resources per each actor.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            For example, for declaring that each actor is to use a GPU,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            one can pass `actor_config=dict(num_gpus=1)`.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            Can also be given as None (which is the default),</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            if no such options are to be passed.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        num_subbatches: If `num_subbatches` is None (assuming that</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            `subbatch_size` is also None), then, when evaluating a</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            population, the population will be split into n pieces, `n`</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            being the number of actors, and each actor will evaluate</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            its assigned piece. If `num_subbatches` is an integer `m`,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">            then the population will be split into `m` pieces,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            piece as they finish their current tasks.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">            The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            be given values other than None at the same time.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        subbatch_size: If `subbatch_size` is None (assuming that</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">            `num_subbatches` is also None), then, when evaluating a</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            population, the population will be split into `n` pieces, `n`</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            being the number of actors, and each actor will evaluate its</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            assigned piece. If `subbatch_size` is an integer `m`,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            then the population will be split into pieces of size `m`,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            piece as they finish their current tasks.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            When there can be significant difference across the solutions</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            in terms of computational requirements, specifying a</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            `subbatch_size` can be beneficial, because, while one</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            actor is busy with a subbatch containing computationally</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            challenging solutions, other actors can accept more</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            tasks and save time.</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            be given values other than None at the same time.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        initial_bounds: Specifies an interval from which the values of the</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            initial policy parameters will be drawn.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="c1"># Store various environment information</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">env</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">env_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span> <span class="o">=</span> <span class="n">env</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">env</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">env_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span> <span class="o">=</span> <span class="n">env_name</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">env</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">env_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="sa">f</span><span class="s2">&quot;Received values for both `env` (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">env</span><span class="p">)</span><span class="si">}</span><span class="s2">) and `env_name` (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">env_name</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="sa">f</span><span class="s2">&quot; Please specify the environment to solve via only one of these arguments, not both.&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Environment name is missing. Please specify it via the argument `env`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="c1"># Make sure that the network argument is not missing.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">if</span> <span class="n">network</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="s2">&quot;Received None via the argument `network`.&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="s2">&quot;Please provide the network as a string, or as a `Callable`, or as a `torch.nn.Module` instance.&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="c1"># Store various environment information</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">env_config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">deepcopy</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">env_config</span><span class="p">))</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_decrease_rewards_by</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="n">decrease_rewards_by</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">decrease_rewards_by</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="o">=</span> <span class="n">alive_bonus_schedule</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_action_noise_stdev</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">action_noise_stdev</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">action_noise_stdev</span><span class="p">)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_observation_normalization</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">observation_normalization</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_episodes</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_episode_length</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">episode_length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">episode_length</span><span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_info_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cumulative_reward</span><span class="o">=</span><span class="s2">&quot;avg&quot;</span><span class="p">,</span> <span class="n">interaction_count</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunningStat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunningStat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="c1"># Create a temporary environment to read its dimensions</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">tmp_env</span> <span class="o">=</span> <span class="n">_make_env</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">))</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="c1"># Store the temporary environment&#39;s dimensions</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obs_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tmp_env</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">):</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_act_length</span> <span class="o">=</span> <span class="n">tmp_env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_box_act_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">),</span> <span class="n">high</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_act_length</span><span class="p">,))</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_act_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_box_act_space</span> <span class="o">=</span> <span class="n">tmp_env</span><span class="o">.</span><span class="n">action_space</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_act_space</span> <span class="o">=</span> <span class="n">tmp_env</span><span class="o">.</span><span class="n">action_space</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obs_space</span> <span class="o">=</span> <span class="n">tmp_env</span><span class="o">.</span><span class="n">observation_space</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obs_shape</span> <span class="o">=</span> <span class="n">tmp_env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="c1"># Validate the space types of the environment</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">ensure_space_types</span><span class="p">(</span><span class="n">tmp_env</span><span class="p">)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="o">=</span> <span class="n">RunningStat</span><span class="p">()</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="o">=</span> <span class="n">RunningStat</span><span class="p">()</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="n">objective_sense</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>  <span class="c1"># RL is maximization</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>  <span class="c1"># Using the policy as the network</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="n">network_args</span><span class="o">=</span><span class="n">network_args</span><span class="p">,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">initial_bounds</span><span class="o">=</span><span class="n">initial_bounds</span><span class="p">,</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="n">num_actors</span><span class="o">=</span><span class="n">num_actors</span><span class="p">,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="n">actor_config</span><span class="o">=</span><span class="n">actor_config</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">subbatch_size</span><span class="o">=</span><span class="n">subbatch_size</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">after_eval_hook</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extra_status</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.get_env" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_env</span><span class="p">()</span></code>

<a href="#evotorch.neuroevolution.GymNE.get_env" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the gym environment stored by this GymNE instance</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_env</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">:</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">    Get the gym environment stored by this GymNE instance</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.get_observation_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_observation_stats</span><span class="p">()</span></code>

<a href="#evotorch.neuroevolution.GymNE.get_observation_stats" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the observation stats</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunningStat</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.pop_observation_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pop_observation_stats</span><span class="p">()</span></code>

<a href="#evotorch.neuroevolution.GymNE.pop_observation_stats" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get and clear the collected observation stats</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="k">def</span><span class="w"> </span><span class="nf">pop_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunningStat</span><span class="p">:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get and clear the collected observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="o">=</span> <span class="n">RunningStat</span><span class="p">()</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">update_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">visualize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_episodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decrease_rewards_by</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.GymNE.run" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Evaluate the policy on the gym environment.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>policy</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="torch.nn.Module">Module</span>, <span title="typing.Iterable">Iterable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The policy to be evaluated. This can be a torch module
or a sequence of real numbers representing the parameters
of a policy network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>update_stats</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to update the observation
normalization data while running the policy. If observation
normalization is not enabled, then this argument will be
ignored.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>visualize</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to render the environment while running
the policy.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_episodes</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Over how many episodes will the policy be evaluated.
Expected as None (which is the default), or as an integer.
If given as None, then the <code>num_episodes</code> value that was given
while initializing this GymNE will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>decrease_rewards_by</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How much each reward value should be
decreased. If left as None, the <code>decrease_rewards_by</code> value
value that was given while initializing this GymNE will be
used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="n">policy</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">],</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="n">update_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="n">visualize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="n">num_episodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="n">decrease_rewards_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    Evaluate the policy on the gym environment.</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">        policy: The policy to be evaluated. This can be a torch module</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">            or a sequence of real numbers representing the parameters</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">            of a policy network.</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        update_stats: Whether or not to update the observation</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">            normalization data while running the policy. If observation</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">            normalization is not enabled, then this argument will be</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">            ignored.</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        visualize: Whether or not to render the environment while running</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            the policy.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        num_episodes: Over how many episodes will the policy be evaluated.</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">            Expected as None (which is the default), or as an integer.</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">            If given as None, then the `num_episodes` value that was given</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">            while initializing this GymNE will be used.</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        decrease_rewards_by: How much each reward value should be</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">            decreased. If left as None, the `decrease_rewards_by` value</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">            value that was given while initializing this GymNE will be</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">            used.</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">        A dictionary containing the score and the timestep count.</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">policy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_net</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="k">if</span> <span class="n">num_episodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="n">num_episodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">policy</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="n">episode_results</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rollout</span><span class="p">(</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                <span class="n">update_stats</span><span class="o">=</span><span class="n">update_stats</span><span class="p">,</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                <span class="n">visualize</span><span class="o">=</span><span class="n">visualize</span><span class="p">,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                <span class="n">decrease_rewards_by</span><span class="o">=</span><span class="n">decrease_rewards_by</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_episodes</span><span class="p">)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="p">]</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="n">results</span> <span class="o">=</span> <span class="n">_accumulate_all_across_dicts</span><span class="p">(</span><span class="n">episode_results</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_keys</span><span class="p">)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="k">return</span> <span class="n">results</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="n">policy</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.save_solution" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_solution</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.GymNE.save_solution" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Save the solution into a pickle file.
Among the saved data within the pickle file are the solution
(as a PyTorch tensor), the policy (as a <code>torch.nn.Module</code> instance),
and observation stats (if any).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>solution</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solution to be saved. This can be a PyTorch tensor,
a <code>Solution</code> instance, or any <code>Iterable</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fname</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file name of the pickle file to be created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">fname</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">    Save the solution into a pickle file.</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">    Among the saved data within the pickle file are the solution</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">    (as a PyTorch tensor), the policy (as a `torch.nn.Module` instance),</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">    and observation stats (if any).</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">        solution: The solution to be saved. This can be a PyTorch tensor,</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">            a `Solution` instance, or any `Iterable`.</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">        fname: The file name of the pickle file to be created.</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="c1"># Convert the solution to a PyTorch tensor on the cpu.</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">ReadOnlyTensor</span><span class="p">):</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">as_subclass</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>    <span class="n">policy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_policy</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>    <span class="c1"># Store the solution and the policy.</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>        <span class="s2">&quot;solution&quot;</span><span class="p">:</span> <span class="n">solution</span><span class="p">,</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>        <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="n">policy</span><span class="p">,</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="p">}</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>    <span class="c1"># If available, store the observation stats.</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_stdev&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">stdev</span><span class="p">)</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_sum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_sum_of_squares&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">sum_of_squares</span><span class="p">)</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="c1"># Some additional data.</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;interaction_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;episode_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>    <span class="c1"># If the environment is specified via a string ID, then store that ID.</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;env&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>    <span class="c1"># Save the dictionary which stores the data.</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.set_episode_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_episode_count</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.GymNE.set_episode_count" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the episode count manually.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_episode_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">    Set the episode count manually.</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.set_interaction_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_interaction_count</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.GymNE.set_interaction_count" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the interaction count manually.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_interaction_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">    Set the interaction count manually.</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.set_observation_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_observation_stats</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.GymNE.set_observation_stats" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the observation stats</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rs</span><span class="p">:</span> <span class="n">RunningStat</span><span class="p">):</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.to_policy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_policy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">clip_actions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.GymNE.to_policy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert the given parameter vector to a policy as a PyTorch module.</p>
<p>If the problem is configured to have observation normalization,
the PyTorch module also contains an additional normalization layer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An sequence of real numbers, containing the parameters
of a policy. Can be a PyTorch tensor, a numpy array,
or a Solution.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clip_actions</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to add an action clipping layer so
that the generated actions will always be within an
acceptable range for the environment.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">clip_actions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">    Convert the given parameter vector to a policy as a PyTorch module.</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    If the problem is configured to have observation normalization,</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">    the PyTorch module also contains an additional normalization layer.</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        x: An sequence of real numbers, containing the parameters</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">            of a policy. Can be a PyTorch tensor, a numpy array,</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">            or a Solution.</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        clip_actions: Whether or not to add an action clipping layer so</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">            that the generated actions will always be within an</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">            acceptable range for the environment.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">        The policy expressed by the parameters.</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="n">policy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="n">policy</span> <span class="o">=</span> <span class="n">ObsNormWrapperModule</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="p">)</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="k">if</span> <span class="n">clip_actions</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">()</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="n">policy</span> <span class="o">=</span> <span class="n">ActClipWrapperModule</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">()</span><span class="o">.</span><span class="n">action_space</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>    <span class="k">return</span> <span class="n">policy</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.update_observation_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_observation_stats</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.GymNE.update_observation_stats" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the observation stats via another RunningStat instance</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rs</span><span class="p">:</span> <span class="n">RunningStat</span><span class="p">):</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the observation stats via another RunningStat instance&quot;&quot;&quot;</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.GymNE.visualize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visualize</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">update_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_episodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">decrease_rewards_by</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.GymNE.visualize" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Evaluate the policy and render its actions in the environment.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>policy</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="torch.nn.Module">Module</span>, <span title="typing.Iterable">Iterable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The policy to be evaluated. This can be a torch module
or a sequence of real numbers representing the parameters
of a policy network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>update_stats</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to update the observation
normalization data while running the policy. If observation
normalization is not enabled, then this argument will be
ignored.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_episodes</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Over how many episodes will the policy be evaluated.
Expected as None (which is the default), or as an integer.
If given as None, then the <code>num_episodes</code> value that was given
while initializing this GymNE will be used.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>decrease_rewards_by</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How much each reward value should be
decreased. If left as None, the <code>decrease_rewards_by</code> value
value that was given while initializing this GymNE will be
used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/gymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="k">def</span><span class="w"> </span><span class="nf">visualize</span><span class="p">(</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="n">policy</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">],</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>    <span class="n">update_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="n">num_episodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="n">decrease_rewards_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">    Evaluate the policy and render its actions in the environment.</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">        policy: The policy to be evaluated. This can be a torch module</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">            or a sequence of real numbers representing the parameters</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">            of a policy network.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">        update_stats: Whether or not to update the observation</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">            normalization data while running the policy. If observation</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">            normalization is not enabled, then this argument will be</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">            ignored.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">        num_episodes: Over how many episodes will the policy be evaluated.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">            Expected as None (which is the default), or as an integer.</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">            If given as None, then the `num_episodes` value that was given</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">            while initializing this GymNE will be used.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">        decrease_rewards_by: How much each reward value should be</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">            decreased. If left as None, the `decrease_rewards_by` value</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">            value that was given while initializing this GymNE will be</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">            used.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        A dictionary containing the score and the timestep count.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="p">,</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="n">update_stats</span><span class="o">=</span><span class="n">update_stats</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="n">visualize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="n">num_episodes</span><span class="o">=</span><span class="n">num_episodes</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="n">decrease_rewards_by</span><span class="o">=</span><span class="n">decrease_rewards_by</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.neuroevolution.NEProblem" class="doc doc-heading">
            <code>NEProblem</code>


<a href="#evotorch.neuroevolution.NEProblem" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseNEProblem (evotorch.neuroevolution.baseneproblem.BaseNEProblem)" href="baseneproblem/#evotorch.neuroevolution.baseneproblem.BaseNEProblem">BaseNEProblem</a></code></p>


        <p>Base class for neuro-evolution problems where the goal is to optimize the
parameters of a neural network represented as a PyTorch module.</p>
<p>Any problem inheriting from this class is expected to override the method
<code>_evaluate_network(self, net: torch.nn.Module) -&gt; Union[torch.Tensor, float]</code>
where <code>net</code> is the neural network to be evaluated, and the return value
is a scalar or a vector (for multi-objective cases) expressing the
fitness value(s).</p>
<p>Alternatively, this class can be directly instantiated in the following
way:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">MyTorchModuleClass</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="c1"># Evaluate the given PyTorch module here</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">fitness</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="k">return</span> <span class="n">fitness</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">problem</span> <span class="o">=</span> <span class="n">NEProblem</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">MyTorchModuleClass</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div>
<p>which specifies that the problem's goal is to minimize the return of the
function <code>f</code>.
For multi-objective cases, the fitness returned by <code>f</code> is expected as a
1-dimensional tensor. For when the problem has additional evaluation data,
a two-element tuple can be returned by <code>f</code> instead, where the first
element is the fitness value(s) and the second element is a 1-dimensional
tensor storing the additional data.</p>







              <details class="quote">
                <summary>Source code in <code>evotorch/neuroevolution/neproblem.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="k">class</span><span class="w"> </span><span class="nc">NEProblem</span><span class="p">(</span><span class="n">BaseNEProblem</span><span class="p">):</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Base class for neuro-evolution problems where the goal is to optimize the</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    parameters of a neural network represented as a PyTorch module.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Any problem inheriting from this class is expected to override the method</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    `_evaluate_network(self, net: torch.nn.Module) -&gt; Union[torch.Tensor, float]`</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    where `net` is the neural network to be evaluated, and the return value</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    is a scalar or a vector (for multi-objective cases) expressing the</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    fitness value(s).</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    Alternatively, this class can be directly instantiated in the following</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    way:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    def f(module: MyTorchModuleClass) -&gt; Union[float, torch.Tensor, tuple]:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        # Evaluate the given PyTorch module here</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        fitness = ...</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        return fitness</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    problem = NEProblem(&quot;min&quot;, MyTorchModuleClass, f, ...)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    ```</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    which specifies that the problem&#39;s goal is to minimize the return of the</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    function `f`.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    For multi-objective cases, the fitness returned by `f` is expected as a</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    1-dimensional tensor. For when the problem has additional evaluation data,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    a two-element tuple can be returned by `f` instead, where the first</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    element is the fitness value(s) and the second element is a 1-dimensional</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    tensor storing the additional data.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">objective_sense</span><span class="p">:</span> <span class="n">ObjectiveSense</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">network</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]],</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">network_eval_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">network_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">initial_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundsPairLike</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">),</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">eval_dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">eval_data_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">num_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">num_gpus_per_actor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="p">):</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        `__init__(...)`: Initialize the NEProblem.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            objective_sense: The objective sense, expected as &quot;min&quot; or &quot;max&quot;</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">                for single-objective cases, or as a sequence of strings</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">                (each string being &quot;min&quot; or &quot;max&quot;) for multi-objective cases.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            network: A network structure string, or a Callable (which can be</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">                a class inheriting from `torch.nn.Module`, or a function</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">                which returns a `torch.nn.Module` instance), or an instance</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">                of `torch.nn.Module`.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">                The object provided here determines the structure of the</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">                neural network whose parameters will be evolved.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">                A network structure string is a string which can be processed</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">                by `evotorch.neuroevolution.net.str_to_net(...)`.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">                Please see the documentation of the function</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">                `evotorch.neuroevolution.net.str_to_net(...)` to see how such</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">                a neural network structure string looks like.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            network_eval_func: Optionally a function (or any Callable object)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">                which receives a PyTorch module as its argument, and returns</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">                either a fitness, or a two-element tuple containing the fitness</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">                and the additional evaluation data. The fitness can be a scalar</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">                (for single-objective cases) or a 1-dimensional tensor (for</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">                multi-objective cases). The additional evaluation data is</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">                expected as a 1-dimensional tensor.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">                If this argument is left as None, it will be expected that</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">                the method `_evaluate_network(...)` is overriden by the</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">                inheriting class.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">            network_args: Optionally a dict-like object, storing keyword</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">                arguments to be passed to the network while instantiating it.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">            initial_bounds: Specifies an interval from which the values of the</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">                initial neural network parameters will be drawn.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            eval_dtype: dtype to be used for fitnesses. If not specified, then</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">                `eval_dtype` will be inferred from the dtype of the parameters</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">                of the neural network.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">                In more details, if the neural network&#39;s parameters have a</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">                float dtype, `eval_dtype` will be a compatible float.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">                Otherwise, it will be &quot;float32&quot;.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            eval_data_length: Length of the extra evaluation data.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            seed: Random number seed. If left as None, this NEProblem instance</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">                will not have its own random generator, and the global random</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">                generator of PyTorch will be used instead.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            num_actors: Number of actors to create for parallelized</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">                evaluation of the solutions.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">                Certain string values are also accepted.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">                When given as &quot;max&quot; or as &quot;num_cpus&quot;, the number of actors</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">                will be equal to the number of all available CPUs in the ray</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">                cluster.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">                When given as &quot;num_gpus&quot;, the number of actors will be</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                equal to the number of all available GPUs in the ray</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">                cluster, and each actor will be assigned a GPU.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">                When given as &quot;num_devices&quot;, the number of actors will be</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">                equal to the minimum among the number of CPUs and the number</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">                of GPUs available in the cluster (or will be equal to the</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">                number of CPUs if there is no GPU), and each actor will be</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">                assigned a GPU (if available).</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">                If `num_actors` is given as &quot;num_gpus&quot; or &quot;num_devices&quot;,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">                the argument `num_gpus_per_actor` must not be used,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">                and the `actor_config` dictionary must not contain the</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">                key &quot;num_gpus&quot;.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">                If `num_actors` is given as something other than &quot;num_gpus&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">                or &quot;num_devices&quot;, and if you wish to assign GPUs to each</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">                actor, then please see the argument `num_gpus_per_actor`.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            actor_config: A dictionary, representing the keyword arguments</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">                to be passed to the options(...) used when creating the</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">                ray actor objects. To be used for explicitly allocating</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">                resources per each actor.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">                For example, for declaring that each actor is to use a GPU,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">                one can pass `actor_config=dict(num_gpus=1)`.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">                Can also be given as None (which is the default),</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">                if no such options are to be passed.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            num_gpus_per_actor: Number of GPUs to be allocated by each</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">                remote actor.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">                The default behavior is to NOT allocate any GPU at all</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">                (which is the default behavior of the ray library as well).</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">                When given as a number `n`, each actor will be given</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">                `n` GPUs (where `n` can be an integer, or can be a `float`</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">                for fractional allocation).</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">                When given as a string &quot;max&quot;, then the available GPUs</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">                across the entire ray cluster (or within the local computer</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">                in the simplest cases) will be equally distributed among</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">                the actors.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">                When given as a string &quot;all&quot;, then each actor will have</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">                access to all the GPUs (this will be achieved by suppressing</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">                the environment variable `CUDA_VISIBLE_DEVICES` for each</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">                actor).</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">                When the problem is not distributed (i.e. when there are</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">                no actors), this argument is expected to be left as None.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            num_subbatches: If `num_subbatches` is None (assuming that</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">                `subbatch_size` is also None), then, when evaluating a</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">                population, the population will be split into n pieces, `n`</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">                being the number of actors, and each actor will evaluate</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">                its assigned piece. If `num_subbatches` is an integer `m`,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">                then the population will be split into `m` pieces,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">                piece as they finish their current tasks.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">                The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">                be given values other than None at the same time.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">                While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">                how many sub-batches will be generated, and therefore,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">                how many gradients will be computed by the remote actors.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            subbatch_size: If `subbatch_size` is None (assuming that</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">                `num_subbatches` is also None), then, when evaluating a</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">                population, the population will be split into `n` pieces, `n`</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">                being the number of actors, and each actor will evaluate its</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">                assigned piece. If `subbatch_size` is an integer `m`,</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">                then the population will be split into pieces of size `m`,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">                and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">                piece as they finish their current tasks.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">                When there can be significant difference across the solutions</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">                in terms of computational requirements, specifying a</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">                `subbatch_size` can be beneficial, because, while one</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">                actor is busy with a subbatch containing computationally</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">                challenging solutions, other actors can accept more</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">                tasks and save time.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">                The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">                be given values other than None at the same time.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">                While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">                the size of a sub-batch (or sub-population) sampled by a</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">                remote actor for computing a gradient.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">                In distributed mode, it is expected that the population size</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">                is divisible by `subbatch_size`.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            device: Default device in which a new population will be generated</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">                and the neural networks will operate.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">                If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="c1"># Set the main device of the problem</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="c1"># Although the operation of setting the main device is done by the main Problem class,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="c1"># here we need this at an earlier stage.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="c1"># Set the network</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span> <span class="o">=</span> <span class="n">network</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_network_args</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">network_args</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">network_args</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="c1"># Store the function that will evaluate the network, if available</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_network_eval_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="n">network_eval_func</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_network</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="c1"># Create temporary network</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">temp_network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate_net</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="n">objective_sense</span><span class="o">=</span><span class="n">objective_sense</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="n">initial_bounds</span><span class="o">=</span><span class="n">initial_bounds</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Neuroevolution is an unbounded problem</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="n">solution_length</span><span class="o">=</span><span class="n">count_parameters</span><span class="p">(</span><span class="n">temp_network</span><span class="p">),</span>  <span class="c1"># The solution length is inherited from the network passed</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="n">dtype</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">temp_network</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>  <span class="c1"># The datatype is inherited from the network passed</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="n">eval_dtype</span><span class="o">=</span><span class="n">eval_dtype</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="n">eval_data_length</span><span class="o">=</span><span class="n">eval_data_length</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="n">num_actors</span><span class="o">=</span><span class="n">num_actors</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="n">num_gpus_per_actor</span><span class="o">=</span><span class="n">num_gpus_per_actor</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="n">actor_config</span><span class="o">=</span><span class="n">actor_config</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="n">num_subbatches</span><span class="o">=</span><span class="n">num_subbatches</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="n">subbatch_size</span><span class="o">=</span><span class="n">subbatch_size</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="n">store_solution_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">network_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Device</span><span class="p">:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The device on which the problem should place data e.g. the network&quot;&quot;&quot;</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">cpu_device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="c1"># This is the case where this is the main process (not a remote actor)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">==</span> <span class="n">cpu_device</span><span class="p">:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                <span class="c1"># If the main device of the problem is &quot;cpu&quot;, then we assume that the network is going to be on the cpu as well</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                <span class="k">return</span> <span class="n">cpu_device</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>                <span class="c1"># If the main device of the problem is some other device, then it is that device into which the network will be put</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="c1"># If this is a remote actor, then the network will be put into the auxiliary device allocated for that actor</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_device</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_str_network_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        Named constants which will be passed to `str_to_net`.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        To be overridden by the user for custom fixed constants for a problem.</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_network_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        Named constants which will be passed to the network instantiation.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        To be overridden by the user for custom fixed constants for a problem.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">network_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Named constants which can be passed to the network instantiation&quot;&quot;&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="n">constants</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="n">constants</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_network_constants</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">constants</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_network_args</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="k">return</span> <span class="n">constants</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_nonserialized_attribs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;instantiated_network&quot;</span><span class="p">]</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_instantiate_net</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate the network on the target device, to be overridden by the user for custom behaviour</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">            instantiated_network (nn.Module): The network instantiated on the target device</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="c1"># Branching point determines instantiation of network</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="c1"># Passed argument was a string representation of a torch module</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="n">net_consts</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="n">net_consts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_constants</span><span class="p">())</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="n">net_consts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str_network_constants</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>            <span class="n">instantiated_network</span> <span class="o">=</span> <span class="n">str_to_net</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="o">**</span><span class="n">net_consts</span><span class="p">)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="c1"># Passed argument was directly a torch module</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="n">instantiated_network</span> <span class="o">=</span> <span class="n">network</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="c1"># Passed argument was callable yielding network</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="n">instantiated_network</span> <span class="o">=</span> <span class="n">pass_info_if_needed</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_network_constants</span><span class="p">)(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_network_args</span><span class="p">)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="c1"># Map to device</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_device</span> <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">device</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">instantiated_network</span> <span class="o">=</span> <span class="n">instantiated_network</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="k">return</span> <span class="n">instantiated_network</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate the network on the target device, if not already done&quot;&quot;&quot;</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate_net</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span><span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="c1"># Clear reference to original network</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">make_net</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        Make a new network filled with the provided parameters.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            parameters: Parameters to be used as weights within the network.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">                Can be a Solution, or any 1-dimensional Iterable that can be</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">                converted to a PyTorch tensor.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">            A new network, as a `torch.Module` instance.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">access_values</span><span class="p">(</span><span class="n">keep_evals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="n">net</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterize_net</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="k">return</span> <span class="n">net</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parameterize_net</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parameterize the network with a given set of parameters.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">            parameters (torch.Tensor): The parameters with which to instantiate the network</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">            instantiated_network (nn.Module): The network instantiated with the parameters</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="c1"># Check if network exists</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_network</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate_net</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span><span class="p">)</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_network</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="c1"># Move the parameters if needed</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="k">if</span> <span class="n">parameters</span><span class="o">.</span><span class="n">device</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_device</span><span class="p">:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_device</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="c1"># Fill the network with the parameters</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="n">fill_parameters</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="c1"># Return the network</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="k">return</span> <span class="n">network</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_grad_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Device</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        Get the device in which new solutions will be made in distributed mode.</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        In more details, in distributed mode, each actor creates its own</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        sub-populations, evaluates them, and computes its own gradient</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        (all such actor gradients eventually being collected by the</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        distribution-based search algorithm in the main process).</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        For some problem types, it can make sense for the remote actors to</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        create their temporary sub-populations on another device</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        (e.g. on the GPU that is allocated specifically for them).</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        For such situations, one is encouraged to override this property</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        and make it return whatever device is to be used.</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        In the case of NEProblem, this property returns whatever device</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        is specified by the property `network_device`.</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_device</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_evaluate_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        Evaluate a network and return the evaluation result(s).</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">        In the case where the `__init__` of `NEProblem` was not given</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        a network evaluator function (via the argument `network_eval_func`),</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        it will be expected that the inheriting class overrides this</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">        method and defines how a network should be evaluated.</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">            network (nn.Module): The network to evaluate</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            fitness: The networks&#39; fitness value(s), as a scalar for</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">                single-objective cases, or as a 1-dimensional tensor</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">                for multi-objective cases. The returned value can also</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">                be a two-element tuple where the first element is the</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">                fitness (as a scalar or as a vector) and the second</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">                element is a 1-dimensional vector storing the extra</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">                evaluation data.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        Evaluate a single solution.</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        This is achieved by parameterising the problem&#39;s attribute</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        named `instantiated_network`, and then evaluating the network</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        with the method `_evaluate_network(...)`.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            solution (Solution): The solution to evaluate.</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="n">parameters</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_network_eval_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>            <span class="n">evaluator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_network</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>            <span class="n">evaluator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_network_eval_func</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="n">fitnesses</span> <span class="o">=</span> <span class="n">evaluator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterize_net</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fitnesses</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>            <span class="n">solution</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="o">*</span><span class="n">fitnesses</span><span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="n">solution</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="n">fitnesses</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="evotorch.neuroevolution.NEProblem.network_device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">network_device</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.neuroevolution.NEProblem.network_device" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The device on which the problem should place data e.g. the network</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.NEProblem.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">network_eval_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">network_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1e-05</span><span class="p">,</span> <span class="mf">1e-05</span><span class="p">),</span> <span class="n">eval_dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eval_data_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_actors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">actor_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_gpus_per_actor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_subbatches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subbatch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.NEProblem.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the NEProblem.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="evotorch.core.ObjectiveSense">ObjectiveSense</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The objective sense, expected as "min" or "max"
for single-objective cases, or as a sequence of strings
(each string being "min" or "max") for multi-objective cases.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>network</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="torch.nn.Module">Module</span>, <span title="typing.Callable">Callable</span>[[], <span title="torch.nn.Module">Module</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A network structure string, or a Callable (which can be
a class inheriting from <code>torch.nn.Module</code>, or a function
which returns a <code>torch.nn.Module</code> instance), or an instance
of <code>torch.nn.Module</code>.
The object provided here determines the structure of the
neural network whose parameters will be evolved.
A network structure string is a string which can be processed
by <code>evotorch.neuroevolution.net.str_to_net(...)</code>.
Please see the documentation of the function
<code>evotorch.neuroevolution.net.str_to_net(...)</code> to see how such
a neural network structure string looks like.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>network_eval_func</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a function (or any Callable object)
which receives a PyTorch module as its argument, and returns
either a fitness, or a two-element tuple containing the fitness
and the additional evaluation data. The fitness can be a scalar
(for single-objective cases) or a 1-dimensional tensor (for
multi-objective cases). The additional evaluation data is
expected as a 1-dimensional tensor.
If this argument is left as None, it will be expected that
the method <code>_evaluate_network(...)</code> is overriden by the
inheriting class.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>network_args</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a dict-like object, storing keyword
arguments to be passed to the network while instantiating it.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_bounds</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.core.BoundsPairLike">BoundsPairLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies an interval from which the values of the
initial neural network parameters will be drawn.</p>
              </div>
            </td>
            <td>
                  <code>(-1e-05, 1e-05)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eval_dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.core.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dtype to be used for fitnesses. If not specified, then
<code>eval_dtype</code> will be inferred from the dtype of the parameters
of the neural network.
In more details, if the neural network's parameters have a
float dtype, <code>eval_dtype</code> will be a compatible float.
Otherwise, it will be "float32".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eval_data_length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Length of the extra evaluation data.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number seed. If left as None, this NEProblem instance
will not have its own random generator, and the global random
generator of PyTorch will be used instead.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_actors</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of actors to create for parallelized
evaluation of the solutions.
Certain string values are also accepted.
When given as "max" or as "num_cpus", the number of actors
will be equal to the number of all available CPUs in the ray
cluster.
When given as "num_gpus", the number of actors will be
equal to the number of all available GPUs in the ray
cluster, and each actor will be assigned a GPU.
When given as "num_devices", the number of actors will be
equal to the minimum among the number of CPUs and the number
of GPUs available in the cluster (or will be equal to the
number of CPUs if there is no GPU), and each actor will be
assigned a GPU (if available).
If <code>num_actors</code> is given as "num_gpus" or "num_devices",
the argument <code>num_gpus_per_actor</code> must not be used,
and the <code>actor_config</code> dictionary must not contain the
key "num_gpus".
If <code>num_actors</code> is given as something other than "num_gpus"
or "num_devices", and if you wish to assign GPUs to each
actor, then please see the argument <code>num_gpus_per_actor</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary, representing the keyword arguments
to be passed to the options(...) used when creating the
ray actor objects. To be used for explicitly allocating
resources per each actor.
For example, for declaring that each actor is to use a GPU,
one can pass <code>actor_config=dict(num_gpus=1)</code>.
Can also be given as None (which is the default),
if no such options are to be passed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_gpus_per_actor</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="float">float</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of GPUs to be allocated by each
remote actor.
The default behavior is to NOT allocate any GPU at all
(which is the default behavior of the ray library as well).
When given as a number <code>n</code>, each actor will be given
<code>n</code> GPUs (where <code>n</code> can be an integer, or can be a <code>float</code>
for fractional allocation).
When given as a string "max", then the available GPUs
across the entire ray cluster (or within the local computer
in the simplest cases) will be equally distributed among
the actors.
When given as a string "all", then each actor will have
access to all the GPUs (this will be achieved by suppressing
the environment variable <code>CUDA_VISIBLE_DEVICES</code> for each
actor).
When the problem is not distributed (i.e. when there are
no actors), this argument is expected to be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_subbatches</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>num_subbatches</code> is None (assuming that
<code>subbatch_size</code> is also None), then, when evaluating a
population, the population will be split into n pieces, <code>n</code>
being the number of actors, and each actor will evaluate
its assigned piece. If <code>num_subbatches</code> is an integer <code>m</code>,
then the population will be split into <code>m</code> pieces,
and actors will continually accept the next unevaluated
piece as they finish their current tasks.
The arguments <code>num_subbatches</code> and <code>subbatch_size</code> cannot
be given values other than None at the same time.
While using a distributed algorithm, this argument determines
how many sub-batches will be generated, and therefore,
how many gradients will be computed by the remote actors.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subbatch_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>subbatch_size</code> is None (assuming that
<code>num_subbatches</code> is also None), then, when evaluating a
population, the population will be split into <code>n</code> pieces, <code>n</code>
being the number of actors, and each actor will evaluate its
assigned piece. If <code>subbatch_size</code> is an integer <code>m</code>,
then the population will be split into pieces of size <code>m</code>,
and actors will continually accept the next unevaluated
piece as they finish their current tasks.
When there can be significant difference across the solutions
in terms of computational requirements, specifying a
<code>subbatch_size</code> can be beneficial, because, while one
actor is busy with a subbatch containing computationally
challenging solutions, other actors can accept more
tasks and save time.
The arguments <code>num_subbatches</code> and <code>subbatch_size</code> cannot
be given values other than None at the same time.
While using a distributed algorithm, this argument determines
the size of a sub-batch (or sub-population) sampled by a
remote actor for computing a gradient.
In distributed mode, it is expected that the population size
is divisible by <code>subbatch_size</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default device in which a new population will be generated
and the neural networks will operate.
If not specified, "cpu" will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/neproblem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="n">ObjectiveSense</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">network</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]],</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">network_eval_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">network_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">initial_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundsPairLike</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">),</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">eval_dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">eval_data_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">num_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">num_gpus_per_actor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="p">):</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    `__init__(...)`: Initialize the NEProblem.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        objective_sense: The objective sense, expected as &quot;min&quot; or &quot;max&quot;</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            for single-objective cases, or as a sequence of strings</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            (each string being &quot;min&quot; or &quot;max&quot;) for multi-objective cases.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        network: A network structure string, or a Callable (which can be</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">            a class inheriting from `torch.nn.Module`, or a function</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            which returns a `torch.nn.Module` instance), or an instance</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            of `torch.nn.Module`.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            The object provided here determines the structure of the</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            neural network whose parameters will be evolved.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            A network structure string is a string which can be processed</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            by `evotorch.neuroevolution.net.str_to_net(...)`.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            Please see the documentation of the function</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            `evotorch.neuroevolution.net.str_to_net(...)` to see how such</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            a neural network structure string looks like.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        network_eval_func: Optionally a function (or any Callable object)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            which receives a PyTorch module as its argument, and returns</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            either a fitness, or a two-element tuple containing the fitness</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            and the additional evaluation data. The fitness can be a scalar</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            (for single-objective cases) or a 1-dimensional tensor (for</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            multi-objective cases). The additional evaluation data is</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">            expected as a 1-dimensional tensor.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            If this argument is left as None, it will be expected that</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            the method `_evaluate_network(...)` is overriden by the</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            inheriting class.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        network_args: Optionally a dict-like object, storing keyword</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">            arguments to be passed to the network while instantiating it.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        initial_bounds: Specifies an interval from which the values of the</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            initial neural network parameters will be drawn.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        eval_dtype: dtype to be used for fitnesses. If not specified, then</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">            `eval_dtype` will be inferred from the dtype of the parameters</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            of the neural network.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">            In more details, if the neural network&#39;s parameters have a</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            float dtype, `eval_dtype` will be a compatible float.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            Otherwise, it will be &quot;float32&quot;.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        eval_data_length: Length of the extra evaluation data.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        seed: Random number seed. If left as None, this NEProblem instance</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            will not have its own random generator, and the global random</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            generator of PyTorch will be used instead.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        num_actors: Number of actors to create for parallelized</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            evaluation of the solutions.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            Certain string values are also accepted.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            When given as &quot;max&quot; or as &quot;num_cpus&quot;, the number of actors</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            will be equal to the number of all available CPUs in the ray</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            cluster.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            When given as &quot;num_gpus&quot;, the number of actors will be</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            equal to the number of all available GPUs in the ray</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            cluster, and each actor will be assigned a GPU.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            When given as &quot;num_devices&quot;, the number of actors will be</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            equal to the minimum among the number of CPUs and the number</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            of GPUs available in the cluster (or will be equal to the</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            number of CPUs if there is no GPU), and each actor will be</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            assigned a GPU (if available).</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            If `num_actors` is given as &quot;num_gpus&quot; or &quot;num_devices&quot;,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            the argument `num_gpus_per_actor` must not be used,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            and the `actor_config` dictionary must not contain the</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            key &quot;num_gpus&quot;.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            If `num_actors` is given as something other than &quot;num_gpus&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            or &quot;num_devices&quot;, and if you wish to assign GPUs to each</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            actor, then please see the argument `num_gpus_per_actor`.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        actor_config: A dictionary, representing the keyword arguments</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            to be passed to the options(...) used when creating the</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            ray actor objects. To be used for explicitly allocating</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            resources per each actor.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            For example, for declaring that each actor is to use a GPU,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            one can pass `actor_config=dict(num_gpus=1)`.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            Can also be given as None (which is the default),</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            if no such options are to be passed.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        num_gpus_per_actor: Number of GPUs to be allocated by each</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            remote actor.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            The default behavior is to NOT allocate any GPU at all</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            (which is the default behavior of the ray library as well).</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            When given as a number `n`, each actor will be given</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            `n` GPUs (where `n` can be an integer, or can be a `float`</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            for fractional allocation).</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            When given as a string &quot;max&quot;, then the available GPUs</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            across the entire ray cluster (or within the local computer</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            in the simplest cases) will be equally distributed among</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            the actors.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            When given as a string &quot;all&quot;, then each actor will have</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            access to all the GPUs (this will be achieved by suppressing</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            the environment variable `CUDA_VISIBLE_DEVICES` for each</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            actor).</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            When the problem is not distributed (i.e. when there are</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            no actors), this argument is expected to be left as None.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        num_subbatches: If `num_subbatches` is None (assuming that</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            `subbatch_size` is also None), then, when evaluating a</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            population, the population will be split into n pieces, `n`</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            being the number of actors, and each actor will evaluate</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            its assigned piece. If `num_subbatches` is an integer `m`,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            then the population will be split into `m` pieces,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            piece as they finish their current tasks.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            be given values other than None at the same time.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            how many sub-batches will be generated, and therefore,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            how many gradients will be computed by the remote actors.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        subbatch_size: If `subbatch_size` is None (assuming that</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            `num_subbatches` is also None), then, when evaluating a</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            population, the population will be split into `n` pieces, `n`</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            being the number of actors, and each actor will evaluate its</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            assigned piece. If `subbatch_size` is an integer `m`,</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            then the population will be split into pieces of size `m`,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">            piece as they finish their current tasks.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            When there can be significant difference across the solutions</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            in terms of computational requirements, specifying a</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">            `subbatch_size` can be beneficial, because, while one</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            actor is busy with a subbatch containing computationally</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            challenging solutions, other actors can accept more</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">            tasks and save time.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            be given values other than None at the same time.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            the size of a sub-batch (or sub-population) sampled by a</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            remote actor for computing a gradient.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            In distributed mode, it is expected that the population size</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            is divisible by `subbatch_size`.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        device: Default device in which a new population will be generated</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            and the neural networks will operate.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="c1"># Set the main device of the problem</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="c1"># Although the operation of setting the main device is done by the main Problem class,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="c1"># here we need this at an earlier stage.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="c1"># Set the network</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span> <span class="o">=</span> <span class="n">network</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_network_args</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">network_args</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">network_args</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="c1"># Store the function that will evaluate the network, if available</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_network_eval_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="n">network_eval_func</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_network</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="c1"># Create temporary network</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="n">temp_network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate_net</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">objective_sense</span><span class="o">=</span><span class="n">objective_sense</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="n">initial_bounds</span><span class="o">=</span><span class="n">initial_bounds</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Neuroevolution is an unbounded problem</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">solution_length</span><span class="o">=</span><span class="n">count_parameters</span><span class="p">(</span><span class="n">temp_network</span><span class="p">),</span>  <span class="c1"># The solution length is inherited from the network passed</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">dtype</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">temp_network</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>  <span class="c1"># The datatype is inherited from the network passed</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">eval_dtype</span><span class="o">=</span><span class="n">eval_dtype</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">eval_data_length</span><span class="o">=</span><span class="n">eval_data_length</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">num_actors</span><span class="o">=</span><span class="n">num_actors</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">num_gpus_per_actor</span><span class="o">=</span><span class="n">num_gpus_per_actor</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">actor_config</span><span class="o">=</span><span class="n">actor_config</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="n">num_subbatches</span><span class="o">=</span><span class="n">num_subbatches</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="n">subbatch_size</span><span class="o">=</span><span class="n">subbatch_size</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">store_solution_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.NEProblem.make_net" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_net</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.NEProblem.make_net" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Make a new network filled with the provided parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parameters</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameters to be used as weights within the network.
Can be a Solution, or any 1-dimensional Iterable that can be
converted to a PyTorch tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/neproblem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_net</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    Make a new network filled with the provided parameters.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        parameters: Parameters to be used as weights within the network.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">            Can be a Solution, or any 1-dimensional Iterable that can be</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">            converted to a PyTorch tensor.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        A new network, as a `torch.Module` instance.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">access_values</span><span class="p">(</span><span class="n">keep_evals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="n">net</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterize_net</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="k">return</span> <span class="n">net</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.NEProblem.network_constants" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">network_constants</span><span class="p">()</span></code>

<a href="#evotorch.neuroevolution.NEProblem.network_constants" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Named constants which can be passed to the network instantiation</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/neproblem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="k">def</span><span class="w"> </span><span class="nf">network_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Named constants which can be passed to the network instantiation&quot;&quot;&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">constants</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="n">constants</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_network_constants</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">constants</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_network_args</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="k">return</span> <span class="n">constants</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.NEProblem.parameterize_net" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parameterize_net</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.NEProblem.parameterize_net" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Parameterize the network with a given set of parameters.
Args:
    parameters (torch.Tensor): The parameters with which to instantiate the network
Returns:
    instantiated_network (nn.Module): The network instantiated with the parameters</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/neproblem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="k">def</span><span class="w"> </span><span class="nf">parameterize_net</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameterize the network with a given set of parameters.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        parameters (torch.Tensor): The parameters with which to instantiate the network</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        instantiated_network (nn.Module): The network instantiated with the parameters</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="c1"># Check if network exists</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_network</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate_net</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_network</span><span class="p">)</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instantiated_network</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="c1"># Move the parameters if needed</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="k">if</span> <span class="n">parameters</span><span class="o">.</span><span class="n">device</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_device</span><span class="p">:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_device</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="c1"># Fill the network with the parameters</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="n">fill_parameters</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="c1"># Return the network</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="k">return</span> <span class="n">network</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.neuroevolution.SupervisedNE" class="doc doc-heading">
            <code>SupervisedNE</code>


<a href="#evotorch.neuroevolution.SupervisedNE" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="NEProblem (evotorch.neuroevolution.neproblem.NEProblem)" href="neproblem/#evotorch.neuroevolution.neproblem.NEProblem">NEProblem</a></code></p>


        <p>Representation of a neuro-evolution problem where the goal is to minimize
a loss function in a supervised learning setting.</p>
<p>A supervised learning problem can be defined via subclassing this class
and overriding the methods
<code>_loss(y_hat, y)</code> (which is to define how the loss is computed)
and <code>_make_dataloader()</code> (which is to define how a new DataLoader is
created).</p>
<p>Alternatively, this class can be directly instantiated as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_loss_function</span><span class="p">(</span><span class="n">output_of_network</span><span class="p">,</span> <span class="n">desired_output</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">loss</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># compute the loss here</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="n">loss</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">problem</span> <span class="o">=</span> <span class="n">SupervisedNE</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">my_dataset</span><span class="p">,</span> <span class="n">MyTorchModuleClass</span><span class="p">,</span> <span class="n">my_loss_function</span><span class="p">,</span> <span class="n">minibatch_size</span><span class="o">=...</span><span class="p">,</span> <span class="o">...</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span>
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>evotorch/neuroevolution/supervisedne.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="k">class</span><span class="w"> </span><span class="nc">SupervisedNE</span><span class="p">(</span><span class="n">NEProblem</span><span class="p">):</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Representation of a neuro-evolution problem where the goal is to minimize</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    a loss function in a supervised learning setting.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    A supervised learning problem can be defined via subclassing this class</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    and overriding the methods</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    `_loss(y_hat, y)` (which is to define how the loss is computed)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    and `_make_dataloader()` (which is to define how a new DataLoader is</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    created).</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Alternatively, this class can be directly instantiated as follows:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    def my_loss_function(output_of_network, desired_output):</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        loss = ...  # compute the loss here</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        return loss</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    problem = SupervisedNE(</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        my_dataset, MyTorchModuleClass, my_loss_function, minibatch_size=..., ...</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    )</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    ```</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">network</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]],</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">loss_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">network_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="n">initial_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundsPairLike</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">),</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">minibatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">num_minibatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">num_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">common_minibatch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">num_gpus_per_actor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="p">):</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        `__init__(...)`: Initialize the SupervisedNE.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            dataset: The Dataset from which the minibatches will be pulled</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            network: A network structure string, or a Callable (which can be</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">                a class inheriting from `torch.nn.Module`, or a function</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">                which returns a `torch.nn.Module` instance), or an instance</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">                of `torch.nn.Module`.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">                The object provided here determines the structure of the</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">                neural network whose parameters will be evolved.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">                A network structure string is a string which can be processed</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">                by `evotorch.neuroevolution.net.str_to_net(...)`.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">                Please see the documentation of the function</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">                `evotorch.neuroevolution.net.str_to_net(...)` to see how such</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">                a neural network structure string looks like.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            loss_func: Optionally a function (or a Callable object) which</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">                receives `y_hat` (the output generated by the neural network)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">                and `y` (the desired output), and returns the loss as a</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">                scalar.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">                This argument can also be left as None, in which case it will</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">                be expected that the method `_loss(self, y_hat, y)` is</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">                overridden by the inheriting class.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            network_args: Optionally a dict-like object, storing keyword</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">                arguments to be passed to the network while instantiating it.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            initial_bounds: Specifies an interval from which the values of the</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">                initial neural network parameters will be drawn.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            minibatch_size: Optionally an integer, describing the size of a</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">                minibatch when pulling data from the dataset.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">                Can also be left as None, in which case it will be expected</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">                that the inheriting class overrides the method</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">                `_make_dataloader()` and defines how a new DataLoader is to be</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">                made.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            num_minibatches: An integer, specifying over how many minibatches</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">                will a single neural network be evaluated.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">                If not specified, it will be assumed that the desired number</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">                of minibatches per network evaluation is 1.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            num_actors: Number of actors to create for parallelized</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">                evaluation of the solutions.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">                Certain string values are also accepted.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">                When given as &quot;max&quot; or as &quot;num_cpus&quot;, the number of actors</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">                will be equal to the number of all available CPUs in the ray</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">                cluster.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">                When given as &quot;num_gpus&quot;, the number of actors will be</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">                equal to the number of all available GPUs in the ray</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">                cluster, and each actor will be assigned a GPU.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">                When given as &quot;num_devices&quot;, the number of actors will be</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">                equal to the minimum among the number of CPUs and the number</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">                of GPUs available in the cluster (or will be equal to the</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">                number of CPUs if there is no GPU), and each actor will be</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">                assigned a GPU (if available).</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">                If `num_actors` is given as &quot;num_gpus&quot; or &quot;num_devices&quot;,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">                the argument `num_gpus_per_actor` must not be used,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">                and the `actor_config` dictionary must not contain the</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">                key &quot;num_gpus&quot;.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">                If `num_actors` is given as something other than &quot;num_gpus&quot;</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">                or &quot;num_devices&quot;, and if you wish to assign GPUs to each</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">                actor, then please see the argument `num_gpus_per_actor`.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            common_minibatch: Whether the same minibatches will be</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">                used when evaluating the solutions or not.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            actor_config: A dictionary, representing the keyword arguments</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">                to be passed to the options(...) used when creating the</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">                ray actor objects. To be used for explicitly allocating</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">                resources per each actor.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">                For example, for declaring that each actor is to use a GPU,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">                one can pass `actor_config=dict(num_gpus=1)`.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">                Can also be given as None (which is the default),</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">                if no such options are to be passed.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            num_gpus_per_actor: Number of GPUs to be allocated by each</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">                remote actor.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">                The default behavior is to NOT allocate any GPU at all</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">                (which is the default behavior of the ray library as well).</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">                When given as a number `n`, each actor will be given</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">                `n` GPUs (where `n` can be an integer, or can be a `float`</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">                for fractional allocation).</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">                When given as a string &quot;max&quot;, then the available GPUs</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">                across the entire ray cluster (or within the local computer</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">                in the simplest cases) will be equally distributed among</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">                the actors.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">                When given as a string &quot;all&quot;, then each actor will have</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">                access to all the GPUs (this will be achieved by suppressing</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">                the environment variable `CUDA_VISIBLE_DEVICES` for each</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">                actor).</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">                When the problem is not distributed (i.e. when there are</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">                no actors), this argument is expected to be left as None.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            num_subbatches: If `num_subbatches` is None (assuming that</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">                `subbatch_size` is also None), then, when evaluating a</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">                population, the population will be split into n pieces, `n`</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">                being the number of actors, and each actor will evaluate</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">                its assigned piece. If `num_subbatches` is an integer `m`,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">                then the population will be split into `m` pieces,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">                and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">                piece as they finish their current tasks.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">                The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">                be given values other than None at the same time.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">                While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">                how many sub-batches will be generated, and therefore,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">                how many gradients will be computed by the remote actors.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            subbatch_size: If `subbatch_size` is None (assuming that</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">                `num_subbatches` is also None), then, when evaluating a</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">                population, the population will be split into `n` pieces, `n`</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">                being the number of actors, and each actor will evaluate its</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">                assigned piece. If `subbatch_size` is an integer `m`,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">                then the population will be split into pieces of size `m`,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">                and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                piece as they finish their current tasks.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">                When there can be significant difference across the solutions</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">                in terms of computational requirements, specifying a</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">                `subbatch_size` can be beneficial, because, while one</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">                actor is busy with a subbatch containing computationally</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">                challenging solutions, other actors can accept more</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">                tasks and save time.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">                The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">                be given values other than None at the same time.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">                While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">                the size of a sub-batch (or sub-population) sampled by a</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">                remote actor for computing a gradient.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">                In distributed mode, it is expected that the population size</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">                is divisible by `subbatch_size`.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">            device: Default device in which a new population will be generated</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">                and the neural networks will operate.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">                If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="n">objective_sense</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">network_args</span><span class="o">=</span><span class="n">network_args</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="n">initial_bounds</span><span class="o">=</span><span class="n">initial_bounds</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="n">num_actors</span><span class="o">=</span><span class="n">num_actors</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="n">num_gpus_per_actor</span><span class="o">=</span><span class="n">num_gpus_per_actor</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="n">actor_config</span><span class="o">=</span><span class="n">actor_config</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="n">num_subbatches</span><span class="o">=</span><span class="n">num_subbatches</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="n">subbatch_size</span><span class="o">=</span><span class="n">subbatch_size</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_func</span> <span class="o">=</span> <span class="n">loss_func</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_minibatch_size</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">minibatch_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">minibatch_size</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_minibatches</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">num_minibatches</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_minibatches</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_common_minibatch</span> <span class="o">=</span> <span class="n">common_minibatch</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_current_minibatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        Make a new DataLoader.</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        This method, in its default state, does not contain an implementation.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        In the case where the `__init__` of `SupervisedNE` is not provided</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        with a minibatch size, it will be expected that this method is</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        overridden by the inheriting class and that the operation of creating</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        a new DataLoader is defined here.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            The new DataLoader.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">make_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        Make a new DataLoader.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        If the `__init__` of `SupervisedNE` was provided with a minibatch size</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        via the argument `minibatch_size`, then a new DataLoader will be made</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        with that minibatch size.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        Otherwise, it will be expected that the method `_make_dataloader(...)`</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        was overridden to contain details regarding how the DataLoader should be</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        created, and that method will be executed.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            The created DataLoader.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minibatch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_dataloader</span><span class="p">()</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>            <span class="k">return</span> <span class="n">DataLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_minibatch_size</span><span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_evaluate_using_minibatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        Pass a minibatch through a network, and compute the loss.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            network: The network using which the loss will be computed.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            batch: The minibatch that will be used as data.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            The loss.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">yhat</span> <span class="o">=</span> <span class="n">network</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">yhat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        The loss function.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        This method, in its default state, does not contain an implementation.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        In the case where `__init__` of `SupervisedNE` class was not given</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        a loss function via the argument `loss_func`, it will be expected</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        that this method is overridden by the inheriting class and that the</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        operation of computing the loss is defined here.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            y_hat: The output estimated by the network</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            y: The desired output</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">            A scalar, representing the loss</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        Run the loss function and return the loss.</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        If the `__init__` of `SupervisedNE` class was given a loss</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        function via the argument `loss_func`, then that loss function</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        will be used. Otherwise, it will be expected that the method</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        `_loss(...)` is overriden with a loss definition, and that method</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        will be used to compute the loss.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        The computed loss will be returned.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            y_hat: The output estimated by the network</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            y: The desired output</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            A scalar, representing the loss</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_func</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_dataloader</span><span class="p">()</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_minibatch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        Get the next minibatch from the DataLoader.</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataloader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_prepare</span><span class="p">()</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataloader</span><span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="n">batch</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span><span class="p">)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>            <span class="k">pass</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="k">if</span> <span class="n">batch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataloader</span><span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="c1"># Move batch to device of network</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_device</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_evaluate_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="n">loss</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">for</span> <span class="n">batch_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_minibatches</span><span class="p">):</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_common_minibatch</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_current_minibatch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_minibatch</span><span class="p">()</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_current_minibatch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_minibatches</span><span class="p">[</span><span class="n">batch_idx</span><span class="p">]</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">loss</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_using_minibatch</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_minibatch</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_minibatches</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="k">return</span> <span class="n">loss</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_evaluate_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_common_minibatch</span><span class="p">:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="c1"># If using a common data batch, generate them now and use them for the entire batch of solutions</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_current_minibatches</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_minibatch</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_minibatches</span><span class="p">)]</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_evaluate_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.SupervisedNE.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">network_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1e-05</span><span class="p">,</span> <span class="mf">1e-05</span><span class="p">),</span> <span class="n">minibatch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_minibatches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_actors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">common_minibatch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_gpus_per_actor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">actor_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_subbatches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subbatch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.SupervisedNE.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the SupervisedNE.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code><span title="torch.utils.data.Dataset">Dataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Dataset from which the minibatches will be pulled</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>network</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="torch.nn.Module">Module</span>, <span title="typing.Callable">Callable</span>[[], <span title="torch.nn.Module">Module</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A network structure string, or a Callable (which can be
a class inheriting from <code>torch.nn.Module</code>, or a function
which returns a <code>torch.nn.Module</code> instance), or an instance
of <code>torch.nn.Module</code>.
The object provided here determines the structure of the
neural network whose parameters will be evolved.
A network structure string is a string which can be processed
by <code>evotorch.neuroevolution.net.str_to_net(...)</code>.
Please see the documentation of the function
<code>evotorch.neuroevolution.net.str_to_net(...)</code> to see how such
a neural network structure string looks like.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_func</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a function (or a Callable object) which
receives <code>y_hat</code> (the output generated by the neural network)
and <code>y</code> (the desired output), and returns the loss as a
scalar.
This argument can also be left as None, in which case it will
be expected that the method <code>_loss(self, y_hat, y)</code> is
overridden by the inheriting class.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>network_args</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a dict-like object, storing keyword
arguments to be passed to the network while instantiating it.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_bounds</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.core.BoundsPairLike">BoundsPairLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies an interval from which the values of the
initial neural network parameters will be drawn.</p>
              </div>
            </td>
            <td>
                  <code>(-1e-05, 1e-05)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minibatch_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally an integer, describing the size of a
minibatch when pulling data from the dataset.
Can also be left as None, in which case it will be expected
that the inheriting class overrides the method
<code>_make_dataloader()</code> and defines how a new DataLoader is to be
made.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_minibatches</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An integer, specifying over how many minibatches
will a single neural network be evaluated.
If not specified, it will be assumed that the desired number
of minibatches per network evaluation is 1.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_actors</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of actors to create for parallelized
evaluation of the solutions.
Certain string values are also accepted.
When given as "max" or as "num_cpus", the number of actors
will be equal to the number of all available CPUs in the ray
cluster.
When given as "num_gpus", the number of actors will be
equal to the number of all available GPUs in the ray
cluster, and each actor will be assigned a GPU.
When given as "num_devices", the number of actors will be
equal to the minimum among the number of CPUs and the number
of GPUs available in the cluster (or will be equal to the
number of CPUs if there is no GPU), and each actor will be
assigned a GPU (if available).
If <code>num_actors</code> is given as "num_gpus" or "num_devices",
the argument <code>num_gpus_per_actor</code> must not be used,
and the <code>actor_config</code> dictionary must not contain the
key "num_gpus".
If <code>num_actors</code> is given as something other than "num_gpus"
or "num_devices", and if you wish to assign GPUs to each
actor, then please see the argument <code>num_gpus_per_actor</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>common_minibatch</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the same minibatches will be
used when evaluating the solutions or not.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary, representing the keyword arguments
to be passed to the options(...) used when creating the
ray actor objects. To be used for explicitly allocating
resources per each actor.
For example, for declaring that each actor is to use a GPU,
one can pass <code>actor_config=dict(num_gpus=1)</code>.
Can also be given as None (which is the default),
if no such options are to be passed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_gpus_per_actor</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="float">float</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of GPUs to be allocated by each
remote actor.
The default behavior is to NOT allocate any GPU at all
(which is the default behavior of the ray library as well).
When given as a number <code>n</code>, each actor will be given
<code>n</code> GPUs (where <code>n</code> can be an integer, or can be a <code>float</code>
for fractional allocation).
When given as a string "max", then the available GPUs
across the entire ray cluster (or within the local computer
in the simplest cases) will be equally distributed among
the actors.
When given as a string "all", then each actor will have
access to all the GPUs (this will be achieved by suppressing
the environment variable <code>CUDA_VISIBLE_DEVICES</code> for each
actor).
When the problem is not distributed (i.e. when there are
no actors), this argument is expected to be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_subbatches</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>num_subbatches</code> is None (assuming that
<code>subbatch_size</code> is also None), then, when evaluating a
population, the population will be split into n pieces, <code>n</code>
being the number of actors, and each actor will evaluate
its assigned piece. If <code>num_subbatches</code> is an integer <code>m</code>,
then the population will be split into <code>m</code> pieces,
and actors will continually accept the next unevaluated
piece as they finish their current tasks.
The arguments <code>num_subbatches</code> and <code>subbatch_size</code> cannot
be given values other than None at the same time.
While using a distributed algorithm, this argument determines
how many sub-batches will be generated, and therefore,
how many gradients will be computed by the remote actors.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subbatch_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>subbatch_size</code> is None (assuming that
<code>num_subbatches</code> is also None), then, when evaluating a
population, the population will be split into <code>n</code> pieces, <code>n</code>
being the number of actors, and each actor will evaluate its
assigned piece. If <code>subbatch_size</code> is an integer <code>m</code>,
then the population will be split into pieces of size <code>m</code>,
and actors will continually accept the next unevaluated
piece as they finish their current tasks.
When there can be significant difference across the solutions
in terms of computational requirements, specifying a
<code>subbatch_size</code> can be beneficial, because, while one
actor is busy with a subbatch containing computationally
challenging solutions, other actors can accept more
tasks and save time.
The arguments <code>num_subbatches</code> and <code>subbatch_size</code> cannot
be given values other than None at the same time.
While using a distributed algorithm, this argument determines
the size of a sub-batch (or sub-population) sampled by a
remote actor for computing a gradient.
In distributed mode, it is expected that the population size
is divisible by <code>subbatch_size</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default device in which a new population will be generated
and the neural networks will operate.
If not specified, "cpu" will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/supervisedne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">network</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]],</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">loss_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">network_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">initial_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundsPairLike</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">),</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">minibatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">num_minibatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">num_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">common_minibatch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">num_gpus_per_actor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="p">):</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    `__init__(...)`: Initialize the SupervisedNE.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        dataset: The Dataset from which the minibatches will be pulled</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        network: A network structure string, or a Callable (which can be</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            a class inheriting from `torch.nn.Module`, or a function</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">            which returns a `torch.nn.Module` instance), or an instance</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            of `torch.nn.Module`.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">            The object provided here determines the structure of the</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            neural network whose parameters will be evolved.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">            A network structure string is a string which can be processed</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            by `evotorch.neuroevolution.net.str_to_net(...)`.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            Please see the documentation of the function</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            `evotorch.neuroevolution.net.str_to_net(...)` to see how such</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            a neural network structure string looks like.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        loss_func: Optionally a function (or a Callable object) which</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            receives `y_hat` (the output generated by the neural network)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            and `y` (the desired output), and returns the loss as a</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">            scalar.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            This argument can also be left as None, in which case it will</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            be expected that the method `_loss(self, y_hat, y)` is</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            overridden by the inheriting class.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        network_args: Optionally a dict-like object, storing keyword</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            arguments to be passed to the network while instantiating it.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        initial_bounds: Specifies an interval from which the values of the</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            initial neural network parameters will be drawn.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        minibatch_size: Optionally an integer, describing the size of a</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            minibatch when pulling data from the dataset.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            Can also be left as None, in which case it will be expected</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            that the inheriting class overrides the method</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            `_make_dataloader()` and defines how a new DataLoader is to be</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            made.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        num_minibatches: An integer, specifying over how many minibatches</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            will a single neural network be evaluated.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">            If not specified, it will be assumed that the desired number</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            of minibatches per network evaluation is 1.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        num_actors: Number of actors to create for parallelized</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            evaluation of the solutions.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">            Certain string values are also accepted.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">            When given as &quot;max&quot; or as &quot;num_cpus&quot;, the number of actors</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">            will be equal to the number of all available CPUs in the ray</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            cluster.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            When given as &quot;num_gpus&quot;, the number of actors will be</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">            equal to the number of all available GPUs in the ray</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            cluster, and each actor will be assigned a GPU.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">            When given as &quot;num_devices&quot;, the number of actors will be</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            equal to the minimum among the number of CPUs and the number</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            of GPUs available in the cluster (or will be equal to the</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            number of CPUs if there is no GPU), and each actor will be</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            assigned a GPU (if available).</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            If `num_actors` is given as &quot;num_gpus&quot; or &quot;num_devices&quot;,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            the argument `num_gpus_per_actor` must not be used,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            and the `actor_config` dictionary must not contain the</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            key &quot;num_gpus&quot;.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            If `num_actors` is given as something other than &quot;num_gpus&quot;</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            or &quot;num_devices&quot;, and if you wish to assign GPUs to each</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            actor, then please see the argument `num_gpus_per_actor`.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        common_minibatch: Whether the same minibatches will be</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            used when evaluating the solutions or not.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        actor_config: A dictionary, representing the keyword arguments</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            to be passed to the options(...) used when creating the</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            ray actor objects. To be used for explicitly allocating</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            resources per each actor.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            For example, for declaring that each actor is to use a GPU,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            one can pass `actor_config=dict(num_gpus=1)`.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            Can also be given as None (which is the default),</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            if no such options are to be passed.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        num_gpus_per_actor: Number of GPUs to be allocated by each</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            remote actor.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            The default behavior is to NOT allocate any GPU at all</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            (which is the default behavior of the ray library as well).</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            When given as a number `n`, each actor will be given</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            `n` GPUs (where `n` can be an integer, or can be a `float`</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            for fractional allocation).</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            When given as a string &quot;max&quot;, then the available GPUs</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            across the entire ray cluster (or within the local computer</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            in the simplest cases) will be equally distributed among</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            the actors.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            When given as a string &quot;all&quot;, then each actor will have</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            access to all the GPUs (this will be achieved by suppressing</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            the environment variable `CUDA_VISIBLE_DEVICES` for each</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            actor).</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            When the problem is not distributed (i.e. when there are</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            no actors), this argument is expected to be left as None.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        num_subbatches: If `num_subbatches` is None (assuming that</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            `subbatch_size` is also None), then, when evaluating a</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            population, the population will be split into n pieces, `n`</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            being the number of actors, and each actor will evaluate</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            its assigned piece. If `num_subbatches` is an integer `m`,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            then the population will be split into `m` pieces,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            piece as they finish their current tasks.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            be given values other than None at the same time.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            how many sub-batches will be generated, and therefore,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            how many gradients will be computed by the remote actors.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        subbatch_size: If `subbatch_size` is None (assuming that</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            `num_subbatches` is also None), then, when evaluating a</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            population, the population will be split into `n` pieces, `n`</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            being the number of actors, and each actor will evaluate its</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            assigned piece. If `subbatch_size` is an integer `m`,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            then the population will be split into pieces of size `m`,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            piece as they finish their current tasks.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            When there can be significant difference across the solutions</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            in terms of computational requirements, specifying a</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            `subbatch_size` can be beneficial, because, while one</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            actor is busy with a subbatch containing computationally</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            challenging solutions, other actors can accept more</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            tasks and save time.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            be given values other than None at the same time.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            the size of a sub-batch (or sub-population) sampled by a</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            remote actor for computing a gradient.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            In distributed mode, it is expected that the population size</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            is divisible by `subbatch_size`.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        device: Default device in which a new population will be generated</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            and the neural networks will operate.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="n">objective_sense</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">network_args</span><span class="o">=</span><span class="n">network_args</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">initial_bounds</span><span class="o">=</span><span class="n">initial_bounds</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">num_actors</span><span class="o">=</span><span class="n">num_actors</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">num_gpus_per_actor</span><span class="o">=</span><span class="n">num_gpus_per_actor</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">actor_config</span><span class="o">=</span><span class="n">actor_config</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="n">num_subbatches</span><span class="o">=</span><span class="n">num_subbatches</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="n">subbatch_size</span><span class="o">=</span><span class="n">subbatch_size</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_loss_func</span> <span class="o">=</span> <span class="n">loss_func</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_minibatch_size</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">minibatch_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">minibatch_size</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_num_minibatches</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">num_minibatches</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_minibatches</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_common_minibatch</span> <span class="o">=</span> <span class="n">common_minibatch</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_current_minibatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.SupervisedNE.get_minibatch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_minibatch</span><span class="p">()</span></code>

<a href="#evotorch.neuroevolution.SupervisedNE.get_minibatch" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the next minibatch from the DataLoader.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/supervisedne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_minibatch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    Get the next minibatch from the DataLoader.</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataloader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepare</span><span class="p">()</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataloader</span><span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="n">batch</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span><span class="p">)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="k">pass</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="k">if</span> <span class="n">batch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataloader</span><span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataloader_iterator</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="c1"># Move batch to device of network</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_device</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.SupervisedNE.loss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loss</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.SupervisedNE.loss" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Run the loss function and return the loss.</p>
<p>If the <code>__init__</code> of <code>SupervisedNE</code> class was given a loss
function via the argument <code>loss_func</code>, then that loss function
will be used. Otherwise, it will be expected that the method
<code>_loss(...)</code> is overriden with a loss definition, and that method
will be used to compute the loss.
The computed loss will be returned.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_hat</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The output estimated by the network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired output</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/supervisedne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="k">def</span><span class="w"> </span><span class="nf">loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">    Run the loss function and return the loss.</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    If the `__init__` of `SupervisedNE` class was given a loss</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    function via the argument `loss_func`, then that loss function</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    will be used. Otherwise, it will be expected that the method</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    `_loss(...)` is overriden with a loss definition, and that method</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    will be used to compute the loss.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    The computed loss will be returned.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        y_hat: The output estimated by the network</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        y: The desired output</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        A scalar, representing the loss</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_func</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.SupervisedNE.make_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_dataloader</span><span class="p">()</span></code>

<a href="#evotorch.neuroevolution.SupervisedNE.make_dataloader" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Make a new DataLoader.</p>
<p>If the <code>__init__</code> of <code>SupervisedNE</code> was provided with a minibatch size
via the argument <code>minibatch_size</code>, then a new DataLoader will be made
with that minibatch size.
Otherwise, it will be expected that the method <code>_make_dataloader(...)</code>
was overridden to contain details regarding how the DataLoader should be
created, and that method will be executed.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The created DataLoader.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/supervisedne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    Make a new DataLoader.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    If the `__init__` of `SupervisedNE` was provided with a minibatch size</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    via the argument `minibatch_size`, then a new DataLoader will be made</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    with that minibatch size.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Otherwise, it will be expected that the method `_make_dataloader(...)`</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    was overridden to contain details regarding how the DataLoader should be</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    created, and that method will be executed.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        The created DataLoader.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minibatch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_dataloader</span><span class="p">()</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">return</span> <span class="n">DataLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_minibatch_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="evotorch.neuroevolution.VecGymNE" class="doc doc-heading">
            <code>VecGymNE</code>


<a href="#evotorch.neuroevolution.VecGymNE" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseNEProblem (evotorch.neuroevolution.baseneproblem.BaseNEProblem)" href="baseneproblem/#evotorch.neuroevolution.baseneproblem.BaseNEProblem">BaseNEProblem</a></code></p>


        <p>An EvoTorch problem for solving vectorized gym environments</p>







              <details class="quote">
                <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-95">  95</a></span>
<span class="normal"><a href="#__codelineno-0-96">  96</a></span>
<span class="normal"><a href="#__codelineno-0-97">  97</a></span>
<span class="normal"><a href="#__codelineno-0-98">  98</a></span>
<span class="normal"><a href="#__codelineno-0-99">  99</a></span>
<span class="normal"><a href="#__codelineno-0-100"> 100</a></span>
<span class="normal"><a href="#__codelineno-0-101"> 101</a></span>
<span class="normal"><a href="#__codelineno-0-102"> 102</a></span>
<span class="normal"><a href="#__codelineno-0-103"> 103</a></span>
<span class="normal"><a href="#__codelineno-0-104"> 104</a></span>
<span class="normal"><a href="#__codelineno-0-105"> 105</a></span>
<span class="normal"><a href="#__codelineno-0-106"> 106</a></span>
<span class="normal"><a href="#__codelineno-0-107"> 107</a></span>
<span class="normal"><a href="#__codelineno-0-108"> 108</a></span>
<span class="normal"><a href="#__codelineno-0-109"> 109</a></span>
<span class="normal"><a href="#__codelineno-0-110"> 110</a></span>
<span class="normal"><a href="#__codelineno-0-111"> 111</a></span>
<span class="normal"><a href="#__codelineno-0-112"> 112</a></span>
<span class="normal"><a href="#__codelineno-0-113"> 113</a></span>
<span class="normal"><a href="#__codelineno-0-114"> 114</a></span>
<span class="normal"><a href="#__codelineno-0-115"> 115</a></span>
<span class="normal"><a href="#__codelineno-0-116"> 116</a></span>
<span class="normal"><a href="#__codelineno-0-117"> 117</a></span>
<span class="normal"><a href="#__codelineno-0-118"> 118</a></span>
<span class="normal"><a href="#__codelineno-0-119"> 119</a></span>
<span class="normal"><a href="#__codelineno-0-120"> 120</a></span>
<span class="normal"><a href="#__codelineno-0-121"> 121</a></span>
<span class="normal"><a href="#__codelineno-0-122"> 122</a></span>
<span class="normal"><a href="#__codelineno-0-123"> 123</a></span>
<span class="normal"><a href="#__codelineno-0-124"> 124</a></span>
<span class="normal"><a href="#__codelineno-0-125"> 125</a></span>
<span class="normal"><a href="#__codelineno-0-126"> 126</a></span>
<span class="normal"><a href="#__codelineno-0-127"> 127</a></span>
<span class="normal"><a href="#__codelineno-0-128"> 128</a></span>
<span class="normal"><a href="#__codelineno-0-129"> 129</a></span>
<span class="normal"><a href="#__codelineno-0-130"> 130</a></span>
<span class="normal"><a href="#__codelineno-0-131"> 131</a></span>
<span class="normal"><a href="#__codelineno-0-132"> 132</a></span>
<span class="normal"><a href="#__codelineno-0-133"> 133</a></span>
<span class="normal"><a href="#__codelineno-0-134"> 134</a></span>
<span class="normal"><a href="#__codelineno-0-135"> 135</a></span>
<span class="normal"><a href="#__codelineno-0-136"> 136</a></span>
<span class="normal"><a href="#__codelineno-0-137"> 137</a></span>
<span class="normal"><a href="#__codelineno-0-138"> 138</a></span>
<span class="normal"><a href="#__codelineno-0-139"> 139</a></span>
<span class="normal"><a href="#__codelineno-0-140"> 140</a></span>
<span class="normal"><a href="#__codelineno-0-141"> 141</a></span>
<span class="normal"><a href="#__codelineno-0-142"> 142</a></span>
<span class="normal"><a href="#__codelineno-0-143"> 143</a></span>
<span class="normal"><a href="#__codelineno-0-144"> 144</a></span>
<span class="normal"><a href="#__codelineno-0-145"> 145</a></span>
<span class="normal"><a href="#__codelineno-0-146"> 146</a></span>
<span class="normal"><a href="#__codelineno-0-147"> 147</a></span>
<span class="normal"><a href="#__codelineno-0-148"> 148</a></span>
<span class="normal"><a href="#__codelineno-0-149"> 149</a></span>
<span class="normal"><a href="#__codelineno-0-150"> 150</a></span>
<span class="normal"><a href="#__codelineno-0-151"> 151</a></span>
<span class="normal"><a href="#__codelineno-0-152"> 152</a></span>
<span class="normal"><a href="#__codelineno-0-153"> 153</a></span>
<span class="normal"><a href="#__codelineno-0-154"> 154</a></span>
<span class="normal"><a href="#__codelineno-0-155"> 155</a></span>
<span class="normal"><a href="#__codelineno-0-156"> 156</a></span>
<span class="normal"><a href="#__codelineno-0-157"> 157</a></span>
<span class="normal"><a href="#__codelineno-0-158"> 158</a></span>
<span class="normal"><a href="#__codelineno-0-159"> 159</a></span>
<span class="normal"><a href="#__codelineno-0-160"> 160</a></span>
<span class="normal"><a href="#__codelineno-0-161"> 161</a></span>
<span class="normal"><a href="#__codelineno-0-162"> 162</a></span>
<span class="normal"><a href="#__codelineno-0-163"> 163</a></span>
<span class="normal"><a href="#__codelineno-0-164"> 164</a></span>
<span class="normal"><a href="#__codelineno-0-165"> 165</a></span>
<span class="normal"><a href="#__codelineno-0-166"> 166</a></span>
<span class="normal"><a href="#__codelineno-0-167"> 167</a></span>
<span class="normal"><a href="#__codelineno-0-168"> 168</a></span>
<span class="normal"><a href="#__codelineno-0-169"> 169</a></span>
<span class="normal"><a href="#__codelineno-0-170"> 170</a></span>
<span class="normal"><a href="#__codelineno-0-171"> 171</a></span>
<span class="normal"><a href="#__codelineno-0-172"> 172</a></span>
<span class="normal"><a href="#__codelineno-0-173"> 173</a></span>
<span class="normal"><a href="#__codelineno-0-174"> 174</a></span>
<span class="normal"><a href="#__codelineno-0-175"> 175</a></span>
<span class="normal"><a href="#__codelineno-0-176"> 176</a></span>
<span class="normal"><a href="#__codelineno-0-177"> 177</a></span>
<span class="normal"><a href="#__codelineno-0-178"> 178</a></span>
<span class="normal"><a href="#__codelineno-0-179"> 179</a></span>
<span class="normal"><a href="#__codelineno-0-180"> 180</a></span>
<span class="normal"><a href="#__codelineno-0-181"> 181</a></span>
<span class="normal"><a href="#__codelineno-0-182"> 182</a></span>
<span class="normal"><a href="#__codelineno-0-183"> 183</a></span>
<span class="normal"><a href="#__codelineno-0-184"> 184</a></span>
<span class="normal"><a href="#__codelineno-0-185"> 185</a></span>
<span class="normal"><a href="#__codelineno-0-186"> 186</a></span>
<span class="normal"><a href="#__codelineno-0-187"> 187</a></span>
<span class="normal"><a href="#__codelineno-0-188"> 188</a></span>
<span class="normal"><a href="#__codelineno-0-189"> 189</a></span>
<span class="normal"><a href="#__codelineno-0-190"> 190</a></span>
<span class="normal"><a href="#__codelineno-0-191"> 191</a></span>
<span class="normal"><a href="#__codelineno-0-192"> 192</a></span>
<span class="normal"><a href="#__codelineno-0-193"> 193</a></span>
<span class="normal"><a href="#__codelineno-0-194"> 194</a></span>
<span class="normal"><a href="#__codelineno-0-195"> 195</a></span>
<span class="normal"><a href="#__codelineno-0-196"> 196</a></span>
<span class="normal"><a href="#__codelineno-0-197"> 197</a></span>
<span class="normal"><a href="#__codelineno-0-198"> 198</a></span>
<span class="normal"><a href="#__codelineno-0-199"> 199</a></span>
<span class="normal"><a href="#__codelineno-0-200"> 200</a></span>
<span class="normal"><a href="#__codelineno-0-201"> 201</a></span>
<span class="normal"><a href="#__codelineno-0-202"> 202</a></span>
<span class="normal"><a href="#__codelineno-0-203"> 203</a></span>
<span class="normal"><a href="#__codelineno-0-204"> 204</a></span>
<span class="normal"><a href="#__codelineno-0-205"> 205</a></span>
<span class="normal"><a href="#__codelineno-0-206"> 206</a></span>
<span class="normal"><a href="#__codelineno-0-207"> 207</a></span>
<span class="normal"><a href="#__codelineno-0-208"> 208</a></span>
<span class="normal"><a href="#__codelineno-0-209"> 209</a></span>
<span class="normal"><a href="#__codelineno-0-210"> 210</a></span>
<span class="normal"><a href="#__codelineno-0-211"> 211</a></span>
<span class="normal"><a href="#__codelineno-0-212"> 212</a></span>
<span class="normal"><a href="#__codelineno-0-213"> 213</a></span>
<span class="normal"><a href="#__codelineno-0-214"> 214</a></span>
<span class="normal"><a href="#__codelineno-0-215"> 215</a></span>
<span class="normal"><a href="#__codelineno-0-216"> 216</a></span>
<span class="normal"><a href="#__codelineno-0-217"> 217</a></span>
<span class="normal"><a href="#__codelineno-0-218"> 218</a></span>
<span class="normal"><a href="#__codelineno-0-219"> 219</a></span>
<span class="normal"><a href="#__codelineno-0-220"> 220</a></span>
<span class="normal"><a href="#__codelineno-0-221"> 221</a></span>
<span class="normal"><a href="#__codelineno-0-222"> 222</a></span>
<span class="normal"><a href="#__codelineno-0-223"> 223</a></span>
<span class="normal"><a href="#__codelineno-0-224"> 224</a></span>
<span class="normal"><a href="#__codelineno-0-225"> 225</a></span>
<span class="normal"><a href="#__codelineno-0-226"> 226</a></span>
<span class="normal"><a href="#__codelineno-0-227"> 227</a></span>
<span class="normal"><a href="#__codelineno-0-228"> 228</a></span>
<span class="normal"><a href="#__codelineno-0-229"> 229</a></span>
<span class="normal"><a href="#__codelineno-0-230"> 230</a></span>
<span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="k">class</span><span class="w"> </span><span class="nc">VecGymNE</span><span class="p">(</span><span class="n">BaseNEProblem</span><span class="p">):</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    An EvoTorch problem for solving vectorized gym environments</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">env</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="n">network</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">],</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">env_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">max_num_envs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">network_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">observation_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">decrease_rewards_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="n">alive_bonus_schedule</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">action_noise_stdev</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">num_episodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">num_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">num_gpus_per_actor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="p">):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        Initialize the VecGymNE.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            env: Environment to be solved.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">                If this is given as a string starting with &quot;gym::&quot; (e.g.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">                &quot;gym::Humanoid-v4&quot;, etc.), then it is assumed that the target</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">                environment is a classical gym environment.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">                If this is given as a string starting with &quot;brax::&quot; (e.g.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">                &quot;brax::humanoid&quot;, etc.), then it is assumed that the target</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">                environment is a brax environment.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">                If this is given as a string which does not contain &quot;::&quot; at</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">                all (e.g. &quot;Humanoid-v4&quot;, etc.), then it is assumed that the</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                target environment is a classical gym environment. Therefore,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">                &quot;gym::Humanoid-v4&quot; and &quot;Humanoid-v4&quot; are equivalent.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">                If this argument is given as a Callable (maybe a function or a</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">                class), then, with the assumption that this Callable expects</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">                a keyword argument `num_envs: int`, this Callable is called</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">                and its result (expected as a `gym.vector.VectorEnv` instance)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">                is used as the environment.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            network: A network structure string, or a Callable (which can be</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">                a class inheriting from `torch.nn.Module`, or a function</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">                which returns a `torch.nn.Module` instance), or an instance</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">                of `torch.nn.Module`.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">                The object provided here determines the structure of the</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">                neural network whose parameters will be evolved.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">                A network structure string is a string which can be processed</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">                by `evotorch.neuroevolution.net.str_to_net(...)`.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">                Please see the documentation of the function</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">                `evotorch.neuroevolution.net.str_to_net(...)` to see how such</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">                a neural network structure string looks like.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">                Note that this network can be a recurrent network.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">                When the network&#39;s `forward(...)` method can optionally accept</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">                an additional positional argument for the hidden state of the</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">                network and returns an additional value for its next state,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">                then the policy is treated as a recurrent one.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">                When the network is given as a callable object (e.g.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">                a subclass of `nn.Module` or a function) and this callable</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">                object is decorated via `evotorch.decorators.pass_info`,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">                the following keyword arguments will be passed:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">                (i) `obs_length` (the length of the observation vector),</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">                (ii) `act_length` (the length of the action vector),</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">                (iii) `obs_shape` (the shape tuple of the observation space),</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">                (iv) `act_shape` (the shape tuple of the action space),</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">                (v) `obs_space` (the Box object specifying the observation</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">                space, and</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">                (vi) `act_space` (the Box object specifying the action</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">                space). Note that `act_space` will always be given as a</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">                `gym.spaces.Box` instance, even when the actual gym</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">                environment has a discrete action space. This because</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">                `VecGymNE` always expects the neural network to return</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">                a tensor of floating-point numbers.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            env_config: Keyword arguments to pass to the environment while</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">                it is being created.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            max_num_envs: Maximum number of environments to be instantiated.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">                By default, this is None, which means that the number of</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">                environments can go up to the population size (or up to the</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">                number of solutions that a remote actor receives, if the</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                problem object is configured to have parallelization).</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">                For situations where the current reinforcement learning task</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">                requires large amount of resources (e.g. memory), allocating</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">                environments as much as the number of solutions might not</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">                be feasible. In such cases, one can set `max_num_envs` as an</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">                integer to bring an upper bound (in total, across all the</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">                remote actors, for when the problem is parallelized) to how</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">                many environments can be allocated.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            network_args: Any additional keyword argument to be used when</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">                instantiating the network can be specified via `network_args`</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">                as a dictionary. If there are no such additional keyword</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">                arguments, then `network_args` can be left as None.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">                Note that the argument `network_args` is expected to be None</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">                when the network is specified as a `torch.nn.Module` instance.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">            observation_normalization: Whether or not online normalization</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">                will be done on the encountered observations.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            decrease_rewards_by: If given as a float, each reward will be</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">                decreased by this amount. For example, if the environment&#39;s</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">                reward function has a constant &quot;alive bonus&quot; (i.e. a bonus</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">                that is constantly added onto the reward as long as the</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">                agent is alive), and if you wish to negate this bonus,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">                you can set `decrease_rewards_by` to this bonus amount,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">                and the bonus will be nullified.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">                If you do not wish to affect the rewards in this manner,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">                keep this as None.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            alive_bonus_schedule: Use this to add a customized amount of</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">                alive bonus.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">                If left as None (which is the default), additional alive</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">                bonus will not be added.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">                If given as a tuple `(t, b)`, an alive bonus `b` will be</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">                added onto all the rewards beyond the timestep `t`.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">                If given as a tuple `(t0, t1, b)`, a partial (linearly</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">                increasing towards `b`) alive bonus will be added onto</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">                all the rewards between the timesteps `t0` and `t1`,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">                and a full alive bonus (which equals to `b`) will be added</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">                onto all the rewards beyond the timestep `t1`.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            action_noise_stdev: If given as a real number `s`, then, for</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">                each generated action, Gaussian noise with standard</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">                deviation `s` will be sampled, and then this sampled noise</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">                will be added onto the action.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">                If action noise is not desired, then this argument can be</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">                left as None.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">                For sampling the noise, the global random number generator</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">                of PyTorch on the simulator&#39;s device will be used.</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            num_episodes: Number of episodes over which each policy will</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">                be evaluated. The default is 1.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            device: The device in which the population will be kept.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">                If you wish to do a single-GPU evolution, we recommend</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">                to set this as &quot;cuda&quot; (or &quot;cuda:0&quot;, or &quot;cuda:1&quot;, etc.),</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">                assuming that the simulator will also instantiate itself</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">                on that same device.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">                Alternatively, if you wish to do a multi-GPU evolution,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">                we recommend to leave this as None or set this as &quot;cpu&quot;,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">                so that the main population will be kept on the cpu</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">                and the remote actors will perform their evaluations on</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">                the GPUs that are assigned to them.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            num_actors: Number of actors to create for parallelized</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">                evaluation of the solutions.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">                Certain string values are also accepted.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">                When given as &quot;max&quot; or as &quot;num_cpus&quot;, the number of actors</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">                will be equal to the number of all available CPUs in the ray</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">                cluster.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">                When given as &quot;num_gpus&quot;, the number of actors will be</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">                equal to the number of all available GPUs in the ray</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">                cluster, and each actor will be assigned a GPU.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">                When given as &quot;num_devices&quot;, the number of actors will be</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">                equal to the minimum among the number of CPUs and the number</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">                of GPUs available in the cluster (or will be equal to the</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">                number of CPUs if there is no GPU), and each actor will be</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">                assigned a GPU (if available).</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">                If `num_actors` is given as &quot;num_gpus&quot; or &quot;num_devices&quot;,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">                the argument `num_gpus_per_actor` must not be used,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">                and the `actor_config` dictionary must not contain the</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">                key &quot;num_gpus&quot;.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">                If `num_actors` is given as something other than &quot;num_gpus&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">                or &quot;num_devices&quot;, and if you wish to assign GPUs to each</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">                actor, then please see the argument `num_gpus_per_actor`.</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            num_gpus_per_actor: Number of GPUs to be assigned to each</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">                actor. This can be an integer or a float (for when you</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">                wish to assign fractional amounts of GPUs to actors).</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">                When `num_actors` has the special value &quot;num_devices&quot;,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">                the argument `num_gpus_per_actor` is expected to be left as</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">                None.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            num_subbatches: For when there are multiple actors, you can</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">                set this to an integer n if you wish the population</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">                to be divided exactly into n sub-batches. The actors, as they</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">                finish their currently assigned sub-batch of solutions,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">                will pick the next un-evaluated sub-batch.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">                If you specify too large numbers for this argument, then</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">                each sub-batch will be smaller.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">                When working with vectorized simulators on GPU, having too</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">                many and too small sub-batches can hurt the performance.</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">                This argument can be left as None, in which case, assuming</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">                that `subbatch_size` is also None, the population will be</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">                split to m sub-batches, m being the number of actors.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">            subbatch_size: For when there are multiple actors, you can</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">                set this to an integer n if you wish the population to be</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">                divided into sub-batches in such a way that each sub-batch</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">                will consist of exactly n solutions. The actors, as they</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">                finish their currently assigned sub-batch of solutions,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">                will pick the next un-evaluated sub-batch.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">                If you specify too small numbers for this argument, then</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">                there will be many sub-batches, each sub-batch having a</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">                small number of solutions.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">                When working with vectorized simulators on GPU, having too</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">                many and too small sub-batches can hurt the performance.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">                This argument can be left as None, in which case, assuming</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">                that `num_subbatches` is also None, the population will be</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">                split to m sub-batches, m being the number of actors.</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            actor_config: Additional configuration to be used when creating</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">                each actor with the help of `ray` library.</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">                Can be left as None if additional configuration is not needed.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="c1"># Store the string or the Callable that will be used to generate the reinforcement learning environment.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span> <span class="o">=</span> <span class="n">env</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="c1"># Declare the variable which will store the environment.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TorchWrapper</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="c1"># Declare the variable which will store the batch size of the vectorized environment.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_envs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="c1"># Store the upper bound (if any) regarding how many environments can exist at the same time.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_max_num_envs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">max_num_envs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_num_envs</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="c1"># Actor-specific upper bound regarding how many environments can exist at the same time.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="c1"># This variable will be filled by the `_parallelize(...)` method.</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="c1"># Declare the variable which stores whether or not we properly initialized the `_actor_max_num_envs` variable.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs_ready</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="c1"># Store the additional configurations to be used as keyword arguments while instantiating the environment.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">env_config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">(</span><span class="n">env_config</span><span class="p">)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="c1"># Declare the variable that will store the device of the simulator.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="c1"># This variable will be filled when the first observation is received from the environment.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="c1"># The device of the observation array received from the environment will determine the value of this variable.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="c1"># Store the neural network architecture (that might be a string or an `nn.Module` instance).</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_architecture</span> <span class="o">=</span> <span class="n">network</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="k">if</span> <span class="n">network_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="c1"># If `network_args` is given as None, change it to an empty dictionary</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="n">network_args</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="c1"># If the network is given as a string, then we will need the values for the constants `obs_length`,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="c1"># `act_length`, and `obs_space`. To obtain those values, we use our helper function</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="c1"># `_env_constants_for_str_net(...)` which temporarily instantiates the specified environment and returns</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="c1"># its needed constants.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="n">env_constants</span> <span class="o">=</span> <span class="n">_env_constants_for_str_net</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">))</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="c1"># If the network is an already instantiated nn.Module, then we do not prepare any pre-defined constants.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="n">env_constants</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="c1"># If the network is given as a Callable, then we will need the values for the constants `obs_length`,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="c1"># `act_length`, and `obs_space`. To obtain those values, we use our helper function</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="c1"># `_env_constants_for_callable_net(...)` which temporarily instantiates the specified environment and</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="c1"># returns its needed constants.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="n">env_constants</span> <span class="o">=</span> <span class="n">_env_constants_for_callable_net</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">))</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="c1"># Build a `Policy` instance according to the given architecture, and store it.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="n">instantiated_net</span> <span class="o">=</span> <span class="n">str_to_net</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="n">env_constants</span><span class="p">,</span> <span class="o">**</span><span class="n">network_args</span><span class="p">})</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="n">instantiated_net</span> <span class="o">=</span> <span class="n">network</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="n">instantiated_net</span> <span class="o">=</span> <span class="n">pass_info_if_needed</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">env_constants</span><span class="p">)(</span><span class="o">**</span><span class="n">network_args</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">instantiated_net</span><span class="p">)</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="c1"># Store the boolean which indicates whether or not there will be observation normalization.</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_observation_normalization</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">observation_normalization</span><span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="c1"># Declare the variables that will store the observation-related stats if observation normalization is enabled.</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunningNorm</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunningNorm</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="c1"># Store the number of episodes configuration given by the user.</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_episodes</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="c1"># Store the `decrease_rewards_by` configuration given by the user.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_decrease_rewards_by</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">decrease_rewards_by</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">decrease_rewards_by</span><span class="p">)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="k">if</span> <span class="n">alive_bonus_schedule</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="c1"># If `alive_bonus_schedule` argument is None, then we store it as None as well.</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="c1"># This is the case where the user has specified an `alive_bonus_schedule`.</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="n">alive_bonus_schedule</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="n">alive_bonus_schedule_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="k">if</span> <span class="n">alive_bonus_schedule_length</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>                <span class="c1"># If `alive_bonus_schedule` was given as a 2-element sequence (t, b), then store it as (t, t, b).</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>                <span class="c1"># This means that the partial alive bonus time window starts and ends at t, therefore, there will</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>                <span class="c1"># be no alive bonus until t, and beginning with t, there will be full alive bonus.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                    <span class="nb">float</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                <span class="p">]</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="k">elif</span> <span class="n">alive_bonus_schedule_length</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>                <span class="c1"># If `alive_bonus_schedule` was given as a 3-element sequence (t0, t1, b), then store those 3</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                <span class="c1"># elements.</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                    <span class="nb">float</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>                <span class="p">]</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>                <span class="c1"># `alive_bonus_schedule` sequences with unrecognized lengths trigger an error.</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                    <span class="sa">f</span><span class="s2">&quot;Received invalid number elements as the alive bonus schedule.&quot;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                    <span class="sa">f</span><span class="s2">&quot; Expected 2 or 3 items, but got these: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                    <span class="sa">f</span><span class="s2">&quot; (having a length of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                <span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="c1"># If `action_noise_stdev` is specified, store it.</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_action_noise_stdev</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">action_noise_stdev</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">action_noise_stdev</span><span class="p">)</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="c1"># Initialize the counters for the number of simulator interactions and the number of episodes.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="n">device_is_cpu</span> <span class="o">=</span> <span class="p">(</span><span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="n">actors_use_gpu</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="p">(</span><span class="n">num_actors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">num_actors</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">num_gpus_per_actor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">num_gpus_per_actor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">device_is_cpu</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="c1"># In the case where the device is something other than the cpu, we tell SyncVectorEnv to use this device.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_device_for_sync_vector_env</span> <span class="o">=</span> <span class="n">device</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_vector_env_uses_aux_device</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="k">elif</span> <span class="n">actors_use_gpu</span><span class="p">:</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="c1"># In the case where this problem instance is configured to use multiple actors and the actors are</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="c1"># configured to use the available gpu(s), we tell SyncVectorEnv to use the `aux_device`.</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_device_for_sync_vector_env</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_vector_env_uses_aux_device</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_device_for_sync_vector_env</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_vector_env_uses_aux_device</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="c1"># Call the superclass</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>            <span class="n">objective_sense</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>            <span class="n">initial_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">),</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>            <span class="n">solution_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_policy</span><span class="o">.</span><span class="n">parameter_length</span><span class="p">,</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>            <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="n">num_actors</span><span class="o">=</span><span class="n">num_actors</span><span class="p">,</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>            <span class="n">num_gpus_per_actor</span><span class="o">=</span><span class="n">num_gpus_per_actor</span><span class="p">,</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>            <span class="n">actor_config</span><span class="o">=</span><span class="n">actor_config</span><span class="p">,</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>            <span class="n">num_subbatches</span><span class="o">=</span><span class="n">num_subbatches</span><span class="p">,</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>            <span class="n">subbatch_size</span><span class="o">=</span><span class="n">subbatch_size</span><span class="p">,</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">after_eval_hook</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extra_status</span><span class="p">)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_parallelize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_parallelize</span><span class="p">()</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs_ready</span><span class="p">:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_num_envs</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_num_envs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                        <span class="n">max_num_envs_per_actor</span> <span class="o">=</span> <span class="n">split_workload</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_max_num_envs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">))</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                        <span class="k">for</span> <span class="n">i_actor</span><span class="p">,</span> <span class="n">actor</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">):</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>                            <span class="n">actor</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;_set_actor_max_num_envs&quot;</span><span class="p">,</span> <span class="n">max_num_envs_per_actor</span><span class="p">[</span><span class="n">i_actor</span><span class="p">])</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs_ready</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_set_actor_max_num_envs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs_ready</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_extra_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">total_interaction_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span><span class="p">,</span> <span class="n">total_episode_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span><span class="p">)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">observation_normalization</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observation_normalization</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_episode_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        Set the episode count manually.</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_interaction_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">        Set the interaction count manually.</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">interaction_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        Get the total number of simulator interactions made.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">episode_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        Get the total number of episodes completed.</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_local_episode_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_local_interaction_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_env</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_policies</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TorchWrapper</span><span class="p">:</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="c1"># Get the existing environment instance stored by this VecGymNE, after (re)building it if needed.</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num_policies</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_envs</span><span class="p">):</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="c1"># If this VecGymNE does not have its environment ready yet (i.e. the `_env` attribute is None)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="c1"># or it the batch size of the previously instantiated environment is not enough to deal with</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="c1"># the number of policies (i.e. the `_num_envs` attribute is less than `num_policies`), then</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="c1"># we (re)build the environment.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="c1"># Keyword arguments to pass to the TorchWrapper.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="n">torch_wrapper_cfg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>                <span class="n">force_classic_api</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                <span class="n">discrete_to_continuous_act</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                <span class="n">clip_actions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="p">)</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="c1"># Keyword arguments to use only when the underlying environment is a classical gymnasium environment</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>            <span class="n">gym_cfg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">empty_info</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_episodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span><span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sync_vector_env_uses_aux_device</span><span class="p">:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>                <span class="n">gym_cfg</span><span class="p">[</span><span class="s2">&quot;device&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_device</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_device_for_sync_vector_env</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                <span class="n">gym_cfg</span><span class="p">[</span><span class="s2">&quot;device&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_device_for_sync_vector_env</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                <span class="c1"># If the environment is specified via a string, then we use our `make_vector_env` function.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_env</span> <span class="o">=</span> <span class="n">make_vector_env</span><span class="p">(</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>                    <span class="n">num_envs</span><span class="o">=</span><span class="n">num_policies</span><span class="p">,</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                    <span class="n">gym_kwargs</span><span class="o">=</span><span class="n">gym_cfg</span><span class="p">,</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                    <span class="o">**</span><span class="n">torch_wrapper_cfg</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                    <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">),</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                <span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                <span class="c1"># If the environment is specified via a Callable, then we call it.</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="c1"># We expect this Callable to accept a keyword argument named `num_envs`, and additionally, we pass</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                <span class="c1"># the environment configuration dictionary as keyword arguments.</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">(</span><span class="n">num_envs</span><span class="o">=</span><span class="n">num_policies</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">))</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">VectorEnv</span><span class="p">):</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>                    <span class="c1"># If what is returned by the Callable is not a vectorized environment, then we trigger an error.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;This is not a vectorized environment&quot;</span><span class="p">)</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                <span class="c1"># We wrap the returned vectorized environment with a TorchWrapper, so that the actions that we send</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>                <span class="c1"># and the observations and rewards that we receive are PyTorch tensors.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_env</span> <span class="o">=</span> <span class="n">TorchWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="p">,</span> <span class="o">**</span><span class="n">torch_wrapper_cfg</span><span class="p">)</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">num_envs</span> <span class="o">!=</span> <span class="n">num_policies</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>                <span class="c1"># If the finally obtained vectorized environment has a different number of batch size, then we trigger</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>                <span class="c1"># an error.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Incompatible number of environments&quot;</span><span class="p">)</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>            <span class="c1"># We update the batch size of the created environment.</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_envs</span> <span class="o">=</span> <span class="n">num_policies</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">single_observation_space</span><span class="p">,</span> <span class="n">Box</span><span class="p">):</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                <span class="c1"># If the observation space is not Box, then we trigger an error.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                    <span class="sa">f</span><span class="s2">&quot;Unsupported observation type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">single_observation_space</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                    <span class="sa">f</span><span class="s2">&quot; Only Box-typed observation spaces are supported.&quot;</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                <span class="p">)</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                <span class="c1"># If possible, use the `seed(...)` method to explicitly randomize the environment.</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                <span class="c1"># Although the new gym API removed the seed method, some environments define their own `seed(...)`</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>                <span class="c1"># method for randomization.</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                <span class="n">new_seed</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">new_seed</span><span class="p">)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>                <span class="c1"># Our attempt at manually seeding the environment has failed.</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>                <span class="c1"># This could be because the environment does not have a `seed(...)` method.</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>                <span class="c1"># Nothing to do.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>                <span class="k">pass</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_nonserialized_attribs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="c1"># Call the `_nonserialized_attribs` property implementation of the superclass to receive the base list</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="c1"># of non-serialized attributes, then add &quot;_env&quot; to this base list, and then return the resulting list.</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_nonserialized_attribs</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;_env&quot;</span><span class="p">]</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_grad_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="c1"># For distributed mode, this property determines the device in which the temporary populations will be made</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="c1"># for gradient computation.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>            <span class="c1"># If the simulator device is not known yet, then we return the cpu device.</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="c1"># If the simulator device is known, then we return that device.</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_running_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observation</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunningNorm</span><span class="p">:</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="c1"># Make a new RunningNorm instance according to the observation tensor.</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="c1"># The dtype and the device of the new RunningNorm is taken from the observation.</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="c1"># This new RunningNorm is empty (i.e. does not contain any stats yet).</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="k">return</span> <span class="n">RunningNorm</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">observation</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">observation</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_transfer_running_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rn</span><span class="p">:</span> <span class="n">RunningNorm</span><span class="p">,</span> <span class="n">observation</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunningNorm</span><span class="p">:</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="c1"># Transfer (if necessary) the RunningNorm to the device of the observation tensor.</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="c1"># The returned RunningNorm may be the RunningNorm itself (if the device did not change)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="c1"># or a new copy (if the device did change).</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">rn</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">!=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">device</span><span class="p">):</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>            <span class="n">rn</span> <span class="o">=</span> <span class="n">rn</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="k">return</span> <span class="n">rn</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_normalize_observation</span><span class="p">(</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">observation</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">update_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="c1"># This function normalizes the received observation batch.</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="c1"># If a mask is given (as a tensor of booleans), only observations with corresponding mask value set as True</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="c1"># will be taken into consideration.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>        <span class="c1"># If `update_stats` is given as True and observation normalization is enabled, then we will update the</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>        <span class="c1"># RunningNorm instances as well.</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="c1"># This is the case where observation normalization is enabled.</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>                <span class="c1"># If we do not have observation stats yet, we build a new one (according to the dtype and device</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>                <span class="c1"># of the observation).</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_running_norm</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>                <span class="c1"># If we already have observation stats, we make sure that it is in the correct device.</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_running_norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>            <span class="k">if</span> <span class="n">update_stats</span><span class="p">:</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>                <span class="c1"># This is the case where the `update_stats` argument was encountered as True.</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>                    <span class="c1"># If the RunningNorm responsible to collect new stats is not built yet, we build it here</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>                    <span class="c1"># (according to the dtype and device of the observation).</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_running_norm</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>                    <span class="c1"># If the RunningNorm responsible to collect new stats already exists, then we make sure</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                    <span class="c1"># that it is in the correct device.</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_running_norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                <span class="c1"># We first update the RunningNorm responsible for collecting the new stats.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>                <span class="c1"># We now update the RunningNorm which stores all the stats, and return the normalized observation.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">update_and_normalize</span><span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                <span class="c1"># This is the case where the `update_stats` argument was encountered as False.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                <span class="c1"># Here we normalize the observation but do not update our existing RunningNorm instances.</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>            <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>            <span class="c1"># This is the case where observation normalization is disabled.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>            <span class="c1"># In this case, we just return the observation as it is.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>            <span class="k">return</span> <span class="n">observation</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_ensure_obsnorm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This feature can only be used when observation_normalization=True.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunningNorm</span><span class="p">:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_sync_data_for_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>            <span class="n">obs_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_observation_stats</span><span class="p">()</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="k">if</span> <span class="n">obs_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>                <span class="n">obs_stats</span> <span class="o">=</span> <span class="n">obs_stats</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">obs_stats</span><span class="o">=</span><span class="n">obs_stats</span><span class="p">)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rn</span><span class="p">:</span> <span class="n">RunningNorm</span><span class="p">):</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="o">=</span> <span class="n">rn</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_use_sync_data_from_main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">received</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">received</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;obs_stats&quot;</span><span class="p">:</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_observation_stats</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pop_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunningNorm</span><span class="p">:</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get and clear the collected observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_sync_data_for_main</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>        <span class="n">result</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">episode_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span><span class="p">,</span> <span class="n">interaction_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span><span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>            <span class="n">collected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_observation_stats</span><span class="p">()</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="k">if</span> <span class="n">collected</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>                <span class="n">collected</span> <span class="o">=</span> <span class="n">collected</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_stats_delta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">collected</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rn</span><span class="p">:</span> <span class="n">RunningNorm</span><span class="p">):</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the observation stats via another RunningNorm instance&quot;&quot;&quot;</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="o">=</span> <span class="n">rn</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rn</span><span class="p">)</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_use_sync_data_from_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">received</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="n">total_episode_count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>        <span class="n">total_interaction_count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">received</span><span class="p">:</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>            <span class="n">total_episode_count</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;episode_count&quot;</span><span class="p">]</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>            <span class="n">total_interaction_count</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;interaction_count&quot;</span><span class="p">]</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span><span class="p">:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_observation_stats</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;obs_stats_delta&quot;</span><span class="p">])</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_episode_count</span><span class="p">(</span><span class="n">total_episode_count</span><span class="p">)</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_interaction_count</span><span class="p">(</span><span class="n">total_interaction_count</span><span class="p">)</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_pickle_data_for_main</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="c1"># For when the main Problem object (the non-remote one) gets pickled,</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="c1"># this function returns the counters of this remote Problem instance,</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="c1"># to be sent to the main one.</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">interaction_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span><span class="p">,</span> <span class="n">episode_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span><span class="p">)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_use_pickle_data_from_main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="c1"># For when a newly unpickled Problem object gets (re)parallelized,</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="c1"># this function restores the inner states specific to this remote</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>        <span class="c1"># worker. In the case of GymNE, those inner states are episode</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="c1"># and interaction counters.</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;episode_count&quot;</span><span class="p">:</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_episode_count</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;interaction_count&quot;</span><span class="p">:</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_interaction_count</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When restoring the inner state of a remote worker, unrecognized state key: </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_evaluate_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_subbatch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>            <span class="n">subbatches</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs</span><span class="p">)</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>            <span class="k">for</span> <span class="n">subbatch</span> <span class="ow">in</span> <span class="n">subbatches</span><span class="p">:</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_subbatch</span><span class="p">(</span><span class="n">subbatch</span><span class="p">)</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_evaluate_subbatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="c1"># Get the number of solutions and the solution batch from the shape of the batch.</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>        <span class="n">num_solutions</span><span class="p">,</span> <span class="n">solution_length</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">values_shape</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>        <span class="c1"># Get (possibly after (re)building) the environment object.</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">(</span><span class="n">num_solutions</span><span class="p">)</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>        <span class="c1"># Reset the environment and receive the first observation batch.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>        <span class="n">obs_per_env</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>        <span class="c1"># Update the simulator device according to the device of the observation batch received.</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span> <span class="o">=</span> <span class="n">obs_per_env</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="c1"># Get the number of environments.</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="n">num_envs</span> <span class="o">=</span> <span class="n">obs_per_env</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>        <span class="c1"># Transfer (if necessary) the solutions (which are the network parameters) to the simulator device.</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>        <span class="n">batch_values</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span><span class="p">)</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>        <span class="k">if</span> <span class="n">num_solutions</span> <span class="o">==</span> <span class="n">num_envs</span><span class="p">:</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>            <span class="c1"># If the number of solutions is equal to the number of environments, then we declare all of the solutions</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>            <span class="c1"># as the network parameters, and we declare all of these environments active.</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="n">params_per_env</span> <span class="o">=</span> <span class="n">batch_values</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="n">active_per_env</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_solutions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span><span class="p">)</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>        <span class="k">elif</span> <span class="n">num_solutions</span> <span class="o">&lt;</span> <span class="n">num_envs</span><span class="p">:</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>            <span class="c1"># If the number of solutions is less than the number of environments, then we allocate a new empty</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>            <span class="c1"># tensor to represent the network parameters.</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>            <span class="n">params_per_env</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">num_envs</span><span class="p">,</span> <span class="n">solution_length</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">batch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span><span class="p">)</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>            <span class="c1"># The first `num_solutions` rows of this new parameters tensor is filled with the values of the solutions.</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>            <span class="n">params_per_env</span><span class="p">[:</span><span class="n">num_solutions</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">batch_values</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>            <span class="c1"># The remaining parameters become the clones of the first solution.</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>            <span class="n">params_per_env</span><span class="p">[</span><span class="n">num_solutions</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">batch_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>            <span class="c1"># At first, all the environments are declared as inactive.</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>            <span class="n">active_per_env</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_envs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span><span class="p">)</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>            <span class="c1"># Now, the first `num_solutions` amount of environments is declared as active.</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>            <span class="c1"># The remaining ones remain inactive.</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>            <span class="n">active_per_env</span><span class="p">[:</span><span class="n">num_solutions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Received incompatible number of environments&quot;</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="c1"># We get the policy and fill it with the parameters stored by the solutions.</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>        <span class="n">policy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_policy</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>        <span class="n">policy</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">params_per_env</span><span class="p">)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="c1"># Declare the counter which stores the total timesteps encountered during this evaluation.</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>        <span class="n">total_timesteps</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>        <span class="c1"># Declare the counters (one for each environment) storing the number of episodes completed.</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>        <span class="n">num_eps_per_env</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_envs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span><span class="p">)</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>        <span class="c1"># Declare the scores (one for each environment).</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>        <span class="n">score_per_env</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_envs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span><span class="p">)</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>            <span class="c1"># If an alive_bonus_schedule was provided, then we extract the timesteps.</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>            <span class="c1"># bonus_t0 is the timestep where the partial alive bonus will start.</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>            <span class="c1"># bonus_t1 is the timestep where the full alive bonus will start.</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>            <span class="c1"># alive_bonus is the amount that will be added to reward if the agent is alive.</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>            <span class="n">bonus_t0</span><span class="p">,</span> <span class="n">bonus_t1</span><span class="p">,</span> <span class="n">alive_bonus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>            <span class="k">if</span> <span class="n">bonus_t1</span> <span class="o">&gt;</span> <span class="n">bonus_t0</span><span class="p">:</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>                <span class="c1"># If bonus_t1 is bigger than bonus_t0, then we have a partial alive bonus time window.</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>                <span class="n">add_partial_alive_bonus</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                <span class="c1"># We compute and store the length of the time window.</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>                <span class="n">bonus_t_gap_as_float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">bonus_t1</span> <span class="o">-</span> <span class="n">bonus_t0</span><span class="p">)</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>                <span class="c1"># If bonus_t1 is NOT bigger than bonus_t0, then we do NOT have a partial alive bonus time window.</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>                <span class="n">add_partial_alive_bonus</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>            <span class="c1"># To properly give the alive bonus for each solution, we need to keep track of the timesteps for all</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>            <span class="c1"># the running solutions. So, we declare the following variable.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>            <span class="n">t_per_env</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_envs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span><span class="p">)</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="n">observations</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">mask</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>            <span class="n">original_observations</span> <span class="o">=</span> <span class="n">observations</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>            <span class="n">observations</span> <span class="o">=</span> <span class="n">observations</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>            <span class="k">if</span> <span class="n">observations</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>                <span class="k">return</span> <span class="n">observations</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>                <span class="n">normalized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_observation</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>                <span class="n">modified_observations</span> <span class="o">=</span> <span class="n">original_observations</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>                <span class="n">modified_observations</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">normalized</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>                <span class="k">return</span> <span class="n">modified_observations</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>        <span class="c1"># We normalize the initial observation.</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>        <span class="c1"># obs_per_env = self._normalize_observation(obs_per_env, mask=active_per_env)</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="n">obs_per_env</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">obs_per_env</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">active_per_env</span><span class="p">)</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>            <span class="c1"># Pass the observations through the policy and get the actions to perform.</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>            <span class="n">action_per_env</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">obs_per_env</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">params_per_env</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action_noise_stdev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>                <span class="c1"># If we are to apply action noise, we sample from a Gaussian distribution and add the noise onto</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>                <span class="c1"># the actions.</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>                <span class="n">action_per_env</span> <span class="o">=</span> <span class="n">action_per_env</span> <span class="o">+</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand_like</span><span class="p">(</span><span class="n">action_per_env</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action_noise_stdev</span><span class="p">)</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>            <span class="c1"># Apply the actions, get the observations, rewards, and the &#39;done&#39; flags.</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>            <span class="n">obs_per_env</span><span class="p">,</span> <span class="n">reward_per_env</span><span class="p">,</span> <span class="n">done_per_env</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action_per_env</span><span class="p">)</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decrease_rewards_by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>                <span class="c1"># We decrease the rewards, if we have the configuration to do so.</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>                <span class="n">reward_per_env</span> <span class="o">=</span> <span class="n">reward_per_env</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decrease_rewards_by</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>                <span class="c1"># Here we handle the alive bonus schedule.</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>                <span class="c1"># For each environment, increment the timestep.</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>                <span class="n">t_per_env</span><span class="p">[</span><span class="n">active_per_env</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>                <span class="c1"># For those who are within the full alive bonus time region, increase the scores by the full amount.</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                <span class="n">in_full_bonus_t_per_env</span> <span class="o">=</span> <span class="n">active_per_env</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t_per_env</span> <span class="o">&gt;=</span> <span class="n">bonus_t1</span><span class="p">)</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>                <span class="n">score_per_env</span><span class="p">[</span><span class="n">in_full_bonus_t_per_env</span><span class="p">]</span> <span class="o">+=</span> <span class="n">alive_bonus</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>                <span class="k">if</span> <span class="n">add_partial_alive_bonus</span><span class="p">:</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>                    <span class="c1"># Here we handle the partial alive bonus time window.</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                    <span class="c1"># We first determine which environments are in the partial alive bonus time window.</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                    <span class="n">in_partial_bonus_t_per_env</span> <span class="o">=</span> <span class="n">active_per_env</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t_per_env</span> <span class="o">&gt;=</span> <span class="n">bonus_t0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t_per_env</span> <span class="o">&lt;</span> <span class="n">bonus_t1</span><span class="p">)</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>                    <span class="c1"># Here we compute the partial alive bonuses and add those bonuses to the scores.</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>                    <span class="n">score_per_env</span><span class="p">[</span><span class="n">in_partial_bonus_t_per_env</span><span class="p">]</span> <span class="o">+=</span> <span class="n">alive_bonus</span> <span class="o">*</span> <span class="p">(</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>                        <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">t_per_env</span><span class="p">[</span><span class="n">in_partial_bonus_t_per_env</span><span class="p">]</span> <span class="o">-</span> <span class="n">bonus_t0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>                        <span class="o">/</span> <span class="n">bonus_t_gap_as_float</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>                    <span class="p">)</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>                <span class="c1"># Determine which environments just finished their episodes.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>                <span class="n">just_finished_per_env</span> <span class="o">=</span> <span class="n">active_per_env</span> <span class="o">&amp;</span> <span class="n">done_per_env</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>                <span class="c1"># Reset the timestep counters of the environments which are just finished.</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>                <span class="n">t_per_env</span><span class="p">[</span><span class="n">just_finished_per_env</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>            <span class="c1"># For each active environment, increase the score by the reward received.</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>            <span class="n">score_per_env</span><span class="p">[</span><span class="n">active_per_env</span><span class="p">]</span> <span class="o">+=</span> <span class="n">reward_per_env</span><span class="p">[</span><span class="n">active_per_env</span><span class="p">]</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>            <span class="c1"># Update the total timesteps counter.</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>            <span class="n">total_timesteps</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">active_per_env</span><span class="p">))</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>            <span class="c1"># Reset the policies whose episodes are done (so that their hidden states become 0).</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>            <span class="n">policy</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">done_per_env</span><span class="p">)</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>            <span class="c1"># Update the number of episodes counter for each environment.</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>            <span class="n">num_eps_per_env</span><span class="p">[</span><span class="n">done_per_env</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>            <span class="c1"># Solutions with number of completed episodes larger than the number of allowed episodes become inactive.</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>            <span class="c1"># active_per_env[:num_solutions] = num_eps_per_env[:num_solutions] &lt; self._num_episodes</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>            <span class="n">active_per_env</span><span class="p">[:</span><span class="n">num_solutions</span><span class="p">]</span> <span class="o">=</span> <span class="n">active_per_env</span><span class="p">[:</span><span class="n">num_solutions</span><span class="p">]</span> <span class="o">&amp;</span> <span class="p">(</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>                <span class="n">num_eps_per_env</span><span class="p">[:</span><span class="n">num_solutions</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>            <span class="p">)</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">torch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">active_per_env</span><span class="p">[:</span><span class="n">num_solutions</span><span class="p">]):</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>                <span class="c1"># If there is not a single active solution left, then we exit this loop.</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>                <span class="k">break</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>            <span class="c1"># For the next iteration of this loop, we normalize the observation.</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>            <span class="c1"># obs_per_env = self._normalize_observation(obs_per_env, mask=active_per_env)</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>            <span class="n">obs_per_env</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">obs_per_env</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">active_per_env</span><span class="p">)</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>        <span class="c1"># Update the interaction count and the episode count stored by this VecGymNE instance.</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span> <span class="o">+=</span> <span class="n">total_timesteps</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span> <span class="o">+=</span> <span class="n">num_solutions</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="c1"># Compute the fitnesses</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>        <span class="n">fitnesses</span> <span class="o">=</span> <span class="n">score_per_env</span><span class="p">[:</span><span class="n">num_solutions</span><span class="p">]</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>            <span class="n">fitnesses</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>        <span class="c1"># Assign the scores to the solutions as fitnesses.</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>        <span class="n">batch</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="n">fitnesses</span><span class="p">)</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_env</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">]:</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">        Get the gym environment.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">            The gym environment if it is built. If not built yet, None.</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">with_wrapper_modules</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">        Convert the given solution to a policy.</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            solution: A solution which can be given as a `torch.Tensor`, as a</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">                `Solution`, or as any `Iterable`.</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            with_wrapper_modules: Whether or not to wrap the policy module</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">                with helper modules so that observations are normalized</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">                and actions are clipped to be within the correct boundaries.</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">                The default and the recommended value is True.</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">            The policy, as a `torch.nn.Module` instance.</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>        <span class="c1"># Get the gym environment</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>        <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>        <span class="c1"># Get the observation space, its lower and higher bounds.</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>        <span class="n">obs_space</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">single_action_space</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>        <span class="n">low</span> <span class="o">=</span> <span class="n">obs_space</span><span class="o">.</span><span class="n">low</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="n">high</span> <span class="o">=</span> <span class="n">obs_space</span><span class="o">.</span><span class="n">high</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>        <span class="c1"># If the lower and higher bounds are not -inf and +inf respectively, then this environment needs clipping.</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="n">needs_clipping</span> <span class="o">=</span> <span class="n">_numpy_arrays_specify_bounds</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>        <span class="c1"># Convert the solution to a PyTorch tensor on cpu.</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>        <span class="c1"># Convert the internally stored policy to a PyTorch module.</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_policy</span><span class="o">.</span><span class="n">to_torch_module</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>        <span class="k">if</span> <span class="n">with_wrapper_modules</span><span class="p">:</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>                <span class="c1"># If observation normalization is needed and there are collected observation stats, then we wrap the</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>                <span class="c1"># policy with an ObsNormWrapperModule.</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">ObsNormWrapperModule</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="p">)</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>            <span class="k">if</span> <span class="n">needs_clipping</span><span class="p">:</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>                <span class="c1"># If clipping is needed, then we wrap the policy with an ActClipWrapperModule</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">ActClipWrapperModule</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">obs_space</span><span class="p">)</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">fname</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">        Save the solution into a pickle file.</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        Among the saved data within the pickle file are the solution</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">        (as a PyTorch tensor), the policy (as a `torch.nn.Module` instance),</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">        and observation stats (if any).</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">            solution: The solution to be saved. This can be a PyTorch tensor,</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">                a `Solution` instance, or any `Iterable`.</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">            fname: The file name of the pickle file to be created.</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>        <span class="c1"># Convert the solution to a PyTorch tensor on the cpu.</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">ReadOnlyTensor</span><span class="p">):</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>            <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">as_subclass</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>        <span class="c1"># Store the solution and the policy.</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>            <span class="s2">&quot;solution&quot;</span><span class="p">:</span> <span class="n">solution</span><span class="p">,</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>            <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_policy</span><span class="p">(</span><span class="n">solution</span><span class="p">),</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>        <span class="p">}</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="c1"># If available, store the observation stats.</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_stdev&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">stdev</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_sum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">sum</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_sum_of_squares&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">sum_of_squares</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="c1"># Some additional data.</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;interaction_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;episode_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>            <span class="c1"># If the environment was specified via a string, store the string.</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;env&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>        <span class="c1"># Store the network architecture.</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;architecture&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_architecture</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>        <span class="c1"># Save the dictionary which stores the data.</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">max_num_envs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        Maximum number of environments to be allocated.</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">        If a maximum number of environments is not set, then None is returned.</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">        If this problem instance is the main one, then the overall maximum</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        number of environments is returned.</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">        If this problem instance is a remote one (i.e. is on a remote actor)</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">        then the maximum number of environments for that actor is returned.</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_num_envs</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">make_net</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">        Make a new policy network parameterized by the given solution.</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">        Note that this parameterized network assumes that the observation</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">        is already normalized, and it does not do action clipping to ensure</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">        that the generated actions are within valid bounds.</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">        To have a policy network which has its own observation normalization</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        and action clipping layers, please see the method `to_policy(...)`.</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">            solution: The solution which stores the parameters.</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">                This can be a Solution instance, or a 1-dimensional tensor,</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">                or any Iterable of real numbers.</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">            The policy network, as a PyTorch module.</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_policy</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">with_wrapper_modules</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">network_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]:</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">        The device on which the policy networks will operate.</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">        Specific to VecGymNE, the network device is determined only</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">        after receiving the first observation from the reinforcement</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">        learning environment. Until then, this property has the value</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">        None.</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="evotorch.neuroevolution.VecGymNE.episode_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">episode_count</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.neuroevolution.VecGymNE.episode_count" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the total number of episodes completed.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.neuroevolution.VecGymNE.interaction_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interaction_count</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.neuroevolution.VecGymNE.interaction_count" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the total number of simulator interactions made.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.neuroevolution.VecGymNE.max_num_envs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_num_envs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.neuroevolution.VecGymNE.max_num_envs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Maximum number of environments to be allocated.</p>
<p>If a maximum number of environments is not set, then None is returned.
If this problem instance is the main one, then the overall maximum
number of environments is returned.
If this problem instance is a remote one (i.e. is on a remote actor)
then the maximum number of environments for that actor is returned.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.neuroevolution.VecGymNE.network_device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">network_device</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.neuroevolution.VecGymNE.network_device" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The device on which the policy networks will operate.</p>
<p>Specific to VecGymNE, the network device is determined only
after receiving the first observation from the reinforcement
learning environment. Until then, this property has the value
None.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">env_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_num_envs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">network_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">observation_normalization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">decrease_rewards_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alive_bonus_schedule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">action_noise_stdev</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_episodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_actors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_gpus_per_actor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_subbatches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subbatch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">actor_config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the VecGymNE.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>env</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Environment to be solved.
If this is given as a string starting with "gym::" (e.g.
"gym::Humanoid-v4", etc.), then it is assumed that the target
environment is a classical gym environment.
If this is given as a string starting with "brax::" (e.g.
"brax::humanoid", etc.), then it is assumed that the target
environment is a brax environment.
If this is given as a string which does not contain "::" at
all (e.g. "Humanoid-v4", etc.), then it is assumed that the
target environment is a classical gym environment. Therefore,
"gym::Humanoid-v4" and "Humanoid-v4" are equivalent.
If this argument is given as a Callable (maybe a function or a
class), then, with the assumption that this Callable expects
a keyword argument <code>num_envs: int</code>, this Callable is called
and its result (expected as a <code>gym.vector.VectorEnv</code> instance)
is used as the environment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>network</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Callable">Callable</span>, <span title="torch.nn.Module">Module</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A network structure string, or a Callable (which can be
a class inheriting from <code>torch.nn.Module</code>, or a function
which returns a <code>torch.nn.Module</code> instance), or an instance
of <code>torch.nn.Module</code>.
The object provided here determines the structure of the
neural network whose parameters will be evolved.
A network structure string is a string which can be processed
by <code>evotorch.neuroevolution.net.str_to_net(...)</code>.
Please see the documentation of the function
<code>evotorch.neuroevolution.net.str_to_net(...)</code> to see how such
a neural network structure string looks like.
Note that this network can be a recurrent network.
When the network's <code>forward(...)</code> method can optionally accept
an additional positional argument for the hidden state of the
network and returns an additional value for its next state,
then the policy is treated as a recurrent one.
When the network is given as a callable object (e.g.
a subclass of <code>nn.Module</code> or a function) and this callable
object is decorated via <code>evotorch.decorators.pass_info</code>,
the following keyword arguments will be passed:
(i) <code>obs_length</code> (the length of the observation vector),
(ii) <code>act_length</code> (the length of the action vector),
(iii) <code>obs_shape</code> (the shape tuple of the observation space),
(iv) <code>act_shape</code> (the shape tuple of the action space),
(v) <code>obs_space</code> (the Box object specifying the observation
space, and
(vi) <code>act_space</code> (the Box object specifying the action
space). Note that <code>act_space</code> will always be given as a
<code>gym.spaces.Box</code> instance, even when the actual gym
environment has a discrete action space. This because
<code>VecGymNE</code> always expects the neural network to return
a tensor of floating-point numbers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>env_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="collections.abc.Mapping">Mapping</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the environment while
it is being created.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_num_envs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of environments to be instantiated.
By default, this is None, which means that the number of
environments can go up to the population size (or up to the
number of solutions that a remote actor receives, if the
problem object is configured to have parallelization).
For situations where the current reinforcement learning task
requires large amount of resources (e.g. memory), allocating
environments as much as the number of solutions might not
be feasible. In such cases, one can set <code>max_num_envs</code> as an
integer to bring an upper bound (in total, across all the
remote actors, for when the problem is parallelized) to how
many environments can be allocated.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>network_args</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="collections.abc.Mapping">Mapping</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any additional keyword argument to be used when
instantiating the network can be specified via <code>network_args</code>
as a dictionary. If there are no such additional keyword
arguments, then <code>network_args</code> can be left as None.
Note that the argument <code>network_args</code> is expected to be None
when the network is specified as a <code>torch.nn.Module</code> instance.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>observation_normalization</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not online normalization
will be done on the encountered observations.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>decrease_rewards_by</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as a float, each reward will be
decreased by this amount. For example, if the environment's
reward function has a constant "alive bonus" (i.e. a bonus
that is constantly added onto the reward as long as the
agent is alive), and if you wish to negate this bonus,
you can set <code>decrease_rewards_by</code> to this bonus amount,
and the bonus will be nullified.
If you do not wish to affect the rewards in this manner,
keep this as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alive_bonus_schedule</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Use this to add a customized amount of
alive bonus.
If left as None (which is the default), additional alive
bonus will not be added.
If given as a tuple <code>(t, b)</code>, an alive bonus <code>b</code> will be
added onto all the rewards beyond the timestep <code>t</code>.
If given as a tuple <code>(t0, t1, b)</code>, a partial (linearly
increasing towards <code>b</code>) alive bonus will be added onto
all the rewards between the timesteps <code>t0</code> and <code>t1</code>,
and a full alive bonus (which equals to <code>b</code>) will be added
onto all the rewards beyond the timestep <code>t1</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>action_noise_stdev</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as a real number <code>s</code>, then, for
each generated action, Gaussian noise with standard
deviation <code>s</code> will be sampled, and then this sampled noise
will be added onto the action.
If action noise is not desired, then this argument can be
left as None.
For sampling the noise, the global random number generator
of PyTorch on the simulator's device will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_episodes</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of episodes over which each policy will
be evaluated. The default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the population will be kept.
If you wish to do a single-GPU evolution, we recommend
to set this as "cuda" (or "cuda:0", or "cuda:1", etc.),
assuming that the simulator will also instantiate itself
on that same device.
Alternatively, if you wish to do a multi-GPU evolution,
we recommend to leave this as None or set this as "cpu",
so that the main population will be kept on the cpu
and the remote actors will perform their evaluations on
the GPUs that are assigned to them.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_actors</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of actors to create for parallelized
evaluation of the solutions.
Certain string values are also accepted.
When given as "max" or as "num_cpus", the number of actors
will be equal to the number of all available CPUs in the ray
cluster.
When given as "num_gpus", the number of actors will be
equal to the number of all available GPUs in the ray
cluster, and each actor will be assigned a GPU.
When given as "num_devices", the number of actors will be
equal to the minimum among the number of CPUs and the number
of GPUs available in the cluster (or will be equal to the
number of CPUs if there is no GPU), and each actor will be
assigned a GPU (if available).
If <code>num_actors</code> is given as "num_gpus" or "num_devices",
the argument <code>num_gpus_per_actor</code> must not be used,
and the <code>actor_config</code> dictionary must not contain the
key "num_gpus".
If <code>num_actors</code> is given as something other than "num_gpus"
or "num_devices", and if you wish to assign GPUs to each
actor, then please see the argument <code>num_gpus_per_actor</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_gpus_per_actor</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of GPUs to be assigned to each
actor. This can be an integer or a float (for when you
wish to assign fractional amounts of GPUs to actors).
When <code>num_actors</code> has the special value "num_devices",
the argument <code>num_gpus_per_actor</code> is expected to be left as
None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_subbatches</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For when there are multiple actors, you can
set this to an integer n if you wish the population
to be divided exactly into n sub-batches. The actors, as they
finish their currently assigned sub-batch of solutions,
will pick the next un-evaluated sub-batch.
If you specify too large numbers for this argument, then
each sub-batch will be smaller.
When working with vectorized simulators on GPU, having too
many and too small sub-batches can hurt the performance.
This argument can be left as None, in which case, assuming
that <code>subbatch_size</code> is also None, the population will be
split to m sub-batches, m being the number of actors.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subbatch_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For when there are multiple actors, you can
set this to an integer n if you wish the population to be
divided into sub-batches in such a way that each sub-batch
will consist of exactly n solutions. The actors, as they
finish their currently assigned sub-batch of solutions,
will pick the next un-evaluated sub-batch.
If you specify too small numbers for this argument, then
there will be many sub-batches, each sub-batch having a
small number of solutions.
When working with vectorized simulators on GPU, having too
many and too small sub-batches can hurt the performance.
This argument can be left as None, in which case, assuming
that <code>num_subbatches</code> is also None, the population will be
split to m sub-batches, m being the number of actors.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="collections.abc.Mapping">Mapping</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional configuration to be used when creating
each actor with the help of <code>ray</code> library.
Can be left as None if additional configuration is not needed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">env</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">network</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">],</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">env_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">max_num_envs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">network_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">observation_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">decrease_rewards_by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">alive_bonus_schedule</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">action_noise_stdev</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">num_episodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">num_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">num_gpus_per_actor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="p">):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    Initialize the VecGymNE.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        env: Environment to be solved.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            If this is given as a string starting with &quot;gym::&quot; (e.g.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            &quot;gym::Humanoid-v4&quot;, etc.), then it is assumed that the target</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            environment is a classical gym environment.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            If this is given as a string starting with &quot;brax::&quot; (e.g.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            &quot;brax::humanoid&quot;, etc.), then it is assumed that the target</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            environment is a brax environment.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            If this is given as a string which does not contain &quot;::&quot; at</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            all (e.g. &quot;Humanoid-v4&quot;, etc.), then it is assumed that the</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            target environment is a classical gym environment. Therefore,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            &quot;gym::Humanoid-v4&quot; and &quot;Humanoid-v4&quot; are equivalent.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            If this argument is given as a Callable (maybe a function or a</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            class), then, with the assumption that this Callable expects</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            a keyword argument `num_envs: int`, this Callable is called</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            and its result (expected as a `gym.vector.VectorEnv` instance)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            is used as the environment.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        network: A network structure string, or a Callable (which can be</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            a class inheriting from `torch.nn.Module`, or a function</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            which returns a `torch.nn.Module` instance), or an instance</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            of `torch.nn.Module`.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            The object provided here determines the structure of the</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            neural network whose parameters will be evolved.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            A network structure string is a string which can be processed</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            by `evotorch.neuroevolution.net.str_to_net(...)`.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            Please see the documentation of the function</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            `evotorch.neuroevolution.net.str_to_net(...)` to see how such</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            a neural network structure string looks like.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            Note that this network can be a recurrent network.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            When the network&#39;s `forward(...)` method can optionally accept</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            an additional positional argument for the hidden state of the</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            network and returns an additional value for its next state,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            then the policy is treated as a recurrent one.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            When the network is given as a callable object (e.g.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            a subclass of `nn.Module` or a function) and this callable</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            object is decorated via `evotorch.decorators.pass_info`,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            the following keyword arguments will be passed:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            (i) `obs_length` (the length of the observation vector),</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            (ii) `act_length` (the length of the action vector),</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            (iii) `obs_shape` (the shape tuple of the observation space),</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            (iv) `act_shape` (the shape tuple of the action space),</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            (v) `obs_space` (the Box object specifying the observation</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            space, and</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            (vi) `act_space` (the Box object specifying the action</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            space). Note that `act_space` will always be given as a</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            `gym.spaces.Box` instance, even when the actual gym</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            environment has a discrete action space. This because</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            `VecGymNE` always expects the neural network to return</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            a tensor of floating-point numbers.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        env_config: Keyword arguments to pass to the environment while</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            it is being created.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        max_num_envs: Maximum number of environments to be instantiated.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            By default, this is None, which means that the number of</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            environments can go up to the population size (or up to the</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            number of solutions that a remote actor receives, if the</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            problem object is configured to have parallelization).</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            For situations where the current reinforcement learning task</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            requires large amount of resources (e.g. memory), allocating</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            environments as much as the number of solutions might not</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            be feasible. In such cases, one can set `max_num_envs` as an</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            integer to bring an upper bound (in total, across all the</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            remote actors, for when the problem is parallelized) to how</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            many environments can be allocated.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        network_args: Any additional keyword argument to be used when</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            instantiating the network can be specified via `network_args`</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            as a dictionary. If there are no such additional keyword</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            arguments, then `network_args` can be left as None.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            Note that the argument `network_args` is expected to be None</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            when the network is specified as a `torch.nn.Module` instance.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        observation_normalization: Whether or not online normalization</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            will be done on the encountered observations.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        decrease_rewards_by: If given as a float, each reward will be</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">            decreased by this amount. For example, if the environment&#39;s</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            reward function has a constant &quot;alive bonus&quot; (i.e. a bonus</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            that is constantly added onto the reward as long as the</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">            agent is alive), and if you wish to negate this bonus,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            you can set `decrease_rewards_by` to this bonus amount,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            and the bonus will be nullified.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            If you do not wish to affect the rewards in this manner,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            keep this as None.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        alive_bonus_schedule: Use this to add a customized amount of</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            alive bonus.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            If left as None (which is the default), additional alive</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            bonus will not be added.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            If given as a tuple `(t, b)`, an alive bonus `b` will be</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            added onto all the rewards beyond the timestep `t`.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            If given as a tuple `(t0, t1, b)`, a partial (linearly</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            increasing towards `b`) alive bonus will be added onto</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            all the rewards between the timesteps `t0` and `t1`,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            and a full alive bonus (which equals to `b`) will be added</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            onto all the rewards beyond the timestep `t1`.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        action_noise_stdev: If given as a real number `s`, then, for</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">            each generated action, Gaussian noise with standard</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">            deviation `s` will be sampled, and then this sampled noise</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            will be added onto the action.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">            If action noise is not desired, then this argument can be</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            left as None.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            For sampling the noise, the global random number generator</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            of PyTorch on the simulator&#39;s device will be used.</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        num_episodes: Number of episodes over which each policy will</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            be evaluated. The default is 1.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        device: The device in which the population will be kept.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">            If you wish to do a single-GPU evolution, we recommend</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">            to set this as &quot;cuda&quot; (or &quot;cuda:0&quot;, or &quot;cuda:1&quot;, etc.),</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            assuming that the simulator will also instantiate itself</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">            on that same device.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">            Alternatively, if you wish to do a multi-GPU evolution,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            we recommend to leave this as None or set this as &quot;cpu&quot;,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            so that the main population will be kept on the cpu</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            and the remote actors will perform their evaluations on</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            the GPUs that are assigned to them.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        num_actors: Number of actors to create for parallelized</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            evaluation of the solutions.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            Certain string values are also accepted.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            When given as &quot;max&quot; or as &quot;num_cpus&quot;, the number of actors</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">            will be equal to the number of all available CPUs in the ray</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            cluster.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            When given as &quot;num_gpus&quot;, the number of actors will be</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            equal to the number of all available GPUs in the ray</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            cluster, and each actor will be assigned a GPU.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            When given as &quot;num_devices&quot;, the number of actors will be</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            equal to the minimum among the number of CPUs and the number</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            of GPUs available in the cluster (or will be equal to the</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            number of CPUs if there is no GPU), and each actor will be</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            assigned a GPU (if available).</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            If `num_actors` is given as &quot;num_gpus&quot; or &quot;num_devices&quot;,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            the argument `num_gpus_per_actor` must not be used,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            and the `actor_config` dictionary must not contain the</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            key &quot;num_gpus&quot;.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            If `num_actors` is given as something other than &quot;num_gpus&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            or &quot;num_devices&quot;, and if you wish to assign GPUs to each</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            actor, then please see the argument `num_gpus_per_actor`.</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        num_gpus_per_actor: Number of GPUs to be assigned to each</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            actor. This can be an integer or a float (for when you</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            wish to assign fractional amounts of GPUs to actors).</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            When `num_actors` has the special value &quot;num_devices&quot;,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            the argument `num_gpus_per_actor` is expected to be left as</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            None.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        num_subbatches: For when there are multiple actors, you can</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            set this to an integer n if you wish the population</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            to be divided exactly into n sub-batches. The actors, as they</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            finish their currently assigned sub-batch of solutions,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">            will pick the next un-evaluated sub-batch.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">            If you specify too large numbers for this argument, then</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            each sub-batch will be smaller.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">            When working with vectorized simulators on GPU, having too</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            many and too small sub-batches can hurt the performance.</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">            This argument can be left as None, in which case, assuming</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            that `subbatch_size` is also None, the population will be</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">            split to m sub-batches, m being the number of actors.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        subbatch_size: For when there are multiple actors, you can</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            set this to an integer n if you wish the population to be</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            divided into sub-batches in such a way that each sub-batch</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">            will consist of exactly n solutions. The actors, as they</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">            finish their currently assigned sub-batch of solutions,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            will pick the next un-evaluated sub-batch.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            If you specify too small numbers for this argument, then</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            there will be many sub-batches, each sub-batch having a</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            small number of solutions.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">            When working with vectorized simulators on GPU, having too</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            many and too small sub-batches can hurt the performance.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">            This argument can be left as None, in which case, assuming</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">            that `num_subbatches` is also None, the population will be</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            split to m sub-batches, m being the number of actors.</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        actor_config: Additional configuration to be used when creating</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            each actor with the help of `ray` library.</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            Can be left as None if additional configuration is not needed.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="c1"># Store the string or the Callable that will be used to generate the reinforcement learning environment.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span> <span class="o">=</span> <span class="n">env</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="c1"># Declare the variable which will store the environment.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TorchWrapper</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="c1"># Declare the variable which will store the batch size of the vectorized environment.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_num_envs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="c1"># Store the upper bound (if any) regarding how many environments can exist at the same time.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_max_num_envs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">max_num_envs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_num_envs</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="c1"># Actor-specific upper bound regarding how many environments can exist at the same time.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="c1"># This variable will be filled by the `_parallelize(...)` method.</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="c1"># Declare the variable which stores whether or not we properly initialized the `_actor_max_num_envs` variable.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_actor_max_num_envs_ready</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="c1"># Store the additional configurations to be used as keyword arguments while instantiating the environment.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">env_config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">(</span><span class="n">env_config</span><span class="p">)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="c1"># Declare the variable that will store the device of the simulator.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="c1"># This variable will be filled when the first observation is received from the environment.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="c1"># The device of the observation array received from the environment will determine the value of this variable.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_simulator_device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="c1"># Store the neural network architecture (that might be a string or an `nn.Module` instance).</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_architecture</span> <span class="o">=</span> <span class="n">network</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="k">if</span> <span class="n">network_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="c1"># If `network_args` is given as None, change it to an empty dictionary</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="n">network_args</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="c1"># If the network is given as a string, then we will need the values for the constants `obs_length`,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="c1"># `act_length`, and `obs_space`. To obtain those values, we use our helper function</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="c1"># `_env_constants_for_str_net(...)` which temporarily instantiates the specified environment and returns</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="c1"># its needed constants.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="n">env_constants</span> <span class="o">=</span> <span class="n">_env_constants_for_str_net</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">))</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="c1"># If the network is an already instantiated nn.Module, then we do not prepare any pre-defined constants.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="n">env_constants</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="c1"># If the network is given as a Callable, then we will need the values for the constants `obs_length`,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="c1"># `act_length`, and `obs_space`. To obtain those values, we use our helper function</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="c1"># `_env_constants_for_callable_net(...)` which temporarily instantiates the specified environment and</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="c1"># returns its needed constants.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="n">env_constants</span> <span class="o">=</span> <span class="n">_env_constants_for_callable_net</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_config</span><span class="p">))</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="c1"># Build a `Policy` instance according to the given architecture, and store it.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="n">instantiated_net</span> <span class="o">=</span> <span class="n">str_to_net</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="n">env_constants</span><span class="p">,</span> <span class="o">**</span><span class="n">network_args</span><span class="p">})</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="n">instantiated_net</span> <span class="o">=</span> <span class="n">network</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="n">instantiated_net</span> <span class="o">=</span> <span class="n">pass_info_if_needed</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">env_constants</span><span class="p">)(</span><span class="o">**</span><span class="n">network_args</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">instantiated_net</span><span class="p">)</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="c1"># Store the boolean which indicates whether or not there will be observation normalization.</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_observation_normalization</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">observation_normalization</span><span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="c1"># Declare the variables that will store the observation-related stats if observation normalization is enabled.</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunningNorm</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunningNorm</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="c1"># Store the number of episodes configuration given by the user.</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_num_episodes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_episodes</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="c1"># Store the `decrease_rewards_by` configuration given by the user.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_decrease_rewards_by</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">decrease_rewards_by</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">decrease_rewards_by</span><span class="p">)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="k">if</span> <span class="n">alive_bonus_schedule</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="c1"># If `alive_bonus_schedule` argument is None, then we store it as None as well.</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="c1"># This is the case where the user has specified an `alive_bonus_schedule`.</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="n">alive_bonus_schedule</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="n">alive_bonus_schedule_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="k">if</span> <span class="n">alive_bonus_schedule_length</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="c1"># If `alive_bonus_schedule` was given as a 2-element sequence (t, b), then store it as (t, t, b).</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="c1"># This means that the partial alive bonus time window starts and ends at t, therefore, there will</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="c1"># be no alive bonus until t, and beginning with t, there will be full alive bonus.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                <span class="nb">int</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="nb">int</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="nb">float</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="p">]</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">elif</span> <span class="n">alive_bonus_schedule_length</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="c1"># If `alive_bonus_schedule` was given as a 3-element sequence (t0, t1, b), then store those 3</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="c1"># elements.</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="nb">int</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                <span class="nb">int</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                <span class="nb">float</span><span class="p">(</span><span class="n">alive_bonus_schedule</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="p">]</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="c1"># `alive_bonus_schedule` sequences with unrecognized lengths trigger an error.</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                <span class="sa">f</span><span class="s2">&quot;Received invalid number elements as the alive bonus schedule.&quot;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                <span class="sa">f</span><span class="s2">&quot; Expected 2 or 3 items, but got these: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                <span class="sa">f</span><span class="s2">&quot; (having a length of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alive_bonus_schedule</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="c1"># If `action_noise_stdev` is specified, store it.</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_action_noise_stdev</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">action_noise_stdev</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">action_noise_stdev</span><span class="p">)</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="c1"># Initialize the counters for the number of simulator interactions and the number of episodes.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="n">device_is_cpu</span> <span class="o">=</span> <span class="p">(</span><span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="n">actors_use_gpu</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="p">(</span><span class="n">num_actors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="ow">and</span> <span class="p">(</span><span class="n">num_actors</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="ow">and</span> <span class="p">(</span><span class="n">num_gpus_per_actor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="ow">and</span> <span class="p">(</span><span class="n">num_gpus_per_actor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">device_is_cpu</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="c1"># In the case where the device is something other than the cpu, we tell SyncVectorEnv to use this device.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_device_for_sync_vector_env</span> <span class="o">=</span> <span class="n">device</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_vector_env_uses_aux_device</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="k">elif</span> <span class="n">actors_use_gpu</span><span class="p">:</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="c1"># In the case where this problem instance is configured to use multiple actors and the actors are</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="c1"># configured to use the available gpu(s), we tell SyncVectorEnv to use the `aux_device`.</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_device_for_sync_vector_env</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_vector_env_uses_aux_device</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_device_for_sync_vector_env</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_vector_env_uses_aux_device</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="c1"># Call the superclass</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="n">objective_sense</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">initial_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">),</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="n">solution_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_policy</span><span class="o">.</span><span class="n">parameter_length</span><span class="p">,</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="n">num_actors</span><span class="o">=</span><span class="n">num_actors</span><span class="p">,</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="n">num_gpus_per_actor</span><span class="o">=</span><span class="n">num_gpus_per_actor</span><span class="p">,</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="n">actor_config</span><span class="o">=</span><span class="n">actor_config</span><span class="p">,</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="n">num_subbatches</span><span class="o">=</span><span class="n">num_subbatches</span><span class="p">,</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="n">subbatch_size</span><span class="o">=</span><span class="n">subbatch_size</span><span class="p">,</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">after_eval_hook</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extra_status</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.get_env" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_env</span><span class="p">()</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.get_env" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the gym environment.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="gymnasium.Env">Env</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The gym environment if it is built. If not built yet, None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_env</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">]:</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">    Get the gym environment.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">        The gym environment if it is built. If not built yet, None.</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.get_observation_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_observation_stats</span><span class="p">()</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.get_observation_stats" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the observation stats</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunningNorm</span><span class="p">:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.make_net" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_net</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.make_net" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Make a new policy network parameterized by the given solution.
Note that this parameterized network assumes that the observation
is already normalized, and it does not do action clipping to ensure
that the generated actions are within valid bounds.</p>
<p>To have a policy network which has its own observation normalization
and action clipping layers, please see the method <code>to_policy(...)</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>solution</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solution which stores the parameters.
This can be a Solution instance, or a 1-dimensional tensor,
or any Iterable of real numbers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_net</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">    Make a new policy network parameterized by the given solution.</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">    Note that this parameterized network assumes that the observation</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">    is already normalized, and it does not do action clipping to ensure</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">    that the generated actions are within valid bounds.</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">    To have a policy network which has its own observation normalization</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">    and action clipping layers, please see the method `to_policy(...)`.</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">        solution: The solution which stores the parameters.</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">            This can be a Solution instance, or a 1-dimensional tensor,</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">            or any Iterable of real numbers.</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">        The policy network, as a PyTorch module.</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_policy</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">with_wrapper_modules</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.pop_observation_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pop_observation_stats</span><span class="p">()</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.pop_observation_stats" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get and clear the collected observation stats</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="k">def</span><span class="w"> </span><span class="nf">pop_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunningNorm</span><span class="p">:</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get and clear the collected observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_collected_stats</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.save_solution" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_solution</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.save_solution" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Save the solution into a pickle file.
Among the saved data within the pickle file are the solution
(as a PyTorch tensor), the policy (as a <code>torch.nn.Module</code> instance),
and observation stats (if any).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>solution</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solution to be saved. This can be a PyTorch tensor,
a <code>Solution</code> instance, or any <code>Iterable</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fname</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file name of the pickle file to be created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">fname</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">    Save the solution into a pickle file.</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">    Among the saved data within the pickle file are the solution</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">    (as a PyTorch tensor), the policy (as a `torch.nn.Module` instance),</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">    and observation stats (if any).</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">        solution: The solution to be saved. This can be a PyTorch tensor,</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">            a `Solution` instance, or any `Iterable`.</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">        fname: The file name of the pickle file to be created.</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>    <span class="c1"># Convert the solution to a PyTorch tensor on the cpu.</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">ReadOnlyTensor</span><span class="p">):</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">as_subclass</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>    <span class="c1"># Store the solution and the policy.</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>        <span class="s2">&quot;solution&quot;</span><span class="p">:</span> <span class="n">solution</span><span class="p">,</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>        <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_policy</span><span class="p">(</span><span class="n">solution</span><span class="p">),</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>    <span class="p">}</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>    <span class="c1"># If available, store the observation stats.</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_stdev&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">stdev</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_sum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">sum</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;obs_sum_of_squares&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">sum_of_squares</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>    <span class="c1"># Some additional data.</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;interaction_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_count</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;episode_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">episode_count</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>        <span class="c1"># If the environment was specified via a string, store the string.</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;env&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env_maker</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>    <span class="c1"># Store the network architecture.</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;architecture&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_architecture</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>    <span class="c1"># Save the dictionary which stores the data.</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.set_episode_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_episode_count</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.set_episode_count" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the episode count manually.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_episode_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    Set the episode count manually.</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_episode_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.set_interaction_count" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_interaction_count</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.set_interaction_count" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the interaction count manually.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_interaction_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">    Set the interaction count manually.</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.set_observation_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_observation_stats</span><span class="p">(</span><span class="n">rn</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.set_observation_stats" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the observation stats</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rn</span><span class="p">:</span> <span class="n">RunningNorm</span><span class="p">):</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the observation stats&quot;&quot;&quot;</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="o">=</span> <span class="n">rn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.to_policy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_policy</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">with_wrapper_modules</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.to_policy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert the given solution to a policy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>solution</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A solution which can be given as a <code>torch.Tensor</code>, as a
<code>Solution</code>, or as any <code>Iterable</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_wrapper_modules</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to wrap the policy module
with helper modules so that observations are normalized
and actions are clipped to be within the correct boundaries.
The default and the recommended value is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">with_wrapper_modules</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">:</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">    Convert the given solution to a policy.</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">        solution: A solution which can be given as a `torch.Tensor`, as a</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            `Solution`, or as any `Iterable`.</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">        with_wrapper_modules: Whether or not to wrap the policy module</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">            with helper modules so that observations are normalized</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            and actions are clipped to be within the correct boundaries.</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            The default and the recommended value is True.</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">        The policy, as a `torch.nn.Module` instance.</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>    <span class="c1"># Get the gym environment</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>    <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_env</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>    <span class="c1"># Get the observation space, its lower and higher bounds.</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>    <span class="n">obs_space</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">single_action_space</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>    <span class="n">low</span> <span class="o">=</span> <span class="n">obs_space</span><span class="o">.</span><span class="n">low</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>    <span class="n">high</span> <span class="o">=</span> <span class="n">obs_space</span><span class="o">.</span><span class="n">high</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>    <span class="c1"># If the lower and higher bounds are not -inf and +inf respectively, then this environment needs clipping.</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>    <span class="n">needs_clipping</span> <span class="o">=</span> <span class="n">_numpy_arrays_specify_bounds</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>    <span class="c1"># Convert the solution to a PyTorch tensor on cpu.</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>        <span class="n">solution</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>    <span class="c1"># Convert the internally stored policy to a PyTorch module.</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_policy</span><span class="o">.</span><span class="n">to_torch_module</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>    <span class="k">if</span> <span class="n">with_wrapper_modules</span><span class="p">:</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_normalization</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>            <span class="c1"># If observation normalization is needed and there are collected observation stats, then we wrap the</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>            <span class="c1"># policy with an ObsNormWrapperModule.</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">ObsNormWrapperModule</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="p">)</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="k">if</span> <span class="n">needs_clipping</span><span class="p">:</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>            <span class="c1"># If clipping is needed, then we wrap the policy with an ActClipWrapperModule</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">ActClipWrapperModule</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">obs_space</span><span class="p">)</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.neuroevolution.VecGymNE.update_observation_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_observation_stats</span><span class="p">(</span><span class="n">rn</span><span class="p">)</span></code>

<a href="#evotorch.neuroevolution.VecGymNE.update_observation_stats" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the observation stats via another RunningNorm instance</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/neuroevolution/vecgymne.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_observation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rn</span><span class="p">:</span> <span class="n">RunningNorm</span><span class="p">):</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the observation stats via another RunningNorm instance&quot;&quot;&quot;</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_obsnorm</span><span class="p">()</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span> <span class="o">=</span> <span class="n">rn</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obs_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rn</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 NNAISENSE SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>