
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="EvoTorch is an open source evolutionary computation library developed at NNAISENSE, built on top of PyTorch.">
      
      
      
      
        <link rel="prev" href="../structures/">
      
      
        <link rel="next" href="../tensormaker/">
      
      
      <link rel="icon" href="../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Tensorframe - EvoTorch</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#evotorch.tools.tensorframe" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-header__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EvoTorch
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tensorframe
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../quickstart/" class="md-tabs__link">
        
  
  
    
  
  Quickstart

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../user_guide/general_usage/" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../advanced_usage/solution_batch/" class="md-tabs__link">
          
  
  
    
  
  Advanced Usage

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-nav__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EvoTorch
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/general_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/algorithm_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithm Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/algorithms_tour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms Tour
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/problems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Defining Problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/problem_parallelization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Problem Parallelization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/neuroevolution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/gym/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution for Gym
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/supervised_ne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervised Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/solution_batch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manipulating Solutions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/dist_based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributed Evolution Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/custom_ea/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Searchers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/custom_logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Loggers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/ray_cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Ray Clusters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Brax_Experiments_Visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization of the brax Experiment Results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Brax_Experiments_with_PGPE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving a Brax environment using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Evolving_Objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Feature_Space_Illumination_with_MAPElites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Space Illumination with MAPElites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Genetic_Programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic Programming using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Gym_Experiments_with_PGPE_and_CoSyNE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gym Experiments with PGPE and CoSyNE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Minimizing_Lennard-Jones_Atom_Cluster_Potentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimising Lennard-Jones Atom Cluster Potentials with Evolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Training_MNIST30K/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training MNIST30K
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Variational_Quantum_Eigensolvers_with_SNES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variational Quantum Eigensolvers with SNES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/batched_searches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maintaining a batch of populations using the functional EvoTorch API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/constrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving constrained optimization problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/func_rl_ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving objects using the functional operators API of EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/functional_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic algorithm with the help of functional operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/multiobj_batched_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multiobjective optimization via functional operators API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving reinforcement learning tasks using functional evolutionary algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/reacher_mpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Predictive Control (MPC) with EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Evotorch
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Evotorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimizers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8" id="__nav_6_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8">
            <span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/cmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ga
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/mapelites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mapelites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/pycmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pycmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/searchalgorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Searchalgorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/distributed/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Distributed
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_7" id="__nav_6_1_8_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_7">
            <span class="md-nav__icon md-icon"></span>
            Distributed
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/distributed/gaussian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/functional/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_8" id="__nav_6_1_8_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_8">
            <span class="md-nav__icon md-icon"></span>
            Functional
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcadam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcadam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funccem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funccem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcclipup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcclipup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcpgpe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcpgpe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcsgd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcsgd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/restarter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Restarter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_9" id="__nav_6_1_8_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_9">
            <span class="md-nav__icon md-icon"></span>
            Restarter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/restarter/modify_restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modify restart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/restarter/restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../neuroevolution/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9" id="__nav_6_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9">
            <span class="md-nav__icon md-icon"></span>
            Neuroevolution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/baseneproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Baseneproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/gymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/neproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/supervisedne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervisedne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/vecgymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecgymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../neuroevolution/net/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Net
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9_7" id="__nav_6_1_9_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_9_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9_7">
            <span class="md-nav__icon md-icon"></span>
            Net
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/layers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/multilayered/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multilayered
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/rl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rl
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/runningnorm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningnorm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/runningstat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningstat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/statefulmodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statefulmodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/vecrl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecrl
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../operators/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_10" id="__nav_6_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_10">
            <span class="md-nav__icon md-icon"></span>
            Operators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operators/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operators/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operators/real/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Real
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operators/sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sequence
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_11" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_11" id="__nav_6_1_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1_11">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../immutable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Immutable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../objectarray/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Objectarray
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ranking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ranking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readonlytensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Readonlytensor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recursiveprintable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recursiveprintable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Tensorframe
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Tensorframe
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe" class="md-nav__link">
    <span class="md-ellipsis">
      tensorframe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame" class="md-nav__link">
    <span class="md-ellipsis">
      TensorFrame
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.columns" class="md-nav__link">
    <span class="md-ellipsis">
      columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.device" class="md-nav__link">
    <span class="md-ellipsis">
      device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.is_read_only" class="md-nav__link">
    <span class="md-ellipsis">
      is_read_only
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.pick" class="md-nav__link">
    <span class="md-ellipsis">
      pick
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.argsort" class="md-nav__link">
    <span class="md-ellipsis">
      argsort
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.as_tensor" class="md-nav__link">
    <span class="md-ellipsis">
      as_tensor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.clone" class="md-nav__link">
    <span class="md-ellipsis">
      clone
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.cpu" class="md-nav__link">
    <span class="md-ellipsis">
      cpu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.cuda" class="md-nav__link">
    <span class="md-ellipsis">
      cuda
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.drop" class="md-nav__link">
    <span class="md-ellipsis">
      drop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.each" class="md-nav__link">
    <span class="md-ellipsis">
      each
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.get_read_only_view" class="md-nav__link">
    <span class="md-ellipsis">
      get_read_only_view
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.hstack" class="md-nav__link">
    <span class="md-ellipsis">
      hstack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.join" class="md-nav__link">
    <span class="md-ellipsis">
      join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.nlargest" class="md-nav__link">
    <span class="md-ellipsis">
      nlargest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.nsmallest" class="md-nav__link">
    <span class="md-ellipsis">
      nsmallest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.sort_values" class="md-nav__link">
    <span class="md-ellipsis">
      sort_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.to_string" class="md-nav__link">
    <span class="md-ellipsis">
      to_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.vstack" class="md-nav__link">
    <span class="md-ellipsis">
      vstack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.with_columns" class="md-nav__link">
    <span class="md-ellipsis">
      with_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.with_enforced_device" class="md-nav__link">
    <span class="md-ellipsis">
      with_enforced_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.without_enforced_device" class="md-nav__link">
    <span class="md-ellipsis">
      without_enforced_device
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensormaker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensormaker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe" class="md-nav__link">
    <span class="md-ellipsis">
      tensorframe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame" class="md-nav__link">
    <span class="md-ellipsis">
      TensorFrame
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.columns" class="md-nav__link">
    <span class="md-ellipsis">
      columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.device" class="md-nav__link">
    <span class="md-ellipsis">
      device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.is_read_only" class="md-nav__link">
    <span class="md-ellipsis">
      is_read_only
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.pick" class="md-nav__link">
    <span class="md-ellipsis">
      pick
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.argsort" class="md-nav__link">
    <span class="md-ellipsis">
      argsort
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.as_tensor" class="md-nav__link">
    <span class="md-ellipsis">
      as_tensor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.clone" class="md-nav__link">
    <span class="md-ellipsis">
      clone
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.cpu" class="md-nav__link">
    <span class="md-ellipsis">
      cpu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.cuda" class="md-nav__link">
    <span class="md-ellipsis">
      cuda
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.drop" class="md-nav__link">
    <span class="md-ellipsis">
      drop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.each" class="md-nav__link">
    <span class="md-ellipsis">
      each
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.get_read_only_view" class="md-nav__link">
    <span class="md-ellipsis">
      get_read_only_view
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.hstack" class="md-nav__link">
    <span class="md-ellipsis">
      hstack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.join" class="md-nav__link">
    <span class="md-ellipsis">
      join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.nlargest" class="md-nav__link">
    <span class="md-ellipsis">
      nlargest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.nsmallest" class="md-nav__link">
    <span class="md-ellipsis">
      nsmallest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.sort_values" class="md-nav__link">
    <span class="md-ellipsis">
      sort_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.to_string" class="md-nav__link">
    <span class="md-ellipsis">
      to_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.vstack" class="md-nav__link">
    <span class="md-ellipsis">
      vstack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.with_columns" class="md-nav__link">
    <span class="md-ellipsis">
      with_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.with_enforced_device" class="md-nav__link">
    <span class="md-ellipsis">
      with_enforced_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.tensorframe.TensorFrame.without_enforced_device" class="md-nav__link">
    <span class="md-ellipsis">
      without_enforced_device
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Tensorframe</h1>

<div class="doc doc-object doc-module">



<a id="evotorch.tools.tensorframe"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="evotorch.tools.tensorframe.TensorFrame" class="doc doc-heading">
            <code>TensorFrame</code>


<a href="#evotorch.tools.tensorframe.TensorFrame" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="RecursivePrintable (evotorch.tools.recursiveprintable.RecursivePrintable)" href="../recursiveprintable/#evotorch.tools.recursiveprintable.RecursivePrintable">RecursivePrintable</a></code></p>


        <p>A structure which allows one to manipulate tensors in a tabular manner.
The interface of this structure is inspired by the <code>DataFrame</code> class
of the <code>pandas</code> library.</p>
<p><strong>Motivation.</strong>
It is a common scenario to have to work with arrays/tensors that are
associated with each other (e.g. when working on a knapsack problem, we
could have arrays <code>A</code> and <code>B</code>, where <code>A[i]</code> represents the value of the
i-th item and <code>B[i]</code> represents the weight of the i-th item).
A practical approach for such cases is to organize those arrays and
operate on them in a tabular manner. <code>pandas</code> is a popular library
for doing such tabular operations.</p>
<p>In the context of evolutionary computation, efficiency via vectorization
and/or parallelization becomes an important concern. For example, if we
have a fitness function in which a solution vector is evaluated with the
help of tabular operations, we would like to be able to obtain a batched
version of that function, so that not just a solution, but an entire
population can be evaluated efficiently. Another example is when
developing custom evolutionary algorithms, where solutions, fitnesses,
and algorithm-specific (or problem-specific) metadata can be organized
in a tabular manner, and operating on such tabular data has to be
vectorized and/or parallelized for increased efficiency.</p>
<p><code>TensorFrame</code> is introduced to address these concerns. In more details,
with evolutionary computation in mind, it has these features/behaviors:</p>
<p>(i) The columns of a <code>TensorFrame</code> are expressed via PyTorch tensors
(or via <code>evotorch.tools.ReadOnlyTensor</code> instances), allowing one
to place the tabular data on devices such as cuda.</p>
<p>(ii) A <code>TensorFrame</code> can be placed into a function that is transformed
via <code>torch.vmap</code> or <code>evotorch.decorators.expects_ndim</code> or
<code>evotorch.decorators.rowwise</code>, therefore it can work on batched data.</p>
<p>(iii) Upon being pickled or cloned, a <code>TensorFrame</code> applies the <code>clone</code>
method on all its columns and ensures that the cloned tensors have
minimally sized storages (even when their originals might have shared
their storages with larger tensors). Therefore, one can send a
<code>TensorFrame</code> to a remote worker (e.g. using <code>ray</code> library), without
having to worry about oversized shared tensor storages.</p>
<p>(iv) A <code>TensorFrame</code> can be placed as an item into an
<code>evotorch.tools.ObjectArray</code> container. Therefore, it can serve as a
value in a solution of a problem whose <code>dtype</code> is <code>object</code>.</p>
<p><strong>Basic usage.</strong>
A tensorframe can be instantiated like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TensorFrame</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">my_tensorframe</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="p">{</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="s2">&quot;COLUMN1&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="s2">&quot;COLUMN2&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="s2">&quot;COLUMN3&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">]),</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="p">}</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="p">)</span>
</code></pre></div>
<p>which represents the following tabular data:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>  float32    float32     &lt;- dtype of the column
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    cpu        cpu       &lt;- device of the column
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  COLUMN1    COLUMN2    COLUMN3
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a> =========  =========  =========
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    1.0        10.0      -10.0
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    2.0        20.0      -20.0
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    3.0        30.0      -30.0
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    4.0        40.0      -40.0
</code></pre></div>
<p>Rows can be picked and re-organized like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">my_tensorframe</span> <span class="o">=</span> <span class="n">my_tensorframe</span><span class="o">.</span><span class="n">pick</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</code></pre></div>
<p>which causes <code>my_tensorframe</code> to now store:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>  float32    float32    float32
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    cpu        cpu        cpu
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  COLUMN1    COLUMN2    COLUMN3
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a> =========  =========  =========
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    1.0        10.0      -10.0
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    4.0        40.0      -40.0
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    3.0        30.0      -30.0
</code></pre></div>
<p>A tensor of a column can be received like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">my_tensorframe</span><span class="p">[</span><span class="s2">&quot;COLUMN1&quot;</span><span class="p">])</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="c1"># Note: alternatively: print(my_tensorframe.COLUMN1)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1"># Prints: torch.tensor([1.0, 4.0, 3.0], dtype=torch.float32)</span>
</code></pre></div>
<p>Multiple columns can be received like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">my_tensorframe</span><span class="p">[[</span><span class="s2">&quot;COLUMN1&quot;</span><span class="p">,</span> <span class="s2">&quot;COLUMN2&quot;</span><span class="p">]])</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1"># Prints:</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1">#</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1">#  float32    float32</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="c1">#    cpu        cpu</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1">#</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="c1">#  COLUMN1    COLUMN2</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="c1"># =========  =========</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="c1">#    1.0        10.0</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="c1">#    4.0        40.0</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="c1">#    3.0        30.0</span>
</code></pre></div>
<p>The values of a column can be changed like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">my_tensorframe</span><span class="o">.</span><span class="n">pick</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="s2">&quot;COLUMN1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">])</span>
</code></pre></div>
<p>which causes <code>my_tensorframe</code> to become:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>  float32    float32    float32
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    cpu        cpu        cpu
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>  COLUMN1    COLUMN2    COLUMN3
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a> =========  =========  =========
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>    1.0        10.0      -10.0
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>    7.0        40.0      -40.0
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>    9.0        30.0      -30.0
</code></pre></div>
<p>Multiple columns can be changed like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">my_tensorframe</span><span class="o">.</span><span class="n">pick</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">[</span><span class="s2">&quot;COLUMN1&quot;</span><span class="p">,</span> <span class="s2">&quot;COLUMN2&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    <span class="p">{</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>        <span class="s2">&quot;COLUMN1&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mf">11.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">]),</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>        <span class="s2">&quot;COLUMN2&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mf">44.0</span><span class="p">,</span> <span class="mf">55.0</span><span class="p">]),</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="p">}</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="p">)</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c1"># Note: alternatively, the right-hand side can be given as a dictionary:</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="c1"># my_tensorframe.pick[1:, [&quot;COLUMN1&quot;, &quot;COLUMN2&quot;]] = {</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c1">#     &quot;COLUMN1&quot;: torch.FloatTensor([11.0, 12.0]),</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="c1">#     &quot;COLUMN2&quot;: torch.FloatTensor([44.0, 55.0]),</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="c1"># }</span>
</code></pre></div>
<p>which causes <code>my_tensorframe</code> to become:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>  float32    float32    float32
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    cpu        cpu        cpu
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>  COLUMN1    COLUMN2    COLUMN3
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a> =========  =========  =========
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>    1.0        10.0      -10.0
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>   11.0        44.0      -40.0
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>   12.0        55.0      -30.0
</code></pre></div>
<p><strong>Further notes.</strong></p>
<ul>
<li>A tensor under a TensorFrame column can have more than one dimension.
    Across different columns, the size of the leftmost dimensions must
    match.</li>
<li>Unlike a <code>pandas.DataFrame</code>, a TensorFrame does not have a special index
    column.</li>
</ul>







              <details class="quote">
                <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-53">  53</a></span>
<span class="normal"><a href="#__codelineno-0-54">  54</a></span>
<span class="normal"><a href="#__codelineno-0-55">  55</a></span>
<span class="normal"><a href="#__codelineno-0-56">  56</a></span>
<span class="normal"><a href="#__codelineno-0-57">  57</a></span>
<span class="normal"><a href="#__codelineno-0-58">  58</a></span>
<span class="normal"><a href="#__codelineno-0-59">  59</a></span>
<span class="normal"><a href="#__codelineno-0-60">  60</a></span>
<span class="normal"><a href="#__codelineno-0-61">  61</a></span>
<span class="normal"><a href="#__codelineno-0-62">  62</a></span>
<span class="normal"><a href="#__codelineno-0-63">  63</a></span>
<span class="normal"><a href="#__codelineno-0-64">  64</a></span>
<span class="normal"><a href="#__codelineno-0-65">  65</a></span>
<span class="normal"><a href="#__codelineno-0-66">  66</a></span>
<span class="normal"><a href="#__codelineno-0-67">  67</a></span>
<span class="normal"><a href="#__codelineno-0-68">  68</a></span>
<span class="normal"><a href="#__codelineno-0-69">  69</a></span>
<span class="normal"><a href="#__codelineno-0-70">  70</a></span>
<span class="normal"><a href="#__codelineno-0-71">  71</a></span>
<span class="normal"><a href="#__codelineno-0-72">  72</a></span>
<span class="normal"><a href="#__codelineno-0-73">  73</a></span>
<span class="normal"><a href="#__codelineno-0-74">  74</a></span>
<span class="normal"><a href="#__codelineno-0-75">  75</a></span>
<span class="normal"><a href="#__codelineno-0-76">  76</a></span>
<span class="normal"><a href="#__codelineno-0-77">  77</a></span>
<span class="normal"><a href="#__codelineno-0-78">  78</a></span>
<span class="normal"><a href="#__codelineno-0-79">  79</a></span>
<span class="normal"><a href="#__codelineno-0-80">  80</a></span>
<span class="normal"><a href="#__codelineno-0-81">  81</a></span>
<span class="normal"><a href="#__codelineno-0-82">  82</a></span>
<span class="normal"><a href="#__codelineno-0-83">  83</a></span>
<span class="normal"><a href="#__codelineno-0-84">  84</a></span>
<span class="normal"><a href="#__codelineno-0-85">  85</a></span>
<span class="normal"><a href="#__codelineno-0-86">  86</a></span>
<span class="normal"><a href="#__codelineno-0-87">  87</a></span>
<span class="normal"><a href="#__codelineno-0-88">  88</a></span>
<span class="normal"><a href="#__codelineno-0-89">  89</a></span>
<span class="normal"><a href="#__codelineno-0-90">  90</a></span>
<span class="normal"><a href="#__codelineno-0-91">  91</a></span>
<span class="normal"><a href="#__codelineno-0-92">  92</a></span>
<span class="normal"><a href="#__codelineno-0-93">  93</a></span>
<span class="normal"><a href="#__codelineno-0-94">  94</a></span>
<span class="normal"><a href="#__codelineno-0-95">  95</a></span>
<span class="normal"><a href="#__codelineno-0-96">  96</a></span>
<span class="normal"><a href="#__codelineno-0-97">  97</a></span>
<span class="normal"><a href="#__codelineno-0-98">  98</a></span>
<span class="normal"><a href="#__codelineno-0-99">  99</a></span>
<span class="normal"><a href="#__codelineno-0-100"> 100</a></span>
<span class="normal"><a href="#__codelineno-0-101"> 101</a></span>
<span class="normal"><a href="#__codelineno-0-102"> 102</a></span>
<span class="normal"><a href="#__codelineno-0-103"> 103</a></span>
<span class="normal"><a href="#__codelineno-0-104"> 104</a></span>
<span class="normal"><a href="#__codelineno-0-105"> 105</a></span>
<span class="normal"><a href="#__codelineno-0-106"> 106</a></span>
<span class="normal"><a href="#__codelineno-0-107"> 107</a></span>
<span class="normal"><a href="#__codelineno-0-108"> 108</a></span>
<span class="normal"><a href="#__codelineno-0-109"> 109</a></span>
<span class="normal"><a href="#__codelineno-0-110"> 110</a></span>
<span class="normal"><a href="#__codelineno-0-111"> 111</a></span>
<span class="normal"><a href="#__codelineno-0-112"> 112</a></span>
<span class="normal"><a href="#__codelineno-0-113"> 113</a></span>
<span class="normal"><a href="#__codelineno-0-114"> 114</a></span>
<span class="normal"><a href="#__codelineno-0-115"> 115</a></span>
<span class="normal"><a href="#__codelineno-0-116"> 116</a></span>
<span class="normal"><a href="#__codelineno-0-117"> 117</a></span>
<span class="normal"><a href="#__codelineno-0-118"> 118</a></span>
<span class="normal"><a href="#__codelineno-0-119"> 119</a></span>
<span class="normal"><a href="#__codelineno-0-120"> 120</a></span>
<span class="normal"><a href="#__codelineno-0-121"> 121</a></span>
<span class="normal"><a href="#__codelineno-0-122"> 122</a></span>
<span class="normal"><a href="#__codelineno-0-123"> 123</a></span>
<span class="normal"><a href="#__codelineno-0-124"> 124</a></span>
<span class="normal"><a href="#__codelineno-0-125"> 125</a></span>
<span class="normal"><a href="#__codelineno-0-126"> 126</a></span>
<span class="normal"><a href="#__codelineno-0-127"> 127</a></span>
<span class="normal"><a href="#__codelineno-0-128"> 128</a></span>
<span class="normal"><a href="#__codelineno-0-129"> 129</a></span>
<span class="normal"><a href="#__codelineno-0-130"> 130</a></span>
<span class="normal"><a href="#__codelineno-0-131"> 131</a></span>
<span class="normal"><a href="#__codelineno-0-132"> 132</a></span>
<span class="normal"><a href="#__codelineno-0-133"> 133</a></span>
<span class="normal"><a href="#__codelineno-0-134"> 134</a></span>
<span class="normal"><a href="#__codelineno-0-135"> 135</a></span>
<span class="normal"><a href="#__codelineno-0-136"> 136</a></span>
<span class="normal"><a href="#__codelineno-0-137"> 137</a></span>
<span class="normal"><a href="#__codelineno-0-138"> 138</a></span>
<span class="normal"><a href="#__codelineno-0-139"> 139</a></span>
<span class="normal"><a href="#__codelineno-0-140"> 140</a></span>
<span class="normal"><a href="#__codelineno-0-141"> 141</a></span>
<span class="normal"><a href="#__codelineno-0-142"> 142</a></span>
<span class="normal"><a href="#__codelineno-0-143"> 143</a></span>
<span class="normal"><a href="#__codelineno-0-144"> 144</a></span>
<span class="normal"><a href="#__codelineno-0-145"> 145</a></span>
<span class="normal"><a href="#__codelineno-0-146"> 146</a></span>
<span class="normal"><a href="#__codelineno-0-147"> 147</a></span>
<span class="normal"><a href="#__codelineno-0-148"> 148</a></span>
<span class="normal"><a href="#__codelineno-0-149"> 149</a></span>
<span class="normal"><a href="#__codelineno-0-150"> 150</a></span>
<span class="normal"><a href="#__codelineno-0-151"> 151</a></span>
<span class="normal"><a href="#__codelineno-0-152"> 152</a></span>
<span class="normal"><a href="#__codelineno-0-153"> 153</a></span>
<span class="normal"><a href="#__codelineno-0-154"> 154</a></span>
<span class="normal"><a href="#__codelineno-0-155"> 155</a></span>
<span class="normal"><a href="#__codelineno-0-156"> 156</a></span>
<span class="normal"><a href="#__codelineno-0-157"> 157</a></span>
<span class="normal"><a href="#__codelineno-0-158"> 158</a></span>
<span class="normal"><a href="#__codelineno-0-159"> 159</a></span>
<span class="normal"><a href="#__codelineno-0-160"> 160</a></span>
<span class="normal"><a href="#__codelineno-0-161"> 161</a></span>
<span class="normal"><a href="#__codelineno-0-162"> 162</a></span>
<span class="normal"><a href="#__codelineno-0-163"> 163</a></span>
<span class="normal"><a href="#__codelineno-0-164"> 164</a></span>
<span class="normal"><a href="#__codelineno-0-165"> 165</a></span>
<span class="normal"><a href="#__codelineno-0-166"> 166</a></span>
<span class="normal"><a href="#__codelineno-0-167"> 167</a></span>
<span class="normal"><a href="#__codelineno-0-168"> 168</a></span>
<span class="normal"><a href="#__codelineno-0-169"> 169</a></span>
<span class="normal"><a href="#__codelineno-0-170"> 170</a></span>
<span class="normal"><a href="#__codelineno-0-171"> 171</a></span>
<span class="normal"><a href="#__codelineno-0-172"> 172</a></span>
<span class="normal"><a href="#__codelineno-0-173"> 173</a></span>
<span class="normal"><a href="#__codelineno-0-174"> 174</a></span>
<span class="normal"><a href="#__codelineno-0-175"> 175</a></span>
<span class="normal"><a href="#__codelineno-0-176"> 176</a></span>
<span class="normal"><a href="#__codelineno-0-177"> 177</a></span>
<span class="normal"><a href="#__codelineno-0-178"> 178</a></span>
<span class="normal"><a href="#__codelineno-0-179"> 179</a></span>
<span class="normal"><a href="#__codelineno-0-180"> 180</a></span>
<span class="normal"><a href="#__codelineno-0-181"> 181</a></span>
<span class="normal"><a href="#__codelineno-0-182"> 182</a></span>
<span class="normal"><a href="#__codelineno-0-183"> 183</a></span>
<span class="normal"><a href="#__codelineno-0-184"> 184</a></span>
<span class="normal"><a href="#__codelineno-0-185"> 185</a></span>
<span class="normal"><a href="#__codelineno-0-186"> 186</a></span>
<span class="normal"><a href="#__codelineno-0-187"> 187</a></span>
<span class="normal"><a href="#__codelineno-0-188"> 188</a></span>
<span class="normal"><a href="#__codelineno-0-189"> 189</a></span>
<span class="normal"><a href="#__codelineno-0-190"> 190</a></span>
<span class="normal"><a href="#__codelineno-0-191"> 191</a></span>
<span class="normal"><a href="#__codelineno-0-192"> 192</a></span>
<span class="normal"><a href="#__codelineno-0-193"> 193</a></span>
<span class="normal"><a href="#__codelineno-0-194"> 194</a></span>
<span class="normal"><a href="#__codelineno-0-195"> 195</a></span>
<span class="normal"><a href="#__codelineno-0-196"> 196</a></span>
<span class="normal"><a href="#__codelineno-0-197"> 197</a></span>
<span class="normal"><a href="#__codelineno-0-198"> 198</a></span>
<span class="normal"><a href="#__codelineno-0-199"> 199</a></span>
<span class="normal"><a href="#__codelineno-0-200"> 200</a></span>
<span class="normal"><a href="#__codelineno-0-201"> 201</a></span>
<span class="normal"><a href="#__codelineno-0-202"> 202</a></span>
<span class="normal"><a href="#__codelineno-0-203"> 203</a></span>
<span class="normal"><a href="#__codelineno-0-204"> 204</a></span>
<span class="normal"><a href="#__codelineno-0-205"> 205</a></span>
<span class="normal"><a href="#__codelineno-0-206"> 206</a></span>
<span class="normal"><a href="#__codelineno-0-207"> 207</a></span>
<span class="normal"><a href="#__codelineno-0-208"> 208</a></span>
<span class="normal"><a href="#__codelineno-0-209"> 209</a></span>
<span class="normal"><a href="#__codelineno-0-210"> 210</a></span>
<span class="normal"><a href="#__codelineno-0-211"> 211</a></span>
<span class="normal"><a href="#__codelineno-0-212"> 212</a></span>
<span class="normal"><a href="#__codelineno-0-213"> 213</a></span>
<span class="normal"><a href="#__codelineno-0-214"> 214</a></span>
<span class="normal"><a href="#__codelineno-0-215"> 215</a></span>
<span class="normal"><a href="#__codelineno-0-216"> 216</a></span>
<span class="normal"><a href="#__codelineno-0-217"> 217</a></span>
<span class="normal"><a href="#__codelineno-0-218"> 218</a></span>
<span class="normal"><a href="#__codelineno-0-219"> 219</a></span>
<span class="normal"><a href="#__codelineno-0-220"> 220</a></span>
<span class="normal"><a href="#__codelineno-0-221"> 221</a></span>
<span class="normal"><a href="#__codelineno-0-222"> 222</a></span>
<span class="normal"><a href="#__codelineno-0-223"> 223</a></span>
<span class="normal"><a href="#__codelineno-0-224"> 224</a></span>
<span class="normal"><a href="#__codelineno-0-225"> 225</a></span>
<span class="normal"><a href="#__codelineno-0-226"> 226</a></span>
<span class="normal"><a href="#__codelineno-0-227"> 227</a></span>
<span class="normal"><a href="#__codelineno-0-228"> 228</a></span>
<span class="normal"><a href="#__codelineno-0-229"> 229</a></span>
<span class="normal"><a href="#__codelineno-0-230"> 230</a></span>
<span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="k">class</span><span class="w"> </span><span class="nc">TensorFrame</span><span class="p">(</span><span class="n">RecursivePrintable</span><span class="p">):</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    A structure which allows one to manipulate tensors in a tabular manner.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    The interface of this structure is inspired by the `DataFrame` class</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    of the `pandas` library.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    **Motivation.**</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    It is a common scenario to have to work with arrays/tensors that are</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    associated with each other (e.g. when working on a knapsack problem, we</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    could have arrays `A` and `B`, where `A[i]` represents the value of the</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    i-th item and `B[i]` represents the weight of the i-th item).</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    A practical approach for such cases is to organize those arrays and</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    operate on them in a tabular manner. `pandas` is a popular library</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    for doing such tabular operations.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    In the context of evolutionary computation, efficiency via vectorization</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    and/or parallelization becomes an important concern. For example, if we</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    have a fitness function in which a solution vector is evaluated with the</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    help of tabular operations, we would like to be able to obtain a batched</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    version of that function, so that not just a solution, but an entire</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    population can be evaluated efficiently. Another example is when</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    developing custom evolutionary algorithms, where solutions, fitnesses,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    and algorithm-specific (or problem-specific) metadata can be organized</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    in a tabular manner, and operating on such tabular data has to be</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    vectorized and/or parallelized for increased efficiency.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    `TensorFrame` is introduced to address these concerns. In more details,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    with evolutionary computation in mind, it has these features/behaviors:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    (i) The columns of a `TensorFrame` are expressed via PyTorch tensors</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    (or via `evotorch.tools.ReadOnlyTensor` instances), allowing one</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    to place the tabular data on devices such as cuda.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    (ii) A `TensorFrame` can be placed into a function that is transformed</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    via `torch.vmap` or `evotorch.decorators.expects_ndim` or</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    `evotorch.decorators.rowwise`, therefore it can work on batched data.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    (iii) Upon being pickled or cloned, a `TensorFrame` applies the `clone`</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    method on all its columns and ensures that the cloned tensors have</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    minimally sized storages (even when their originals might have shared</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    their storages with larger tensors). Therefore, one can send a</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    `TensorFrame` to a remote worker (e.g. using `ray` library), without</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    having to worry about oversized shared tensor storages.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    (iv) A `TensorFrame` can be placed as an item into an</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    `evotorch.tools.ObjectArray` container. Therefore, it can serve as a</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    value in a solution of a problem whose `dtype` is `object`.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    **Basic usage.**</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    A tensorframe can be instantiated like this:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    from evotorch.tools import TensorFrame</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    my_tensorframe = TensorFrame(</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        {</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            &quot;COLUMN1&quot;: torch.FloatTensor([1, 2, 3, 4]),</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            &quot;COLUMN2&quot;: torch.FloatTensor([10, 20, 30, 40]),</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">            &quot;COLUMN3&quot;: torch.FloatTensor([-10, -20, -30, -40]),</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        }</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    )</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    ```</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    which represents the following tabular data:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">      float32    float32     &lt;- dtype of the column</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        cpu        cpu       &lt;- device of the column</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">      COLUMN1    COLUMN2    COLUMN3</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">     =========  =========  =========</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        1.0        10.0      -10.0</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        2.0        20.0      -20.0</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        3.0        30.0      -30.0</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        4.0        40.0      -40.0</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    ```</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    Rows can be picked and re-organized like this:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    my_tensorframe = my_tensorframe.pick[[0, 3, 2]]</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    ```</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    which causes `my_tensorframe` to now store:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">      float32    float32    float32</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        cpu        cpu        cpu</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">      COLUMN1    COLUMN2    COLUMN3</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">     =========  =========  =========</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        1.0        10.0      -10.0</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        4.0        40.0      -40.0</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        3.0        30.0      -30.0</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    ```</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    A tensor of a column can be received like this:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    print(my_tensorframe[&quot;COLUMN1&quot;])</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    # Note: alternatively: print(my_tensorframe.COLUMN1)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    # Prints: torch.tensor([1.0, 4.0, 3.0], dtype=torch.float32)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    ```</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    Multiple columns can be received like this:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    print(my_tensorframe[[&quot;COLUMN1&quot;, &quot;COLUMN2&quot;]])</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    # Prints:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    #</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    #  float32    float32</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    #    cpu        cpu</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    #</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    #  COLUMN1    COLUMN2</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    # =========  =========</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    #    1.0        10.0</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    #    4.0        40.0</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">    #    3.0        30.0</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    ```</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    The values of a column can be changed like this:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    my_tensorframe.pick[1:, &quot;COLUMN1&quot;] = torch.FloatTensor([7.0, 9.0])</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    ```</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    which causes `my_tensorframe` to become:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">      float32    float32    float32</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        cpu        cpu        cpu</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">      COLUMN1    COLUMN2    COLUMN3</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">     =========  =========  =========</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        1.0        10.0      -10.0</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        7.0        40.0      -40.0</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        9.0        30.0      -30.0</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    ```</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Multiple columns can be changed like this:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    my_tensorframe.pick[1:, [&quot;COLUMN1&quot;, &quot;COLUMN2&quot;]] = TensorFrame(</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        {</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            &quot;COLUMN1&quot;: torch.FloatTensor([11.0, 12.0]),</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            &quot;COLUMN2&quot;: torch.FloatTensor([44.0, 55.0]),</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        }</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">    )</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    # Note: alternatively, the right-hand side can be given as a dictionary:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    # my_tensorframe.pick[1:, [&quot;COLUMN1&quot;, &quot;COLUMN2&quot;]] = {</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">    #     &quot;COLUMN1&quot;: torch.FloatTensor([11.0, 12.0]),</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    #     &quot;COLUMN2&quot;: torch.FloatTensor([44.0, 55.0]),</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    # }</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    ```</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    which causes `my_tensorframe` to become:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    ```text</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">      float32    float32    float32</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        cpu        cpu        cpu</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">      COLUMN1    COLUMN2    COLUMN3</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">     =========  =========  =========</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        1.0        10.0      -10.0</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">       11.0        44.0      -40.0</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">       12.0        55.0      -30.0</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    ```</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    **Further notes.**</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">    - A tensor under a TensorFrame column can have more than one dimension.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        Across different columns, the size of the leftmost dimensions must</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        match.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    - Unlike a `pandas.DataFrame`, a TensorFrame does not have a special index</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        column.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">,</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">,</span> <span class="n">_PandasDataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">read_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="p">):</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        `__init__(...)`: Initialize the TensorFrame</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            data: Optionally a TensorFrame, or a dictionary (where the keys</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">                are column names and the values are column values), or a</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">                `pandas.DataFrame` object. If provided, the tabular data</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">                given here are used for initializing the new TensorFrame.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            read_only: Whether or not the newly made TensorFrame will be</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">                read-only. A read-only TensorFrame&#39;s columns will be</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">                ReadOnlyTensors, and its columns and values will not change.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            device: If left as None, each column can be on a different device.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">                If given as a string or a `torch.device`, each column will</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">                be forcefully moved to this given device.</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.readonlytensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">as_read_only_tensor</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__device</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="k">if</span> <span class="n">read_only</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="k">def</span><span class="w"> </span><span class="nf">prepare_value</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>                <span class="k">return</span> <span class="n">as_read_only_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="k">def</span><span class="w"> </span><span class="nf">prepare_value</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__data</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="k">pass</span>  <span class="c1"># no data is given, nothing to do</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="k">elif</span> <span class="n">_is_pandas_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>                <span class="n">v</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">prepare_value</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">prepare_value</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">TensorFrame</span><span class="p">):</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">prepare_value</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>                <span class="s2">&quot;When constructing a new TensorFrame, the argument `data` was expected as a dictionary-like object&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>                <span class="s2">&quot; (an instance of Mapping), or as a TensorFrame.&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>                <span class="sa">f</span><span class="s2">&quot; However, the encountered object is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="p">)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span> <span class="o">=</span> <span class="n">read_only</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__get_first_tensor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__get_default_device_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">return</span> <span class="p">{}</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__device</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{</span><span class="s2">&quot;device&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">}</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__get_first_tensor_device_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">first_tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_first_tensor</span><span class="p">()</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="k">return</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">first_tensor</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{</span><span class="s2">&quot;device&quot;</span><span class="p">:</span> <span class="n">first_tensor</span><span class="o">.</span><span class="n">device</span><span class="p">}</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">as_tensor</span><span class="p">(</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">to_work_with</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="n">broadcast_if_scalar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        Convert the given object `x` to a PyTorch tensor.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            x: The object to be converted to a PyTorch tensor.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            to_work_with: Optionally a string, referring to an existing column</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">                within this TensorFrame, or a PyTorch tensor. The object `x`</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">                will be converted to a PyTorch tensor on the same device with</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">                this given column/tensor. If `to_work_with` is left as None,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">                `x` will be converted to a PyTorch tensor on the same device</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">                with this TensorFrame&#39;s first column.</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            broadcast_if_scalar: If this argument is given as True and if `x`</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">                is a scalar, its tensor-counterpart will be broadcast to a</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">                vector of length `n`, where `n` is the number of rows of this</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">                TensorFrame.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">            The tensor counterpart of `x`.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">.readonlytensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">as_read_only_tensor</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="k">if</span> <span class="n">to_work_with</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_work_with</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>                <span class="k">pass</span>  <span class="c1"># nothing to do</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_work_with</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)):</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>                <span class="n">to_work_with</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">to_work_with</span><span class="p">)]</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                    <span class="s2">&quot;The argument `to_work_with` was expected as a PyTorch tensor or as a string&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>                    <span class="s2">&quot; (that refers to one of the columns of this TensorFrame).&quot;</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                    <span class="sa">f</span><span class="s2">&quot; However, it was received as an instance of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">to_work_with</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>                <span class="p">)</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">to_work_with</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="n">convert</span> <span class="o">=</span> <span class="n">as_read_only_tensor</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>                <span class="n">convert</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__get_default_device_kwargs</span><span class="p">()))</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__get_first_tensor_device_kwargs</span><span class="p">()))</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="k">if</span> <span class="n">broadcast_if_scalar</span> <span class="ow">and</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="n">first_tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_first_tensor</span><span class="p">()</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="k">if</span> <span class="n">first_tensor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The first column cannot be given as a scalar.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">first_tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span> <span class="n">values</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span><span class="p">:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot modify a read-only TensorFrame&quot;</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="n">column_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">broadcast_if_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="n">column_name_or_mask</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">]]],</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">column_name_or_mask</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">column_name_or_mask</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">column_name_or_mask</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">column_name_or_mask</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="p">):</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pick</span><span class="p">[</span><span class="n">column_name_or_mask</span><span class="p">]</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column_name_or_mask</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)):</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">column_name_or_mask</span><span class="p">)]</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column_name_or_mask</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">()</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">column_name_or_mask</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)):</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The sequence of column names has an item of this unrecognized type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_read_only</span><span class="p">:</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_read_only_view</span><span class="p">()</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                <span class="s2">&quot;Expected a column name (as a string) or a sequence of column names, but encountered an instance of&quot;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">column_name_or_mask</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="k">if</span> <span class="n">attr_name</span> <span class="o">==</span> <span class="s2">&quot;__dict__&quot;</span><span class="p">:</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="k">elif</span> <span class="p">(</span><span class="s2">&quot;_initialized&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;_initialized&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="k">elif</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>                    <span class="sa">f</span><span class="s2">&quot;Please do not use the dot notation to change the column </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>                    <span class="sa">f</span><span class="s2">&quot; Hint: you could use: tensorframe[</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="si">}</span><span class="s2">] = ...&quot;</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>                <span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                    <span class="sa">f</span><span class="s2">&quot;Unknown attribute: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                    <span class="sa">f</span><span class="s2">&quot; Hint: to add a new column </span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">, you could use: tensorframe[</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="si">}</span><span class="s2">] = ...&quot;</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                <span class="p">)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="k">if</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">:</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">without_enforced_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        Make a shallow copy of this TensorFrame without any enforced device.</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">        In the newly made shallow copy, columns will be able to exist on</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">        different devices.</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">            A shallow copy of this TensorFrame without any enforced device.</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">with_enforced_device</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">        Make a shallow copy of this TensorFrame with an enforced device.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        In the newly made shallow copy, columns will be forcefully moved onto</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        the specified device.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            device: The device to which the new TensorFrame&#39;s columns will move.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">            A shallow copy of this TensorFrame with an enforced device.</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;When using the method `with_enforced_device`, the argument `device` cannot be None&quot;</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>            <span class="n">enforce_device_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>            <span class="n">enforce_device_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;device&quot;</span><span class="p">:</span> <span class="n">device</span><span class="p">}</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>            <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="n">read_only</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span><span class="p">,</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>            <span class="o">**</span><span class="n">enforce_device_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="p">)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">        Get a shallow copy of this TensorFrame with all columns moved to cpu.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cuda</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">        Get a shallow copy of this TensorFrame with all columns moved to cuda.</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="nb">set</span><span class="p">]]:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        Get the device(s) of this TensorFrame.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        If different columns exist on different devices, a set of devices</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        will be returned. If all the columns exist on the same device, then</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">        that device will be returned.</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">devices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">device</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">devices</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="p">[</span><span class="n">only_device</span><span class="p">]</span> <span class="o">=</span> <span class="n">devices</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="k">return</span> <span class="n">only_device</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="k">return</span> <span class="n">devices</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">        Columns as a list of strings</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pick</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Picker&quot;</span><span class="p">:</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">        Get or set values of this TensorFrame.</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        **Usage.**</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">        # Get values</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        tensorframe.pick[slice_or_indexlist, column_name]</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">        # Set values</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        tensorframe.pick[slice_or_indexlist, column_name] = (</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">            ...  # A tensor or a list/tensor of indices or a TensorFrame</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        )</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">        ```</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="k">return</span> <span class="n">Picker</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__non_tabular_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_MAX_DEPTH_FOR_PRINTING</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="k">if</span> <span class="n">max_depth</span> <span class="o">&gt;=</span> <span class="n">DEFAULT_MAX_DEPTH_FOR_PRINTING</span><span class="p">:</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="n">indent</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>            <span class="n">dbl_indent</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">8</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="n">colon_for_dict</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="n">comma_for_dict</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="k">def</span><span class="w"> </span><span class="nf">prn</span><span class="p">(</span><span class="o">*</span><span class="n">items</span><span class="p">):</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">items</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>            <span class="n">indent</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>            <span class="n">dbl_indent</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>            <span class="n">colon_for_dict</span> <span class="o">=</span> <span class="s2">&quot;: &quot;</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>            <span class="n">comma_for_dict</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="k">def</span><span class="w"> </span><span class="nf">prn</span><span class="p">(</span><span class="o">*</span><span class="n">items</span><span class="p">):</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>                <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">items</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>            <span class="n">prn</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s2">&quot;(&quot;</span><span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="n">prn</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="s2">&quot;{&quot;</span><span class="p">)</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>            <span class="n">last_i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>                    <span class="n">prn</span><span class="p">()</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>                <span class="n">prn</span><span class="p">(</span><span class="n">dbl_indent</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">colon_for_dict</span><span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>                <span class="n">comma</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">last_i</span> <span class="k">else</span> <span class="n">comma_for_dict</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">RecursivePrintable</span><span class="p">):</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>                    <span class="n">v_as_str</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="p">(</span><span class="n">max_depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                    <span class="n">v_as_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">dbl_indent</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                    <span class="n">v_as_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                <span class="n">prn</span><span class="p">(</span><span class="n">dbl_indent</span><span class="p">,</span> <span class="n">v_as_str</span><span class="p">,</span> <span class="n">comma</span><span class="p">)</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>            <span class="n">prn</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="s2">&quot;}&quot;</span><span class="p">)</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                <span class="n">prn</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">comma_for_dict</span><span class="p">,</span> <span class="s2">&quot;read_only=True&quot;</span><span class="p">,</span> <span class="n">comma_for_dict</span><span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                <span class="n">prn</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="s2">&quot;device=&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">))</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span><span class="p">:</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                <span class="n">prn</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">comma_for_dict</span><span class="p">,</span> <span class="s2">&quot;read_only=True&quot;</span><span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                <span class="n">prn</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">comma_for_dict</span><span class="p">,</span> <span class="s2">&quot;device=&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">))</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__tabular_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">chain</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="n">half_rows_to_show</span> <span class="o">=</span> <span class="mi">15</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="n">num_rows_to_show</span> <span class="o">=</span> <span class="n">half_rows_to_show</span> <span class="o">*</span> <span class="mi">2</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="n">num_rows_to_show</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>            <span class="n">row_indices_to_show</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>            <span class="n">three_dots_after_row</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>            <span class="n">row_indices_to_show</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">half_rows_to_show</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">half_rows_to_show</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>            <span class="n">three_dots_after_row</span> <span class="o">=</span> <span class="n">half_rows_to_show</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="n">col_lengths</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">update_col_length</span><span class="p">(</span><span class="n">col_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_col_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>            <span class="k">if</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="n">col_lengths</span><span class="p">:</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>                <span class="n">current_col_length</span> <span class="o">=</span> <span class="n">col_lengths</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>                <span class="k">if</span> <span class="n">new_col_length</span> <span class="o">&gt;</span> <span class="n">current_col_length</span><span class="p">:</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>                    <span class="n">col_lengths</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_col_length</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>                <span class="n">col_lengths</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_col_length</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">fill_line</span><span class="p">(</span><span class="o">*</span><span class="n">items</span><span class="p">):</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>            <span class="n">current_line</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>            <span class="k">for</span> <span class="n">col_index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>                    <span class="c1"># item_as_str = &quot; &quot; + str(item.cpu().item()) + &quot; &quot;</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                    <span class="n">item_as_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>                    <span class="n">item_as_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>                <span class="n">update_col_length</span><span class="p">(</span><span class="n">col_index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">item_as_str</span><span class="p">))</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>                <span class="n">current_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item_as_str</span><span class="p">)</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_line</span><span class="p">)</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>        <span class="n">fill_line</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">_without_torch_dot</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>        <span class="n">fill_line</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">((</span><span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="n">fill_line</span><span class="p">()</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="n">fill_line</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="n">fill_line</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">((</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="n">col_lengths</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))))</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="k">for</span> <span class="n">row_index</span> <span class="ow">in</span> <span class="n">row_indices_to_show</span><span class="p">:</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>            <span class="n">fill_line</span><span class="p">(</span><span class="n">row_index</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">][</span><span class="n">row_index</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">three_dots_after_row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row_index</span> <span class="o">==</span> <span class="n">three_dots_after_row</span><span class="p">):</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                <span class="n">fill_line</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="s2">&quot;...&quot;</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>                <span class="k">for</span> <span class="n">col_index</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">col_lengths</span><span class="p">[</span><span class="n">col_index</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>                <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>            <span class="n">needs_another_line</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; device=&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                <span class="n">needs_another_line</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span><span class="p">:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; read_only=True&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                <span class="n">needs_another_line</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="k">if</span> <span class="n">needs_another_line</span><span class="p">:</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__all_columns_are_one_dimensional</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>            <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_MAX_DEPTH_FOR_PRINTING</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">        Return the string representation of this TensorFrame</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;()&quot;</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">max_depth</span> <span class="o">&gt;=</span> <span class="n">DEFAULT_MAX_DEPTH_FOR_PRINTING</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__all_columns_are_one_dimensional</span><span class="p">():</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__tabular_repr</span><span class="p">()</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__non_tabular_repr</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__tabular_repr_html</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">chain</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="n">half_rows_to_show</span> <span class="o">=</span> <span class="mi">15</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="n">num_rows_to_show</span> <span class="o">=</span> <span class="n">half_rows_to_show</span> <span class="o">*</span> <span class="mi">2</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="n">num_rows_to_show</span><span class="p">:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="n">row_indices_to_show</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="n">three_dots_after_row</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="n">row_indices_to_show</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">half_rows_to_show</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">half_rows_to_show</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>            <span class="n">three_dots_after_row</span> <span class="o">=</span> <span class="n">half_rows_to_show</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">safe_html</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="n">replacements</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                <span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;amp;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                <span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;lt;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                <span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>                <span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;apos;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>                <span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&amp;quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>            <span class="p">)</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>            <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">replacements</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>            <span class="k">return</span> <span class="n">s</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">prn</span><span class="p">(</span><span class="o">*</span><span class="n">msg</span><span class="p">):</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>            <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">msg</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>            <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;table&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>            <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;tr&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>            <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;th&gt;&lt;/th&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>                <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;th&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>                <span class="n">prn</span><span class="p">(</span><span class="n">safe_html</span><span class="p">(</span><span class="n">_without_torch_dot</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">dtype</span><span class="p">)),</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>                <span class="n">prn</span><span class="p">(</span><span class="n">safe_html</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">device</span><span class="p">),</span> <span class="s2">&quot;&lt;br/&gt;&lt;br/&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>                <span class="n">prn</span><span class="p">(</span><span class="n">safe_html</span><span class="p">(</span><span class="n">column</span><span class="p">))</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>                <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;/th&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>            <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;/tr&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">row_indices_to_show</span><span class="p">:</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>                <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;tr&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>                <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;&lt;strong&gt;&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;&lt;/strong&gt;&lt;/td&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>                <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>                    <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;&quot;</span><span class="p">,</span> <span class="n">safe_html</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>                <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;/tr&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">three_dots_after_row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">three_dots_after_row</span><span class="p">):</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>                    <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;tr&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>                    <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;...&lt;/td&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>                    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>                        <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;td&gt;...&lt;/td&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>                    <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;/tr&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;tr&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>            <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;th&gt;&lt;/th&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>                <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>                <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;th&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>                <span class="n">prn</span><span class="p">(</span><span class="n">safe_html</span><span class="p">(</span><span class="n">column</span><span class="p">))</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>                <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;/th&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;/tr&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="n">prn</span><span class="p">(</span><span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;()&quot;</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__all_columns_are_one_dimensional</span><span class="p">():</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__tabular_repr_html</span><span class="p">()</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>            <span class="k">return</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__non_tabular_repr</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;[&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;]&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/pre&gt;&quot;</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_read_only</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">        True if this TensorFrame is read-only; False otherwise.</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_read_only_view</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">        Get a read-only counterpart of this TensorFrame.</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>        <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">preserve_read_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">memo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">        Get a clone of this TensorFrame.</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">            preserve_read_only: If True, the newly made clone will be read-only</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">                only if this TensorFrame is also read-only.</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">            The clone of this TensorFrame.</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>        <span class="k">if</span> <span class="n">memo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>            <span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="n">self_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>        <span class="k">if</span> <span class="n">self_id</span> <span class="ow">in</span> <span class="n">memo</span><span class="p">:</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>            <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">self_id</span><span class="p">]</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>        <span class="n">new_read_only</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span> <span class="k">if</span> <span class="n">preserve_read_only</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="n">newdata</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>            <span class="n">newdata</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="n">newdata</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="n">new_read_only</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">preserve_read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">preserve_read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">)</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>        <span class="n">cloned_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">preserve_read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>        <span class="k">return</span> <span class="n">cloned_frame</span><span class="o">.</span><span class="vm">__dict__</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;__dict__&quot;</span><span class="p">,</span> <span class="p">{})</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>            <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>        <span class="k">return</span> <span class="mi">0</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">argsort</span><span class="p">(</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>        <span class="n">indices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>        <span class="n">ranks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>        <span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>        <span class="n">join</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">        Return row indices (also optionally ranks) for sorting the TensorFrame.</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        For example, let us assume that we have a TensorFrame named `table`.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">        We can sort this `table` like this:</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">        indices_for_sorting = table.argsort(by=&quot;A&quot;)  # sort by the column A</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">        sorted_table = table.pick[indices_for_sorting]</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">        ```</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">            by: The name of the column according to which the TensorFrame</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">                will be sorted.</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">            indices: If given as a string `s`, the result will be a new</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">                TensorFrame, and the sorting indices will be listed under</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">                a column named `s`.</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">            ranks: If given as a string `z`, the result will be a new</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">                TensorFrame, and the ranks will be listed under a column</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">                named `z`.</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">            descending: If True, the sorting will be in descending order.</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">            join: Can be used only if column names are given via `indices`</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">                and/or `ranks`. If `join` is True, then the resulting</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">                TensorFrame will have the sorted TensorFrame&#39;s columns</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">                as well.</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">            A tensor of indices, or a TensorFrame.</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="n">by</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>        <span class="n">target_column</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">by</span><span class="p">]</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>        <span class="n">indices_for_sorting</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">target_column</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="n">descending</span><span class="p">)</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">indices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ranks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>            <span class="k">if</span> <span class="n">join</span><span class="p">:</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>                    <span class="s2">&quot;When the argument `join` is given as True,&quot;</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>                    <span class="s2">&quot; the arguments `indices` and/or `ranks` are also required.&quot;</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>                    <span class="s2">&quot; However, both `indices` and `ranks` are encountered as None.&quot;</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>                <span class="p">)</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>            <span class="k">return</span> <span class="n">indices_for_sorting</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">()</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>        <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>            <span class="n">result</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">indices_for_sorting</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>        <span class="k">if</span> <span class="n">ranks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="n">rank_integers</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">indices_for_sorting</span><span class="p">)</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>            <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">rank_integers</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>            <span class="n">increasing_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">rank_integers</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>            <span class="n">rank_integers</span><span class="p">[</span><span class="n">indices_for_sorting</span><span class="p">]</span> <span class="o">=</span> <span class="n">increasing_indices</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>            <span class="n">result</span><span class="p">[</span><span class="n">ranks</span><span class="p">]</span> <span class="o">=</span> <span class="n">rank_integers</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>        <span class="k">if</span> <span class="n">join</span><span class="p">:</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">        Return a sorted copy of this TensorFrame.</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">            by: Name of the column according to which the sorting will be done.</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">            descending: If True, the sorting will be in descending order.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">            The sorted copy of this TensorFrame.</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>        <span class="n">indices_for_sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="n">descending</span><span class="p">)</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pick</span><span class="p">[</span><span class="n">indices_for_sorting</span><span class="p">]</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">hstack</span><span class="p">(</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>        <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">,</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>        <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">        Horizontally join this TensorFrame with another.</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">            other: The other TensorFrame.</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">            override: If this is given as True and if the other TensorFrame</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">                has overlapping columns, the other TensorFrame&#39;s values will</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">                override (i.e. will take priority) in the joined result.</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">            A new TensorFrame formed from joining this TensorFrame with the</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">            other TensorFrame.</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span><span class="p">:</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>            <span class="n">left_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>            <span class="n">right_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>            <span class="n">common_columns</span> <span class="o">=</span> <span class="n">left_columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">right_columns</span><span class="p">)</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>                    <span class="s2">&quot;Cannot horizontally stack these two TensorFrame objects,&quot;</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>                    <span class="sa">f</span><span class="s2">&quot; because they have the following shared column(s): </span><span class="si">{</span><span class="n">common_columns</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>                <span class="p">)</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>                <span class="s2">&quot;Cannot horizontally stack these two TensorFrame objects,&quot;</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>                <span class="sa">f</span><span class="s2">&quot; because the number of rows of the first TensorFrame is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>                <span class="sa">f</span><span class="s2">&quot; while the length of the second TensorFrame is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>            <span class="p">)</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>        <span class="k">for</span> <span class="n">right_column</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>            <span class="n">result</span><span class="p">[</span><span class="n">right_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="n">right_column</span><span class="p">]</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">vstack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        Vertically join this TensorFrame with the other TensorFrame.</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">            other: The other TensorFrame which will be at the bottom.</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">            The joined TensorFrame.</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>                <span class="s2">&quot;Cannot vertically stack these two TensorFrame objects, because their columns do not perfectly match.&quot;</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>            <span class="p">)</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">combine_tensors</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>            <span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>            <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="n">b</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot combine two columns that have different numbers of dimensions&quot;</span><span class="p">)</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>            <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>                <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>            <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>                <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Execution should not have reached this point. This is probably a bug.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="n">newdata</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>            <span class="n">newdata</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">combine_tensors</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">other</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>        <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="n">newdata</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">each</span><span class="p">(</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>        <span class="n">chunk_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>        <span class="n">randomness</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>        <span class="n">join</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>        <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">        For each row of this TensorFrame, perform the operations of `fn`.</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">        `fn` is executed on the rows in a vectorized manner, with the help</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">        of `torch.vmap`.</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">        The function `fn` is expected to have this interface:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">        def fn(row: dict) -&gt; dict:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">            # `row` is a dictionary where the keys are column names.</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">            # This function is expected to return another dictionary.</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">            ...</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">        ```</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">        For example, if we have a TensorFrame with columns A and B, and</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        if we want to create a new column C where, for each row, the</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">        value under C is the sum of A&#39;s value and B&#39;s value, then the</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">        function would look like this:</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">        def do_summation_for_each_row(row: dict) -&gt; dict:</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">            a = row[&quot;A&quot;]</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">            b = row[&quot;B&quot;]</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">            return {&quot;C&quot;: a + b}</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">        ```</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">        Now, if our current TensorFrame looks like this:</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">        ```</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">         A    B</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">        ===  ===</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">         1    4</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">         2    5</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">         3    6</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">        ```</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">        Running `tensorframe.each(do_summation_for_each_row)` will result in</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">        the following new TensorFrame:</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="sd">         C</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">        ===</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="sd">         5</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">         7</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">         9</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">            fn: A function which receives a dictionary as its argument, and</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">                returns another dictionary.</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">            chunk_size: For performing `fn` on each row, this `each` method</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">                uses `torch.vmap`. This `chunk_size` argument configures the</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">                size of the chunks on which the transformed `fn` will</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">                operate. If `chunk_size` is ignored, `fn` will operate on the</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">                whole batch.</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">            randomness: If given as &quot;error&quot; (which is the default), any random</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">                number generation operation within `fn` will raise an error.</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">                If given as &quot;different&quot;, random numbers generated by `fn`</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">                will differ from row to row.</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">                If given as &quot;same&quot;, random numbers generated by `fn` will be</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">                the same across the rows.</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">            join: If given as True, the resulting TensorFrame will also contain</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">                this TensorFrame&#39;s columns.</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">            override: If given as True (and if `join` is also True), and if</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">                the resulting TensorFrame has overlapping columns, the new</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">                values under the overlapping columns will take precedence.</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">            A new TensorFrame which stores the results of `fn`</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">join</span><span class="p">)</span> <span class="ow">and</span> <span class="n">override</span><span class="p">:</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The argument `override` can be set as True only if `join` is also True.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>        <span class="n">input_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>        <span class="n">output_dict</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span> <span class="n">randomness</span><span class="o">=</span><span class="n">randomness</span><span class="p">)(</span><span class="n">input_dict</span><span class="p">)</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="n">output_dict</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_read_only</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__get_default_device_kwargs</span><span class="p">()))</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>        <span class="k">if</span> <span class="n">join</span><span class="p">:</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">)</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sort_values</span><span class="p">(</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>        <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">],</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>        <span class="n">ascending</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">        Like the `sort` method, but with a more pandas-like interface.</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">            by: Column according to which this TensorFrame will be sorted.</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">            ascending: If True, the sorting will be in ascending order.</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">            The sorted counterpart of this TensorFrame.</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>        <span class="n">by</span> <span class="o">=</span> <span class="n">_get_only_one_column_name</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>        <span class="n">ascending</span> <span class="o">=</span> <span class="n">_get_only_one_boolean</span><span class="p">(</span><span class="n">ascending</span><span class="p">)</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="n">ascending</span><span class="p">))</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nlargest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">        Sort this TensorFrame and take the largest `n` rows.</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">            n: Number of rows of the resulting TensorFrame.</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">            columns: The name of the column according to which the rows will</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">                be sorted. Although the name of this argument is plural</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">                (&quot;columns&quot;) for compatibility with pandas&#39; interface, only</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">                one column name is supported.</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">            A new TensorFrame that contains the largest n rows of the original</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">            TensorFrame.</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">pick</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nsmallest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">        Sort this TensorFrame and take the smallest `n` rows.</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">            n: Number of rows of the resulting TensorFrame.</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">            columns: The name of the column according to which the rows will</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">                be sorted. Although the name of this argument is plural</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">                (&quot;columns&quot;) for compatibility with pandas&#39; interface, only</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">                one column name is supported.</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">            A new TensorFrame that contains the smallest n rows of the original</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">            TensorFrame.</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">pick</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;TensorFrame&quot;</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">        Like the `hstack` method, but with a more pandas-like interface.</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">        Joins this TensorFrame with the other TensorFrame.</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">            t: The TensorFrame that will be horizontally stacked to the right.</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">            A new TensorFrame which is the result of horizontally joining this</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">            TensorFrame with the other (`t`).</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">_get_only_one_tensorframe</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">        Get a new TensorFrame where the given columns are dropped.</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">            columns: A single column name or a sequence of column names</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">                to be dropped.</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">            A modified copy of this TensorFrame where the specified `columns`</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">            are dropped.</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)):</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">columns</span><span class="p">]</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>            <span class="k">pass</span>  <span class="c1"># nothing to do</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>                <span class="s2">&quot;The argument `columns` was expected as a string or as a sequence of strings.&quot;</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>                <span class="sa">f</span><span class="s2">&quot; However, it was received as an instance of this unrecognized type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>            <span class="p">)</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>        <span class="n">all_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>        <span class="n">columns_to_drop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">columns_to_drop</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">all_columns</span><span class="p">):</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>                <span class="s2">&quot;Some of the `columns` cannot be found within the original TensorFrame,&quot;</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>                <span class="s2">&quot; and therefore, they cannot be dropped.&quot;</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>            <span class="p">)</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns_to_drop</span><span class="p">:</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>                <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_read_only</span><span class="p">:</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_read_only_view</span><span class="p">()</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">with_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">        Get a modified copy of this TensorFrame with some columns added/updated.</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">        The columns to be updated or added are expected as keyword arguments.</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">        For example, if a keyword argument is given as `A=new_a_values`, then,</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">        if `A` already exists in the original TensorFrame, those values will be</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">        dropped and the resulting TensorFrame will have the new values</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">        (`new_a_values`). On the other hand, if `A` does not exist in the</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">        original TensorFrame, the resulting TensorFrame will have a new column</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">        `A` with the given `new_a_values`.</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>        <span class="n">columns_to_update</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>        <span class="n">columns_already_updated</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_to_update</span><span class="p">:</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>                <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>                <span class="n">columns_already_updated</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>                <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_to_update</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">columns_already_updated</span><span class="p">):</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>            <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_read_only</span><span class="p">:</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_read_only_view</span><span class="p">()</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="evotorch.tools.tensorframe.TensorFrame.columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">columns</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.tools.tensorframe.TensorFrame.columns" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Columns as a list of strings</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.tools.tensorframe.TensorFrame.device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">device</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.tools.tensorframe.TensorFrame.device" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the device(s) of this TensorFrame.</p>
<p>If different columns exist on different devices, a set of devices
will be returned. If all the columns exist on the same device, then
that device will be returned.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.tools.tensorframe.TensorFrame.is_read_only" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_read_only</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.tools.tensorframe.TensorFrame.is_read_only" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>True if this TensorFrame is read-only; False otherwise.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="evotorch.tools.tensorframe.TensorFrame.pick" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pick</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#evotorch.tools.tensorframe.TensorFrame.pick" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get or set values of this TensorFrame.</p>
<p><strong>Usage.</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Get values</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">tensorframe</span><span class="o">.</span><span class="n">pick</span><span class="p">[</span><span class="n">slice_or_indexlist</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Set values</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">tensorframe</span><span class="o">.</span><span class="n">pick</span><span class="p">[</span><span class="n">slice_or_indexlist</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="o">...</span>  <span class="c1"># A tensor or a list/tensor of indices or a TensorFrame</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span>
</code></pre></div>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p><code>__init__(...)</code>: Initialize the TensorFrame</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="collections.abc.Mapping">Mapping</span>, <a class="autorefs autorefs-internal" title="TensorFrame (evotorch.tools.tensorframe.TensorFrame)" href="#evotorch.tools.tensorframe.TensorFrame">TensorFrame</a>, <span title="evotorch.tools.tensorframe._PandasDataFrame">_PandasDataFrame</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a TensorFrame, or a dictionary (where the keys
are column names and the values are column values), or a
<code>pandas.DataFrame</code> object. If provided, the tabular data
given here are used for initializing the new TensorFrame.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>read_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the newly made TensorFrame will be
read-only. A read-only TensorFrame's columns will be
ReadOnlyTensors, and its columns and values will not change.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="torch.device">device</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If left as None, each column can be on a different device.
If given as a string or a <code>torch.device</code>, each column will
be forcefully moved to this given device.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">,</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">,</span> <span class="n">_PandasDataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="n">read_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="p">):</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    `__init__(...)`: Initialize the TensorFrame</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        data: Optionally a TensorFrame, or a dictionary (where the keys</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            are column names and the values are column values), or a</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            `pandas.DataFrame` object. If provided, the tabular data</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            given here are used for initializing the new TensorFrame.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        read_only: Whether or not the newly made TensorFrame will be</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            read-only. A read-only TensorFrame&#39;s columns will be</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            ReadOnlyTensors, and its columns and values will not change.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        device: If left as None, each column can be on a different device.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            If given as a string or a `torch.device`, each column will</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            be forcefully moved to this given device.</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.readonlytensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">as_read_only_tensor</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__device</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="k">if</span> <span class="n">read_only</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">prepare_value</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="k">return</span> <span class="n">as_read_only_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">prepare_value</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__data</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="k">pass</span>  <span class="c1"># no data is given, nothing to do</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">elif</span> <span class="n">_is_pandas_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="n">v</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">prepare_value</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">prepare_value</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">TensorFrame</span><span class="p">):</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">prepare_value</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="s2">&quot;When constructing a new TensorFrame, the argument `data` was expected as a dictionary-like object&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="s2">&quot; (an instance of Mapping), or as a TensorFrame.&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="sa">f</span><span class="s2">&quot; However, the encountered object is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="p">)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span> <span class="o">=</span> <span class="n">read_only</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.argsort" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">argsort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ranks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.argsort" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return row indices (also optionally ranks) for sorting the TensorFrame.</p>
<p>For example, let us assume that we have a TensorFrame named <code>table</code>.
We can sort this <code>table</code> like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">indices_for_sorting</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>  <span class="c1"># sort by the column A</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">sorted_table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">pick</span><span class="p">[</span><span class="n">indices_for_sorting</span><span class="p">]</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>by</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="numpy.str_">str_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column according to which the TensorFrame
will be sorted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>indices</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="numpy.str_">str_</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as a string <code>s</code>, the result will be a new
TensorFrame, and the sorting indices will be listed under
a column named <code>s</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ranks</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="numpy.str_">str_</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as a string <code>z</code>, the result will be a new
TensorFrame, and the ranks will be listed under a column
named <code>z</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>descending</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the sorting will be in descending order.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>join</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Can be used only if column names are given via <code>indices</code>
and/or <code>ranks</code>. If <code>join</code> is True, then the resulting
TensorFrame will have the sorted TensorFrame's columns
as well.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="k">def</span><span class="w"> </span><span class="nf">argsort</span><span class="p">(</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>    <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>    <span class="n">indices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>    <span class="n">ranks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>    <span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>    <span class="n">join</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">    Return row indices (also optionally ranks) for sorting the TensorFrame.</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">    For example, let us assume that we have a TensorFrame named `table`.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">    We can sort this `table` like this:</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">    indices_for_sorting = table.argsort(by=&quot;A&quot;)  # sort by the column A</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">    sorted_table = table.pick[indices_for_sorting]</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">    ```</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">        by: The name of the column according to which the TensorFrame</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">            will be sorted.</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">        indices: If given as a string `s`, the result will be a new</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">            TensorFrame, and the sorting indices will be listed under</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">            a column named `s`.</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">        ranks: If given as a string `z`, the result will be a new</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">            TensorFrame, and the ranks will be listed under a column</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">            named `z`.</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">        descending: If True, the sorting will be in descending order.</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">        join: Can be used only if column names are given via `indices`</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">            and/or `ranks`. If `join` is True, then the resulting</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">            TensorFrame will have the sorted TensorFrame&#39;s columns</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">            as well.</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        A tensor of indices, or a TensorFrame.</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>    <span class="n">by</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>    <span class="n">target_column</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">by</span><span class="p">]</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>    <span class="n">indices_for_sorting</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">target_column</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="n">descending</span><span class="p">)</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">indices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ranks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>        <span class="k">if</span> <span class="n">join</span><span class="p">:</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>                <span class="s2">&quot;When the argument `join` is given as True,&quot;</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>                <span class="s2">&quot; the arguments `indices` and/or `ranks` are also required.&quot;</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>                <span class="s2">&quot; However, both `indices` and `ranks` are encountered as None.&quot;</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>            <span class="p">)</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>        <span class="k">return</span> <span class="n">indices_for_sorting</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">()</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>    <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>        <span class="n">result</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">indices_for_sorting</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>    <span class="k">if</span> <span class="n">ranks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>        <span class="n">rank_integers</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">indices_for_sorting</span><span class="p">)</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>        <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">rank_integers</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="n">increasing_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">rank_integers</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>        <span class="n">rank_integers</span><span class="p">[</span><span class="n">indices_for_sorting</span><span class="p">]</span> <span class="o">=</span> <span class="n">increasing_indices</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>        <span class="n">result</span><span class="p">[</span><span class="n">ranks</span><span class="p">]</span> <span class="o">=</span> <span class="n">rank_integers</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>    <span class="k">if</span> <span class="n">join</span><span class="p">:</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.as_tensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">as_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">to_work_with</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">broadcast_if_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.as_tensor" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert the given object <code>x</code> to a PyTorch tensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object to be converted to a PyTorch tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_work_with</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="numpy.str_">str_</span>, <span title="torch.Tensor">Tensor</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string, referring to an existing column
within this TensorFrame, or a PyTorch tensor. The object <code>x</code>
will be converted to a PyTorch tensor on the same device with
this given column/tensor. If <code>to_work_with</code> is left as None,
<code>x</code> will be converted to a PyTorch tensor on the same device
with this TensorFrame's first column.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>broadcast_if_scalar</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If this argument is given as True and if <code>x</code>
is a scalar, its tensor-counterpart will be broadcast to a
vector of length <code>n</code>, where <code>n</code> is the number of rows of this
TensorFrame.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="k">def</span><span class="w"> </span><span class="nf">as_tensor</span><span class="p">(</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="n">to_work_with</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">broadcast_if_scalar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    Convert the given object `x` to a PyTorch tensor.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        x: The object to be converted to a PyTorch tensor.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        to_work_with: Optionally a string, referring to an existing column</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            within this TensorFrame, or a PyTorch tensor. The object `x`</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            will be converted to a PyTorch tensor on the same device with</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            this given column/tensor. If `to_work_with` is left as None,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            `x` will be converted to a PyTorch tensor on the same device</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            with this TensorFrame&#39;s first column.</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        broadcast_if_scalar: If this argument is given as True and if `x`</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            is a scalar, its tensor-counterpart will be broadcast to a</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            vector of length `n`, where `n` is the number of rows of this</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            TensorFrame.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        The tensor counterpart of `x`.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.readonlytensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">as_read_only_tensor</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="k">if</span> <span class="n">to_work_with</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_work_with</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="k">pass</span>  <span class="c1"># nothing to do</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_work_with</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)):</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>            <span class="n">to_work_with</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">to_work_with</span><span class="p">)]</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                <span class="s2">&quot;The argument `to_work_with` was expected as a PyTorch tensor or as a string&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>                <span class="s2">&quot; (that refers to one of the columns of this TensorFrame).&quot;</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                <span class="sa">f</span><span class="s2">&quot; However, it was received as an instance of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">to_work_with</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="p">)</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">to_work_with</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="n">convert</span> <span class="o">=</span> <span class="n">as_read_only_tensor</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="n">convert</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__get_default_device_kwargs</span><span class="p">()))</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__get_first_tensor_device_kwargs</span><span class="p">()))</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="k">if</span> <span class="n">broadcast_if_scalar</span> <span class="ow">and</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="n">first_tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_first_tensor</span><span class="p">()</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="k">if</span> <span class="n">first_tensor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The first column cannot be given as a scalar.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">first_tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.clone" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clone</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">preserve_read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.clone" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get a clone of this TensorFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>preserve_read_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the newly made clone will be read-only
only if this TensorFrame is also read-only.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="k">def</span><span class="w"> </span><span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">preserve_read_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">memo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">    Get a clone of this TensorFrame.</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">        preserve_read_only: If True, the newly made clone will be read-only</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">            only if this TensorFrame is also read-only.</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">        The clone of this TensorFrame.</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>    <span class="k">if</span> <span class="n">memo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>        <span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>    <span class="n">self_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>    <span class="k">if</span> <span class="n">self_id</span> <span class="ow">in</span> <span class="n">memo</span><span class="p">:</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>        <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">self_id</span><span class="p">]</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="n">new_read_only</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span> <span class="k">if</span> <span class="n">preserve_read_only</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>    <span class="n">newdata</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="n">newdata</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>    <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="n">newdata</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="n">new_read_only</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.cpu" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cpu</span><span class="p">()</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.cpu" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get a shallow copy of this TensorFrame with all columns moved to cpu.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="k">def</span><span class="w"> </span><span class="nf">cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">    Get a shallow copy of this TensorFrame with all columns moved to cpu.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.cuda" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cuda</span><span class="p">()</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.cuda" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get a shallow copy of this TensorFrame with all columns moved to cuda.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="k">def</span><span class="w"> </span><span class="nf">cuda</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">    Get a shallow copy of this TensorFrame with all columns moved to cuda.</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.drop" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.drop" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get a new TensorFrame where the given columns are dropped.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="numpy.str_">str_</span>, <span title="collections.abc.Sequence">Sequence</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single column name or a sequence of column names
to be dropped.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="k">def</span><span class="w"> </span><span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">    Get a new TensorFrame where the given columns are dropped.</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">        columns: A single column name or a sequence of column names</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">            to be dropped.</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">        A modified copy of this TensorFrame where the specified `columns`</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">        are dropped.</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">)):</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">columns</span><span class="p">]</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>        <span class="k">pass</span>  <span class="c1"># nothing to do</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>            <span class="s2">&quot;The argument `columns` was expected as a string or as a sequence of strings.&quot;</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>            <span class="sa">f</span><span class="s2">&quot; However, it was received as an instance of this unrecognized type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>        <span class="p">)</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>    <span class="n">all_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>    <span class="n">columns_to_drop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">columns_to_drop</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">all_columns</span><span class="p">):</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>            <span class="s2">&quot;Some of the `columns` cannot be found within the original TensorFrame,&quot;</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>            <span class="s2">&quot; and therefore, they cannot be dropped.&quot;</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>        <span class="p">)</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>        <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns_to_drop</span><span class="p">:</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>            <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_read_only</span><span class="p">:</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_read_only_view</span><span class="p">()</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.each" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">each</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">randomness</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.each" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>For each row of this TensorFrame, perform the operations of <code>fn</code>.</p>
<p><code>fn</code> is executed on the rows in a vectorized manner, with the help
of <code>torch.vmap</code>.</p>
<p>The function <code>fn</code> is expected to have this interface:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">fn</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="c1"># `row` is a dictionary where the keys are column names.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="c1"># This function is expected to return another dictionary.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="o">...</span>
</code></pre></div>
<p>For example, if we have a TensorFrame with columns A and B, and
if we want to create a new column C where, for each row, the
value under C is the sum of A's value and B's value, then the
function would look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">do_summation_for_each_row</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="n">a</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">b</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">}</span>
</code></pre></div>
<p>Now, if our current TensorFrame looks like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a> A    B
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>===  ===
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a> 1    4
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a> 2    5
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a> 3    6
</code></pre></div>
<p>Running <code>tensorframe.each(do_summation_for_each_row)</code> will result in
the following new TensorFrame:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a> C
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>===
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a> 5
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a> 7
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a> 9
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A function which receives a dictionary as its argument, and
returns another dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chunk_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For performing <code>fn</code> on each row, this <code>each</code> method
uses <code>torch.vmap</code>. This <code>chunk_size</code> argument configures the
size of the chunks on which the transformed <code>fn</code> will
operate. If <code>chunk_size</code> is ignored, <code>fn</code> will operate on the
whole batch.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>randomness</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as "error" (which is the default), any random
number generation operation within <code>fn</code> will raise an error.
If given as "different", random numbers generated by <code>fn</code>
will differ from row to row.
If given as "same", random numbers generated by <code>fn</code> will be
the same across the rows.</p>
              </div>
            </td>
            <td>
                  <code>&#39;error&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>join</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as True, the resulting TensorFrame will also contain
this TensorFrame's columns.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>override</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as True (and if <code>join</code> is also True), and if
the resulting TensorFrame has overlapping columns, the new
values under the overlapping columns will take precedence.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="k">def</span><span class="w"> </span><span class="nf">each</span><span class="p">(</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>    <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="n">chunk_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>    <span class="n">randomness</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>    <span class="n">join</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>    <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">    For each row of this TensorFrame, perform the operations of `fn`.</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">    `fn` is executed on the rows in a vectorized manner, with the help</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">    of `torch.vmap`.</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">    The function `fn` is expected to have this interface:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">    def fn(row: dict) -&gt; dict:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">        # `row` is a dictionary where the keys are column names.</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">        # This function is expected to return another dictionary.</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">        ...</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">    ```</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">    For example, if we have a TensorFrame with columns A and B, and</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">    if we want to create a new column C where, for each row, the</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">    value under C is the sum of A&#39;s value and B&#39;s value, then the</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">    function would look like this:</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">    def do_summation_for_each_row(row: dict) -&gt; dict:</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">        a = row[&quot;A&quot;]</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">        b = row[&quot;B&quot;]</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">        return {&quot;C&quot;: a + b}</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">    ```</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">    Now, if our current TensorFrame looks like this:</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">    ```</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">     A    B</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">    ===  ===</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">     1    4</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">     2    5</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">     3    6</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">    ```</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">    Running `tensorframe.each(do_summation_for_each_row)` will result in</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">    the following new TensorFrame:</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="sd">     C</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">    ===</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="sd">     5</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">     7</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">     9</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">        fn: A function which receives a dictionary as its argument, and</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">            returns another dictionary.</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">        chunk_size: For performing `fn` on each row, this `each` method</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">            uses `torch.vmap`. This `chunk_size` argument configures the</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">            size of the chunks on which the transformed `fn` will</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">            operate. If `chunk_size` is ignored, `fn` will operate on the</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">            whole batch.</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        randomness: If given as &quot;error&quot; (which is the default), any random</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">            number generation operation within `fn` will raise an error.</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">            If given as &quot;different&quot;, random numbers generated by `fn`</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">            will differ from row to row.</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">            If given as &quot;same&quot;, random numbers generated by `fn` will be</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">            the same across the rows.</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">        join: If given as True, the resulting TensorFrame will also contain</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">            this TensorFrame&#39;s columns.</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">        override: If given as True (and if `join` is also True), and if</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">            the resulting TensorFrame has overlapping columns, the new</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">            values under the overlapping columns will take precedence.</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">        A new TensorFrame which stores the results of `fn`</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">join</span><span class="p">)</span> <span class="ow">and</span> <span class="n">override</span><span class="p">:</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The argument `override` can be set as True only if `join` is also True.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>    <span class="n">input_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>    <span class="n">output_dict</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span> <span class="n">randomness</span><span class="o">=</span><span class="n">randomness</span><span class="p">)(</span><span class="n">input_dict</span><span class="p">)</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="n">output_dict</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_read_only</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__get_default_device_kwargs</span><span class="p">()))</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>    <span class="k">if</span> <span class="n">join</span><span class="p">:</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">)</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.get_read_only_view" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_read_only_view</span><span class="p">()</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.get_read_only_view" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get a read-only counterpart of this TensorFrame.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_read_only_view</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">    Get a read-only counterpart of this TensorFrame.</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>    <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.hstack" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hstack</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.hstack" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Horizontally join this TensorFrame with another.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TensorFrame (evotorch.tools.tensorframe.TensorFrame)" href="#evotorch.tools.tensorframe.TensorFrame">TensorFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The other TensorFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>override</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If this is given as True and if the other TensorFrame
has overlapping columns, the other TensorFrame's values will
override (i.e. will take priority) in the joined result.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="k">def</span><span class="w"> </span><span class="nf">hstack</span><span class="p">(</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>    <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">,</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>    <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">    Horizontally join this TensorFrame with another.</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">        other: The other TensorFrame.</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">        override: If this is given as True and if the other TensorFrame</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">            has overlapping columns, the other TensorFrame&#39;s values will</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">            override (i.e. will take priority) in the joined result.</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">        A new TensorFrame formed from joining this TensorFrame with the</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">        other TensorFrame.</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span><span class="p">:</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>        <span class="n">left_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>        <span class="n">right_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>        <span class="n">common_columns</span> <span class="o">=</span> <span class="n">left_columns</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">right_columns</span><span class="p">)</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>                <span class="s2">&quot;Cannot horizontally stack these two TensorFrame objects,&quot;</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>                <span class="sa">f</span><span class="s2">&quot; because they have the following shared column(s): </span><span class="si">{</span><span class="n">common_columns</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>            <span class="p">)</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>            <span class="s2">&quot;Cannot horizontally stack these two TensorFrame objects,&quot;</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>            <span class="sa">f</span><span class="s2">&quot; because the number of rows of the first TensorFrame is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>            <span class="sa">f</span><span class="s2">&quot; while the length of the second TensorFrame is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>        <span class="p">)</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>    <span class="k">for</span> <span class="n">right_column</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>        <span class="n">result</span><span class="p">[</span><span class="n">right_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="n">right_column</span><span class="p">]</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.join" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.join" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Like the <code>hstack</code> method, but with a more pandas-like interface.</p>
<p>Joins this TensorFrame with the other TensorFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="TensorFrame (evotorch.tools.tensorframe.TensorFrame)" href="#evotorch.tools.tensorframe.TensorFrame">TensorFrame</a>, <span title="collections.abc.Sequence">Sequence</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The TensorFrame that will be horizontally stacked to the right.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="k">def</span><span class="w"> </span><span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;TensorFrame&quot;</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">    Like the `hstack` method, but with a more pandas-like interface.</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">    Joins this TensorFrame with the other TensorFrame.</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">        t: The TensorFrame that will be horizontally stacked to the right.</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">        A new TensorFrame which is the result of horizontally joining this</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">        TensorFrame with the other (`t`).</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">_get_only_one_tensorframe</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.nlargest" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nlargest</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.nlargest" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Sort this TensorFrame and take the largest <code>n</code> rows.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rows of the resulting TensorFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="numpy.str_">str_</span>, <span title="collections.abc.Sequence">Sequence</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column according to which the rows will
be sorted. Although the name of this argument is plural
("columns") for compatibility with pandas' interface, only
one column name is supported.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="k">def</span><span class="w"> </span><span class="nf">nlargest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">    Sort this TensorFrame and take the largest `n` rows.</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">        n: Number of rows of the resulting TensorFrame.</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">        columns: The name of the column according to which the rows will</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">            be sorted. Although the name of this argument is plural</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">            (&quot;columns&quot;) for compatibility with pandas&#39; interface, only</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">            one column name is supported.</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">        A new TensorFrame that contains the largest n rows of the original</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">        TensorFrame.</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">pick</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.nsmallest" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nsmallest</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.nsmallest" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Sort this TensorFrame and take the smallest <code>n</code> rows.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rows of the resulting TensorFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="numpy.str_">str_</span>, <span title="collections.abc.Sequence">Sequence</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column according to which the rows will
be sorted. Although the name of this argument is plural
("columns") for compatibility with pandas' interface, only
one column name is supported.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="k">def</span><span class="w"> </span><span class="nf">nsmallest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">    Sort this TensorFrame and take the smallest `n` rows.</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">        n: Number of rows of the resulting TensorFrame.</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">        columns: The name of the column according to which the rows will</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">            be sorted. Although the name of this argument is plural</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">            (&quot;columns&quot;) for compatibility with pandas&#39; interface, only</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">            one column name is supported.</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">        A new TensorFrame that contains the smallest n rows of the original</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">        TensorFrame.</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">pick</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.sort" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.sort" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a sorted copy of this TensorFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>by</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="numpy.str_">str_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column according to which the sorting will be done.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>descending</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the sorting will be in descending order.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">    Return a sorted copy of this TensorFrame.</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">        by: Name of the column according to which the sorting will be done.</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">        descending: If True, the sorting will be in descending order.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">        The sorted copy of this TensorFrame.</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>    <span class="n">indices_for_sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="n">descending</span><span class="p">)</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pick</span><span class="p">[</span><span class="n">indices_for_sorting</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.sort_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.sort_values" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Like the <code>sort</code> method, but with a more pandas-like interface.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>by</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="numpy.str_">str_</span>, <span title="collections.abc.Sequence">Sequence</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column according to which this TensorFrame will be sorted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ascending</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="bool">bool</span>, <span title="collections.abc.Sequence">Sequence</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the sorting will be in ascending order.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="k">def</span><span class="w"> </span><span class="nf">sort_values</span><span class="p">(</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>    <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">],</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>    <span class="n">ascending</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">    Like the `sort` method, but with a more pandas-like interface.</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">        by: Column according to which this TensorFrame will be sorted.</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        ascending: If True, the sorting will be in ascending order.</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">        The sorted counterpart of this TensorFrame.</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>    <span class="n">by</span> <span class="o">=</span> <span class="n">_get_only_one_column_name</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>    <span class="n">ascending</span> <span class="o">=</span> <span class="n">_get_only_one_boolean</span><span class="p">(</span><span class="n">ascending</span><span class="p">)</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="n">ascending</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.to_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_string</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">DEFAULT_MAX_DEPTH_FOR_PRINTING</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.to_string" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the string representation of this TensorFrame</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_MAX_DEPTH_FOR_PRINTING</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">    Return the string representation of this TensorFrame</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;()&quot;</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">max_depth</span> <span class="o">&gt;=</span> <span class="n">DEFAULT_MAX_DEPTH_FOR_PRINTING</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__all_columns_are_one_dimensional</span><span class="p">():</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__tabular_repr</span><span class="p">()</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__non_tabular_repr</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.vstack" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vstack</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.vstack" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Vertically join this TensorFrame with the other TensorFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TensorFrame (evotorch.tools.tensorframe.TensorFrame)" href="#evotorch.tools.tensorframe.TensorFrame">TensorFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The other TensorFrame which will be at the bottom.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="k">def</span><span class="w"> </span><span class="nf">vstack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    Vertically join this TensorFrame with the other TensorFrame.</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">        other: The other TensorFrame which will be at the bottom.</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">        The joined TensorFrame.</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>            <span class="s2">&quot;Cannot vertically stack these two TensorFrame objects, because their columns do not perfectly match.&quot;</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>        <span class="p">)</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">combine_tensors</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>        <span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="n">b</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot combine two columns that have different numbers of dimensions&quot;</span><span class="p">)</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>        <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Execution should not have reached this point. This is probably a bug.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>    <span class="n">newdata</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>        <span class="n">newdata</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">combine_tensors</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">other</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>    <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="n">newdata</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.with_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_columns</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.with_columns" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get a modified copy of this TensorFrame with some columns added/updated.</p>
<p>The columns to be updated or added are expected as keyword arguments.
For example, if a keyword argument is given as <code>A=new_a_values</code>, then,
if <code>A</code> already exists in the original TensorFrame, those values will be
dropped and the resulting TensorFrame will have the new values
(<code>new_a_values</code>). On the other hand, if <code>A</code> does not exist in the
original TensorFrame, the resulting TensorFrame will have a new column
<code>A</code> with the given <code>new_a_values</code>.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="k">def</span><span class="w"> </span><span class="nf">with_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">    Get a modified copy of this TensorFrame with some columns added/updated.</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">    The columns to be updated or added are expected as keyword arguments.</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">    For example, if a keyword argument is given as `A=new_a_values`, then,</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">    if `A` already exists in the original TensorFrame, those values will be</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">    dropped and the resulting TensorFrame will have the new values</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">    (`new_a_values`). On the other hand, if `A` does not exist in the</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">    original TensorFrame, the resulting TensorFrame will have a new column</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="sd">    `A` with the given `new_a_values`.</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>    <span class="n">columns_to_update</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>    <span class="n">columns_already_updated</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_to_update</span><span class="p">:</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>            <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>            <span class="n">columns_already_updated</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>            <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_to_update</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">columns_already_updated</span><span class="p">):</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>        <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_read_only</span><span class="p">:</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_read_only_view</span><span class="p">()</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.with_enforced_device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_enforced_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.with_enforced_device" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Make a shallow copy of this TensorFrame with an enforced device.</p>
<p>In the newly made shallow copy, columns will be forcefully moved onto
the specified device.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="torch.device">device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device to which the new TensorFrame's columns will move.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="k">def</span><span class="w"> </span><span class="nf">with_enforced_device</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">    Make a shallow copy of this TensorFrame with an enforced device.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    In the newly made shallow copy, columns will be forcefully moved onto</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">    the specified device.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        device: The device to which the new TensorFrame&#39;s columns will move.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        A shallow copy of this TensorFrame with an enforced device.</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;When using the method `with_enforced_device`, the argument `device` cannot be None&quot;</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.tensorframe.TensorFrame.without_enforced_device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">without_enforced_device</span><span class="p">()</span></code>

<a href="#evotorch.tools.tensorframe.TensorFrame.without_enforced_device" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Make a shallow copy of this TensorFrame without any enforced device.</p>
<p>In the newly made shallow copy, columns will be able to exist on
different devices.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="TensorFrame (evotorch.tools.tensorframe.TensorFrame)" href="#evotorch.tools.tensorframe.TensorFrame">TensorFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A shallow copy of this TensorFrame without any enforced device.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/tensorframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="k">def</span><span class="w"> </span><span class="nf">without_enforced_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TensorFrame&quot;</span><span class="p">:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">    Make a shallow copy of this TensorFrame without any enforced device.</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">    In the newly made shallow copy, columns will be able to exist on</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">    different devices.</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">        A shallow copy of this TensorFrame without any enforced device.</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="k">return</span> <span class="n">TensorFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__is_read_only</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 NNAISENSE SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>