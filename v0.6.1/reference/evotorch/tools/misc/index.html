
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="EvoTorch is an open source evolutionary computation library developed at NNAISENSE, built on top of PyTorch.">
      
      
      
      
        <link rel="prev" href="../immutable/">
      
      
        <link rel="next" href="../objectarray/">
      
      
      <link rel="icon" href="../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Misc - EvoTorch</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#evotorch.tools.misc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-header__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EvoTorch
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Misc
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../quickstart/" class="md-tabs__link">
        
  
  
    
  
  Quickstart

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../user_guide/general_usage/" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../advanced_usage/solution_batch/" class="md-tabs__link">
          
  
  
    
  
  Advanced Usage

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-nav__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EvoTorch
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/general_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/algorithm_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithm Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/algorithms_tour/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithms Tour
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/problems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Defining Problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/problem_parallelization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Problem Parallelization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/neuroevolution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/gym/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neuroevolution for Gym
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/supervised_ne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervised Neuroevolution
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/solution_batch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manipulating Solutions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/dist_based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributed Evolution Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/custom_ea/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Searchers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/custom_logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Loggers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/ray_cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Ray Clusters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Brax_Experiments_Visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization of the brax Experiment Results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Brax_Experiments_with_PGPE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving a Brax environment using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Evolving_Objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Feature_Space_Illumination_with_MAPElites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Space Illumination with MAPElites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Genetic_Programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic Programming using EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Gym_Experiments_with_PGPE_and_CoSyNE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gym Experiments with PGPE and CoSyNE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Minimizing_Lennard-Jones_Atom_Cluster_Potentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minimising Lennard-Jones Atom Cluster Potentials with Evolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Training_MNIST30K/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training MNIST30K
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/Variational_Quantum_Eigensolvers_with_SNES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variational Quantum Eigensolvers with SNES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/batched_searches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maintaining a batch of populations using the functional EvoTorch API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/constrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving constrained optimization problems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/func_rl_ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evolving objects using the functional operators API of EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/functional_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic algorithm with the help of functional operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/multiobj_batched_ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multiobjective optimization via functional operators API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/problem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving reinforcement learning tasks using functional evolutionary algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/notebooks/reacher_mpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Predictive Control (MPC) with EvoTorch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Evotorch
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Evotorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimizers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8" id="__nav_6_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8">
            <span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/cmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/ga/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ga
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/mapelites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mapelites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/pycmaes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pycmaes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/searchalgorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Searchalgorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/distributed/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Distributed
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_7" id="__nav_6_1_8_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_7">
            <span class="md-nav__icon md-icon"></span>
            Distributed
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/distributed/gaussian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/functional/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_8" id="__nav_6_1_8_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_8">
            <span class="md-nav__icon md-icon"></span>
            Functional
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcadam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcadam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funccem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funccem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcclipup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcclipup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcpgpe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcpgpe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/funcsgd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcsgd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/functional/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_8_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../algorithms/restarter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Restarter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_8_9" id="__nav_6_1_8_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_8_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_8_9">
            <span class="md-nav__icon md-icon"></span>
            Restarter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/restarter/modify_restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modify restart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algorithms/restarter/restart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../neuroevolution/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Neuroevolution
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9" id="__nav_6_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9">
            <span class="md-nav__icon md-icon"></span>
            Neuroevolution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/baseneproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Baseneproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/gymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/neproblem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neproblem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/supervisedne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supervisedne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/vecgymne/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecgymne
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_9_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../neuroevolution/net/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Net
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_9_7" id="__nav_6_1_9_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_1_9_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_9_7">
            <span class="md-nav__icon md-icon"></span>
            Net
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/layers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/multilayered/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multilayered
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/rl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rl
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/runningnorm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningnorm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/runningstat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runningstat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/statefulmodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statefulmodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroevolution/net/vecrl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vecrl
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../operators/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_10" id="__nav_6_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1_10">
            <span class="md-nav__icon md-icon"></span>
            Operators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operators/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operators/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operators/real/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Real
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operators/sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sequence
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1_11" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1_11" id="__nav_6_1_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_1_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1_11">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constraints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../immutable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Immutable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc" class="md-nav__link">
    <span class="md-ellipsis">
      misc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.ErroneousResult" class="md-nav__link">
    <span class="md-ellipsis">
      ErroneousResult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ErroneousResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.misc.ErroneousResult.call" class="md-nav__link">
    <span class="md-ellipsis">
      call
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.as_tensor" class="md-nav__link">
    <span class="md-ellipsis">
      as_tensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.cast_tensors_in_container" class="md-nav__link">
    <span class="md-ellipsis">
      cast_tensors_in_container
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.clip_tensor" class="md-nav__link">
    <span class="md-ellipsis">
      clip_tensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.clone" class="md-nav__link">
    <span class="md-ellipsis">
      clone
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.device_of" class="md-nav__link">
    <span class="md-ellipsis">
      device_of
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.device_of_container" class="md-nav__link">
    <span class="md-ellipsis">
      device_of_container
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.dtype_of" class="md-nav__link">
    <span class="md-ellipsis">
      dtype_of
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.dtype_of_container" class="md-nav__link">
    <span class="md-ellipsis">
      dtype_of_container
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.empty_tensor_like" class="md-nav__link">
    <span class="md-ellipsis">
      empty_tensor_like
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.ensure_ray" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_ray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.ensure_tensor_length_and_dtype" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_tensor_length_and_dtype
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.expect_none" class="md-nav__link">
    <span class="md-ellipsis">
      expect_none
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_bool" class="md-nav__link">
    <span class="md-ellipsis">
      is_bool
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_bool_vector" class="md-nav__link">
    <span class="md-ellipsis">
      is_bool_vector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_dtype_bool" class="md-nav__link">
    <span class="md-ellipsis">
      is_dtype_bool
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_dtype_float" class="md-nav__link">
    <span class="md-ellipsis">
      is_dtype_float
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_dtype_integer" class="md-nav__link">
    <span class="md-ellipsis">
      is_dtype_integer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_dtype_object" class="md-nav__link">
    <span class="md-ellipsis">
      is_dtype_object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_dtype_real" class="md-nav__link">
    <span class="md-ellipsis">
      is_dtype_real
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_integer" class="md-nav__link">
    <span class="md-ellipsis">
      is_integer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_integer_vector" class="md-nav__link">
    <span class="md-ellipsis">
      is_integer_vector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_real" class="md-nav__link">
    <span class="md-ellipsis">
      is_real
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_real_vector" class="md-nav__link">
    <span class="md-ellipsis">
      is_real_vector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      is_sequence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_tensor_on_cpu" class="md-nav__link">
    <span class="md-ellipsis">
      is_tensor_on_cpu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_I" class="md-nav__link">
    <span class="md-ellipsis">
      make_I
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_batched_false_for_vmap" class="md-nav__link">
    <span class="md-ellipsis">
      make_batched_false_for_vmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_empty" class="md-nav__link">
    <span class="md-ellipsis">
      make_empty
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      make_gaussian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_nan" class="md-nav__link">
    <span class="md-ellipsis">
      make_nan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_ones" class="md-nav__link">
    <span class="md-ellipsis">
      make_ones
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_randint" class="md-nav__link">
    <span class="md-ellipsis">
      make_randint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_tensor" class="md-nav__link">
    <span class="md-ellipsis">
      make_tensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_uniform" class="md-nav__link">
    <span class="md-ellipsis">
      make_uniform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_zeros" class="md-nav__link">
    <span class="md-ellipsis">
      make_zeros
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.message_from" class="md-nav__link">
    <span class="md-ellipsis">
      message_from
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.modify_tensor" class="md-nav__link">
    <span class="md-ellipsis">
      modify_tensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.modify_vector" class="md-nav__link">
    <span class="md-ellipsis">
      modify_vector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.numpy_copy" class="md-nav__link">
    <span class="md-ellipsis">
      numpy_copy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.pass_info_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      pass_info_if_needed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.set_default_logger_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_default_logger_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.split_workload" class="md-nav__link">
    <span class="md-ellipsis">
      split_workload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.stdev_from_radius" class="md-nav__link">
    <span class="md-ellipsis">
      stdev_from_radius
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.storage_ptr" class="md-nav__link">
    <span class="md-ellipsis">
      storage_ptr
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.to_numpy_dtype" class="md-nav__link">
    <span class="md-ellipsis">
      to_numpy_dtype
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.to_stdev_init" class="md-nav__link">
    <span class="md-ellipsis">
      to_stdev_init
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.to_torch_dtype" class="md-nav__link">
    <span class="md-ellipsis">
      to_torch_dtype
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../objectarray/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Objectarray
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ranking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ranking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readonlytensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Readonlytensor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recursiveprintable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recursiveprintable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensorframe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensormaker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tensormaker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc" class="md-nav__link">
    <span class="md-ellipsis">
      misc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.ErroneousResult" class="md-nav__link">
    <span class="md-ellipsis">
      ErroneousResult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ErroneousResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.tools.misc.ErroneousResult.call" class="md-nav__link">
    <span class="md-ellipsis">
      call
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.as_tensor" class="md-nav__link">
    <span class="md-ellipsis">
      as_tensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.cast_tensors_in_container" class="md-nav__link">
    <span class="md-ellipsis">
      cast_tensors_in_container
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.clip_tensor" class="md-nav__link">
    <span class="md-ellipsis">
      clip_tensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.clone" class="md-nav__link">
    <span class="md-ellipsis">
      clone
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.device_of" class="md-nav__link">
    <span class="md-ellipsis">
      device_of
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.device_of_container" class="md-nav__link">
    <span class="md-ellipsis">
      device_of_container
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.dtype_of" class="md-nav__link">
    <span class="md-ellipsis">
      dtype_of
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.dtype_of_container" class="md-nav__link">
    <span class="md-ellipsis">
      dtype_of_container
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.empty_tensor_like" class="md-nav__link">
    <span class="md-ellipsis">
      empty_tensor_like
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.ensure_ray" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_ray
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.ensure_tensor_length_and_dtype" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_tensor_length_and_dtype
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.expect_none" class="md-nav__link">
    <span class="md-ellipsis">
      expect_none
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_bool" class="md-nav__link">
    <span class="md-ellipsis">
      is_bool
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_bool_vector" class="md-nav__link">
    <span class="md-ellipsis">
      is_bool_vector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_dtype_bool" class="md-nav__link">
    <span class="md-ellipsis">
      is_dtype_bool
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_dtype_float" class="md-nav__link">
    <span class="md-ellipsis">
      is_dtype_float
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_dtype_integer" class="md-nav__link">
    <span class="md-ellipsis">
      is_dtype_integer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_dtype_object" class="md-nav__link">
    <span class="md-ellipsis">
      is_dtype_object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_dtype_real" class="md-nav__link">
    <span class="md-ellipsis">
      is_dtype_real
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_integer" class="md-nav__link">
    <span class="md-ellipsis">
      is_integer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_integer_vector" class="md-nav__link">
    <span class="md-ellipsis">
      is_integer_vector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_real" class="md-nav__link">
    <span class="md-ellipsis">
      is_real
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_real_vector" class="md-nav__link">
    <span class="md-ellipsis">
      is_real_vector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      is_sequence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.is_tensor_on_cpu" class="md-nav__link">
    <span class="md-ellipsis">
      is_tensor_on_cpu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_I" class="md-nav__link">
    <span class="md-ellipsis">
      make_I
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_batched_false_for_vmap" class="md-nav__link">
    <span class="md-ellipsis">
      make_batched_false_for_vmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_empty" class="md-nav__link">
    <span class="md-ellipsis">
      make_empty
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      make_gaussian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_nan" class="md-nav__link">
    <span class="md-ellipsis">
      make_nan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_ones" class="md-nav__link">
    <span class="md-ellipsis">
      make_ones
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_randint" class="md-nav__link">
    <span class="md-ellipsis">
      make_randint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_tensor" class="md-nav__link">
    <span class="md-ellipsis">
      make_tensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_uniform" class="md-nav__link">
    <span class="md-ellipsis">
      make_uniform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.make_zeros" class="md-nav__link">
    <span class="md-ellipsis">
      make_zeros
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.message_from" class="md-nav__link">
    <span class="md-ellipsis">
      message_from
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.modify_tensor" class="md-nav__link">
    <span class="md-ellipsis">
      modify_tensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.modify_vector" class="md-nav__link">
    <span class="md-ellipsis">
      modify_vector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.numpy_copy" class="md-nav__link">
    <span class="md-ellipsis">
      numpy_copy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.pass_info_if_needed" class="md-nav__link">
    <span class="md-ellipsis">
      pass_info_if_needed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.set_default_logger_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_default_logger_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.split_workload" class="md-nav__link">
    <span class="md-ellipsis">
      split_workload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.stdev_from_radius" class="md-nav__link">
    <span class="md-ellipsis">
      stdev_from_radius
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.storage_ptr" class="md-nav__link">
    <span class="md-ellipsis">
      storage_ptr
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.to_numpy_dtype" class="md-nav__link">
    <span class="md-ellipsis">
      to_numpy_dtype
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.to_stdev_init" class="md-nav__link">
    <span class="md-ellipsis">
      to_stdev_init
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.tools.misc.to_torch_dtype" class="md-nav__link">
    <span class="md-ellipsis">
      to_torch_dtype
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Misc</h1>

<div class="doc doc-object doc-module">



<a id="evotorch.tools.misc"></a>
    <div class="doc doc-contents first">

        <p>Miscellaneous utility functions</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="evotorch.tools.misc.ErroneousResult" class="doc doc-heading">
            <code>ErroneousResult</code>


<a href="#evotorch.tools.misc.ErroneousResult" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Representation of a caught error being returned as a result.</p>







              <details class="quote">
                <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="k">class</span><span class="w"> </span><span class="nc">ErroneousResult</span><span class="p">:</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">    Representation of a caught error being returned as a result.</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">):</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="n">error</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, error: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_string</span><span class="p">()</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_string</span><span class="p">()</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">        Call a function with the given arguments.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">        If the function raises an error, wrap the error in an ErroneousResult</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        object, and return that ErroneousResult object instead.</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">            The result of the function if there was no error,</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">            or an ErroneousResult if there was an error.</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">ErroneousResult</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="evotorch.tools.misc.ErroneousResult.call" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">call</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#evotorch.tools.misc.ErroneousResult.call" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Call a function with the given arguments.
If the function raises an error, wrap the error in an ErroneousResult
object, and return that ErroneousResult object instead.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the function if there was no error,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>or an ErroneousResult if there was an error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">    Call a function with the given arguments.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">    If the function raises an error, wrap the error in an ErroneousResult</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">    object, and return that ErroneousResult object instead.</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">        The result of the function if there was no error,</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        or an ErroneousResult if there was an error.</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">ErroneousResult</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.as_tensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">as_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.as_tensor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the tensor counterpart of the given object <code>x</code>.</p>
<p>This function can be used to convert native Python objects to tensors:</p>
<div class="highlight"><pre><span></span><code>my_tensor = as_tensor([1.0, 2.0, 3.0], dtype=&quot;float32&quot;)
</code></pre></div>
<p>One can also use this function to convert an existing tensor to another
dtype:</p>
<div class="highlight"><pre><span></span><code>my_new_tensor = as_tensor(my_tensor, dtype=&quot;float16&quot;)
</code></pre></div>
<p>This function can also be used for moving a tensor from one device to
another:</p>
<div class="highlight"><pre><span></span><code>my_gpu_tensor = as_tensor(my_tensor, device=&quot;cuda:0&quot;)
</code></pre></div>
<p>This function can also create ObjectArray instances when dtype is
given as <code>object</code> or <code>Any</code> or "object" or "O".</p>
<div class="highlight"><pre><span></span><code>my_objects = as_tensor([1, {&quot;a&quot;: 3}], dtype=object)
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any object to be converted to a tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string (e.g. "float32") or a PyTorch dtype
(e.g. torch.float32) or, for creating an <code>ObjectArray</code>,
"object" (as string) or <code>object</code> or <code>Any</code>.
If <code>dtype</code> is not specified, the default behavior of
<code>torch.as_tensor(...)</code> will be used, that is, dtype will be
inferred from <code>x</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the resulting tensor will be stored.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1817" name="__codelineno-0-1817"></a><span class="k">def</span><span class="w"> </span><span class="nf">as_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a><span class="sd">    Get the tensor counterpart of the given object `x`.</span>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a><span class="sd">    This function can be used to convert native Python objects to tensors:</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a><span class="sd">        my_tensor = as_tensor([1.0, 2.0, 3.0], dtype=&quot;float32&quot;)</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a><span class="sd">    One can also use this function to convert an existing tensor to another</span>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a><span class="sd">    dtype:</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a><span class="sd">        my_new_tensor = as_tensor(my_tensor, dtype=&quot;float16&quot;)</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a><span class="sd">    This function can also be used for moving a tensor from one device to</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a><span class="sd">    another:</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a><span class="sd">        my_gpu_tensor = as_tensor(my_tensor, device=&quot;cuda:0&quot;)</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a><span class="sd">    This function can also create ObjectArray instances when dtype is</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a><span class="sd">    given as `object` or `Any` or &quot;object&quot; or &quot;O&quot;.</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a><span class="sd">        my_objects = as_tensor([1, {&quot;a&quot;: 3}], dtype=object)</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a><span class="sd">        x: Any object to be converted to a tensor.</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a><span class="sd">        dtype: Optionally a string (e.g. &quot;float32&quot;) or a PyTorch dtype</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a><span class="sd">            (e.g. torch.float32) or, for creating an `ObjectArray`,</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a><span class="sd">            &quot;object&quot; (as string) or `object` or `Any`.</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a><span class="sd">            If `dtype` is not specified, the default behavior of</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a><span class="sd">            `torch.as_tensor(...)` will be used, that is, dtype will be</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a><span class="sd">            inferred from `x`.</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a><span class="sd">        device: The device in which the resulting tensor will be stored.</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a><span class="sd">        The tensor counterpart of the given object `x`.</span>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.objectarray</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObjectArray</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">)):</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>            <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>                <span class="sa">f</span><span class="s2">&quot;An ObjectArray cannot be moved into a device other than &#39;cpu&#39;. The received device is: </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>            <span class="p">)</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>    <span class="k">elif</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>                <span class="sa">f</span><span class="s2">&quot;An ObjectArray cannot be created on a device other than &#39;cpu&#39;. The received device is: </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>            <span class="p">)</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">):</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>            <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>            <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">ObjectArray</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a>            <span class="n">result</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">x</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>            <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>        <span class="n">dtype</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.cast_tensors_in_container" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cast_tensors_in_container</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.cast_tensors_in_container" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Cast and/or transfer all the tensors in a Python container.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as a dtype and not as None, then all the PyTorch
tensors in the container will be cast to this dtype.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as a device and not as None, then all the PyTorch
tensors in the container will be copied to this device.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>memo</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a memo dictionary to handle shared objects and
circular references. In most scenarios, when calling this
function from outside, this is expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="k">def</span><span class="w"> </span><span class="nf">cast_tensors_in_container</span><span class="p">(</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">container</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="n">memo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">    Cast and/or transfer all the tensors in a Python container.</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        dtype: If given as a dtype and not as None, then all the PyTorch</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">            tensors in the container will be cast to this dtype.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        device: If given as a device and not as None, then all the PyTorch</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">            tensors in the container will be copied to this device.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        memo: Optionally a memo dictionary to handle shared objects and</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">            circular references. In most scenarios, when calling this</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">            function from outside, this is expected as None.</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        A new copy of the original container in which the tensors have the</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        desired dtype and/or device.</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="k">if</span> <span class="n">memo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">container_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="k">if</span> <span class="n">container_id</span> <span class="ow">in</span> <span class="n">memo</span><span class="p">:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="n">cast_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="n">cast_kwargs</span><span class="p">[</span><span class="s2">&quot;dtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">cast_kwargs</span><span class="p">[</span><span class="s2">&quot;device&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">call_self</span><span class="p">(</span><span class="n">sub_container</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">return</span> <span class="n">cast_tensors_in_container</span><span class="p">(</span><span class="n">sub_container</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="o">**</span><span class="n">cast_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">memo</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">container</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">container</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="n">result</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="n">memo</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="n">result</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">call_self</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="n">memo</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">container</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">call_self</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="n">memo</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">call_self</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="s2">&quot;_fields&quot;</span><span class="p">):</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="n">result</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">container</span><span class="p">)(</span><span class="o">*</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="n">result</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">container</span><span class="p">)(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="n">memo</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="n">memo</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">call_self</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encountered an object of unrecognized type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">container</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.clip_tensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clip_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ensure_copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.clip_tensor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Clip the values of a tensor with respect to the given bounds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PyTorch tensor whose values will be clipped.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lb</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="typing.Iterable">Iterable</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bounds, as a PyTorch tensor.
Can be None if there are no lower bounds.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ub</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="typing.Iterable">Iterable</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bounds, as a PyTorch tensor.
Can be None if there are no upper bonuds.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ensure_copy</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>ensure_copy</code> is True, the result will be
a clipped copy of the original tensor.
If <code>ensure_copy</code> is False, and both <code>lb</code> and <code>ub</code>
are None, then there is nothing to do, so, the result
will be the original tensor itself, not a copy of it.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="k">def</span><span class="w"> </span><span class="nf">clip_tensor</span><span class="p">(</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>    <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>    <span class="n">lb</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>    <span class="n">ub</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="n">ensure_copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">    Clip the values of a tensor with respect to the given bounds.</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">        x: The PyTorch tensor whose values will be clipped.</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">        lb: Lower bounds, as a PyTorch tensor.</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="sd">            Can be None if there are no lower bounds.</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">        ub: Upper bounds, as a PyTorch tensor.</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="sd">            Can be None if there are no upper bonuds.</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">        ensure_copy: If `ensure_copy` is True, the result will be</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">            a clipped copy of the original tensor.</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">            If `ensure_copy` is False, and both `lb` and `ub`</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">            are None, then there is nothing to do, so, the result</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="sd">            will be the original tensor itself, not a copy of it.</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">        The clipped tensor.</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">x</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>    <span class="k">if</span> <span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="n">lb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">lb</span><span class="p">)</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>    <span class="k">if</span> <span class="n">ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>        <span class="n">ub</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">ub</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="k">if</span> <span class="n">ensure_copy</span> <span class="ow">and</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">x</span><span class="p">:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.clone" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clone</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.clone" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get a deep copy of the given object.</p>
<p>The cloning is done in no_grad mode.</p>
<p>When this function is used on read-only containers (e.g. ReadOnlyTensor,
ImmutableContainer, etc.), the created clones preserve their read-only
behaviors. For creating a mutable clone of an immutable object,
use their <code>clone()</code> method instead.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The deep copy of the given object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="k">def</span><span class="w"> </span><span class="nf">clone</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">memo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">    Get a deep copy of the given object.</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">    The cloning is done in no_grad mode.</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">    When this function is used on read-only containers (e.g. ReadOnlyTensor,</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">    ImmutableContainer, etc.), the created clones preserve their read-only</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">    behaviors. For creating a mutable clone of an immutable object,</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">    use their `clone()` method instead.</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">        The deep copy of the given object.</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.cloning</span><span class="w"> </span><span class="kn">import</span> <span class="n">deep_clone</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>    <span class="k">if</span> <span class="n">memo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>    <span class="k">return</span> <span class="n">deep_clone</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">otherwise_deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.device_of" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">device_of</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.device_of" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the device of the given object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object whose device is being queried.
The object can be a PyTorch tensor, or a PyTorch module
(in which case the device of the first parameter tensor
will be returned), or an ObjectArray (in which case
the returned device will be the cpu device), or any object
with the attribute <code>device</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span>
<span class="normal"><a href="#__codelineno-0-2030">2030</a></span>
<span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2014" name="__codelineno-0-2014"></a><span class="k">def</span><span class="w"> </span><span class="nf">device_of</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Device</span><span class="p">:</span>
<a id="__codelineno-0-2015" name="__codelineno-0-2015"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2016" name="__codelineno-0-2016"></a><span class="sd">    Get the device of the given object.</span>
<a id="__codelineno-0-2017" name="__codelineno-0-2017"></a>
<a id="__codelineno-0-2018" name="__codelineno-0-2018"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2019" name="__codelineno-0-2019"></a><span class="sd">        x: The object whose device is being queried.</span>
<a id="__codelineno-0-2020" name="__codelineno-0-2020"></a><span class="sd">            The object can be a PyTorch tensor, or a PyTorch module</span>
<a id="__codelineno-0-2021" name="__codelineno-0-2021"></a><span class="sd">            (in which case the device of the first parameter tensor</span>
<a id="__codelineno-0-2022" name="__codelineno-0-2022"></a><span class="sd">            will be returned), or an ObjectArray (in which case</span>
<a id="__codelineno-0-2023" name="__codelineno-0-2023"></a><span class="sd">            the returned device will be the cpu device), or any object</span>
<a id="__codelineno-0-2024" name="__codelineno-0-2024"></a><span class="sd">            with the attribute `device`.</span>
<a id="__codelineno-0-2025" name="__codelineno-0-2025"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2026" name="__codelineno-0-2026"></a><span class="sd">        The device of the given object.</span>
<a id="__codelineno-0-2027" name="__codelineno-0-2027"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2028" name="__codelineno-0-2028"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-2029" name="__codelineno-0-2029"></a>        <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2030" name="__codelineno-0-2030"></a>        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
<a id="__codelineno-0-2031" name="__codelineno-0-2031"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-2032" name="__codelineno-0-2032"></a>            <span class="k">break</span>
<a id="__codelineno-0-2033" name="__codelineno-0-2033"></a>        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2034" name="__codelineno-0-2034"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot determine the device of the module </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2035" name="__codelineno-0-2035"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-2036" name="__codelineno-0-2036"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2037" name="__codelineno-0-2037"></a>        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">device</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.device_of_container" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">device_of_container</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">visiting</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.device_of_container" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the device of the given container.</p>
<p>It is assumed that the given container stores PyTorch tensors from
which the device information will be extracted.
If the container contains only basic types like int, float, string,
bool, or None, or if the container is empty, then the returned device
will be None.
If the container contains unrecognized objects, an error will be
raised.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>container</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A sequence or a dictionary of objects from which the
device information will be extracted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>visited</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a dictionary which stores the (sub)containers
which are already visited. In most cases, when this function
is called from outside, this is expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>visiting</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a set which stores the (sub)containers
which are being visited. This set is used to prevent recursion
errors while handling circular references. In most cases,
when this function is called from outside, this argument is
expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="k">def</span><span class="w"> </span><span class="nf">device_of_container</span><span class="p">(</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="n">container</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">visited</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">visiting</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    Get the device of the given container.</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    It is assumed that the given container stores PyTorch tensors from</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">    which the device information will be extracted.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">    If the container contains only basic types like int, float, string,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    bool, or None, or if the container is empty, then the returned device</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    will be None.</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    If the container contains unrecognized objects, an error will be</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">    raised.</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">        container: A sequence or a dictionary of objects from which the</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">            device information will be extracted.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        visited: Optionally a dictionary which stores the (sub)containers</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            which are already visited. In most cases, when this function</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">            is called from outside, this is expected as None.</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        visiting: Optionally a set which stores the (sub)containers</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            which are being visited. This set is used to prevent recursion</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">            errors while handling circular references. In most cases,</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">            when this function is called from outside, this argument is</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">            expected as None.</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">        The device if available, None otherwise.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="n">container_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="k">if</span> <span class="n">visited</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>        <span class="n">visited</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="k">if</span> <span class="n">container_id</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="k">return</span> <span class="n">visited</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="k">if</span> <span class="n">visiting</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="n">visiting</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="k">if</span> <span class="n">container_id</span> <span class="ow">in</span> <span class="n">visiting</span><span class="p">:</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">result</span><span class="p">:</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="nd">@classmethod</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]):</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="k">if</span> <span class="n">new_device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                    <span class="bp">cls</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">new_device</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                    <span class="k">if</span> <span class="n">new_device</span> <span class="o">!=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">device</span><span class="p">:</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encountered tensors whose `device`s mismatch: </span><span class="si">{</span><span class="n">new_device</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">call_self</span><span class="p">(</span><span class="n">sub_container</span><span class="p">):</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="k">return</span> <span class="n">device_of_container</span><span class="p">(</span><span class="n">sub_container</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="n">visited</span><span class="p">,</span> <span class="n">visiting</span><span class="o">=</span><span class="n">visiting</span><span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">container</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">container</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="k">pass</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="n">visiting</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">container_id</span><span class="p">)</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">container</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>                <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">call_self</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="n">visiting</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">container_id</span><span class="p">)</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="n">visiting</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">container_id</span><span class="p">)</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>                <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">call_self</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>            <span class="n">visiting</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">container_id</span><span class="p">)</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encountered an object of unrecognized type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">container</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>    <span class="n">visited</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">device</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.dtype_of" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dtype_of</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.dtype_of" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the dtype of the given object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object whose dtype is being queried.
The object can be a PyTorch tensor, or a PyTorch module
(in which case the dtype of the first parameter tensor
will be returned), or an ObjectArray (in which case
the returned dtype will be <code>object</code>), or any object with
the attribute <code>dtype</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1988" name="__codelineno-0-1988"></a><span class="k">def</span><span class="w"> </span><span class="nf">dtype_of</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DType</span><span class="p">:</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a><span class="sd">    Get the dtype of the given object.</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a><span class="sd">        x: The object whose dtype is being queried.</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a><span class="sd">            The object can be a PyTorch tensor, or a PyTorch module</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a><span class="sd">            (in which case the dtype of the first parameter tensor</span>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a><span class="sd">            will be returned), or an ObjectArray (in which case</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a><span class="sd">            the returned dtype will be `object`), or any object with</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a><span class="sd">            the attribute `dtype`.</span>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a><span class="sd">        The dtype of the given object.</span>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a>        <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a>            <span class="k">break</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot determine the dtype of the module </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.dtype_of_container" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dtype_of_container</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">visiting</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.dtype_of_container" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the dtype of the given container.</p>
<p>It is assumed that the given container stores PyTorch tensors from
which the dtype information will be extracted.
If the container contains only basic types like int, float, string,
bool, or None, or if the container is empty, then the returned dtype
will be None.
If the container contains unrecognized objects, an error will be
raised.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>container</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A sequence or a dictionary of objects from which the
dtype information will be extracted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>visited</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a dictionary which stores the (sub)containers
which are already visited. In most cases, when this function
is called from outside, this is expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>visiting</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a set which stores the (sub)containers
which are being visited. This set is used to prevent recursion
errors while handling circular references. In most cases,
when this function is called from outside, this argument is
expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="k">def</span><span class="w"> </span><span class="nf">dtype_of_container</span><span class="p">(</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="n">container</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">visited</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">visiting</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">]:</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    Get the dtype of the given container.</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">    It is assumed that the given container stores PyTorch tensors from</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">    which the dtype information will be extracted.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    If the container contains only basic types like int, float, string,</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    bool, or None, or if the container is empty, then the returned dtype</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">    will be None.</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    If the container contains unrecognized objects, an error will be</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">    raised.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        container: A sequence or a dictionary of objects from which the</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">            dtype information will be extracted.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        visited: Optionally a dictionary which stores the (sub)containers</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            which are already visited. In most cases, when this function</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            is called from outside, this is expected as None.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        visiting: Optionally a set which stores the (sub)containers</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">            which are being visited. This set is used to prevent recursion</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">            errors while handling circular references. In most cases,</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">            when this function is called from outside, this argument is</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">            expected as None.</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        The dtype if available, None otherwise.</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="n">container_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">if</span> <span class="n">visited</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">visited</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="k">if</span> <span class="n">container_id</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="k">return</span> <span class="n">visited</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="k">if</span> <span class="n">visiting</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">visiting</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="k">if</span> <span class="n">container_id</span> <span class="ow">in</span> <span class="n">visiting</span><span class="p">:</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">result</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="nd">@classmethod</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">]):</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="k">if</span> <span class="n">new_dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>                    <span class="bp">cls</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">new_dtype</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>                    <span class="k">if</span> <span class="n">new_dtype</span> <span class="o">!=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encountered tensors whose `dtype`s mismatch: </span><span class="si">{</span><span class="n">new_dtype</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">call_self</span><span class="p">(</span><span class="n">sub_container</span><span class="p">):</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="k">return</span> <span class="n">dtype_of_container</span><span class="p">(</span><span class="n">sub_container</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="n">visited</span><span class="p">,</span> <span class="n">visiting</span><span class="o">=</span><span class="n">visiting</span><span class="p">)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">container</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">container</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="k">pass</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="n">visiting</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">container_id</span><span class="p">)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">container</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">call_self</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="n">visiting</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">container_id</span><span class="p">)</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="n">visiting</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">container_id</span><span class="p">)</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">container</span><span class="p">:</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>                <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">call_self</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>            <span class="n">visiting</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">container_id</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encountered an object of unrecognized type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">container</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="n">visited</span><span class="p">[</span><span class="n">container_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">dtype</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.empty_tensor_like" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">empty_tensor_like</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.empty_tensor_like" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Make an empty tensor with attributes taken from a source tensor.</p>
<p>The source tensor can be a PyTorch tensor, or an ObjectArray.</p>
<p>Unlike <code>torch.empty_like(...)</code>, this function allows one to redefine the
shape and/or length of the new empty tensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The source tensor whose shape, dtype, and device will be used
by default for the new empty tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="tuple">tuple</span>, <span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as None (which is the default), then the shape of the
source tensor will be used for the new empty tensor.
If given as a tuple or a <code>torch.Size</code> instance, then the new empty
tensor will be in this given shape instead.
This argument cannot be used together with <code>length</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as None (which is the default), then the length of
the new empty tensor will be equal to the length of the source
tensor (where length here means the size of the outermost
dimension, i.e., what is returned by <code>len(...)</code>).
If given as an integer, the length of the empty tensor will be
this given length instead.
This argument cannot be used together with <code>shape</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as None, the dtype of the new empty tensor will be
the dtype of the source tensor.
If given as a <code>torch.dtype</code> instance, then the dtype of the
tensor will be this given dtype instead.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given as None, the device of the new empty tensor will be
the device of the source tensor.
If given as a <code>torch.device</code> instance, then the device of the
tensor will be this given device instead.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="k">def</span><span class="w"> </span><span class="nf">empty_tensor_like</span><span class="p">(</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>    <span class="n">shape</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>    <span class="n">length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">    Make an empty tensor with attributes taken from a source tensor.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">    The source tensor can be a PyTorch tensor, or an ObjectArray.</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    Unlike `torch.empty_like(...)`, this function allows one to redefine the</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">    shape and/or length of the new empty tensor.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        source: The source tensor whose shape, dtype, and device will be used</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">            by default for the new empty tensor.</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">        shape: If given as None (which is the default), then the shape of the</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">            source tensor will be used for the new empty tensor.</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            If given as a tuple or a `torch.Size` instance, then the new empty</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            tensor will be in this given shape instead.</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            This argument cannot be used together with `length`.</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">        length: If given as None (which is the default), then the length of</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            the new empty tensor will be equal to the length of the source</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            tensor (where length here means the size of the outermost</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">            dimension, i.e., what is returned by `len(...)`).</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">            If given as an integer, the length of the empty tensor will be</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">            this given length instead.</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">            This argument cannot be used together with `shape`.</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">        dtype: If given as None, the dtype of the new empty tensor will be</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">            the dtype of the source tensor.</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">            If given as a `torch.dtype` instance, then the dtype of the</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">            tensor will be this given dtype instead.</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">        device: If given as None, the device of the new empty tensor will be</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">            the device of the source tensor.</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">            If given as a `torch.device` instance, then the device of the</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">            tensor will be this given device instead.</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">        The new empty tensor.</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.objectarray</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObjectArray</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">):</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>        <span class="k">elif</span> <span class="n">shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>                        <span class="sa">f</span><span class="s2">&quot;An ObjectArray must always be 1-dimensional.&quot;</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>                        <span class="sa">f</span><span class="s2">&quot; Therefore, this given shape is incompatible: </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>                    <span class="p">)</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>                <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>        <span class="k">elif</span> <span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`length` and `shape` cannot be used together&quot;</span><span class="p">)</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>        <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">:</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>                    <span class="sa">f</span><span class="s2">&quot;An ObjectArray can only be allocated on cpu. However, the specified `device` is: </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>                <span class="p">)</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>                    <span class="sa">f</span><span class="s2">&quot;The dtype of an ObjectArray can only be `object`. However, the specified `dtype` is: </span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>                <span class="p">)</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>        <span class="k">return</span> <span class="n">ObjectArray</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>            <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`length` and `shape` cannot be used together&quot;</span><span class="p">)</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>            <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`length` can only be used when the source tensor is at least 1-dimensional&quot;</span><span class="p">)</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>            <span class="n">newshape</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="p">)]</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>            <span class="n">newshape</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>            <span class="n">shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">newshape</span><span class="p">)</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">)):</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>            <span class="n">dtype</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>            <span class="n">source</span><span class="o">.</span><span class="n">shape</span> <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>            <span class="n">dtype</span><span class="o">=</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">dtype</span> <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dtype</span><span class="p">),</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>            <span class="n">device</span><span class="o">=</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">device</span> <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">device</span><span class="p">),</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>        <span class="p">)</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The source tensor is of an unrecognized type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.ensure_ray" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ensure_ray</span><span class="p">()</span></code>

<a href="#evotorch.tools.misc.ensure_ray" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Ensure that the ray parallelization engine is initialized.
If ray is already initialized, this function does nothing.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1977" name="__codelineno-0-1977"></a><span class="k">def</span><span class="w"> </span><span class="nf">ensure_ray</span><span class="p">():</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a><span class="sd">    Ensure that the ray parallelization engine is initialized.</span>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a><span class="sd">    If ray is already initialized, this function does nothing.</span>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">ray</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">ray</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>        <span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.ensure_tensor_length_and_dtype" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ensure_tensor_length_and_dtype</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">about</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">allow_scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.ensure_tensor_length_and_dtype" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return the given sequence as a tensor while also confirming its
length, dtype, and device.
If the given object is already a tensor conforming to the desired
length, dtype, and device, the object will be returned as it is
(there will be no copying).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tensor, or a sequence which is convertible to a tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The length to which the tensor is expected to conform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.DType">DType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dtype to which the tensor is expected to conform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>about</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefix for the error message. Can be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_scalar</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to accept scalars in addition
to vector of the desired length.
If <code>allow_scalar</code> is False, then scalars will be converted
to sequences of the desired length. The sequence will contain
the same scalar, repeated.
If <code>allow_scalar</code> is True, then the scalar itself will be
converted to a PyTorch scalar, and then will be returned.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the sequence is to be stored.
If the given sequence is on a different device than the
desired device, a copy on the correct device will be made.
If device is None, the default behavior of <code>torch.tensor(...)</code>
will be used, that is: if <code>t</code> is already a tensor, the result
will be on the same device, otherwise, the result will be on
the cpu.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="k">def</span><span class="w"> </span><span class="nf">ensure_tensor_length_and_dtype</span><span class="p">(</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>    <span class="n">t</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>    <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">DType</span><span class="p">,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>    <span class="n">about</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="n">allow_scalar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">    Return the given sequence as a tensor while also confirming its</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">    length, dtype, and device.</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">    If the given object is already a tensor conforming to the desired</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">    length, dtype, and device, the object will be returned as it is</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">    (there will be no copying).</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        t: The tensor, or a sequence which is convertible to a tensor.</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">        length: The length to which the tensor is expected to conform.</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">        dtype: The dtype to which the tensor is expected to conform.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">        about: The prefix for the error message. Can be left as None.</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">        allow_scalar: Whether or not to accept scalars in addition</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">            to vector of the desired length.</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">            If `allow_scalar` is False, then scalars will be converted</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">            to sequences of the desired length. The sequence will contain</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">            the same scalar, repeated.</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">            If `allow_scalar` is True, then the scalar itself will be</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">            converted to a PyTorch scalar, and then will be returned.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">        device: The device in which the sequence is to be stored.</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">            If the given sequence is on a different device than the</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">            desired device, a copy on the correct device will be made.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">            If device is None, the default behavior of `torch.tensor(...)`</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            will be used, that is: if `t` is already a tensor, the result</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">            will be on the same device, otherwise, the result will be on</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">            the cpu.</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">        The sequence whose correctness in terms of length, dtype, and</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">        device is ensured.</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">        ValueError: if there is a length mismatch.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>    <span class="n">device_args</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="n">device_args</span><span class="p">[</span><span class="s2">&quot;device&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">as_tensor</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="o">**</span><span class="n">device_args</span><span class="p">)</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>    <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="k">if</span> <span class="n">allow_scalar</span><span class="p">:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="k">return</span> <span class="n">t</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">!=</span> <span class="n">length</span><span class="p">:</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="k">if</span> <span class="n">about</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>                <span class="n">err_prefix</span> <span class="o">=</span> <span class="n">about</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>                <span class="n">err_prefix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">err_prefix</span><span class="si">}</span><span class="s2">Expected a 1-dimensional tensor of length </span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2">, but got a tensor with shape: </span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="k">return</span> <span class="n">t</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.expect_none" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expect_none</span><span class="p">(</span><span class="n">msg_prefix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.expect_none" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Expect the values associated with the given keyword arguments
to be None. If not, raise error.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>msg_prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prefix of the error message.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments whose values are expected to be None.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="k">def</span><span class="w"> </span><span class="nf">expect_none</span><span class="p">(</span><span class="n">msg_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    Expect the values associated with the given keyword arguments</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    to be None. If not, raise error.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        msg_prefix: Prefix of the error message.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        kwargs: Keyword arguments whose values are expected to be None.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        ValueError: if at least one of the keyword arguments has a value</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            other than None.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">msg_prefix</span><span class="si">}</span><span class="s2">: expected `</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">` as None, however, it was found to be </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_bool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_bool</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_bool" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if <code>x</code> represents a bool.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An object whose type is being queried.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_bool</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    Return True if `x` represents a bool.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        x: An object whose type is being queried.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        True if `x` is a bool; False otherwise.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)):</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="k">return</span> <span class="n">is_dtype_bool</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_bool_vector" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_bool_vector</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_bool_vector" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if <code>x</code> is a vector consisting of bools.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An object whose elements' types are to be queried.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_bool_vector</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Return True if `x` is a vector consisting of bools.</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        x: An object whose elements&#39; types are to be queried.</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        True if the elements of `x` are bools; False otherwise.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="k">return</span> <span class="n">is_dtype_bool</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_bool</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_dtype_bool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_dtype_bool</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_dtype_bool" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if the given dtype is an bool type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.DType">DType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dtype, which can be a dtype string, a numpy dtype,
or a PyTorch dtype.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_dtype_bool</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">DType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    Return True if the given dtype is an bool type.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        t: The dtype, which can be a dtype string, a numpy dtype,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            or a PyTorch dtype.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        True if t is a bool type; False otherwise.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">to_numpy_dtype</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">kind</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_dtype_float" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_dtype_float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_dtype_float" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if the given dtype is an float type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.DType">DType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dtype, which can be a dtype string, a numpy dtype,
or a PyTorch dtype.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_dtype_float</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">DType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    Return True if the given dtype is an float type.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        t: The dtype, which can be a dtype string, a numpy dtype,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            or a PyTorch dtype.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        True if t is an float type; False otherwise.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">to_numpy_dtype</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">kind</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_dtype_integer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_dtype_integer</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_dtype_integer" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if the given dtype is an integer type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.DType">DType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dtype, which can be a dtype string, a numpy dtype,
or a PyTorch dtype.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_dtype_integer</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">DType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Return True if the given dtype is an integer type.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        t: The dtype, which can be a dtype string, a numpy dtype,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            or a PyTorch dtype.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        True if t is an integer type; False otherwise.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">to_numpy_dtype</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">kind</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;u&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">kind</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;i&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_dtype_object" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_dtype_object</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_dtype_object" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if the given dtype is <code>object</code> or <code>Any</code>.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the given dtype is <code>object</code> or <code>Any</code>; False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_dtype_object</span><span class="p">(</span><span class="n">dtype</span><span class="p">:</span> <span class="n">DType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    Return True if the given dtype is `object` or `Any`.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        True if the given dtype is `object` or `Any`; False otherwise.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">return</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;Any&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">elif</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="nb">object</span> <span class="ow">or</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_dtype_real" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_dtype_real</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_dtype_real" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if the given dtype represents real numbers
(i.e. if dtype is an integer type or is a float type).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.DType">DType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dtype, which can be a dtype string, a numpy dtype,
or a PyTorch dtype.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_dtype_real</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">DType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Return True if the given dtype represents real numbers</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    (i.e. if dtype is an integer type or is a float type).</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        t: The dtype, which can be a dtype string, a numpy dtype,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            or a PyTorch dtype.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        True if t represents a real numbers type; False otherwise.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="k">return</span> <span class="n">is_dtype_float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_dtype_integer</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_integer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_integer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_integer" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if <code>x</code> is an integer.</p>
<p>Note that this function does NOT consider booleans as integers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An object whose type is being queried.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_integer</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    Return True if `x` is an integer.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    Note that this function does NOT consider booleans as integers.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        x: An object whose type is being queried.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        True if `x` is an integer; False otherwise.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="k">if</span> <span class="n">is_bool</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Integral</span><span class="p">):</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="k">return</span> <span class="n">is_dtype_integer</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_integer_vector" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_integer_vector</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_integer_vector" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if <code>x</code> is a vector consisting of integers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An object whose elements' types are to be queried.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_integer_vector</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    Return True if `x` is a vector consisting of integers.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        x: An object whose elements&#39; types are to be queried.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        True if the elements of `x` are integers; False otherwise.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="k">return</span> <span class="n">is_dtype_integer</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_real" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_real" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if <code>x</code> is a real number.</p>
<p>Note that this function does NOT consider booleans as real numbers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An object whose type is being queried.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_real</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    Return True if `x` is a real number.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Note that this function does NOT consider booleans as real numbers.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        x: An object whose type is being queried.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        True if `x` is a real number; False otherwise.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">if</span> <span class="n">is_bool</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Real</span><span class="p">):</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="k">return</span> <span class="n">is_dtype_real</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_real_vector" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_real_vector</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_real_vector" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if <code>x</code> is a vector consisting of real numbers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An object whose elements' types are to be queried.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_real_vector</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    Return True if `x` is a vector consisting of real numbers.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        x: An object whose elements&#39; types are to be queried.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        True if the elements of `x` are real numbers; False otherwise.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="k">return</span> <span class="n">is_dtype_real</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_real</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_sequence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_sequence</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_sequence" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True if <code>x</code> is a sequence.
Note that this function considers <code>str</code> and <code>bytes</code> as scalars,
not as sequences.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object whose sequential nature is being queried.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_sequence</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    Return True if `x` is a sequence.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    Note that this function considers `str` and `bytes` as scalars,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    not as sequences.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        x: The object whose sequential nature is being queried.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        True if `x` is a sequence; False otherwise.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)):</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.is_tensor_on_cpu" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_tensor_on_cpu</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.is_tensor_on_cpu" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return True of the given PyTorch tensor or ObjectArray is on cpu.</p>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_tensor_on_cpu</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">    Return True of the given PyTorch tensor or ObjectArray is on cpu.</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.make_I" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_I</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.make_I" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Make a new identity matrix (I), or change an existing tensor into one.</p>
<p>The following example creates a 3x3 identity matrix:</p>
<div class="highlight"><pre><span></span><code>identity_matrix = make_I(3, dtype=&quot;float32&quot;)
</code></pre></div>
<p>The following example changes an already existing square matrix such that
its values will store an identity matrix:</p>
<div class="highlight"><pre><span></span><code>make_I(out=existing_tensor)
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single integer or a tuple containing a single integer,
where the integer specifies the length of the target square
matrix. In this context, "length" means both rowwise length
and columnwise length, since the target is a square matrix.
Note that, if the user wishes to fill an existing tensor with
identity values, then <code>size</code> is expected to be left as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally, the existing tensor whose values will be changed
so that they represent an identity matrix.
If an <code>out</code> tensor is given, then <code>size</code> is expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string (e.g. "float32") or a PyTorch dtype
(e.g. torch.float32).
If <code>dtype</code> is not specified, the default choice of
<code>torch.empty(...)</code> is used, that is, <code>torch.float32</code>.
If an <code>out</code> tensor is specified, then <code>dtype</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the new tensor will be stored.
If not specified, "cpu" will be used.
If an <code>out</code> tensor is specified, then <code>device</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1456" name="__codelineno-0-1456"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_I</span><span class="p">(</span>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a>    <span class="n">size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a>    <span class="n">out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a><span class="sd">    Make a new identity matrix (I), or change an existing tensor into one.</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a><span class="sd">    The following example creates a 3x3 identity matrix:</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a><span class="sd">        identity_matrix = make_I(3, dtype=&quot;float32&quot;)</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a><span class="sd">    The following example changes an already existing square matrix such that</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a><span class="sd">    its values will store an identity matrix:</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><span class="sd">        make_I(out=existing_tensor)</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a><span class="sd">        size: A single integer or a tuple containing a single integer,</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a><span class="sd">            where the integer specifies the length of the target square</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a><span class="sd">            matrix. In this context, &quot;length&quot; means both rowwise length</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a><span class="sd">            and columnwise length, since the target is a square matrix.</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a><span class="sd">            Note that, if the user wishes to fill an existing tensor with</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a><span class="sd">            identity values, then `size` is expected to be left as None.</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a><span class="sd">        out: Optionally, the existing tensor whose values will be changed</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a><span class="sd">            so that they represent an identity matrix.</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a><span class="sd">            If an `out` tensor is given, then `size` is expected as None.</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a><span class="sd">        dtype: Optionally a string (e.g. &quot;float32&quot;) or a PyTorch dtype</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a><span class="sd">            (e.g. torch.float32).</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a><span class="sd">            If `dtype` is not specified, the default choice of</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a><span class="sd">            `torch.empty(...)` is used, that is, `torch.float32`.</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a><span class="sd">            If an `out` tensor is specified, then `dtype` is expected</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a><span class="sd">        device: The device in which the new tensor will be stored.</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a><span class="sd">            If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a><span class="sd">            If an `out` tensor is specified, then `device` is expected</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a><span class="sd">        The created or modified tensor after placing the I matrix values</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a>    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>        <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>                <span class="s2">&quot;When the `size` argument is missing, the function `make_I(...)` expects an `out` tensor.&quot;</span>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a>                <span class="s2">&quot; However, the `out` argument was received as None.&quot;</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a>            <span class="p">)</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>        <span class="n">size</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>                <span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>                    <span class="sa">f</span><span class="s2">&quot;When the `size` argument is given as a tuple,&quot;</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a>                    <span class="sa">f</span><span class="s2">&quot; the function `make_I(...)` expects this tuple to contain exactly one element.&quot;</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>                    <span class="sa">f</span><span class="s2">&quot; The received tuple is </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a>                <span class="p">)</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a>        <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">_out_tensor</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>    <span class="n">out</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a>    <span class="n">out</span><span class="o">.</span><span class="n">fill_diagonal_</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.make_batched_false_for_vmap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_batched_false_for_vmap</span><span class="p">(</span><span class="n">device</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.make_batched_false_for_vmap" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get <code>False</code>, properly batched if inside <code>vmap(..., randomness='different')</code>.</p>
<p><strong>Reasoning.</strong>
Imagine we have the following function:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">sample_and_shift</span><span class="p">(</span><span class="n">target_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">shift</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">target_shape</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">result</span><span class="o">.</span><span class="n">normal_</span><span class="p">()</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">result</span> <span class="o">+=</span> <span class="n">shift</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
<p>which allocates an empty tensor, then fills it with samples from the
standard normal distribution, then shifts the samples and returns the
result. An important implementation detail regarding this example function
is that all of its operations are in-place (i.e. the method <code>normal_()</code>
and the operator <code>+=</code> work on the given pre-allocated tensor).</p>
<p>Let us now imagine that we have a batch of shift tensors, and we would like
to generate multiple shifted sample tensors. Ideally, such a batched
operation could be done by transforming the example function with the help
of <code>vmap</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch.func</span><span class="w"> </span><span class="kn">import</span> <span class="n">vmap</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">batched_sample_and_shift</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">sample_and_shift</span><span class="p">,</span> <span class="n">in_dims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">randomness</span><span class="o">=</span><span class="s2">&quot;different&quot;</span><span class="p">)</span>
</code></pre></div>
<p>where the argument <code>randomness="different"</code> tells PyTorch that for each
batch item, we want to generate different samples (instead of just
duplicating the same samples across the batch dimension(s)).
Such a re-sampling approach is usually desired in applications where
preserving stochasticity is crucial, evolutionary computation being one
of such case.</p>
<p>Now let us call our transformed function:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">batch_of_shifts</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># a tensor like `shift`, but with an extra leftmost</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1"># dimension for the batches</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># Will fail:</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">batched_results</span> <span class="o">=</span> <span class="n">batched_sample_and_shift</span><span class="p">(</span><span class="n">shape_goes_here</span><span class="p">,</span> <span class="n">batch_of_shifts</span><span class="p">)</span>
</code></pre></div>
<p>At this point, we observe that <code>batched_sample_and_shift</code> fails.
The reason for this failure is that the function first allocates an empty
tensor, then tries to perform random sampling in an in-place manner.
The first allocation via <code>empty</code> is not properly batched (it is not aware
of the active <code>vmap</code>), so, when we later call <code>.normal_()</code> on it,
there is no room for the data that would be re-sampled for each batch item.
To remedy this, we could modify our original function slightly:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">sample_and_shift2</span><span class="p">(</span><span class="n">target_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">shift</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">target_shape</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="n">make_batched_false_for_vmap</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">result</span><span class="o">.</span><span class="n">normal_</span><span class="p">()</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="n">result</span> <span class="o">+=</span> <span class="n">shift</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
<p>In this modified function, right after making an initial allocation, we add
onto it a batched false, and re-assign the result to the variable <code>result</code>.
Thanks to being the result of an interaction with a batched false, the new
<code>result</code> variable is now properly batched (if we are inside
<code>vmap(..., randomness="different")</code>. Now, let us transform our function:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch.func</span><span class="w"> </span><span class="kn">import</span> <span class="n">vmap</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">batched_sample_and_shift2</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">sample_and_shift2</span><span class="p">,</span> <span class="n">in_dims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">randomness</span><span class="o">=</span><span class="s2">&quot;different&quot;</span><span class="p">)</span>
</code></pre></div>
<p>The following code should now work:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">batch_of_shifts</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># a tensor like `shift`, but with an extra leftmost</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c1"># dimension for the batches</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1"># Should work:</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">batched_results</span> <span class="o">=</span> <span class="n">batched_sample_and_shift2</span><span class="p">(</span><span class="n">shape_goes_here</span><span class="p">,</span> <span class="n">batch_of_shifts</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Device">Device</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target device on which the batched <code>False</code> will be created</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2209" name="__codelineno-0-2209"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_batched_false_for_vmap</span><span class="p">(</span><span class="n">device</span><span class="p">:</span> <span class="n">Device</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a><span class="sd">    Get `False`, properly batched if inside `vmap(..., randomness=&#39;different&#39;)`.</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a><span class="sd">    **Reasoning.**</span>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><span class="sd">    Imagine we have the following function:</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">    def sample_and_shift(target_shape: tuple, shift: torch.Tensor) -&gt; torch.Tensor:</span>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a><span class="sd">        result = torch.empty(target_shape, device=x.device)</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">        result.normal_()</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">        result += shift</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">        return result</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a><span class="sd">    which allocates an empty tensor, then fills it with samples from the</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a><span class="sd">    standard normal distribution, then shifts the samples and returns the</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a><span class="sd">    result. An important implementation detail regarding this example function</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a><span class="sd">    is that all of its operations are in-place (i.e. the method `normal_()`</span>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><span class="sd">    and the operator `+=` work on the given pre-allocated tensor).</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a><span class="sd">    Let us now imagine that we have a batch of shift tensors, and we would like</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a><span class="sd">    to generate multiple shifted sample tensors. Ideally, such a batched</span>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a><span class="sd">    operation could be done by transforming the example function with the help</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a><span class="sd">    of `vmap`:</span>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="sd">    from torch.func import vmap</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a><span class="sd">    batched_sample_and_shift = vmap(sample_and_shift, in_dims=0, randomness=&quot;different&quot;)</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a><span class="sd">    where the argument `randomness=&quot;different&quot;` tells PyTorch that for each</span>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a><span class="sd">    batch item, we want to generate different samples (instead of just</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a><span class="sd">    duplicating the same samples across the batch dimension(s)).</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a><span class="sd">    Such a re-sampling approach is usually desired in applications where</span>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a><span class="sd">    preserving stochasticity is crucial, evolutionary computation being one</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><span class="sd">    of such case.</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a><span class="sd">    Now let us call our transformed function:</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a><span class="sd">    batch_of_shifts = ...  # a tensor like `shift`, but with an extra leftmost</span>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a><span class="sd">    # dimension for the batches</span>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a><span class="sd">    # Will fail:</span>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a><span class="sd">    batched_results = batched_sample_and_shift(shape_goes_here, batch_of_shifts)</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a><span class="sd">    At this point, we observe that `batched_sample_and_shift` fails.</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a><span class="sd">    The reason for this failure is that the function first allocates an empty</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a><span class="sd">    tensor, then tries to perform random sampling in an in-place manner.</span>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a><span class="sd">    The first allocation via `empty` is not properly batched (it is not aware</span>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a><span class="sd">    of the active `vmap`), so, when we later call `.normal_()` on it,</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a><span class="sd">    there is no room for the data that would be re-sampled for each batch item.</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a><span class="sd">    To remedy this, we could modify our original function slightly:</span>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a><span class="sd">    def sample_and_shift2(target_shape: tuple, shift: torch.Tensor) -&gt; torch.Tensor:</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a><span class="sd">        result = torch.empty(target_shape, device=x.device)</span>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a><span class="sd">        result = result + result.make_batched_false_for_vmap(x.device)</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a><span class="sd">        result.normal_()</span>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a><span class="sd">        result += shift</span>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a><span class="sd">        return result</span>
<a id="__codelineno-0-2279" name="__codelineno-0-2279"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a><span class="sd">    In this modified function, right after making an initial allocation, we add</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a><span class="sd">    onto it a batched false, and re-assign the result to the variable `result`.</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a><span class="sd">    Thanks to being the result of an interaction with a batched false, the new</span>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a><span class="sd">    `result` variable is now properly batched (if we are inside</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a><span class="sd">    `vmap(..., randomness=&quot;different&quot;)`. Now, let us transform our function:</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a><span class="sd">    from torch.func import vmap</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a><span class="sd">    batched_sample_and_shift2 = vmap(sample_and_shift2, in_dims=0, randomness=&quot;different&quot;)</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a><span class="sd">    The following code should now work:</span>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a><span class="sd">    batch_of_shifts = ...  # a tensor like `shift`, but with an extra leftmost</span>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a><span class="sd">    # dimension for the batches</span>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a><span class="sd">    # Should work:</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a><span class="sd">    batched_results = batched_sample_and_shift2(shape_goes_here, batch_of_shifts)</span>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a><span class="sd">        device: The target device on which the batched `False` will be created</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a><span class="sd">        A scalar tensor having the value `False`. This returned tensor will be</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a><span class="sd">        a batch of scalar tensors (i.e. a `BatchedTensor`) if we are inside</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a><span class="sd">        `vmap(..., randomness=&quot;different&quot;)`.</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.make_empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_empty</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.make_empty" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Make an empty tensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Size">Size</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shape of the empty tensor to be created.
expected as multiple positional arguments of integers,
or as a single positional argument containing a tuple of
integers.
Note that when the user wishes to create an <code>ObjectArray</code>
(i.e. when <code>dtype</code> is given as <code>object</code>), then the size
is expected as a single integer, or as a single-element
tuple containing an integer (because <code>ObjectArray</code> can only
be one-dimensional).</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string (e.g. "float32") or a PyTorch dtype
(e.g. torch.float32) or, for creating an <code>ObjectArray</code>,
"object" (as string) or <code>object</code> or <code>Any</code>.
If <code>dtype</code> is not specified, the default choice of
<code>torch.empty(...)</code> is used, that is, <code>torch.float32</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the new empty tensor will be stored.
If not specified, "cpu" will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_empty</span><span class="p">(</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>    <span class="o">*</span><span class="n">size</span><span class="p">:</span> <span class="n">Size</span><span class="p">,</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">    Make an empty tensor.</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">        size: Shape of the empty tensor to be created.</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><span class="sd">            expected as multiple positional arguments of integers,</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">            or as a single positional argument containing a tuple of</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="sd">            integers.</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">            Note that when the user wishes to create an `ObjectArray`</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">            (i.e. when `dtype` is given as `object`), then the size</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">            is expected as a single integer, or as a single-element</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><span class="sd">            tuple containing an integer (because `ObjectArray` can only</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><span class="sd">            be one-dimensional).</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="sd">        dtype: Optionally a string (e.g. &quot;float32&quot;) or a PyTorch dtype</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">            (e.g. torch.float32) or, for creating an `ObjectArray`,</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">            &quot;object&quot; (as string) or `object` or `Any`.</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><span class="sd">            If `dtype` is not specified, the default choice of</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">            `torch.empty(...)` is used, that is, `torch.float32`.</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">        device: The device in which the new empty tensor will be stored.</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">            If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">        The new empty tensor, which can be a PyTorch tensor or an</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">        `ObjectArray`.</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.objectarray</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObjectArray</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>                <span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>            <span class="k">return</span> <span class="n">ObjectArray</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>            <span class="k">return</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid device for ObjectArray: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">device</span><span class="p">)</span><span class="si">}</span><span class="s2">. Note: an ObjectArray can only be stored on &#39;cpu&#39;.&quot;</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>            <span class="p">)</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>        <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;device&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.make_gaussian" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_gaussian</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.make_gaussian" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Make a new or existing tensor filled by Gaussian distributed values.
This function can work only with float dtypes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Size">Size</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the new tensor to be filled with Gaussian distributed
values. This can be given as multiple positional arguments, each
such positional argument being an integer, or as a single
positional argument of a tuple, the tuple containing multiple
integers. Note that, if the user wishes to fill an existing
tensor instead, then no positional argument is expected.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Center point (i.e. mean) of the Gaussian distribution.
Can be a scalar, or a tensor.
If not specified, the center point will be taken as 0.
Note that, if one specifies <code>center</code>, then <code>stdev</code> is also
expected to be explicitly specified.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard deviation for the Gaussian distributed values.
Can be a scalar, or a tensor.
If not specified, the standard deviation will be taken as 1.
Note that, if one specifies <code>stdev</code>, then <code>center</code> is also
expected to be explicitly specified.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>symmetric</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the values should be sampled in a
symmetric (i.e. antithetic) manner.
The default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally, the tensor to be filled by Gaussian distributed
values. If an <code>out</code> tensor is given, then no <code>size</code> argument is
expected.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string (e.g. "float32") or a PyTorch dtype
(e.g. torch.float32).
If <code>dtype</code> is not specified, the default choice of
<code>torch.empty(...)</code> is used, that is, <code>torch.float32</code>.
If an <code>out</code> tensor is specified, then <code>dtype</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the new tensor will be stored.
If not specified, "cpu" will be used.
If an <code>out</code> tensor is specified, then <code>device</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>generator</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pseudo-random number generator to be used when sampling
the values. Can be a <code>torch.Generator</code>, or an object with
a <code>generator</code> attribute (such as <code>Problem</code>).
If left as None, the global generator of PyTorch will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1663" name="__codelineno-0-1663"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_gaussian</span><span class="p">(</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>    <span class="o">*</span><span class="n">size</span><span class="p">:</span> <span class="n">Size</span><span class="p">,</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>    <span class="n">center</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>    <span class="n">stdev</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>    <span class="n">symmetric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a>    <span class="n">out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a>    <span class="n">generator</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><span class="sd">    Make a new or existing tensor filled by Gaussian distributed values.</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><span class="sd">    This function can work only with float dtypes.</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><span class="sd">        size: Size of the new tensor to be filled with Gaussian distributed</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><span class="sd">            values. This can be given as multiple positional arguments, each</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><span class="sd">            such positional argument being an integer, or as a single</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="sd">            positional argument of a tuple, the tuple containing multiple</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><span class="sd">            integers. Note that, if the user wishes to fill an existing</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><span class="sd">            tensor instead, then no positional argument is expected.</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">        center: Center point (i.e. mean) of the Gaussian distribution.</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><span class="sd">            Can be a scalar, or a tensor.</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a><span class="sd">            If not specified, the center point will be taken as 0.</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><span class="sd">            Note that, if one specifies `center`, then `stdev` is also</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><span class="sd">            expected to be explicitly specified.</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><span class="sd">        stdev: Standard deviation for the Gaussian distributed values.</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a><span class="sd">            Can be a scalar, or a tensor.</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a><span class="sd">            If not specified, the standard deviation will be taken as 1.</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a><span class="sd">            Note that, if one specifies `stdev`, then `center` is also</span>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a><span class="sd">            expected to be explicitly specified.</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a><span class="sd">        symmetric: Whether or not the values should be sampled in a</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a><span class="sd">            symmetric (i.e. antithetic) manner.</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a><span class="sd">            The default is False.</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a><span class="sd">        out: Optionally, the tensor to be filled by Gaussian distributed</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a><span class="sd">            values. If an `out` tensor is given, then no `size` argument is</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a><span class="sd">            expected.</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a><span class="sd">        dtype: Optionally a string (e.g. &quot;float32&quot;) or a PyTorch dtype</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a><span class="sd">            (e.g. torch.float32).</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a><span class="sd">            If `dtype` is not specified, the default choice of</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a><span class="sd">            `torch.empty(...)` is used, that is, `torch.float32`.</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a><span class="sd">            If an `out` tensor is specified, then `dtype` is expected</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a><span class="sd">        device: The device in which the new tensor will be stored.</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a><span class="sd">            If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a><span class="sd">            If an `out` tensor is specified, then `device` is expected</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a><span class="sd">        generator: Pseudo-random number generator to be used when sampling</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a><span class="sd">            the values. Can be a `torch.Generator`, or an object with</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a><span class="sd">            a `generator` attribute (such as `Problem`).</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a><span class="sd">            If left as None, the global generator of PyTorch will be used.</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a><span class="sd">        The created or modified tensor after placing the Gaussian</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a><span class="sd">        distributed values.</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>    <span class="n">scalar_requested</span> <span class="o">=</span> <span class="n">_scalar_requested</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>    <span class="k">if</span> <span class="n">scalar_requested</span><span class="p">:</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>        <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">_out_tensor_for_random_operation</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>    <span class="n">gen_kwargs</span> <span class="o">=</span> <span class="n">_generator_kwargs</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>    <span class="k">if</span> <span class="n">symmetric</span><span class="p">:</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>        <span class="n">leftmost_dim</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">leftmost_dim</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>                <span class="sa">f</span><span class="s2">&quot;Symmetric sampling cannot be done if the leftmost dimension of the target tensor is odd.&quot;</span>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>                <span class="sa">f</span><span class="s2">&quot; The shape of the target tensor is: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>            <span class="p">)</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>        <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span><span class="o">.</span><span class="n">normal_</span><span class="p">(</span><span class="o">**</span><span class="n">gen_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>        <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>        <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>        <span class="n">out</span><span class="o">.</span><span class="n">normal_</span><span class="p">(</span><span class="o">**</span><span class="n">gen_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">center</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">stdev</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>        <span class="k">pass</span>  <span class="c1"># do nothing</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">center</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">stdev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>        <span class="n">stdev</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">stdev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>        <span class="n">out</span> <span class="o">*=</span> <span class="n">stdev</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>        <span class="n">center</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>        <span class="n">out</span> <span class="o">+=</span> <span class="n">center</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>            <span class="sa">f</span><span class="s2">&quot;Please either specify none of `stdev` and `center`, or both of them.&quot;</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>            <span class="sa">f</span><span class="s2">&quot; Currently, `center` is </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>            <span class="sa">f</span><span class="s2">&quot; and `stdev` is </span><span class="si">{</span><span class="n">stdev</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>        <span class="p">)</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>    <span class="k">if</span> <span class="n">scalar_requested</span><span class="p">:</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.make_nan" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_nan</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.make_nan" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Make a new tensor filled with NaN, or fill an existing tensor with NaN.</p>
<p>The following example creates a float32 tensor filled with NaN values,
of shape (3, 5):</p>
<div class="highlight"><pre><span></span><code>nan_values = make_nan(3, 5, dtype=&quot;float32&quot;)
</code></pre></div>
<p>The following example fills an existing tensor with NaNs.</p>
<div class="highlight"><pre><span></span><code>make_nan(out=existing_tensor)
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Size">Size</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the new tensor to be filled with NaNs.
This can be given as multiple positional arguments, each such
positional argument being an integer, or as a single positional
argument of a tuple, the tuple containing multiple integers.
Note that, if the user wishes to fill an existing tensor with
NaN values, then no positional argument is expected.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally, the tensor to be filled by NaN values.
If an <code>out</code> tensor is given, then no <code>size</code> argument is expected.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string (e.g. "float32") or a PyTorch dtype
(e.g. torch.float32).
If <code>dtype</code> is not specified, the default choice of
<code>torch.empty(...)</code> is used, that is, <code>torch.float32</code>.
If an <code>out</code> tensor is specified, then <code>dtype</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the new tensor will be stored.
If not specified, "cpu" will be used.
If an <code>out</code> tensor is specified, then <code>device</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1408" name="__codelineno-0-1408"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_nan</span><span class="p">(</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>    <span class="o">*</span><span class="n">size</span><span class="p">:</span> <span class="n">Size</span><span class="p">,</span>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>    <span class="n">out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a><span class="sd">    Make a new tensor filled with NaN, or fill an existing tensor with NaN.</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a><span class="sd">    The following example creates a float32 tensor filled with NaN values,</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a><span class="sd">    of shape (3, 5):</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a><span class="sd">        nan_values = make_nan(3, 5, dtype=&quot;float32&quot;)</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a><span class="sd">    The following example fills an existing tensor with NaNs.</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a><span class="sd">        make_nan(out=existing_tensor)</span>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a><span class="sd">        size: Size of the new tensor to be filled with NaNs.</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a><span class="sd">            This can be given as multiple positional arguments, each such</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="sd">            positional argument being an integer, or as a single positional</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><span class="sd">            argument of a tuple, the tuple containing multiple integers.</span>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a><span class="sd">            Note that, if the user wishes to fill an existing tensor with</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a><span class="sd">            NaN values, then no positional argument is expected.</span>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><span class="sd">        out: Optionally, the tensor to be filled by NaN values.</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><span class="sd">            If an `out` tensor is given, then no `size` argument is expected.</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a><span class="sd">        dtype: Optionally a string (e.g. &quot;float32&quot;) or a PyTorch dtype</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a><span class="sd">            (e.g. torch.float32).</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><span class="sd">            If `dtype` is not specified, the default choice of</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a><span class="sd">            `torch.empty(...)` is used, that is, `torch.float32`.</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><span class="sd">            If an `out` tensor is specified, then `dtype` is expected</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><span class="sd">        device: The device in which the new tensor will be stored.</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a><span class="sd">            If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a><span class="sd">            If an `out` tensor is specified, then `device` is expected</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><span class="sd">        The created or modified tensor after placing NaN values.</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a>    <span class="k">if</span> <span class="n">_scalar_requested</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">):</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a>        <span class="k">return</span> <span class="n">_scalar_tensor</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">_out_tensor</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a>        <span class="n">out</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a>        <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.make_ones" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_ones</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.make_ones" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Make a new tensor filled with 1, or fill an existing tensor with 1.</p>
<p>The following example creates a float32 tensor filled with 1 values,
of shape (3, 5):</p>
<div class="highlight"><pre><span></span><code>zero_values = make_ones(3, 5, dtype=&quot;float32&quot;)
</code></pre></div>
<p>The following example fills an existing tensor with 1s:</p>
<div class="highlight"><pre><span></span><code>make_ones(out=existing_tensor)
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Size">Size</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the new tensor to be filled with 1.
This can be given as multiple positional arguments, each such
positional argument being an integer, or as a single positional
argument of a tuple, the tuple containing multiple integers.
Note that, if the user wishes to fill an existing tensor with
1 values, then no positional argument is expected.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally, the tensor to be filled by 1 values.
If an <code>out</code> tensor is given, then no <code>size</code> argument is expected.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string (e.g. "float32") or a PyTorch dtype
(e.g. torch.float32).
If <code>dtype</code> is not specified, the default choice of
<code>torch.empty(...)</code> is used, that is, <code>torch.float32</code>.
If an <code>out</code> tensor is specified, then <code>dtype</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the new tensor will be stored.
If not specified, "cpu" will be used.
If an <code>out</code> tensor is specified, then <code>device</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_ones</span><span class="p">(</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>    <span class="o">*</span><span class="n">size</span><span class="p">:</span> <span class="n">Size</span><span class="p">,</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>    <span class="n">out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">    Make a new tensor filled with 1, or fill an existing tensor with 1.</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><span class="sd">    The following example creates a float32 tensor filled with 1 values,</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="sd">    of shape (3, 5):</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a><span class="sd">        zero_values = make_ones(3, 5, dtype=&quot;float32&quot;)</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a><span class="sd">    The following example fills an existing tensor with 1s:</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a><span class="sd">        make_ones(out=existing_tensor)</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a><span class="sd">        size: Size of the new tensor to be filled with 1.</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">            This can be given as multiple positional arguments, each such</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">            positional argument being an integer, or as a single positional</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a><span class="sd">            argument of a tuple, the tuple containing multiple integers.</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><span class="sd">            Note that, if the user wishes to fill an existing tensor with</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">            1 values, then no positional argument is expected.</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">        out: Optionally, the tensor to be filled by 1 values.</span>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><span class="sd">            If an `out` tensor is given, then no `size` argument is expected.</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">        dtype: Optionally a string (e.g. &quot;float32&quot;) or a PyTorch dtype</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">            (e.g. torch.float32).</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="sd">            If `dtype` is not specified, the default choice of</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a><span class="sd">            `torch.empty(...)` is used, that is, `torch.float32`.</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">            If an `out` tensor is specified, then `dtype` is expected</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">        device: The device in which the new tensor will be stored.</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a><span class="sd">            If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><span class="sd">            If an `out` tensor is specified, then `device` is expected</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a><span class="sd">        The created or modified tensor after placing 1 values.</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>    <span class="k">if</span> <span class="n">_scalar_requested</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">):</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>        <span class="k">return</span> <span class="n">_scalar_tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">_out_tensor</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>        <span class="n">out</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>        <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.make_randint" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_randint</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.make_randint" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Make a new or existing tensor filled by random integers.
The integers are uniformly distributed within <code>[0 ... n-1]</code>.
This function can be used with integer or float dtypes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Size">Size</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the new tensor to be filled with uniformly distributed
values. This can be given as multiple positional arguments, each
such positional argument being an integer, or as a single
positional argument of a tuple, the tuple containing multiple
integers. Note that, if the user wishes to fill an existing
tensor instead, then no positional argument is expected.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="float">float</span>, <span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of choice(s) for integer sampling.
The lowest possible value will be 0, and the highest possible
value will be n - 1.
<code>n</code> can be a scalar, or a tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally, the tensor to be filled by the random integers.
If an <code>out</code> tensor is given, then no <code>size</code> argument is
expected.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string (e.g. "int64") or a PyTorch dtype
(e.g. torch.int64).
If <code>dtype</code> is not specified, torch.int64 will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the new tensor will be stored.
If not specified, "cpu" will be used.
If an <code>out</code> tensor is specified, then <code>device</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>generator</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pseudo-random number generator to be used when sampling
the values. Can be a <code>torch.Generator</code>, or an object with
a <code>generator</code> attribute (such as <code>Problem</code>).
If left as None, the global generator of PyTorch will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1758" name="__codelineno-0-1758"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_randint</span><span class="p">(</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>    <span class="o">*</span><span class="n">size</span><span class="p">:</span> <span class="n">Size</span><span class="p">,</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>    <span class="n">n</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>    <span class="n">out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>    <span class="n">generator</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a><span class="sd">    Make a new or existing tensor filled by random integers.</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a><span class="sd">    The integers are uniformly distributed within `[0 ... n-1]`.</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a><span class="sd">    This function can be used with integer or float dtypes.</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a><span class="sd">        size: Size of the new tensor to be filled with uniformly distributed</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a><span class="sd">            values. This can be given as multiple positional arguments, each</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a><span class="sd">            such positional argument being an integer, or as a single</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a><span class="sd">            positional argument of a tuple, the tuple containing multiple</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a><span class="sd">            integers. Note that, if the user wishes to fill an existing</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a><span class="sd">            tensor instead, then no positional argument is expected.</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a><span class="sd">        n: Number of choice(s) for integer sampling.</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a><span class="sd">            The lowest possible value will be 0, and the highest possible</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a><span class="sd">            value will be n - 1.</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a><span class="sd">            `n` can be a scalar, or a tensor.</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a><span class="sd">        out: Optionally, the tensor to be filled by the random integers.</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a><span class="sd">            If an `out` tensor is given, then no `size` argument is</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a><span class="sd">            expected.</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a><span class="sd">        dtype: Optionally a string (e.g. &quot;int64&quot;) or a PyTorch dtype</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a><span class="sd">            (e.g. torch.int64).</span>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a><span class="sd">            If `dtype` is not specified, torch.int64 will be used.</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a><span class="sd">        device: The device in which the new tensor will be stored.</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a><span class="sd">            If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a><span class="sd">            If an `out` tensor is specified, then `device` is expected</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a><span class="sd">        generator: Pseudo-random number generator to be used when sampling</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><span class="sd">            the values. Can be a `torch.Generator`, or an object with</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a><span class="sd">            a `generator` attribute (such as `Problem`).</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><span class="sd">            If left as None, the global generator of PyTorch will be used.</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><span class="sd">            The created or modified tensor after placing the uniformly</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a><span class="sd">            distributed values.</span>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a>    <span class="n">scalar_requested</span> <span class="o">=</span> <span class="n">_scalar_requested</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a>    <span class="k">if</span> <span class="n">scalar_requested</span><span class="p">:</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>        <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">out</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a>        <span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">int64</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">_out_tensor_for_random_operation</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a>    <span class="n">gen_kwargs</span> <span class="o">=</span> <span class="n">_generator_kwargs</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a>    <span class="n">out</span><span class="o">.</span><span class="n">random_</span><span class="p">(</span><span class="o">**</span><span class="n">gen_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>    <span class="n">out</span> <span class="o">%=</span> <span class="n">n</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a>    <span class="k">if</span> <span class="n">scalar_requested</span><span class="p">:</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a>    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.make_tensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_tensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.make_tensor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Make a new tensor.</p>
<p>This function can be used to create PyTorch tensors, or ObjectArray
instances with or without read-only behavior.</p>
<p>The following example creates a 2-dimensional PyTorch tensor:</p>
<div class="highlight"><pre><span></span><code>my_tensor = make_tensor(
    [[1, 2], [3, 4]],
    dtype=&quot;float32&quot;,    # alternatively, torch.float32
    device=&quot;cpu&quot;,
)
</code></pre></div>
<p>The following example creates an ObjectArray from a list that contains
arbitrary data:</p>
<div class="highlight"><pre><span></span><code>my_obj_tensor = make_tensor([&quot;a_string&quot;, (1, 2)], dtype=object)
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to be converted to a tensor.
If one wishes to create a PyTorch tensor, this can be anything
that can be stored by a PyTorch tensor.
If one wishes to create an <code>ObjectArray</code> and therefore passes
<code>dtype=object</code>, then the provided <code>data</code> is expected as an
<code>Iterable</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string (e.g. "float32"), or a PyTorch dtype
(e.g. torch.float32), or <code>object</code> or "object" (as a string)
or <code>Any</code> if one wishes to create an <code>ObjectArray</code>.
If <code>dtype</code> is not specified, it will be assumed that the user
wishes to create a PyTorch tensor (not an <code>ObjectArray</code>) and
then <code>dtype</code> will be inferred from the provided <code>data</code>
(according to the default behavior of PyTorch).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the tensor will be stored.
If <code>device</code> is not specified, it will be understood from the
given <code>data</code> (according to the default behavior of PyTorch).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>read_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the created tensor will be read-only.
By default, this is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_tensor</span><span class="p">(</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>    <span class="n">read_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">    Make a new tensor.</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">    This function can be used to create PyTorch tensors, or ObjectArray</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">    instances with or without read-only behavior.</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">    The following example creates a 2-dimensional PyTorch tensor:</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">        my_tensor = make_tensor(</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">            [[1, 2], [3, 4]],</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">            dtype=&quot;float32&quot;,    # alternatively, torch.float32</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">            device=&quot;cpu&quot;,</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">        )</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">    The following example creates an ObjectArray from a list that contains</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">    arbitrary data:</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">        my_obj_tensor = make_tensor([&quot;a_string&quot;, (1, 2)], dtype=object)</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">        data: The data to be converted to a tensor.</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">            If one wishes to create a PyTorch tensor, this can be anything</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a><span class="sd">            that can be stored by a PyTorch tensor.</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">            If one wishes to create an `ObjectArray` and therefore passes</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">            `dtype=object`, then the provided `data` is expected as an</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a><span class="sd">            `Iterable`.</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a><span class="sd">        dtype: Optionally a string (e.g. &quot;float32&quot;), or a PyTorch dtype</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a><span class="sd">            (e.g. torch.float32), or `object` or &quot;object&quot; (as a string)</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="sd">            or `Any` if one wishes to create an `ObjectArray`.</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a><span class="sd">            If `dtype` is not specified, it will be assumed that the user</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">            wishes to create a PyTorch tensor (not an `ObjectArray`) and</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">            then `dtype` will be inferred from the provided `data`</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">            (according to the default behavior of PyTorch).</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><span class="sd">        device: The device in which the tensor will be stored.</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><span class="sd">            If `device` is not specified, it will be understood from the</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">            given `data` (according to the default behavior of PyTorch).</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><span class="sd">        read_only: Whether or not the created tensor will be read-only.</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><span class="sd">            By default, this is False.</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a><span class="sd">        A PyTorch tensor or an ObjectArray.</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.objectarray</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObjectArray</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.readonlytensor</span><span class="w"> </span><span class="kn">import</span> <span class="n">as_read_only_tensor</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>            <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">ObjectArray</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>        <span class="n">result</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">data</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>        <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;device&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>    <span class="k">if</span> <span class="n">read_only</span><span class="p">:</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">as_read_only_tensor</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.make_uniform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_uniform</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.make_uniform" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Make a new or existing tensor filled by uniformly distributed values.
Both lower and upper bounds are inclusive.
This function can work with both float and int dtypes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Size">Size</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the new tensor to be filled with uniformly distributed
values. This can be given as multiple positional arguments, each
such positional argument being an integer, or as a single
positional argument of a tuple, the tuple containing multiple
integers. Note that, if the user wishes to fill an existing
tensor instead, then no positional argument is expected.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lb</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bound for the uniformly distributed values.
Can be a scalar, or a tensor.
If not specified, the lower bound will be taken as 0.
Note that, if one specifies <code>lb</code>, then <code>ub</code> is also expected to
be explicitly specified.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ub</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bound for the uniformly distributed values.
Can be a scalar, or a tensor.
If not specified, the upper bound will be taken as 1.
Note that, if one specifies <code>ub</code>, then <code>lb</code> is also expected to
be explicitly specified.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally, the tensor to be filled by uniformly distributed
values. If an <code>out</code> tensor is given, then no <code>size</code> argument is
expected.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string (e.g. "float32") or a PyTorch dtype
(e.g. torch.float32).
If <code>dtype</code> is not specified, the default choice of
<code>torch.empty(...)</code> is used, that is, <code>torch.float32</code>.
If an <code>out</code> tensor is specified, then <code>dtype</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the new tensor will be stored.
If not specified, "cpu" will be used.
If an <code>out</code> tensor is specified, then <code>device</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>generator</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pseudo-random number generator to be used when sampling
the values. Can be a <code>torch.Generator</code>, or an object with
a <code>generator</code> attribute (such as <code>Problem</code>).
If left as None, the global generator of PyTorch will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1540" name="__codelineno-0-1540"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_uniform</span><span class="p">(</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a>    <span class="o">*</span><span class="n">size</span><span class="p">:</span> <span class="n">Size</span><span class="p">,</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a>    <span class="n">lb</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a>    <span class="n">ub</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a>    <span class="n">out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a>    <span class="n">generator</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">    Make a new or existing tensor filled by uniformly distributed values.</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a><span class="sd">    Both lower and upper bounds are inclusive.</span>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">    This function can work with both float and int dtypes.</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a><span class="sd">        size: Size of the new tensor to be filled with uniformly distributed</span>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a><span class="sd">            values. This can be given as multiple positional arguments, each</span>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><span class="sd">            such positional argument being an integer, or as a single</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="sd">            positional argument of a tuple, the tuple containing multiple</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><span class="sd">            integers. Note that, if the user wishes to fill an existing</span>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><span class="sd">            tensor instead, then no positional argument is expected.</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">        lb: Lower bound for the uniformly distributed values.</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a><span class="sd">            Can be a scalar, or a tensor.</span>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">            If not specified, the lower bound will be taken as 0.</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">            Note that, if one specifies `lb`, then `ub` is also expected to</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><span class="sd">            be explicitly specified.</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a><span class="sd">        ub: Upper bound for the uniformly distributed values.</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><span class="sd">            Can be a scalar, or a tensor.</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">            If not specified, the upper bound will be taken as 1.</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><span class="sd">            Note that, if one specifies `ub`, then `lb` is also expected to</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><span class="sd">            be explicitly specified.</span>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><span class="sd">        out: Optionally, the tensor to be filled by uniformly distributed</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><span class="sd">            values. If an `out` tensor is given, then no `size` argument is</span>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="sd">            expected.</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">        dtype: Optionally a string (e.g. &quot;float32&quot;) or a PyTorch dtype</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><span class="sd">            (e.g. torch.float32).</span>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">            If `dtype` is not specified, the default choice of</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">            `torch.empty(...)` is used, that is, `torch.float32`.</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a><span class="sd">            If an `out` tensor is specified, then `dtype` is expected</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="sd">        device: The device in which the new tensor will be stored.</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a><span class="sd">            If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a><span class="sd">            If an `out` tensor is specified, then `device` is expected</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a><span class="sd">        generator: Pseudo-random number generator to be used when sampling</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a><span class="sd">            the values. Can be a `torch.Generator`, or an object with</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a><span class="sd">            a `generator` attribute (such as `Problem`).</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a><span class="sd">            If left as None, the global generator of PyTorch will be used.</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a><span class="sd">        The created or modified tensor after placing the uniformly</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a><span class="sd">        distributed values.</span>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>    <span class="n">scalar_requested</span> <span class="o">=</span> <span class="n">_scalar_requested</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>    <span class="k">if</span> <span class="n">scalar_requested</span><span class="p">:</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>        <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_invalid_bound_args</span><span class="p">():</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>            <span class="sa">f</span><span class="s2">&quot;Expected both `lb` and `ub` as None, or both `lb` and `ub` as not None.&quot;</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a>            <span class="sa">f</span><span class="s2">&quot; It appears that one of them is None, while the other is not.&quot;</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a>            <span class="sa">f</span><span class="s2">&quot; lb: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>            <span class="sa">f</span><span class="s2">&quot; ub: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>        <span class="p">)</span>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">_out_tensor_for_random_operation</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>    <span class="n">gen_kwargs</span> <span class="o">=</span> <span class="n">_generator_kwargs</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_cast_bounds</span><span class="p">():</span>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a>        <span class="k">nonlocal</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a>        <span class="n">lb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>        <span class="n">ub</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">ub</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>    <span class="k">if</span> <span class="n">out</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">:</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>        <span class="n">out</span><span class="o">.</span><span class="n">random_</span><span class="p">(</span><span class="o">**</span><span class="n">gen_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>            <span class="k">pass</span>  <span class="c1"># nothing to do</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>            <span class="n">_cast_bounds</span><span class="p">()</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>            <span class="n">lb_shape_matches</span> <span class="o">=</span> <span class="n">lb</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">out</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>            <span class="n">ub_shape_matches</span> <span class="o">=</span> <span class="n">ub</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">out</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">lb_shape_matches</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">ub_shape_matches</span><span class="p">):</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>                <span class="n">all_false</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">lb_shape_matches</span><span class="p">:</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>                    <span class="n">lb</span> <span class="o">=</span> <span class="n">lb</span> <span class="o">|</span> <span class="n">all_false</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">ub_shape_matches</span><span class="p">:</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a>                    <span class="n">ub</span> <span class="o">=</span> <span class="n">ub</span> <span class="o">|</span> <span class="n">all_false</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>            <span class="n">mask_for_always_false</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">lb</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">ub</span><span class="p">)</span>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>            <span class="n">mask_for_always_true</span> <span class="o">=</span> <span class="n">lb</span> <span class="o">&amp;</span> <span class="n">ub</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a>            <span class="n">out</span><span class="p">[</span><span class="n">mask_for_always_false</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>            <span class="n">out</span><span class="p">[</span><span class="n">mask_for_always_true</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>            <span class="n">_invalid_bound_args</span><span class="p">()</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>    <span class="k">elif</span> <span class="n">out</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">):</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a>        <span class="n">out</span><span class="o">.</span><span class="n">random_</span><span class="p">(</span><span class="o">**</span><span class="n">gen_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>            <span class="n">out</span> <span class="o">%=</span> <span class="mi">2</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>            <span class="n">_cast_bounds</span><span class="p">()</span>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a>            <span class="n">diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a>            <span class="n">out</span> <span class="o">-=</span> <span class="n">lb</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>            <span class="n">out</span> <span class="o">%=</span> <span class="n">diff</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="n">lb</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>            <span class="n">_invalid_bound_args</span><span class="p">()</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>        <span class="n">out</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="o">**</span><span class="n">gen_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>            <span class="k">pass</span>  <span class="c1"># nothing to do</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>            <span class="n">_cast_bounds</span><span class="p">()</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>            <span class="n">diff</span> <span class="o">=</span> <span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>            <span class="n">out</span> <span class="o">*=</span> <span class="n">diff</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>            <span class="n">out</span> <span class="o">+=</span> <span class="n">lb</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>            <span class="n">_invalid_bound_args</span><span class="p">()</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>    <span class="k">if</span> <span class="n">scalar_requested</span><span class="p">:</span>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.make_zeros" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_zeros</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.make_zeros" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Make a new tensor filled with 0, or fill an existing tensor with 0.</p>
<p>The following example creates a float32 tensor filled with 0 values,
of shape (3, 5):</p>
<div class="highlight"><pre><span></span><code>zero_values = make_zeros(3, 5, dtype=&quot;float32&quot;)
</code></pre></div>
<p>The following example fills an existing tensor with 0s:</p>
<div class="highlight"><pre><span></span><code>make_zeros(out=existing_tensor)
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="evotorch.tools.misc.Size">Size</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the new tensor to be filled with 0.
This can be given as multiple positional arguments, each such
positional argument being an integer, or as a single positional
argument of a tuple, the tuple containing multiple integers.
Note that, if the user wishes to fill an existing tensor with
0 values, then no positional argument is expected.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="torch.Tensor">Tensor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally, the tensor to be filled by 0 values.
If an <code>out</code> tensor is given, then no <code>size</code> argument is expected.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally a string (e.g. "float32") or a PyTorch dtype
(e.g. torch.float32).
If <code>dtype</code> is not specified, the default choice of
<code>torch.empty(...)</code> is used, that is, <code>torch.float32</code>.
If an <code>out</code> tensor is specified, then <code>dtype</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.Device">Device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The device in which the new tensor will be stored.
If not specified, "cpu" will be used.
If an <code>out</code> tensor is specified, then <code>device</code> is expected
as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_zeros</span><span class="p">(</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>    <span class="o">*</span><span class="n">size</span><span class="p">:</span> <span class="n">Size</span><span class="p">,</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>    <span class="n">out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><span class="sd">    Make a new tensor filled with 0, or fill an existing tensor with 0.</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">    The following example creates a float32 tensor filled with 0 values,</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">    of shape (3, 5):</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">        zero_values = make_zeros(3, 5, dtype=&quot;float32&quot;)</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">    The following example fills an existing tensor with 0s:</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">        make_zeros(out=existing_tensor)</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">        size: Size of the new tensor to be filled with 0.</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a><span class="sd">            This can be given as multiple positional arguments, each such</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">            positional argument being an integer, or as a single positional</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">            argument of a tuple, the tuple containing multiple integers.</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a><span class="sd">            Note that, if the user wishes to fill an existing tensor with</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">            0 values, then no positional argument is expected.</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">        out: Optionally, the tensor to be filled by 0 values.</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a><span class="sd">            If an `out` tensor is given, then no `size` argument is expected.</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a><span class="sd">        dtype: Optionally a string (e.g. &quot;float32&quot;) or a PyTorch dtype</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a><span class="sd">            (e.g. torch.float32).</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a><span class="sd">            If `dtype` is not specified, the default choice of</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a><span class="sd">            `torch.empty(...)` is used, that is, `torch.float32`.</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a><span class="sd">            If an `out` tensor is specified, then `dtype` is expected</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="sd">        device: The device in which the new tensor will be stored.</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="sd">            If not specified, &quot;cpu&quot; will be used.</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a><span class="sd">            If an `out` tensor is specified, then `device` is expected</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a><span class="sd">        The created or modified tensor after placing 0 values.</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>    <span class="k">if</span> <span class="n">_scalar_requested</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">):</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>        <span class="k">return</span> <span class="n">_scalar_tensor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">_out_tensor</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>        <span class="n">out</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>        <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.message_from" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">message_from</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.message_from" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Prepend the sender object's name and id to a string message.</p>
<p>Let us imagine that we have a class named <code>Example</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">evotorch.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">message_from</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">Example</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">say_hello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">message_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Hello!&quot;</span><span class="p">))</span>
</code></pre></div>
<p>Let us now instantiate this class and use its <code>say_hello</code> method:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">ex</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">ex</span><span class="o">.</span><span class="n">say_hello</span><span class="p">()</span>
</code></pre></div>
<p>The output becomes something like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Instance of `Example` (id:...) -- Hello!
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sender</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object which produces the message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The message, as something that can be converted to string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2143" name="__codelineno-0-2143"></a><span class="k">def</span><span class="w"> </span><span class="nf">message_from</span><span class="p">(</span><span class="n">sender</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a><span class="sd">    Prepend the sender object&#39;s name and id to a string message.</span>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a><span class="sd">    Let us imagine that we have a class named `Example`:</span>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a><span class="sd">    from evotorch.tools import message_from</span>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a><span class="sd">    class Example:</span>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a><span class="sd">        def say_hello(self):</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a><span class="sd">            print(message_from(self, &quot;Hello!&quot;))</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a><span class="sd">    Let us now instantiate this class and use its `say_hello` method:</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a><span class="sd">    ex = Example()</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a><span class="sd">    ex.say_hello()</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a><span class="sd">    The output becomes something like this:</span>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a><span class="sd">    Instance of `Example` (id:...) -- Hello!</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a><span class="sd">        sender: The object which produces the message</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a><span class="sd">        message: The message, as something that can be converted to string</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a><span class="sd">        The new message string, with the details regarding the sender object</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a><span class="sd">        inserted to the beginning.</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a>    <span class="n">sender_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">sender</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a>    <span class="n">sender_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">sender</span><span class="p">)</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Instance of `</span><span class="si">{</span><span class="n">sender_type</span><span class="si">}</span><span class="s2">` (id:</span><span class="si">{</span><span class="n">sender_id</span><span class="si">}</span><span class="s2">) -- </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.modify_tensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">modify_tensor</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_change</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.modify_tensor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return the modified version of the original tensor, with bounds checking.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>original</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target tensor which contains the values to replace the
old ones in the original tensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lb</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="torch.Tensor">Tensor</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lower bound(s), as a scalar or as an tensor.
Values below these bounds are clipped in the resulting tensor.
None means -inf.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ub</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="torch.Tensor">Tensor</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The upper bound(s), as a scalar or as an tensor.
Value above these bounds are clipped in the resulting tensor.
None means +inf.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_change</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="torch.Tensor">Tensor</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ratio of allowed change.
In more details, when given as a real number r,
modifications are allowed only within
<code>[original-(r*abs(original)) ... original+(r*abs(original))]</code>.
Modifications beyond this interval are clipped.
This argument can also be left as None if no such limitation
is needed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>in_place</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Provide this as True if you wish the modification to be
done within the original tensor. The default value of this
argument is False, which means, the original tensor is not
changed, and its modified version is returned as an independent
copy.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="k">def</span><span class="w"> </span><span class="nf">modify_tensor</span><span class="p">(</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="n">original</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="n">target</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="n">lb</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>    <span class="n">ub</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>    <span class="n">max_change</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the modified version of the original tensor, with bounds checking.</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="sd">        original: The original tensor.</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">        target: The target tensor which contains the values to replace the</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">            old ones in the original tensor.</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">        lb: The lower bound(s), as a scalar or as an tensor.</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">            Values below these bounds are clipped in the resulting tensor.</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">            None means -inf.</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">        ub: The upper bound(s), as a scalar or as an tensor.</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">            Value above these bounds are clipped in the resulting tensor.</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">            None means +inf.</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">        max_change: The ratio of allowed change.</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">            In more details, when given as a real number r,</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">            modifications are allowed only within</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">            ``[original-(r*abs(original)) ... original+(r*abs(original))]``.</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">            Modifications beyond this interval are clipped.</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="sd">            This argument can also be left as None if no such limitation</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">            is needed.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">        in_place: Provide this as True if you wish the modification to be</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">            done within the original tensor. The default value of this</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">            argument is False, which means, the original tensor is not</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">            changed, and its modified version is returned as an independent</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">            copy.</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">        The modified tensor.</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">max_change</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>        <span class="c1"># If there is no restriction regarding how the tensor</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>        <span class="c1"># should be modified (no lb, no ub, no max_change),</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="c1"># then we simply use the target values</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="c1"># themselves for modifying the tensor.</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>        <span class="k">if</span> <span class="n">in_place</span><span class="p">:</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>            <span class="n">original</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">target</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>            <span class="k">return</span> <span class="n">original</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>            <span class="k">return</span> <span class="n">target</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="c1"># If there are some restriction regarding how the tensor</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>        <span class="c1"># should be modified, then we turn to the following</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>        <span class="c1"># operations</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tensorname</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>                <span class="n">converted</span> <span class="o">=</span> <span class="n">x</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>                <span class="n">converted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">original</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">original</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="k">if</span> <span class="n">converted</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">converted</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">original</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                <span class="k">return</span> <span class="n">converted</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>                    <span class="sa">f</span><span class="s2">&quot;Argument </span><span class="si">{</span><span class="n">tensorname</span><span class="si">}</span><span class="s2">: shape mismatch.&quot;</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                    <span class="sa">f</span><span class="s2">&quot; Shape of the original tensor: </span><span class="si">{</span><span class="n">original</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>                    <span class="sa">f</span><span class="s2">&quot; Shape of </span><span class="si">{</span><span class="n">tensorname</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">converted</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>                <span class="p">)</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="k">if</span> <span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>            <span class="c1"># If lb is None, then it should be taken as -inf</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>            <span class="n">lb</span> <span class="o">=</span> <span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">),</span> <span class="s2">&quot;lb&quot;</span><span class="p">)</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>            <span class="n">lb</span> <span class="o">=</span> <span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="s2">&quot;lb&quot;</span><span class="p">)</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="k">if</span> <span class="n">ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>            <span class="c1"># If ub is None, then it should be taken as +inf</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>            <span class="n">ub</span> <span class="o">=</span> <span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="s2">&quot;ub&quot;</span><span class="p">)</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>            <span class="n">ub</span> <span class="o">=</span> <span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">ub</span><span class="p">,</span> <span class="s2">&quot;ub&quot;</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="k">if</span> <span class="n">max_change</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>            <span class="c1"># If max_change is provided as something other than None,</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>            <span class="c1"># then we update the lb and ub so that they are tight</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>            <span class="c1"># enough to satisfy the max_change restriction.</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>            <span class="n">max_change</span> <span class="o">=</span> <span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">max_change</span><span class="p">,</span> <span class="s2">&quot;max_change&quot;</span><span class="p">)</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>            <span class="n">allowed_amounts</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">original</span><span class="p">)</span> <span class="o">*</span> <span class="n">max_change</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>            <span class="n">allowed_lb</span> <span class="o">=</span> <span class="n">original</span> <span class="o">-</span> <span class="n">allowed_amounts</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>            <span class="n">allowed_ub</span> <span class="o">=</span> <span class="n">original</span> <span class="o">+</span> <span class="n">allowed_amounts</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>            <span class="n">lb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">allowed_lb</span><span class="p">)</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>            <span class="n">ub</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ub</span><span class="p">,</span> <span class="n">allowed_ub</span><span class="p">)</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="c1">## If in_place is given as True, the clipping (that we are about</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="c1">## to perform), should be in-place.</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>        <span class="c1"># more_config = {}</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>        <span class="c1"># if in_place:</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>        <span class="c1">#    more_config[&#39;out&#39;] = original</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>        <span class="c1">#</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>        <span class="c1">## Return the clipped version of the target values</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>        <span class="c1"># return torch.clamp(target, lb, ub, **more_config)</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">lb</span><span class="p">)</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>        <span class="k">if</span> <span class="n">in_place</span><span class="p">:</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>            <span class="n">original</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>            <span class="k">return</span> <span class="n">original</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>            <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.modify_vector" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">modify_vector</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_change</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.modify_vector" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return the modified version(s) of the vector(s), with bounds checking.</p>
<p>This function is similar to <code>modify_tensor</code>, but it has the following
different behaviors:</p>
<ul>
<li>Assumes that all of its arguments are either vectors, or are batches
  of vectors. If some or more of its arguments have 2 or more dimensions,
  those arguments will be considered as batches, and the computation will
  be vectorized to return a batch of results.</li>
<li>Designed to be <code>vmap</code>-friendly.</li>
<li>Designed for functional programming paradigm, and therefore lacks the
  in-place modification option.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="k">def</span><span class="w"> </span><span class="nf">modify_vector</span><span class="p">(</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>    <span class="n">original</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>    <span class="n">target</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="n">lb</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>    <span class="n">ub</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>    <span class="n">max_change</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">    Return the modified version(s) of the vector(s), with bounds checking.</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">    This function is similar to `modify_tensor`, but it has the following</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">    different behaviors:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">    - Assumes that all of its arguments are either vectors, or are batches</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">      of vectors. If some or more of its arguments have 2 or more dimensions,</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">      those arguments will be considered as batches, and the computation will</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">      be vectorized to return a batch of results.</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">    - Designed to be `vmap`-friendly.</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">    - Designed for functional programming paradigm, and therefore lacks the</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">      in-place modification option.</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">..decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">expects_ndim</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>    <span class="k">if</span> <span class="n">max_change</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">target</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">expects_ndim</span><span class="p">(</span><span class="n">_modify_vector_using_max_change</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">allow_smaller_ndim</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>            <span class="n">original</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">max_change</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>        <span class="p">)</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>        <span class="k">pass</span>  <span class="c1"># no strict boundaries, so, nothing more to do</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">expects_ndim</span><span class="p">(</span><span class="n">_modify_vector_using_bounds</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">allow_smaller_ndim</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">result</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>            <span class="s2">&quot;`modify_vector` expects either with `lb` and `ub` given together, or with both of them omitted.&quot;</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>            <span class="s2">&quot; Having only `lb` or only `ub` is not supported.&quot;</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>        <span class="p">)</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.numpy_copy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">numpy_copy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.numpy_copy" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return a numpy copy of the given iterable.</p>
<p>The newly created numpy array will be mutable, even if the
original iterable object is read-only.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any Iterable whose numpy copy will be returned.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.DType">DType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired dtype. Can be given as a numpy dtype,
as a torch dtype, or a native dtype (e.g. int, float),
or as a string (e.g. "float32").
If left as None, dtype will be determined according
to the data contained by the original iterable object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="k">def</span><span class="w"> </span><span class="nf">numpy_copy</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">    Return a numpy copy of the given iterable.</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">    The newly created numpy array will be mutable, even if the</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">    original iterable object is read-only.</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">        x: Any Iterable whose numpy copy will be returned.</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">        dtype: The desired dtype. Can be given as a numpy dtype,</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">            as a torch dtype, or a native dtype (e.g. int, float),</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">            or as a string (e.g. &quot;float32&quot;).</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">            If left as None, dtype will be determined according</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">            to the data contained by the original iterable object.</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">        The numpy copy of the original iterable object.</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.objectarray</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObjectArray</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>    <span class="n">needs_casting</span> <span class="o">=</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">):</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>        <span class="n">needs_casting</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>    <span class="k">if</span> <span class="n">needs_casting</span><span class="p">:</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.pass_info_if_needed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pass_info_if_needed</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.pass_info_if_needed" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Pass additional arguments into a callable, the info dictionary is unpacked
and passed as additional keyword arguments only if the policy is decorated
with the <a class="autorefs autorefs-internal" title="pass_info(*args)" href="../../decorators/#evotorch.decorators.pass_info">pass_info</a> decorator.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The callable to be called.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>info</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The info to be passed to the callable.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span>
<span class="normal"><a href="#__codelineno-0-2049">2049</a></span>
<span class="normal"><a href="#__codelineno-0-2050">2050</a></span>
<span class="normal"><a href="#__codelineno-0-2051">2051</a></span>
<span class="normal"><a href="#__codelineno-0-2052">2052</a></span>
<span class="normal"><a href="#__codelineno-0-2053">2053</a></span>
<span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span>
<span class="normal"><a href="#__codelineno-0-2056">2056</a></span>
<span class="normal"><a href="#__codelineno-0-2057">2057</a></span>
<span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2040" name="__codelineno-0-2040"></a><span class="k">def</span><span class="w"> </span><span class="nf">pass_info_if_needed</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-2041" name="__codelineno-0-2041"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2042" name="__codelineno-0-2042"></a><span class="sd">    Pass additional arguments into a callable, the info dictionary is unpacked</span>
<a id="__codelineno-0-2043" name="__codelineno-0-2043"></a><span class="sd">    and passed as additional keyword arguments only if the policy is decorated</span>
<a id="__codelineno-0-2044" name="__codelineno-0-2044"></a><span class="sd">    with the [pass_info][evotorch.decorators.pass_info] decorator.</span>
<a id="__codelineno-0-2045" name="__codelineno-0-2045"></a>
<a id="__codelineno-0-2046" name="__codelineno-0-2046"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2047" name="__codelineno-0-2047"></a><span class="sd">        f (Callable): The callable to be called.</span>
<a id="__codelineno-0-2048" name="__codelineno-0-2048"></a><span class="sd">        info (Dict[str, Any]): The info to be passed to the callable.</span>
<a id="__codelineno-0-2049" name="__codelineno-0-2049"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2050" name="__codelineno-0-2050"></a><span class="sd">        Callable: The callable with extra arguments</span>
<a id="__codelineno-0-2051" name="__codelineno-0-2051"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-2052" name="__codelineno-0-2052"></a><span class="sd">        TypeError: If the callable is decorated with the [pass_info][evotorch.decorators.pass_info] decorator,</span>
<a id="__codelineno-0-2053" name="__codelineno-0-2053"></a><span class="sd">            but its signature does not match the expected signature.</span>
<a id="__codelineno-0-2054" name="__codelineno-0-2054"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2055" name="__codelineno-0-2055"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;__evotorch_pass_info__&quot;</span><span class="p">):</span>
<a id="__codelineno-0-2056" name="__codelineno-0-2056"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2057" name="__codelineno-0-2057"></a>            <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-2058" name="__codelineno-0-2058"></a>            <span class="n">sig</span><span class="o">.</span><span class="n">bind_partial</span><span class="p">(</span><span class="o">**</span><span class="n">info</span><span class="p">)</span>
<a id="__codelineno-0-2059" name="__codelineno-0-2059"></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-2060" name="__codelineno-0-2060"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2061" name="__codelineno-0-2061"></a>                <span class="s2">&quot;Callable </span><span class="si">{f}</span><span class="s2"> is decorated with @pass_info, but it doesn&#39;t expect some of the extra arguments &quot;</span>
<a id="__codelineno-0-2062" name="__codelineno-0-2062"></a>                <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">). Hint: maybe you forgot to add **kwargs to the function signature?&quot;</span>
<a id="__codelineno-0-2063" name="__codelineno-0-2063"></a>            <span class="p">)</span>
<a id="__codelineno-0-2064" name="__codelineno-0-2064"></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-2065" name="__codelineno-0-2065"></a>            <span class="k">pass</span>
<a id="__codelineno-0-2066" name="__codelineno-0-2066"></a>
<a id="__codelineno-0-2067" name="__codelineno-0-2067"></a>        <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="n">info</span><span class="p">)</span>
<a id="__codelineno-0-2068" name="__codelineno-0-2068"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2069" name="__codelineno-0-2069"></a>        <span class="k">return</span> <span class="n">f</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.set_default_logger_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_default_logger_config</span><span class="p">(</span><span class="n">logger_name</span><span class="o">=</span><span class="s1">&#39;evotorch&#39;</span><span class="p">,</span> <span class="n">logger_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">show_process</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_lineno</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.set_default_logger_config" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Configure the "EvoTorch" Python logger to print to the console with default format.</p>
<p>The logger will be configured to print to all messages with level INFO or lower to stdout and all
messages with level WARNING or higher to stderr.</p>
<p>The default format is:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>[2022-11-23 22:28:47] INFO     &lt;75935&gt;   evotorch:      This is a log message
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>{asctime}             {level}  {process} {logger_name}: {message}
</code></pre></div>
The format can be slightly customized by passing <code>show_process=False</code> to hide Process ID or <code>show_lineno=True</code> to
show the filename and line number of the log message instead of the Logger Name.</p>
<p>This function should be called before any other logging is performed, otherwise the default configuration will
not be applied. If the logger is already configured, this function will do nothing unless <code>override=True</code> is passed,
in which case the logger will be reconfigured.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>logger_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the logger to configure.</p>
              </div>
            </td>
            <td>
                  <code>&#39;evotorch&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger_level</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Level of the logger to configure.</p>
              </div>
            </td>
            <td>
                  <code><span title="logging.INFO">INFO</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_process</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show the process name in the log message.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_lineno</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show the filename with the line number in the log message or just the name of the logger.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>override</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to override the logger configuration if it has already been configured.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2072" name="__codelineno-0-2072"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_default_logger_config</span><span class="p">(</span>
<a id="__codelineno-0-2073" name="__codelineno-0-2073"></a>    <span class="n">logger_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;evotorch&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074"></a>    <span class="n">logger_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075"></a>    <span class="n">show_process</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2076" name="__codelineno-0-2076"></a>    <span class="n">show_lineno</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2077" name="__codelineno-0-2077"></a>    <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2078" name="__codelineno-0-2078"></a><span class="p">):</span>
<a id="__codelineno-0-2079" name="__codelineno-0-2079"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2080" name="__codelineno-0-2080"></a><span class="sd">    Configure the &quot;EvoTorch&quot; Python logger to print to the console with default format.</span>
<a id="__codelineno-0-2081" name="__codelineno-0-2081"></a>
<a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">    The logger will be configured to print to all messages with level INFO or lower to stdout and all</span>
<a id="__codelineno-0-2083" name="__codelineno-0-2083"></a><span class="sd">    messages with level WARNING or higher to stderr.</span>
<a id="__codelineno-0-2084" name="__codelineno-0-2084"></a>
<a id="__codelineno-0-2085" name="__codelineno-0-2085"></a><span class="sd">    The default format is:</span>
<a id="__codelineno-0-2086" name="__codelineno-0-2086"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2087" name="__codelineno-0-2087"></a><span class="sd">    [2022-11-23 22:28:47] INFO     &lt;75935&gt;   evotorch:      This is a log message</span>
<a id="__codelineno-0-2088" name="__codelineno-0-2088"></a><span class="sd">    {asctime}             {level}  {process} {logger_name}: {message}</span>
<a id="__codelineno-0-2089" name="__codelineno-0-2089"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2090" name="__codelineno-0-2090"></a><span class="sd">    The format can be slightly customized by passing `show_process=False` to hide Process ID or `show_lineno=True` to</span>
<a id="__codelineno-0-2091" name="__codelineno-0-2091"></a><span class="sd">    show the filename and line number of the log message instead of the Logger Name.</span>
<a id="__codelineno-0-2092" name="__codelineno-0-2092"></a>
<a id="__codelineno-0-2093" name="__codelineno-0-2093"></a><span class="sd">    This function should be called before any other logging is performed, otherwise the default configuration will</span>
<a id="__codelineno-0-2094" name="__codelineno-0-2094"></a><span class="sd">    not be applied. If the logger is already configured, this function will do nothing unless `override=True` is passed,</span>
<a id="__codelineno-0-2095" name="__codelineno-0-2095"></a><span class="sd">    in which case the logger will be reconfigured.</span>
<a id="__codelineno-0-2096" name="__codelineno-0-2096"></a>
<a id="__codelineno-0-2097" name="__codelineno-0-2097"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2098" name="__codelineno-0-2098"></a><span class="sd">        logger_name: Name of the logger to configure.</span>
<a id="__codelineno-0-2099" name="__codelineno-0-2099"></a><span class="sd">        logger_level: Level of the logger to configure.</span>
<a id="__codelineno-0-2100" name="__codelineno-0-2100"></a><span class="sd">        show_process: Whether to show the process name in the log message.</span>
<a id="__codelineno-0-2101" name="__codelineno-0-2101"></a><span class="sd">        show_lineno: Whether to show the filename with the line number in the log message or just the name of the logger.</span>
<a id="__codelineno-0-2102" name="__codelineno-0-2102"></a><span class="sd">        override: Whether to override the logger configuration if it has already been configured.</span>
<a id="__codelineno-0-2103" name="__codelineno-0-2103"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2104" name="__codelineno-0-2104"></a>    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">logger_name</span><span class="p">)</span>
<a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>
<a id="__codelineno-0-2106" name="__codelineno-0-2106"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="n">logger</span><span class="o">.</span><span class="n">hasHandlers</span><span class="p">():</span>
<a id="__codelineno-0-2107" name="__codelineno-0-2107"></a>        <span class="c1"># warn user that the logger is already configured</span>
<a id="__codelineno-0-2108" name="__codelineno-0-2108"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>            <span class="s2">&quot;The logger is already configured. &quot;</span>
<a id="__codelineno-0-2110" name="__codelineno-0-2110"></a>            <span class="s2">&quot;The default configuration will not be applied. &quot;</span>
<a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>            <span class="s2">&quot;Call `set_default_logger_config` with `override=True` to override the current configuration.&quot;</span>
<a id="__codelineno-0-2112" name="__codelineno-0-2112"></a>        <span class="p">)</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113"></a>        <span class="k">return</span>
<a id="__codelineno-0-2114" name="__codelineno-0-2114"></a>    <span class="k">elif</span> <span class="n">override</span><span class="p">:</span>
<a id="__codelineno-0-2115" name="__codelineno-0-2115"></a>        <span class="c1"># remove all handlers</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>        <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
<a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">removeHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
<a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>
<a id="__codelineno-0-2119" name="__codelineno-0-2119"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logger_level</span><span class="p">)</span>
<a id="__codelineno-0-2120" name="__codelineno-0-2120"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">propagate</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>
<a id="__codelineno-0-2122" name="__codelineno-0-2122"></a>    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123"></a>        <span class="s2">&quot;[</span><span class="si">{asctime}</span><span class="s2">] &quot;</span>
<a id="__codelineno-0-2124" name="__codelineno-0-2124"></a>        <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{levelname:&lt;8s}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-2125" name="__codelineno-0-2125"></a>        <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;&lt;</span><span class="si">{process:5d}</span><span class="s2">&gt; &quot;</span> <span class="k">if</span> <span class="n">show_process</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126"></a>        <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{filename}</span><span class="s2">:</span><span class="si">{lineno}</span><span class="s2">: &quot;</span> <span class="k">if</span> <span class="n">show_lineno</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="si">{name}</span><span class="s2">: &quot;</span><span class="p">)</span>
<a id="__codelineno-0-2127" name="__codelineno-0-2127"></a>        <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{message}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128"></a>        <span class="n">datefmt</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2129" name="__codelineno-0-2129"></a>        <span class="n">style</span><span class="o">=</span><span class="s2">&quot;{&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130"></a>    <span class="p">)</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131"></a>
<a id="__codelineno-0-2132" name="__codelineno-0-2132"></a>    <span class="n">_stdout_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133"></a>    <span class="n">_stdout_handler</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">log_record</span><span class="p">:</span> <span class="n">log_record</span><span class="o">.</span><span class="n">levelno</span> <span class="o">&lt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a>    <span class="n">_stdout_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
<a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">_stdout_handler</span><span class="p">)</span>
<a id="__codelineno-0-2136" name="__codelineno-0-2136"></a>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>    <span class="n">_stderr_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
<a id="__codelineno-0-2138" name="__codelineno-0-2138"></a>    <span class="n">_stderr_handler</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">log_record</span><span class="p">:</span> <span class="n">log_record</span><span class="o">.</span><span class="n">levelno</span> <span class="o">&gt;=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
<a id="__codelineno-0-2139" name="__codelineno-0-2139"></a>    <span class="n">_stderr_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">_stderr_handler</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.split_workload" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_workload</span><span class="p">(</span><span class="n">workload</span><span class="p">,</span> <span class="n">num_actors</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.split_workload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Split a workload among actors.</p>
<p>By "workload" what is meant is the total amount of a work,
this amount being expressed by an integer.
For example, if the "work" is the evaluation of a population,
the "workload" would usually be the population size.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>workload</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total amount of work, as an integer.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_actors</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of actors (i.e. remote workers) among
which the workload will be distributed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="k">def</span><span class="w"> </span><span class="nf">split_workload</span><span class="p">(</span><span class="n">workload</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num_actors</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">    Split a workload among actors.</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">    By &quot;workload&quot; what is meant is the total amount of a work,</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">    this amount being expressed by an integer.</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">    For example, if the &quot;work&quot; is the evaluation of a population,</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">    the &quot;workload&quot; would usually be the population size.</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">        workload: Total amount of work, as an integer.</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">        num_actors: Number of actors (i.e. remote workers) among</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">            which the workload will be distributed.</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">        A list of integers. The i-th item of the returned list</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">        expresses the suggested workload for the i-th actor.</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>    <span class="n">base_workload</span> <span class="o">=</span> <span class="n">workload</span> <span class="o">//</span> <span class="n">num_actors</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>    <span class="n">extra_workload</span> <span class="o">=</span> <span class="n">workload</span> <span class="o">%</span> <span class="n">num_actors</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">base_workload</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_actors</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">extra_workload</span><span class="p">):</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>        <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.stdev_from_radius" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stdev_from_radius</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">solution_length</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.stdev_from_radius" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get elementwise standard deviation from a given radius.</p>
<p>Sometimes, for a distribution-based search algorithm, the user might
choose to configure the initial coverage area of the search distribution
not via standard deviation, but via a radius value, as was done in the
study of Toklu et al. (2020).
This function takes the desired radius value and the solution length of
the problem at hand, and returns the elementwise standard deviation value.
Let us name this returned standard deviation value as <code>s</code>.
When a new Gaussian distribution is constructed such that its initial
standard deviation is <code>[s, s, s, ...]</code> (the length of this vector being
equal to the solution length), this constructed distribution's radius
corresponds with the desired radius.</p>
<p>Here, the "radius" of a Gaussian distribution is defined as the norm
of the standard deviation vector. In the case of a standard normal
distribution, this radius formulation serves as a simplified approximation
to <code>E[||Normal(0, I)||]</code> (for which a closer approximation is used in
the study of Hansen &amp; Ostermeier (2001)).</p>
<p>Reference:</p>
<div class="highlight"><pre><span></span><code>Toklu, N.E., Liskowski, P., Srivastava, R.K. (2020).
ClipUp: A Simple and Powerful Optimizer
for Distribution-based Policy Evolution.
Parallel Problem Solving from Nature (PPSN 2020).

Nikolaus Hansen, Andreas Ostermeier (2001).
Completely Derandomized Self-Adaptation in Evolution Strategies.
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>radius</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The radius whose elementwise standard deviation counterpart
will be returned.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solution_length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Length of a solution for the problem at hand.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><span class="k">def</span><span class="w"> </span><span class="nf">stdev_from_radius</span><span class="p">(</span><span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">solution_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><span class="sd">    Get elementwise standard deviation from a given radius.</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a><span class="sd">    Sometimes, for a distribution-based search algorithm, the user might</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a><span class="sd">    choose to configure the initial coverage area of the search distribution</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><span class="sd">    not via standard deviation, but via a radius value, as was done in the</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><span class="sd">    study of Toklu et al. (2020).</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a><span class="sd">    This function takes the desired radius value and the solution length of</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><span class="sd">    the problem at hand, and returns the elementwise standard deviation value.</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><span class="sd">    Let us name this returned standard deviation value as `s`.</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><span class="sd">    When a new Gaussian distribution is constructed such that its initial</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><span class="sd">    standard deviation is `[s, s, s, ...]` (the length of this vector being</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a><span class="sd">    equal to the solution length), this constructed distribution&#39;s radius</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a><span class="sd">    corresponds with the desired radius.</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><span class="sd">    Here, the &quot;radius&quot; of a Gaussian distribution is defined as the norm</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><span class="sd">    of the standard deviation vector. In the case of a standard normal</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a><span class="sd">    distribution, this radius formulation serves as a simplified approximation</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><span class="sd">    to `E[||Normal(0, I)||]` (for which a closer approximation is used in</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a><span class="sd">    the study of Hansen &amp; Ostermeier (2001)).</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a><span class="sd">    Reference:</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><span class="sd">        Toklu, N.E., Liskowski, P., Srivastava, R.K. (2020).</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a><span class="sd">        ClipUp: A Simple and Powerful Optimizer</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a><span class="sd">        for Distribution-based Policy Evolution.</span>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><span class="sd">        Parallel Problem Solving from Nature (PPSN 2020).</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a><span class="sd">        Nikolaus Hansen, Andreas Ostermeier (2001).</span>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a><span class="sd">        Completely Derandomized Self-Adaptation in Evolution Strategies.</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a><span class="sd">        radius: The radius whose elementwise standard deviation counterpart</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a><span class="sd">            will be returned.</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a><span class="sd">        solution_length: Length of a solution for the problem at hand.</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a><span class="sd">        An elementwise standard deviation value `s`, such that a Gaussian</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a><span class="sd">        distribution constructed with the standard deviation `[s, s, s, ...]`</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a><span class="sd">        has the desired radius.</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>    <span class="n">radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>    <span class="n">solution_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">radius</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">solution_length</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.storage_ptr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">storage_ptr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.storage_ptr" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the pointer to the underlying storage of a tensor of an ObjectArray.</p>
<p>Calling <code>storage_ptr(x)</code> is equivalent to <code>x.untyped_storage().data_ptr()</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A regular PyTorch tensor, or a ReadOnlyTensor, or an ObjectArray.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2195" name="__codelineno-0-2195"></a><span class="k">def</span><span class="w"> </span><span class="nf">storage_ptr</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a><span class="sd">    Get the pointer to the underlying storage of a tensor of an ObjectArray.</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a><span class="sd">    Calling `storage_ptr(x)` is equivalent to `x.untyped_storage().data_ptr()`.</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a><span class="sd">        x: A regular PyTorch tensor, or a ReadOnlyTensor, or an ObjectArray.</span>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><span class="sd">        The address of the underlying storage.</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a>    <span class="k">return</span> <span class="n">_storage_ptr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.to_numpy_dtype" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_numpy_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.to_numpy_dtype" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Convert the given string or the given PyTorch dtype to a numpy dtype.
If the argument is already a numpy dtype, then the argument is returned
as it is.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.dtype">dtype</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dtype, converted to a numpy dtype.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_numpy_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">:</span> <span class="n">DType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    Convert the given string or the given PyTorch dtype to a numpy dtype.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    If the argument is already a numpy dtype, then the argument is returned</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    as it is.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        The dtype, converted to a numpy dtype.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">elif</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="k">return</span> <span class="n">dtype</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.to_stdev_init" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_stdev_init</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">solution_length</span><span class="p">,</span> <span class="n">stdev_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">radius_init</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.to_stdev_init" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Ask for both standard deviation and radius, return the standard deviation.</p>
<p>It is very common among the distribution-based search algorithms to ask
for both standard deviation and for radius for initializing the coverage
area of the search distribution. During their initialization phases,
these algorithms must check which one the user provided (radius or
standard deviation), and return the result as the standard deviation
so that a Gaussian distribution can easily be constructed.</p>
<p>This function serves as a helper function for such search algorithms
by performing these actions:</p>
<ul>
<li>If the user provided a standard deviation and not a radius, then this
  provided standard deviation is simply returned.</li>
<li>If the user provided a radius and not a standard deviation, then this
  provided radius is converted to its standard deviation counterpart,
  and then returned.</li>
<li>If both standard deviation and radius are missing, or they are both
  given at the same time, then an error is raised.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>solution_length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Length of a solution for the problem at hand.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stdev_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard deviation. If one wishes to provide a radius
instead, then <code>stdev_init</code> is expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radius_init</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="evotorch.tools.misc.RealOrVector">RealOrVector</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radius. If one wishes to provide a standard deviation
instead, then <code>radius_init</code> is expected as None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1925" name="__codelineno-0-1925"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_stdev_init</span><span class="p">(</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a>    <span class="n">solution_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a>    <span class="n">stdev_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a>    <span class="n">radius_init</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealOrVector</span><span class="p">:</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a><span class="sd">    Ask for both standard deviation and radius, return the standard deviation.</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a><span class="sd">    It is very common among the distribution-based search algorithms to ask</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a><span class="sd">    for both standard deviation and for radius for initializing the coverage</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a><span class="sd">    area of the search distribution. During their initialization phases,</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a><span class="sd">    these algorithms must check which one the user provided (radius or</span>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a><span class="sd">    standard deviation), and return the result as the standard deviation</span>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a><span class="sd">    so that a Gaussian distribution can easily be constructed.</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a><span class="sd">    This function serves as a helper function for such search algorithms</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a><span class="sd">    by performing these actions:</span>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a><span class="sd">    - If the user provided a standard deviation and not a radius, then this</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a><span class="sd">      provided standard deviation is simply returned.</span>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a><span class="sd">    - If the user provided a radius and not a standard deviation, then this</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a><span class="sd">      provided radius is converted to its standard deviation counterpart,</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a><span class="sd">      and then returned.</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a><span class="sd">    - If both standard deviation and radius are missing, or they are both</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a><span class="sd">      given at the same time, then an error is raised.</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a><span class="sd">        solution_length: Length of a solution for the problem at hand.</span>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a><span class="sd">        stdev_init: Standard deviation. If one wishes to provide a radius</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a><span class="sd">            instead, then `stdev_init` is expected as None.</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a><span class="sd">        radius_init: Radius. If one wishes to provide a standard deviation</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a><span class="sd">            instead, then `radius_init` is expected as None.</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a><span class="sd">        The standard deviation for the search distribution to be constructed.</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">stdev_init</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">radius_init</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a>        <span class="k">return</span> <span class="n">stdev_init</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">stdev_init</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">radius_init</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a>        <span class="k">return</span> <span class="n">stdev_from_radius</span><span class="p">(</span><span class="n">radius_init</span><span class="p">,</span> <span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">stdev_init</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">radius_init</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>            <span class="s2">&quot;Received both `stdev_init` and `radius_init` as None.&quot;</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>            <span class="s2">&quot; Please provide a value either for `stdev_init` or for `radius_init`.&quot;</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>        <span class="p">)</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>            <span class="s2">&quot;Found both `stdev_init` and `radius_init` with values other than None.&quot;</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>            <span class="s2">&quot; Please provide a value either for `stdev_init` or for `radius_init`, but not for both.&quot;</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="evotorch.tools.misc.to_torch_dtype" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span></code>

<a href="#evotorch.tools.misc.to_torch_dtype" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Convert the given string or the given numpy dtype to a PyTorch dtype.
If the argument is already a PyTorch dtype, then the argument is returned
as it is.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.dtype">dtype</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dtype, converted to a PyTorch dtype.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>evotorch/tools/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">:</span> <span class="n">DType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    Convert the given string or the given numpy dtype to a PyTorch dtype.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    If the argument is already a PyTorch dtype, then the argument is returned</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    as it is.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        The dtype, converted to a PyTorch dtype.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">torch</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">attrib_within_torch</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">torch</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">attrib_within_torch</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attrib_within_torch</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="k">return</span> <span class="n">attrib_within_torch</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">return</span> <span class="n">dtype</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">elif</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="n">Any</span> <span class="ow">or</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="nb">object</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot make a numeric tensor with dtype </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">))</span><span class="o">.</span><span class="n">dtype</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 NNAISENSE SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>