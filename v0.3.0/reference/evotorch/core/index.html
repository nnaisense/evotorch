
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="EvoTorch is an open source evolutionary computation library developed at NNAISENSE, built on top of PyTorch.">
      
      
      
      <link rel="icon" href="../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.1, mkdocs-material-8.5.7">
    
    
      
        <title>evotorch.core - EvoTorch</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#evotorch.core" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-header__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EvoTorch
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              evotorch.core
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../quickstart/" class="md-tabs__link">
      Quickstart
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../user_guide/general_usage/" class="md-tabs__link">
        User Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../advanced_usage/solution_batch/" class="md-tabs__link">
        Advanced Usage
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../examples/" class="md-tabs__link">
        Examples
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://evotorch.ai" title="EvoTorch" class="md-nav__button md-logo" aria-label="EvoTorch" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    EvoTorch
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nnaisense/evotorch" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    evotorch
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../quickstart/" class="md-nav__link">
        Quickstart
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/general_usage/" class="md-nav__link">
        General Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/algorithm_usage/" class="md-nav__link">
        Algorithm Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/algorithms_tour/" class="md-nav__link">
        Algorithms Tour
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/problems/" class="md-nav__link">
        Defining Problems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/problem_parallelization/" class="md-nav__link">
        Problem Parallelization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/logging/" class="md-nav__link">
        Using Logging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/neuroevolution/" class="md-nav__link">
        Neuroevolution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/gym/" class="md-nav__link">
        Neuroevolution for Gym
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/supervised_ne/" class="md-nav__link">
        Supervised Neuroevolution
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Advanced Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced Usage" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Advanced Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/solution_batch/" class="md-nav__link">
        Manipulating Solutions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/hooks/" class="md-nav__link">
        Using Hooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/dist_based/" class="md-nav__link">
        Distributed Evolution Strategies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/custom_ea/" class="md-nav__link">
        Custom Searchers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/custom_logger/" class="md-nav__link">
        Custom Loggers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced_usage/ray_cluster/" class="md-nav__link">
        Using Ray Clusters
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../examples/">Examples</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_2">
          Notebooks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Notebooks" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Notebooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Brax_Experiments_with_PGPE/" class="md-nav__link">
        Solving a Brax environment using EvoTorch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Gym_Experiments_with_PGPE_and_CoSyNE/" class="md-nav__link">
        Gym Experiments with PGPE and CoSyNE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Minimizing_Lennard-Jones_Atom_Cluster_Potentials/" class="md-nav__link">
        Minimising Lennard-Jones Atom Cluster Potentials with Evolution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Training_MNIST30K/" class="md-nav__link">
        Training MNIST30K
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/Variational_Quantum_Eigensolvers_with_SNES/" class="md-nav__link">
        Variational Quantum Eigensolvers with SNES
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/notebooks/reacher_mpc/" class="md-nav__link">
        Model Predictive Control (MPC) with EvoTorch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">API Reference</a>
          
            <label for="__nav_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" type="checkbox" id="__nav_6_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../algorithms/">evotorch.algorithms</a>
          
            <label for="__nav_6_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="evotorch.algorithms" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          evotorch.algorithms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/cmaes/" class="md-nav__link">
        cmaes
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2_3" type="checkbox" id="__nav_6_2_3" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../algorithms/distributed/">distributed</a>
          
            <label for="__nav_6_2_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="distributed" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_2_3">
          <span class="md-nav__icon md-icon"></span>
          distributed
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/distributed/gaussian/" class="md-nav__link">
        gaussian
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/ga/" class="md-nav__link">
        ga
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/searchalgorithm/" class="md-nav__link">
        searchalgorithm
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          evotorch.core
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        evotorch.core
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.core" class="md-nav__link">
    evotorch.core
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.ActorSeeds" class="md-nav__link">
    ActorSeeds
  </a>
  
    <nav class="md-nav" aria-label="ActorSeeds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ActorSeeds.__getnewargs__" class="md-nav__link">
    __getnewargs__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ActorSeeds.__new__" class="md-nav__link">
    __new__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ActorSeeds.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.AllRemoteEnvs" class="md-nav__link">
    AllRemoteEnvs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.AllRemoteProblems" class="md-nav__link">
    AllRemoteProblems
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.BoundsPair" class="md-nav__link">
    BoundsPair
  </a>
  
    <nav class="md-nav" aria-label="BoundsPair">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.BoundsPair.__getnewargs__" class="md-nav__link">
    __getnewargs__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.BoundsPair.__new__" class="md-nav__link">
    __new__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.BoundsPair.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.ParetoInfo" class="md-nav__link">
    ParetoInfo
  </a>
  
    <nav class="md-nav" aria-label="ParetoInfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ParetoInfo.__getnewargs__" class="md-nav__link">
    __getnewargs__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ParetoInfo.__new__" class="md-nav__link">
    __new__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ParetoInfo.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.Problem" class="md-nav__link">
    Problem
  </a>
  
    <nav class="md-nav" aria-label="Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.actor_index" class="md-nav__link">
    actor_index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.actors" class="md-nav__link">
    actors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.after_eval_hook" class="md-nav__link">
    after_eval_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.after_grad_hook" class="md-nav__link">
    after_grad_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.aux_device" class="md-nav__link">
    aux_device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.before_eval_hook" class="md-nav__link">
    before_eval_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.before_grad_hook" class="md-nav__link">
    before_grad_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.device" class="md-nav__link">
    device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.dtype" class="md-nav__link">
    dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.eval_data_length" class="md-nav__link">
    eval_data_length
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.eval_dtype" class="md-nav__link">
    eval_dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.generator" class="md-nav__link">
    generator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.has_own_generator" class="md-nav__link">
    has_own_generator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.initial_lower_bounds" class="md-nav__link">
    initial_lower_bounds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.initial_upper_bounds" class="md-nav__link">
    initial_upper_bounds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_main" class="md-nav__link">
    is_main
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_multi_objective" class="md-nav__link">
    is_multi_objective
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_remote" class="md-nav__link">
    is_remote
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_single_objective" class="md-nav__link">
    is_single_objective
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.lower_bounds" class="md-nav__link">
    lower_bounds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.num_actors" class="md-nav__link">
    num_actors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.objective_sense" class="md-nav__link">
    objective_sense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.remote_hook" class="md-nav__link">
    remote_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.senses" class="md-nav__link">
    senses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.solution_length" class="md-nav__link">
    solution_length
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.status" class="md-nav__link">
    status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.stores_solution_stats" class="md-nav__link">
    stores_solution_stats
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.upper_bounds" class="md-nav__link">
    upper_bounds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.all_remote_envs" class="md-nav__link">
    all_remote_envs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.all_remote_problems" class="md-nav__link">
    all_remote_problems()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.compare_solutions" class="md-nav__link">
    compare_solutions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.ensure_numeric" class="md-nav__link">
    ensure_numeric()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.ensure_single_objective" class="md-nav__link">
    ensure_single_objective()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.ensure_unbounded" class="md-nav__link">
    ensure_unbounded()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.evaluate" class="md-nav__link">
    evaluate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.generate_batch" class="md-nav__link">
    generate_batch()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.generate_values" class="md-nav__link">
    generate_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.get_obj_order_descending" class="md-nav__link">
    get_obj_order_descending()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_better" class="md-nav__link">
    is_better()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_on_cpu" class="md-nav__link">
    is_on_cpu()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_worse" class="md-nav__link">
    is_worse()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.kill_actors" class="md-nav__link">
    kill_actors()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.manual_seed" class="md-nav__link">
    manual_seed()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.normalize_obj_index" class="md-nav__link">
    normalize_obj_index()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.sample_and_compute_gradients" class="md-nav__link">
    sample_and_compute_gradients()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.RemoteMethod" class="md-nav__link">
    RemoteMethod
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.Solution" class="md-nav__link">
    Solution
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.device" class="md-nav__link">
    device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.dtype" class="md-nav__link">
    dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.eval_dtype" class="md-nav__link">
    eval_dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.eval_shape" class="md-nav__link">
    eval_shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.evals" class="md-nav__link">
    evals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.evaluation" class="md-nav__link">
    evaluation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.is_evaluated" class="md-nav__link">
    is_evaluated
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.ndim" class="md-nav__link">
    ndim
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.senses" class="md-nav__link">
    senses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.shape" class="md-nav__link">
    shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.values" class="md-nav__link">
    values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.access_evals" class="md-nav__link">
    access_evals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.access_values" class="md-nav__link">
    access_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.dim" class="md-nav__link">
    dim()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.objective_sense" class="md-nav__link">
    objective_sense()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.set_evals" class="md-nav__link">
    set_evals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.set_evaluation" class="md-nav__link">
    set_evaluation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.set_values" class="md-nav__link">
    set_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.size" class="md-nav__link">
    size()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.to" class="md-nav__link">
    to()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.to_batch" class="md-nav__link">
    to_batch()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch" class="md-nav__link">
    SolutionBatch
  </a>
  
    <nav class="md-nav" aria-label="SolutionBatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.device" class="md-nav__link">
    device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.dtype" class="md-nav__link">
    dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.eval_dtype" class="md-nav__link">
    eval_dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.eval_shape" class="md-nav__link">
    eval_shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.evals" class="md-nav__link">
    evals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.objective_sense" class="md-nav__link">
    objective_sense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.senses" class="md-nav__link">
    senses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.solution_length" class="md-nav__link">
    solution_length
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.values" class="md-nav__link">
    values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.values_dtype" class="md-nav__link">
    values_dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.values_shape" class="md-nav__link">
    values_shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.access_evals" class="md-nav__link">
    access_evals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.access_values" class="md-nav__link">
    access_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.arg_pareto_sort" class="md-nav__link">
    arg_pareto_sort()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.argbest" class="md-nav__link">
    argbest()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.argsort" class="md-nav__link">
    argsort()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.argworst" class="md-nav__link">
    argworst()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.cat" class="md-nav__link">
    cat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.concat" class="md-nav__link">
    concat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.forget_evals" class="md-nav__link">
    forget_evals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.set_evals" class="md-nav__link">
    set_evals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.set_values" class="md-nav__link">
    set_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.split" class="md-nav__link">
    split()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.take" class="md-nav__link">
    take()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.take_best" class="md-nav__link">
    take_best()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.to" class="md-nav__link">
    to()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.utility" class="md-nav__link">
    utility()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.utils" class="md-nav__link">
    utils()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchPieces" class="md-nav__link">
    SolutionBatchPieces
  </a>
  
    <nav class="md-nav" aria-label="SolutionBatchPieces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchPieces.batch" class="md-nav__link">
    batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchPieces.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchPieces.indices_of" class="md-nav__link">
    indices_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchPieces.iter_with_indices" class="md-nav__link">
    iter_with_indices()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchSliceInfo" class="md-nav__link">
    SolutionBatchSliceInfo
  </a>
  
    <nav class="md-nav" aria-label="SolutionBatchSliceInfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchSliceInfo.__getnewargs__" class="md-nav__link">
    __getnewargs__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchSliceInfo.__new__" class="md-nav__link">
    __new__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchSliceInfo.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../decorators/" class="md-nav__link">
        evotorch.decorators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../distributions/" class="md-nav__link">
        evotorch.distributions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        evotorch.logging
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_7" type="checkbox" id="__nav_6_7" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../neuroevolution/">evotorch.neuroevolution</a>
          
            <label for="__nav_6_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="evotorch.neuroevolution" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_7">
          <span class="md-nav__icon md-icon"></span>
          evotorch.neuroevolution
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/baseneproblem/" class="md-nav__link">
        baseneproblem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/gymne/" class="md-nav__link">
        gymne
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/neproblem/" class="md-nav__link">
        neproblem
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_7_5" type="checkbox" id="__nav_6_7_5" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../neuroevolution/net/">net</a>
          
            <label for="__nav_6_7_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="net" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_7_5">
          <span class="md-nav__icon md-icon"></span>
          net
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/functional/" class="md-nav__link">
        functional
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/layers/" class="md-nav__link">
        layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/misc/" class="md-nav__link">
        misc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/multilayered/" class="md-nav__link">
        multilayered
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/parser/" class="md-nav__link">
        parser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/rl/" class="md-nav__link">
        rl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/runningnorm/" class="md-nav__link">
        runningnorm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/runningstat/" class="md-nav__link">
        runningstat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/statefulmodule/" class="md-nav__link">
        statefulmodule
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/net/vecrl/" class="md-nav__link">
        vecrl
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/supervisedne/" class="md-nav__link">
        supervisedne
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../neuroevolution/vecgymne/" class="md-nav__link">
        vecgymne
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_8" type="checkbox" id="__nav_6_8" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../operators/">evotorch.operators</a>
          
            <label for="__nav_6_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="evotorch.operators" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_8">
          <span class="md-nav__icon md-icon"></span>
          evotorch.operators
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../operators/base/" class="md-nav__link">
        base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../operators/real/" class="md-nav__link">
        real
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../operators/sequence/" class="md-nav__link">
        sequence
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optimizers/" class="md-nav__link">
        evotorch.optimizers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        evotorch.testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_11" type="checkbox" id="__nav_6_11" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../tools/">evotorch.tools</a>
          
            <label for="__nav_6_11">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="evotorch.tools" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_11">
          <span class="md-nav__icon md-icon"></span>
          evotorch.tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/cloning/" class="md-nav__link">
        cloning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/hook/" class="md-nav__link">
        hook
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/immutable/" class="md-nav__link">
        immutable
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/misc/" class="md-nav__link">
        misc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/objectarray/" class="md-nav__link">
        objectarray
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/ranking/" class="md-nav__link">
        ranking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/readonlytensor/" class="md-nav__link">
        readonlytensor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/recursiveprintable/" class="md-nav__link">
        recursiveprintable
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/tensormaker/" class="md-nav__link">
        tensormaker
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#evotorch.core" class="md-nav__link">
    evotorch.core
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.ActorSeeds" class="md-nav__link">
    ActorSeeds
  </a>
  
    <nav class="md-nav" aria-label="ActorSeeds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ActorSeeds.__getnewargs__" class="md-nav__link">
    __getnewargs__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ActorSeeds.__new__" class="md-nav__link">
    __new__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ActorSeeds.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.AllRemoteEnvs" class="md-nav__link">
    AllRemoteEnvs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.AllRemoteProblems" class="md-nav__link">
    AllRemoteProblems
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.BoundsPair" class="md-nav__link">
    BoundsPair
  </a>
  
    <nav class="md-nav" aria-label="BoundsPair">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.BoundsPair.__getnewargs__" class="md-nav__link">
    __getnewargs__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.BoundsPair.__new__" class="md-nav__link">
    __new__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.BoundsPair.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.ParetoInfo" class="md-nav__link">
    ParetoInfo
  </a>
  
    <nav class="md-nav" aria-label="ParetoInfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ParetoInfo.__getnewargs__" class="md-nav__link">
    __getnewargs__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ParetoInfo.__new__" class="md-nav__link">
    __new__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.ParetoInfo.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.Problem" class="md-nav__link">
    Problem
  </a>
  
    <nav class="md-nav" aria-label="Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.actor_index" class="md-nav__link">
    actor_index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.actors" class="md-nav__link">
    actors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.after_eval_hook" class="md-nav__link">
    after_eval_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.after_grad_hook" class="md-nav__link">
    after_grad_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.aux_device" class="md-nav__link">
    aux_device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.before_eval_hook" class="md-nav__link">
    before_eval_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.before_grad_hook" class="md-nav__link">
    before_grad_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.device" class="md-nav__link">
    device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.dtype" class="md-nav__link">
    dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.eval_data_length" class="md-nav__link">
    eval_data_length
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.eval_dtype" class="md-nav__link">
    eval_dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.generator" class="md-nav__link">
    generator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.has_own_generator" class="md-nav__link">
    has_own_generator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.initial_lower_bounds" class="md-nav__link">
    initial_lower_bounds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.initial_upper_bounds" class="md-nav__link">
    initial_upper_bounds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_main" class="md-nav__link">
    is_main
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_multi_objective" class="md-nav__link">
    is_multi_objective
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_remote" class="md-nav__link">
    is_remote
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_single_objective" class="md-nav__link">
    is_single_objective
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.lower_bounds" class="md-nav__link">
    lower_bounds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.num_actors" class="md-nav__link">
    num_actors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.objective_sense" class="md-nav__link">
    objective_sense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.remote_hook" class="md-nav__link">
    remote_hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.senses" class="md-nav__link">
    senses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.solution_length" class="md-nav__link">
    solution_length
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.status" class="md-nav__link">
    status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.stores_solution_stats" class="md-nav__link">
    stores_solution_stats
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.upper_bounds" class="md-nav__link">
    upper_bounds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.all_remote_envs" class="md-nav__link">
    all_remote_envs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.all_remote_problems" class="md-nav__link">
    all_remote_problems()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.compare_solutions" class="md-nav__link">
    compare_solutions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.ensure_numeric" class="md-nav__link">
    ensure_numeric()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.ensure_single_objective" class="md-nav__link">
    ensure_single_objective()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.ensure_unbounded" class="md-nav__link">
    ensure_unbounded()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.evaluate" class="md-nav__link">
    evaluate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.generate_batch" class="md-nav__link">
    generate_batch()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.generate_values" class="md-nav__link">
    generate_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.get_obj_order_descending" class="md-nav__link">
    get_obj_order_descending()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_better" class="md-nav__link">
    is_better()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_on_cpu" class="md-nav__link">
    is_on_cpu()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.is_worse" class="md-nav__link">
    is_worse()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.kill_actors" class="md-nav__link">
    kill_actors()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.manual_seed" class="md-nav__link">
    manual_seed()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.normalize_obj_index" class="md-nav__link">
    normalize_obj_index()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Problem.sample_and_compute_gradients" class="md-nav__link">
    sample_and_compute_gradients()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.RemoteMethod" class="md-nav__link">
    RemoteMethod
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.Solution" class="md-nav__link">
    Solution
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.device" class="md-nav__link">
    device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.dtype" class="md-nav__link">
    dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.eval_dtype" class="md-nav__link">
    eval_dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.eval_shape" class="md-nav__link">
    eval_shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.evals" class="md-nav__link">
    evals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.evaluation" class="md-nav__link">
    evaluation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.is_evaluated" class="md-nav__link">
    is_evaluated
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.ndim" class="md-nav__link">
    ndim
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.senses" class="md-nav__link">
    senses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.shape" class="md-nav__link">
    shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.values" class="md-nav__link">
    values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.access_evals" class="md-nav__link">
    access_evals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.access_values" class="md-nav__link">
    access_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.dim" class="md-nav__link">
    dim()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.objective_sense" class="md-nav__link">
    objective_sense()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.set_evals" class="md-nav__link">
    set_evals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.set_evaluation" class="md-nav__link">
    set_evaluation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.set_values" class="md-nav__link">
    set_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.size" class="md-nav__link">
    size()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.to" class="md-nav__link">
    to()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.Solution.to_batch" class="md-nav__link">
    to_batch()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch" class="md-nav__link">
    SolutionBatch
  </a>
  
    <nav class="md-nav" aria-label="SolutionBatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.device" class="md-nav__link">
    device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.dtype" class="md-nav__link">
    dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.eval_dtype" class="md-nav__link">
    eval_dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.eval_shape" class="md-nav__link">
    eval_shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.evals" class="md-nav__link">
    evals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.objective_sense" class="md-nav__link">
    objective_sense
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.senses" class="md-nav__link">
    senses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.solution_length" class="md-nav__link">
    solution_length
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.values" class="md-nav__link">
    values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.values_dtype" class="md-nav__link">
    values_dtype
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.values_shape" class="md-nav__link">
    values_shape
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.access_evals" class="md-nav__link">
    access_evals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.access_values" class="md-nav__link">
    access_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.arg_pareto_sort" class="md-nav__link">
    arg_pareto_sort()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.argbest" class="md-nav__link">
    argbest()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.argsort" class="md-nav__link">
    argsort()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.argworst" class="md-nav__link">
    argworst()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.cat" class="md-nav__link">
    cat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.concat" class="md-nav__link">
    concat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.forget_evals" class="md-nav__link">
    forget_evals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.set_evals" class="md-nav__link">
    set_evals()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.set_values" class="md-nav__link">
    set_values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.split" class="md-nav__link">
    split()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.take" class="md-nav__link">
    take()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.take_best" class="md-nav__link">
    take_best()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.to" class="md-nav__link">
    to()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.utility" class="md-nav__link">
    utility()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatch.utils" class="md-nav__link">
    utils()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchPieces" class="md-nav__link">
    SolutionBatchPieces
  </a>
  
    <nav class="md-nav" aria-label="SolutionBatchPieces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchPieces.batch" class="md-nav__link">
    batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchPieces.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchPieces.indices_of" class="md-nav__link">
    indices_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchPieces.iter_with_indices" class="md-nav__link">
    iter_with_indices()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchSliceInfo" class="md-nav__link">
    SolutionBatchSliceInfo
  </a>
  
    <nav class="md-nav" aria-label="SolutionBatchSliceInfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchSliceInfo.__getnewargs__" class="md-nav__link">
    __getnewargs__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchSliceInfo.__new__" class="md-nav__link">
    __new__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evotorch.core.SolutionBatchSliceInfo.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/nnaisense/evotorch/edit/master/docs/src/evotorch/core.py" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>evotorch.core</h1>

<div class="doc doc-object doc-module">

<a id="evotorch.core"></a>
    <div class="doc doc-contents first">

      <p>Definitions of the core classes:
Problem, Solution, and SolutionBatch.</p>



  <div class="doc doc-children">













  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.ActorSeeds" class="doc doc-heading">
        <code>
ActorSeeds            (<span title="tuple">tuple</span>)
        </code>



<a href="#evotorch.core.ActorSeeds" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>ActorSeeds(py_global, np_global, torch_global, problem)</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.ActorSeeds.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.ActorSeeds.__getnewargs__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.ActorSeeds.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">py_global</span><span class="p">,</span> <span class="n">np_global</span><span class="p">,</span> <span class="n">torch_global</span><span class="p">,</span> <span class="n">problem</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#evotorch.core.ActorSeeds.__new__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Create new instance of ActorSeeds(py_global, np_global, torch_global, problem)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.ActorSeeds.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.ActorSeeds.__repr__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.AllRemoteEnvs" class="doc doc-heading">
        <code>
AllRemoteEnvs        </code>



<a href="#evotorch.core.AllRemoteEnvs" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Representation of all remote reinforcement learning instances
stored by the ray actors.</p>
<p>An instance of this class is to be obtained from a main
(i.e. non-remote) Problem object, as follows:</p>
<div class="highlight"><pre><span></span><code>remote_envs = my_problem.all_remote_envs()
</code></pre></div>
<p>A remote method f() on all remote environments can then
be executed as follows:</p>
<div class="highlight"><pre><span></span><code>results = remote_envs.f()
</code></pre></div>
<p>Given that there are <code>n</code> actors, <code>results</code> contains <code>n</code> objects,
the i-th object being the method's result from the i-th actor.
An alternative to the example above is like this:</p>
<div class="highlight"><pre><span></span><code>results = my_problem.all_remote_envs().f()
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span> <span class="nc">AllRemoteEnvs</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Representation of all remote reinforcement learning instances</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    stored by the ray actors.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    An instance of this class is to be obtained from a main</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    (i.e. non-remote) Problem object, as follows:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">        remote_envs = my_problem.all_remote_envs()</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    A remote method f() on all remote environments can then</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    be executed as follows:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">        results = remote_envs.f()</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    Given that there are `n` actors, `results` contains `n` objects,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    the i-th object being the method&#39;s result from the i-th actor.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">    An alternative to the example above is like this:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">        results = my_problem.all_remote_envs().f()</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actors</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="o">=</span> <span class="n">actors</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="k">return</span> <span class="n">RemoteMethod</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">,</span> <span class="n">on_env</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">













  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.AllRemoteProblems" class="doc doc-heading">
        <code>
AllRemoteProblems        </code>



<a href="#evotorch.core.AllRemoteProblems" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Representation of all remote problem instances stored by the ray actors.</p>
<p>An instance of this class is to be obtained from a main
(i.e. non-remote) Problem object, as follows:</p>
<div class="highlight"><pre><span></span><code>remote_probs = my_problem.all_remote_problems()
</code></pre></div>
<p>A remote method f() on all remote Problem instances can then
be executed as follows:</p>
<div class="highlight"><pre><span></span><code>results = remote_probs.f()
</code></pre></div>
<p>Given that there are <code>n</code> actors, <code>results</code> contains <code>n</code> objects,
the i-th object being the method's result from the i-th actor.
An alternative to the example above is like this:</p>
<div class="highlight"><pre><span></span><code>results = my_problem.all_remote_problems().f()
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span> <span class="nc">AllRemoteProblems</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Representation of all remote problem instances stored by the ray actors.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    An instance of this class is to be obtained from a main</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    (i.e. non-remote) Problem object, as follows:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">        remote_probs = my_problem.all_remote_problems()</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    A remote method f() on all remote Problem instances can then</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    be executed as follows:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">        results = remote_probs.f()</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    Given that there are `n` actors, `results` contains `n` objects,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    the i-th object being the method&#39;s result from the i-th actor.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    An alternative to the example above is like this:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">        results = my_problem.all_remote_problems().f()</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actors</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="o">=</span> <span class="n">actors</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>        <span class="k">return</span> <span class="n">RemoteMethod</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">













  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.BoundsPair" class="doc doc-heading">
        <code>
BoundsPair            (<span title="tuple">tuple</span>)
        </code>



<a href="#evotorch.core.BoundsPair" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>BoundsPair(lb, ub)</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.BoundsPair.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.BoundsPair.__getnewargs__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.BoundsPair.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#evotorch.core.BoundsPair.__new__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Create new instance of BoundsPair(lb, ub)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.BoundsPair.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.BoundsPair.__repr__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.ParetoInfo" class="doc doc-heading">
        <code>
ParetoInfo            (<span title="tuple">tuple</span>)
        </code>



<a href="#evotorch.core.ParetoInfo" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>ParetoInfo(fronts, ranks)</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.ParetoInfo.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.ParetoInfo.__getnewargs__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.ParetoInfo.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">fronts</span><span class="p">,</span> <span class="n">ranks</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#evotorch.core.ParetoInfo.__new__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Create new instance of ParetoInfo(fronts, ranks)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.ParetoInfo.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.ParetoInfo.__repr__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.Problem" class="doc doc-heading">
        <code>
Problem            (<a class="autorefs autorefs-internal" title="evotorch.tools.tensormaker.TensorMakerMixin" href="../tools/tensormaker/#evotorch.tools.tensormaker.TensorMakerMixin">TensorMakerMixin</a>, <a class="autorefs autorefs-internal" title="evotorch.tools.cloning.Serializable" href="../tools/cloning/#evotorch.tools.cloning.Serializable">Serializable</a>)
        </code>



<a href="#evotorch.core.Problem" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Representation of a problem to be optimized.</p>
<p>A problem can be defined via inheritance.</p>
<p>For example, let us consider a problem of minimizing the L2 norm
of a vector of length 10.</p>
<p>This problem can be defined as follows:</p>
<div class="highlight"><pre><span></span><code>from evotorch import Problem, SolutionBatch

class MinNorm(Problem):
    def __init__(self):

        # Main characteristics of the problem are specified
        # with the help of the `__init__` method of the Problem
        # class
        super().__init__(
            # This is a minimization problem
            objective_sense=&quot;min&quot;,

            # Length of a solution is 10
            solution_length=10,

            # Each element of a new solution is to be initialized
            # between -10.0 and 10.0
            initial_bounds=(-10.0, 10.0)
        )

    def _evaluate_batch(batch: SolutionBatch):
        # We override _evaluate_batch(...) to define how a solution
        # is evaluated.

        # Get the decision values as a ReadOnlyTensor
        values = batch.values

        # Compute the costs of the solutions, which, in the case of
        # this example, is the L2 norm
        costs = torch.linalg.norm(values, dim=-1)

        # Register the computed costs as the evaluation results of
        # the solutions
        batch.set_evals(costs)
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span> <span class="nc">Problem</span><span class="p">(</span><span class="n">TensorMakerMixin</span><span class="p">,</span> <span class="n">Serializable</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Representation of a problem to be optimized.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    A problem can be defined via inheritance.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    For example, let us consider a problem of minimizing the L2 norm</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    of a vector of length 10.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    This problem can be defined as follows:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">        from evotorch import Problem, SolutionBatch</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">        class MinNorm(Problem):</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">            def __init__(self):</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">                # Main characteristics of the problem are specified</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">                # with the help of the `__init__` method of the Problem</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">                # class</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">                super().__init__(</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">                    # This is a minimization problem</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">                    objective_sense=&quot;min&quot;,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">                    # Length of a solution is 10</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">                    solution_length=10,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">                    # Each element of a new solution is to be initialized</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="sd">                    # between -10.0 and 10.0</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">                    initial_bounds=(-10.0, 10.0)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">                )</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="sd">            def _evaluate_batch(batch: SolutionBatch):</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="sd">                # We override _evaluate_batch(...) to define how a solution</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="sd">                # is evaluated.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="sd">                # Get the decision values as a ReadOnlyTensor</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="sd">                values = batch.values</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="sd">                # Compute the costs of the solutions, which, in the case of</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="sd">                # this example, is the L2 norm</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="sd">                costs = torch.linalg.norm(values, dim=-1)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="sd">                # Register the computed costs as the evaluation results of</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="sd">                # the solutions</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="sd">                batch.set_evals(costs)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>        <span class="n">objective_sense</span><span class="p">:</span> <span class="n">ObjectiveSense</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>        <span class="n">objective_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>        <span class="n">initial_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundsPairLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>        <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundsPairLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>        <span class="n">solution_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>        <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>        <span class="n">eval_dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>        <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>        <span class="n">eval_data_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>        <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>        <span class="n">num_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>        <span class="n">actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>        <span class="n">num_gpus_per_actor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>        <span class="n">num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>        <span class="n">subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>        <span class="n">store_solution_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>        <span class="n">vectorized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>    <span class="p">):</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a><span class="sd">        `__init__(...)`: Initialize the Problem object.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a><span class="sd">            objective_sense: A string, or a sequence of strings.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a><span class="sd">                For a single-objective problem, a single string</span>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a><span class="sd">                (&quot;min&quot; or &quot;max&quot;, for minimization or maximization)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a><span class="sd">                is enough.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a><span class="sd">                For a problem with `n` objectives, a sequence</span>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a><span class="sd">                of strings, of length `n`, is required, each string</span>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a><span class="sd">                in the sequence being &quot;min&quot; or &quot;max&quot;.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a><span class="sd">                This argument specifies the goal of the optimization.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a><span class="sd">            initial_bounds: In which interval will the values of a</span>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a><span class="sd">                new solution will be initialized.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="sd">                Expected as a tuple, each element being either a</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="sd">                scalar, or a vector of length `n`, `n` being the</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="sd">                length of a solution.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a><span class="sd">                If a manual solution initialization is preferred</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a><span class="sd">                (instead of an interval-based initialization),</span>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a><span class="sd">                one can leave `initial_bounds` as None, and override</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a><span class="sd">                the `generate_values(...)` method instead in the</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="sd">                inheriting subclass.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a><span class="sd">            bounds: Interval in which all the solutions must always</span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a><span class="sd">                reside.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a><span class="sd">                Expected as a tuple, each element being either a</span>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a><span class="sd">                scalar, or a vector of length `n`, `n` being the</span>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a><span class="sd">                length of a solution.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a><span class="sd">                This argument is optional, and can be left as None</span>
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a><span class="sd">                if one does not wish to declare hard bounds on the</span>
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a><span class="sd">                decision values of the problem.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a><span class="sd">                If `bounds` is specified, `initial_bounds` is missing,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a><span class="sd">                and `generate_values(...)` is not overriden, then</span>
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a><span class="sd">                `bounds` will also serve as the `initial_bounds`.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a><span class="sd">            solution_length: Length of a solution.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a><span class="sd">                Required for all fixed-length numeric optimization</span>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a><span class="sd">                problems.</span>
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a><span class="sd">                For variable-length problems (which might or might not</span>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a><span class="sd">                be numeric), one is expected to leave `solution_length`</span>
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a><span class="sd">                as None, and declare `dtype` as `object`.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a><span class="sd">            dtype: dtype (data type) of the data stored by a solution.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a><span class="sd">                Can be given as a string (e.g. &quot;float32&quot;),</span>
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a><span class="sd">                or as a numpy dtype (e.g. `numpy.dtype(&quot;float32&quot;)`),</span>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a><span class="sd">                or as a PyTorch dtype (e.g. `torch.float32`).</span>
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a><span class="sd">                Alternatively, if the problem is variable-length</span>
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a><span class="sd">                and/or non-numeric, one is expected to declare `dtype`</span>
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a><span class="sd">                as `object`.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a><span class="sd">            eval_dtype: dtype to be used for storing the evaluations</span>
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a><span class="sd">                (or fitnesses, or scores, or costs, or losses)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a><span class="sd">                of the solutions.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a><span class="sd">                Can be given as a string (e.g. &quot;float32&quot;),</span>
<a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a><span class="sd">                or as a numpy dtype (e.g. `numpy.dtype(&quot;float32&quot;)`),</span>
<a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a><span class="sd">                or as a PyTorch dtype (e.g. `torch.float32`).</span>
<a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a><span class="sd">                `eval_dtype` must always refer to a &quot;float&quot; data type,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a><span class="sd">                therefore, `object` is not accepted as a valid `eval_dtype`.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a><span class="sd">                If `eval_dtype` is not specified (i.e. left as None),</span>
<a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a><span class="sd">                then the following actions are taken to determine the</span>
<a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a><span class="sd">                `eval_dtype`:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a><span class="sd">                if `dtype` is &quot;float16&quot;, `eval_dtype` becomes &quot;float16&quot;;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a><span class="sd">                if `dtype` is &quot;bfloat16&quot;, `eval_dtype` becomes &quot;bfloat16&quot;;</span>
<a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a><span class="sd">                if `dtype` is &quot;float32&quot;, `eval_dtype` becomes &quot;float32&quot;;</span>
<a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a><span class="sd">                if `dtype` is &quot;float64&quot;, `eval_dtype` becomes &quot;float64&quot;;</span>
<a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a><span class="sd">                and for any other `dtype`, `eval_dtype` becomes &quot;float32&quot;.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a><span class="sd">            device: Default device in which a new population will be</span>
<a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a><span class="sd">                generated. For non-numeric problems, this must be &quot;cpu&quot;.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a><span class="sd">                For numeric problems, this can be any device supported</span>
<a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a><span class="sd">                by PyTorch (e.g. &quot;cuda&quot;).</span>
<a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a><span class="sd">            eval_data_length: In addition to evaluation results</span>
<a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a><span class="sd">                (which are (un)fitnesses, or scores, or costs, or losses),</span>
<a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a><span class="sd">                each solution can store extra evaluation data.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a><span class="sd">                If storage of such extra evaluation data is required,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a><span class="sd">                one can set this argument to an integer bigger than 0.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a><span class="sd">            seed: Random seed to be used by the random number generator</span>
<a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a><span class="sd">                attached to the problem object.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a><span class="sd">                If left as None, no random number generator will be</span>
<a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a><span class="sd">                attached, and the global random number generator of</span>
<a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a><span class="sd">                PyTorch will be used instead.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a><span class="sd">            num_actors: Number of actors to create for parallelized</span>
<a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a><span class="sd">                evaluation of the solutions.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a><span class="sd">                Certain string values are also accepted.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a><span class="sd">                When given as &quot;max&quot; or as &quot;num_cpus&quot;, the number of actors</span>
<a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a><span class="sd">                will be equal to the number of all available CPUs in the ray</span>
<a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a><span class="sd">                cluster.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a><span class="sd">                When given as &quot;num_gpus&quot;, the number of actors will be</span>
<a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a><span class="sd">                equal to the number of all available GPUs in the ray</span>
<a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a><span class="sd">                cluster, and each actor will be assigned a GPU.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a><span class="sd">                There is also an option, &quot;num_devices&quot;, which means that</span>
<a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a><span class="sd">                both the numbers of CPUs and GPUs will be analyzed, and</span>
<a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a><span class="sd">                new actors and GPUs for them will be allocated,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a><span class="sd">                in a one-to-one mapping manner, if possible.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a><span class="sd">                In more details, with `num_actors=&quot;num_devices&quot;`, if</span>
<a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a><span class="sd">                `device` is given as a GPU device, then it will be inferred</span>
<a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a><span class="sd">                that the user wishes to put everything (including the</span>
<a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a><span class="sd">                population) on a single GPU, and therefore there won&#39;t be</span>
<a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a><span class="sd">                any allocation of actors nor GPUs.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a><span class="sd">                With `num_actors=&quot;num_devices&quot;` and with `device` set as</span>
<a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a><span class="sd">                &quot;cpu&quot; (or as left as None), if there are multiple CPUs</span>
<a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a><span class="sd">                and multiple GPUs, then `n` actors will be allocated</span>
<a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a><span class="sd">                where `n` is the minimum among the number of CPUs</span>
<a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a><span class="sd">                and the number of GPUs, so that there can be one-to-one</span>
<a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a><span class="sd">                mapping between CPUs and GPUs (i.e. such that each actor</span>
<a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a><span class="sd">                can be assigned an entire GPU).</span>
<a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a><span class="sd">                If `num_actors` is given as &quot;num_gpus&quot; or &quot;num_devices&quot;,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a><span class="sd">                the argument `num_gpus_per_actor` must not be used,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a><span class="sd">                and the `actor_config` dictionary must not contain the</span>
<a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a><span class="sd">                key &quot;num_gpus&quot;.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a><span class="sd">                If `num_actors` is given as something other than &quot;num_gpus&quot;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a><span class="sd">                or &quot;num_devices&quot;, and if you wish to assign GPUs to each</span>
<a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a><span class="sd">                actor, then please see the argument `num_gpus_per_actor`.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a><span class="sd">            actor_config: A dictionary, representing the keyword arguments</span>
<a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a><span class="sd">                to be passed to the options(...) used when creating the</span>
<a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a><span class="sd">                ray actor objects. To be used for explicitly allocating</span>
<a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a><span class="sd">                resources per each actor.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a><span class="sd">                For example, for declaring that each actor is to use a GPU,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a><span class="sd">                one can pass `actor_config=dict(num_gpus=1)`.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a><span class="sd">                Can also be given as None (which is the default),</span>
<a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a><span class="sd">                if no such options are to be passed.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a><span class="sd">            num_gpus_per_actor: Number of GPUs to be allocated by each</span>
<a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a><span class="sd">                remote actor.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a><span class="sd">                The default behavior is to NOT allocate any GPU at all</span>
<a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a><span class="sd">                (which is the default behavior of the ray library as well).</span>
<a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a><span class="sd">                When given as a number `n`, each actor will be given</span>
<a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a><span class="sd">                `n` GPUs (where `n` can be an integer, or can be a `float`</span>
<a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a><span class="sd">                for fractional allocation).</span>
<a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a><span class="sd">                When given as a string &quot;max&quot;, then the available GPUs</span>
<a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a><span class="sd">                across the entire ray cluster (or within the local computer</span>
<a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a><span class="sd">                in the simplest cases) will be equally distributed among</span>
<a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a><span class="sd">                the actors.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a><span class="sd">                When given as a string &quot;all&quot;, then each actor will have</span>
<a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a><span class="sd">                access to all the GPUs (this will be achieved by suppressing</span>
<a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a><span class="sd">                the environment variable `CUDA_VISIBLE_DEVICES` for each</span>
<a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a><span class="sd">                actor).</span>
<a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a><span class="sd">                When the problem is not distributed (i.e. when there are</span>
<a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a><span class="sd">                no actors), this argument is expected to be left as None.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a><span class="sd">            num_subbatches: If `num_subbatches` is None (assuming that</span>
<a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a><span class="sd">                `subbatch_size` is also None), then, when evaluating a</span>
<a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a><span class="sd">                population, the population will be split into n pieces, `n`</span>
<a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a><span class="sd">                being the number of actors, and each actor will evaluate</span>
<a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a><span class="sd">                its assigned piece. If `num_subbatches` is an integer `m`,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a><span class="sd">                then the population will be split into `m` pieces,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a><span class="sd">                and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a><span class="sd">                piece as they finish their current tasks.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a><span class="sd">                The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a><span class="sd">                be given values other than None at the same time.</span>
<a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a><span class="sd">                While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a><span class="sd">                how many sub-batches will be generated, and therefore,</span>
<a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a><span class="sd">                how many gradients will be computed by the remote actors.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a><span class="sd">            subbatch_size: If `subbatch_size` is None (assuming that</span>
<a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a><span class="sd">                `num_subbatches` is also None), then, when evaluating a</span>
<a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a><span class="sd">                population, the population will be split into `n` pieces, `n`</span>
<a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a><span class="sd">                being the number of actors, and each actor will evaluate its</span>
<a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a><span class="sd">                assigned piece. If `subbatch_size` is an integer `m`,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a><span class="sd">                then the population will be split into pieces of size `m`,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a><span class="sd">                and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a><span class="sd">                piece as they finish their current tasks.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a><span class="sd">                When there can be significant difference across the solutions</span>
<a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a><span class="sd">                in terms of computational requirements, specifying a</span>
<a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a><span class="sd">                `subbatch_size` can be beneficial, because, while one</span>
<a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a><span class="sd">                actor is busy with a subbatch containing computationally</span>
<a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a><span class="sd">                challenging solutions, other actors can accept more</span>
<a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a><span class="sd">                tasks and save time.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a><span class="sd">                The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a><span class="sd">                be given values other than None at the same time.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a><span class="sd">                While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a><span class="sd">                the size of a sub-batch (or sub-population) sampled by a</span>
<a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a><span class="sd">                remote actor for computing a gradient.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a><span class="sd">                In distributed mode, it is expected that the population size</span>
<a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a><span class="sd">                is divisible by `subbatch_size`.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a><span class="sd">            store_solution_stats: Whether or not the problem object should</span>
<a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a><span class="sd">                keep track of the best and worst solutions.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a><span class="sd">                Can also be left as None (which is the default behavior),</span>
<a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a><span class="sd">                in which case, it will store the best and worst solutions</span>
<a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a><span class="sd">                only when the first solution batch it encounters is on the</span>
<a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a><span class="sd">                cpu. This default behavior is to ensure that there is no</span>
<a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a><span class="sd">                transfer between the cpu and a foreign computation device</span>
<a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a><span class="sd">                (like the gpu) just for the sake of keeping the best and</span>
<a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a><span class="sd">                the worst solutions.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a>        <span class="c1"># Set the dtype for the decision variables of the Problem</span>
<a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a>        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span>
<a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a>        <span class="k">elif</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="nb">object</span>
<a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a>        <span class="c1"># Set the dtype for the solution evaluations (i.e. fitnesses and evaluation data)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a>        <span class="k">if</span> <span class="n">eval_dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a>            <span class="c1"># If an `eval_dtype` is explicitly stated, then accept it as the `_eval_dtype` of the Problem</span>
<a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_eval_dtype</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">eval_dtype</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a>            <span class="c1"># This is the case where an `eval_dtype` is not explicitly stated by the user.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a>            <span class="c1"># We need to choose a default.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="ow">in</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
<a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a>                <span class="c1"># If the `dtype` of the problem is a non-32-bit float type (i.e. float16, bfloat16, float64)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a>                <span class="c1"># then we use that as our `_eval_dtype` as well.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_eval_dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>
<a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a>                <span class="c1"># For any other `dtype`, we use float32 as our `_eval_dtype`.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_eval_dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span>
<a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a>        <span class="c1"># Set the main device of the Problem object</span>
<a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a>        <span class="c1"># Declare the internal variable that might store the random number generator</span>
<a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a>        <span class="c1"># Set the seed of the Problem object, if a seed is provided</span>
<a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a>        <span class="c1"># Declare the internal variables that will store the bounds and the solution length</span>
<a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_lower_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_upper_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lower_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_upper_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_solution_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="ow">is</span> <span class="nb">object</span><span class="p">:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a>            <span class="c1"># If dtype is given as `object`, then there are some runtime sanity checks to perform</span>
<a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a>            <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">initial_bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a>                <span class="c1"># With dtype as object, if bounds are given then we raise an error.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a>                <span class="c1"># This is because the `object` dtype implies that the decision values are not necessarily numeric,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a>                <span class="c1"># and therefore, we cannot have the guarantee of satisfying numeric bounds.</span>
<a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a>                    <span class="sa">f</span><span class="s2">&quot;With dtype as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">, expected to receive `initial_bounds` and/or `bounds` as None.&quot;</span>
<a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a>                    <span class="sa">f</span><span class="s2">&quot; However, one or both of them is/are set as value(s) other than None.&quot;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a>                <span class="p">)</span>
<a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a>            <span class="k">if</span> <span class="n">solution_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a>                <span class="c1"># With dtype as object, if `solution_length` is provided, then we raise an error.</span>
<a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a>                <span class="c1"># This is because the `object` dtype implies that the solutions can be expressed via various</span>
<a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a>                <span class="c1"># containers, each with its own length, and therefore, a fixed solution length cannot be guaranteed.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a>                    <span class="sa">f</span><span class="s2">&quot;With dtype as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">, expected to receive `solution_length` as None.&quot;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a>                    <span class="sa">f</span><span class="s2">&quot; However, received `solution_length` as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">solution_length</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a>                <span class="p">)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a>            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_device</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a>                <span class="c1"># With dtype as object, if `device` is something other than &quot;cpu&quot;, then we raise an error.</span>
<a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a>                <span class="c1"># This is because the `object` dtype implies that the decision values are stored by an ObjectArray,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a>                <span class="c1"># whose device is always &quot;cpu&quot;.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a>                    <span class="sa">f</span><span class="s2">&quot;With dtype as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">, expected to receive `device` as &#39;cpu&#39;.&quot;</span>
<a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a>                    <span class="sa">f</span><span class="s2">&quot; However, received `device` as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">device</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a>                <span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313" href="#__codelineno-0-313"></a>            <span class="c1"># If dtype is something other than `object`, then we need to properly store the given numeric bounds,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314" href="#__codelineno-0-314"></a>            <span class="c1"># and also perform some sanity checks.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315" href="#__codelineno-0-315"></a>            <span class="n">initbnd_tuple_name</span> <span class="o">=</span> <span class="s2">&quot;initial_bounds&quot;</span>
<a id="__codelineno-0-316" name="__codelineno-0-316" href="#__codelineno-0-316"></a>            <span class="n">bnd_tuple_name</span> <span class="o">=</span> <span class="s2">&quot;bounds&quot;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317" href="#__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318" href="#__codelineno-0-318"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">initial_bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-319" name="__codelineno-0-319" href="#__codelineno-0-319"></a>                <span class="c1"># With a numeric dtype, if no boundary is provided at all, then we cannot know how to initialize</span>
<a id="__codelineno-0-320" name="__codelineno-0-320" href="#__codelineno-0-320"></a>                <span class="c1"># the solutions. With such a lack of information, we raise an error.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321" href="#__codelineno-0-321"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-322" name="__codelineno-0-322" href="#__codelineno-0-322"></a>                    <span class="sa">f</span><span class="s2">&quot;Together with a numeric dtype (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">),&quot;</span>
<a id="__codelineno-0-323" name="__codelineno-0-323" href="#__codelineno-0-323"></a>                    <span class="sa">f</span><span class="s2">&quot; expected to receive `initial_bounds` and/or `bounds` as something other than None.&quot;</span>
<a id="__codelineno-0-324" name="__codelineno-0-324" href="#__codelineno-0-324"></a>                    <span class="sa">f</span><span class="s2">&quot; However, both `initial_bounds` and `bounds` are None.&quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325" href="#__codelineno-0-325"></a>                <span class="p">)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326" href="#__codelineno-0-326"></a>            <span class="k">elif</span> <span class="p">(</span><span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">initial_bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-327" name="__codelineno-0-327" href="#__codelineno-0-327"></a>                <span class="c1"># With a numeric dtype, if strict bounds are given but initial bounds are not given, then we assume</span>
<a id="__codelineno-0-328" name="__codelineno-0-328" href="#__codelineno-0-328"></a>                <span class="c1"># that the strict bounds also serve as the initial bounds.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329" href="#__codelineno-0-329"></a>                <span class="c1"># Therefore, we take clones of the strict bounds and use this clones as the initial bounds.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330" href="#__codelineno-0-330"></a>                <span class="n">initial_bounds</span> <span class="o">=</span> <span class="n">clone</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331" href="#__codelineno-0-331"></a>                <span class="n">initbnd_tuple_name</span> <span class="o">=</span> <span class="s2">&quot;bounds&quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332" href="#__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333" href="#__codelineno-0-333"></a>            <span class="k">if</span> <span class="n">solution_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334" href="#__codelineno-0-334"></a>                <span class="c1"># With a numeric dtype, if solution length is missing, then we raise an error.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335" href="#__codelineno-0-335"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-336" name="__codelineno-0-336" href="#__codelineno-0-336"></a>                    <span class="sa">f</span><span class="s2">&quot;Together with a numeric dtype (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">),&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337" href="#__codelineno-0-337"></a>                    <span class="sa">f</span><span class="s2">&quot; expected to receive `solution_length` as an integer.&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338" href="#__codelineno-0-338"></a>                    <span class="sa">f</span><span class="s2">&quot; However, `solution_length` is None.&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339" href="#__codelineno-0-339"></a>                <span class="p">)</span>
<a id="__codelineno-0-340" name="__codelineno-0-340" href="#__codelineno-0-340"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341" href="#__codelineno-0-341"></a>                <span class="c1"># With a numeric dtype, if a solution length is provided, we make sure that it is integer.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342" href="#__codelineno-0-342"></a>                <span class="n">solution_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-343" name="__codelineno-0-343" href="#__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344" href="#__codelineno-0-344"></a>            <span class="c1"># Store the solution length</span>
<a id="__codelineno-0-345" name="__codelineno-0-345" href="#__codelineno-0-345"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_solution_length</span> <span class="o">=</span> <span class="n">solution_length</span>
<a id="__codelineno-0-346" name="__codelineno-0-346" href="#__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347" href="#__codelineno-0-347"></a>            <span class="c1"># Below is an internal helper function for some common operations for the (strict) bounds</span>
<a id="__codelineno-0-348" name="__codelineno-0-348" href="#__codelineno-0-348"></a>            <span class="c1"># and for the initial bounds.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349" href="#__codelineno-0-349"></a>            <span class="k">def</span> <span class="nf">process_bounds</span><span class="p">(</span><span class="n">bounds_tuple</span><span class="p">:</span> <span class="n">BoundsPairLike</span><span class="p">,</span> <span class="n">tuple_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BoundsPair</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350" href="#__codelineno-0-350"></a>                <span class="c1"># This function receives the bounds_tuple (a tuple containing lower and upper bounds),</span>
<a id="__codelineno-0-351" name="__codelineno-0-351" href="#__codelineno-0-351"></a>                <span class="c1"># and the string name of the bounds argument (&quot;bounds&quot; or &quot;initial_bounds&quot;).</span>
<a id="__codelineno-0-352" name="__codelineno-0-352" href="#__codelineno-0-352"></a>                <span class="c1"># What is returned is the bounds expressed as PyTorch tensors in the correct dtype and device.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353" href="#__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354" href="#__codelineno-0-354"></a>                <span class="k">nonlocal</span> <span class="n">solution_length</span>
<a id="__codelineno-0-355" name="__codelineno-0-355" href="#__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356" href="#__codelineno-0-356"></a>                <span class="c1"># Extract the lower and upper bounds from the received bounds tuple.</span>
<a id="__codelineno-0-357" name="__codelineno-0-357" href="#__codelineno-0-357"></a>                <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">bounds_tuple</span>
<a id="__codelineno-0-358" name="__codelineno-0-358" href="#__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359" href="#__codelineno-0-359"></a>                <span class="c1"># Make sure that the lower and upper bounds are expressed as tensors of correct dtype and device.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360" href="#__codelineno-0-360"></a>                <span class="n">lb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_tensor</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361" href="#__codelineno-0-361"></a>                <span class="n">ub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_tensor</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362" href="#__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363" href="#__codelineno-0-363"></a>                <span class="k">for</span> <span class="n">bound_array</span> <span class="ow">in</span> <span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">):</span>  <span class="c1"># For each boundary tensor (lb and ub)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364" href="#__codelineno-0-364"></a>                    <span class="k">if</span> <span class="n">bound_array</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-365" name="__codelineno-0-365" href="#__codelineno-0-365"></a>                        <span class="c1"># If the boundary tensor is not as scalar and is not a 1-dimensional vector, then raise an</span>
<a id="__codelineno-0-366" name="__codelineno-0-366" href="#__codelineno-0-366"></a>                        <span class="c1"># error.</span>
<a id="__codelineno-0-367" name="__codelineno-0-367" href="#__codelineno-0-367"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368" href="#__codelineno-0-368"></a>                            <span class="sa">f</span><span class="s2">&quot;Lower and upper bounds are expected as scalars or as 1-dimensional vectors.&quot;</span>
<a id="__codelineno-0-369" name="__codelineno-0-369" href="#__codelineno-0-369"></a>                            <span class="sa">f</span><span class="s2">&quot; However, these given boundaries have incompatible shape:&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370" href="#__codelineno-0-370"></a>                            <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">bound_array</span><span class="si">}</span><span class="s2"> (of shape </span><span class="si">{</span><span class="n">bound_array</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-371" name="__codelineno-0-371" href="#__codelineno-0-371"></a>                        <span class="p">)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372" href="#__codelineno-0-372"></a>                    <span class="k">if</span> <span class="n">bound_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-373" name="__codelineno-0-373" href="#__codelineno-0-373"></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bound_array</span><span class="p">)</span> <span class="o">!=</span> <span class="n">solution_length</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374" href="#__codelineno-0-374"></a>                            <span class="c1"># In the case where the boundary tensor is a 1-dimensional vector, if this vector&#39;s length</span>
<a id="__codelineno-0-375" name="__codelineno-0-375" href="#__codelineno-0-375"></a>                            <span class="c1"># is not equal to the solution length, then we raise an error.</span>
<a id="__codelineno-0-376" name="__codelineno-0-376" href="#__codelineno-0-376"></a>                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-377" name="__codelineno-0-377" href="#__codelineno-0-377"></a>                                <span class="sa">f</span><span class="s2">&quot;When boundaries are expressed as 1-dimensional vectors, their length are&quot;</span>
<a id="__codelineno-0-378" name="__codelineno-0-378" href="#__codelineno-0-378"></a>                                <span class="sa">f</span><span class="s2">&quot; expected as the solution length of the Problem object.&quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379" href="#__codelineno-0-379"></a>                                <span class="sa">f</span><span class="s2">&quot; However, while the problem&#39;s solution length is </span><span class="si">{</span><span class="n">solution_length</span><span class="si">}</span><span class="s2">,&quot;</span>
<a id="__codelineno-0-380" name="__codelineno-0-380" href="#__codelineno-0-380"></a>                                <span class="sa">f</span><span class="s2">&quot; these given boundaries have incompatible length:&quot;</span>
<a id="__codelineno-0-381" name="__codelineno-0-381" href="#__codelineno-0-381"></a>                                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">bound_array</span><span class="si">}</span><span class="s2"> (of length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bound_array</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382" href="#__codelineno-0-382"></a>                            <span class="p">)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383" href="#__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384" href="#__codelineno-0-384"></a>                <span class="c1"># Return the processed forms of the lower and upper boundary tensors.</span>
<a id="__codelineno-0-385" name="__codelineno-0-385" href="#__codelineno-0-385"></a>                <span class="k">return</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span>
<a id="__codelineno-0-386" name="__codelineno-0-386" href="#__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387" href="#__codelineno-0-387"></a>            <span class="c1"># Process the initial bounds with the help of the internal function `process_bounds(...)`</span>
<a id="__codelineno-0-388" name="__codelineno-0-388" href="#__codelineno-0-388"></a>            <span class="n">init_lb</span><span class="p">,</span> <span class="n">init_ub</span> <span class="o">=</span> <span class="n">process_bounds</span><span class="p">(</span><span class="n">initial_bounds</span><span class="p">,</span> <span class="n">initbnd_tuple_name</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389" href="#__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390" href="#__codelineno-0-390"></a>            <span class="c1"># Store the processed initial bounds</span>
<a id="__codelineno-0-391" name="__codelineno-0-391" href="#__codelineno-0-391"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_initial_lower_bounds</span> <span class="o">=</span> <span class="n">init_lb</span>
<a id="__codelineno-0-392" name="__codelineno-0-392" href="#__codelineno-0-392"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_initial_upper_bounds</span> <span class="o">=</span> <span class="n">init_ub</span>
<a id="__codelineno-0-393" name="__codelineno-0-393" href="#__codelineno-0-393"></a>
<a id="__codelineno-0-394" name="__codelineno-0-394" href="#__codelineno-0-394"></a>            <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395" href="#__codelineno-0-395"></a>                <span class="c1"># If there are strict bounds, then process those bounds with the help of `process_bounds(...)`.</span>
<a id="__codelineno-0-396" name="__codelineno-0-396" href="#__codelineno-0-396"></a>                <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">process_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">bnd_tuple_name</span><span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397" href="#__codelineno-0-397"></a>                <span class="c1"># Store the processed bounds</span>
<a id="__codelineno-0-398" name="__codelineno-0-398" href="#__codelineno-0-398"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_lower_bounds</span> <span class="o">=</span> <span class="n">lb</span>
<a id="__codelineno-0-399" name="__codelineno-0-399" href="#__codelineno-0-399"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_upper_bounds</span> <span class="o">=</span> <span class="n">ub</span>
<a id="__codelineno-0-400" name="__codelineno-0-400" href="#__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401" href="#__codelineno-0-401"></a>        <span class="c1"># Annotate the variable that will store the objective sense(s) of the problem</span>
<a id="__codelineno-0-402" name="__codelineno-0-402" href="#__codelineno-0-402"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_objective_sense</span><span class="p">:</span> <span class="n">ObjectiveSense</span>
<a id="__codelineno-0-403" name="__codelineno-0-403" href="#__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404" href="#__codelineno-0-404"></a>        <span class="c1"># Below is an internal function which makes sure that a provided objective sense has a valid value</span>
<a id="__codelineno-0-405" name="__codelineno-0-405" href="#__codelineno-0-405"></a>        <span class="c1"># (where valid values are &quot;min&quot; or &quot;max&quot;)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406" href="#__codelineno-0-406"></a>        <span class="k">def</span> <span class="nf">validate_sense</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-407" name="__codelineno-0-407" href="#__codelineno-0-407"></a>            <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">):</span>
<a id="__codelineno-0-408" name="__codelineno-0-408" href="#__codelineno-0-408"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-409" name="__codelineno-0-409" href="#__codelineno-0-409"></a>                    <span class="sa">f</span><span class="s2">&quot;Invalid objective sense: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-410" name="__codelineno-0-410" href="#__codelineno-0-410"></a>                    <span class="sa">f</span><span class="s2">&quot;Instead, please provide the objective sense as &#39;min&#39; or &#39;max&#39;.&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411" href="#__codelineno-0-411"></a>                <span class="p">)</span>
<a id="__codelineno-0-412" name="__codelineno-0-412" href="#__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413" href="#__codelineno-0-413"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">):</span>
<a id="__codelineno-0-414" name="__codelineno-0-414" href="#__codelineno-0-414"></a>            <span class="c1"># If the provided objective sense is not a sequence, then convert it to a single-element list</span>
<a id="__codelineno-0-415" name="__codelineno-0-415" href="#__codelineno-0-415"></a>            <span class="n">senses</span> <span class="o">=</span> <span class="p">[</span><span class="n">objective_sense</span><span class="p">]</span>
<a id="__codelineno-0-416" name="__codelineno-0-416" href="#__codelineno-0-416"></a>            <span class="n">num_senses</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-417" name="__codelineno-0-417" href="#__codelineno-0-417"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418" href="#__codelineno-0-418"></a>            <span class="c1"># If the provided objective sense is a sequence, then take a list copy of it</span>
<a id="__codelineno-0-419" name="__codelineno-0-419" href="#__codelineno-0-419"></a>            <span class="n">senses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420" href="#__codelineno-0-420"></a>            <span class="n">num_senses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span>
<a id="__codelineno-0-421" name="__codelineno-0-421" href="#__codelineno-0-421"></a>
<a id="__codelineno-0-422" name="__codelineno-0-422" href="#__codelineno-0-422"></a>            <span class="c1"># Ensure that each provided objective sense is valid</span>
<a id="__codelineno-0-423" name="__codelineno-0-423" href="#__codelineno-0-423"></a>            <span class="k">for</span> <span class="n">sense</span> <span class="ow">in</span> <span class="n">senses</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424" href="#__codelineno-0-424"></a>                <span class="n">validate_sense</span><span class="p">(</span><span class="n">sense</span><span class="p">)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425" href="#__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426" href="#__codelineno-0-426"></a>            <span class="k">if</span> <span class="n">num_senses</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-427" name="__codelineno-0-427" href="#__codelineno-0-427"></a>                <span class="c1"># If the given sequence of objective senses is empty, then we raise an error.</span>
<a id="__codelineno-0-428" name="__codelineno-0-428" href="#__codelineno-0-428"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-429" name="__codelineno-0-429" href="#__codelineno-0-429"></a>                    <span class="s2">&quot;Encountered an empty sequence via `objective_sense`.&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430" href="#__codelineno-0-430"></a>                    <span class="s2">&quot; For a single-objective problem, please set `objective_sense` as &#39;min&#39; or &#39;max&#39;.&quot;</span>
<a id="__codelineno-0-431" name="__codelineno-0-431" href="#__codelineno-0-431"></a>                    <span class="s2">&quot; For a multi-objective problem, please set `objective_sense` as a sequence,&quot;</span>
<a id="__codelineno-0-432" name="__codelineno-0-432" href="#__codelineno-0-432"></a>                    <span class="s2">&quot; each element being &#39;min&#39; or &#39;max&#39;.&quot;</span>
<a id="__codelineno-0-433" name="__codelineno-0-433" href="#__codelineno-0-433"></a>                <span class="p">)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434" href="#__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435" href="#__codelineno-0-435"></a>        <span class="c1"># Store the objective senses</span>
<a id="__codelineno-0-436" name="__codelineno-0-436" href="#__codelineno-0-436"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_senses</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">senses</span>
<a id="__codelineno-0-437" name="__codelineno-0-437" href="#__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438" href="#__codelineno-0-438"></a>        <span class="c1"># Store the provided objective function (which can be None)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439" href="#__codelineno-0-439"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_objective_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="n">objective_func</span>
<a id="__codelineno-0-440" name="__codelineno-0-440" href="#__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441" href="#__codelineno-0-441"></a>        <span class="c1"># Store the information which indicates whether or not the given objective function is vectorized</span>
<a id="__codelineno-0-442" name="__codelineno-0-442" href="#__codelineno-0-442"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_vectorized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">vectorized</span><span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443" href="#__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444" href="#__codelineno-0-444"></a>        <span class="c1"># If the evaluation data length is explicitly stated, then convert it to an integer and store it.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445" href="#__codelineno-0-445"></a>        <span class="c1"># Otherwise, store the evaluation data length as 0.</span>
<a id="__codelineno-0-446" name="__codelineno-0-446" href="#__codelineno-0-446"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_eval_data_length</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">eval_data_length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">eval_data_length</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447" href="#__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448" href="#__codelineno-0-448"></a>        <span class="c1"># Initialize the actor index.</span>
<a id="__codelineno-0-449" name="__codelineno-0-449" href="#__codelineno-0-449"></a>        <span class="c1"># If the problem is configured to be parallelized and the parallelization is triggered, then each remote</span>
<a id="__codelineno-0-450" name="__codelineno-0-450" href="#__codelineno-0-450"></a>        <span class="c1"># copy will have a different integer value for `_actor_index`.</span>
<a id="__codelineno-0-451" name="__codelineno-0-451" href="#__codelineno-0-451"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-452" name="__codelineno-0-452" href="#__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453" href="#__codelineno-0-453"></a>        <span class="c1"># Initialize the variable that might store the list of actors as None.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454" href="#__codelineno-0-454"></a>        <span class="c1"># If the problem is configured to be parallelized and the parallelization is triggered, then this variable</span>
<a id="__codelineno-0-455" name="__codelineno-0-455" href="#__codelineno-0-455"></a>        <span class="c1"># will store references to the remote actors (each remote actor storing its own copy of this Problem</span>
<a id="__codelineno-0-456" name="__codelineno-0-456" href="#__codelineno-0-456"></a>        <span class="c1"># instance).</span>
<a id="__codelineno-0-457" name="__codelineno-0-457" href="#__codelineno-0-457"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-458" name="__codelineno-0-458" href="#__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459" href="#__codelineno-0-459"></a>        <span class="c1"># Initialize the variable that might store the ray ActorPool.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460" href="#__codelineno-0-460"></a>        <span class="c1"># If the problem is configured to be parallelized and the parallelization is triggered, then this variable</span>
<a id="__codelineno-0-461" name="__codelineno-0-461" href="#__codelineno-0-461"></a>        <span class="c1"># will store the ray ActorPool that is generated out of the remote actors.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462" href="#__codelineno-0-462"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_pool</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ActorPool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-463" name="__codelineno-0-463" href="#__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464" href="#__codelineno-0-464"></a>        <span class="c1"># Store the ray actor configuration dictionary provided by the user (if any).</span>
<a id="__codelineno-0-465" name="__codelineno-0-465" href="#__codelineno-0-465"></a>        <span class="c1"># When (or if) the parallelization is triggered, each actor will be created with this given configuration.</span>
<a id="__codelineno-0-466" name="__codelineno-0-466" href="#__codelineno-0-466"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">actor_config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">deepcopy</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">actor_config</span><span class="p">))</span>
<a id="__codelineno-0-467" name="__codelineno-0-467" href="#__codelineno-0-467"></a>
<a id="__codelineno-0-468" name="__codelineno-0-468" href="#__codelineno-0-468"></a>        <span class="c1"># If given, store the sub-batch size or number of sub-batches.</span>
<a id="__codelineno-0-469" name="__codelineno-0-469" href="#__codelineno-0-469"></a>        <span class="c1"># When the problem is parallelized, a sub-batch size determines the maximum size for a SolutionBatch</span>
<a id="__codelineno-0-470" name="__codelineno-0-470" href="#__codelineno-0-470"></a>        <span class="c1"># that will be sent to a remote actor for parallel solution evaluation.</span>
<a id="__codelineno-0-471" name="__codelineno-0-471" href="#__codelineno-0-471"></a>        <span class="c1"># Alternatively, num_subbatches determines into how many pieces will a SolutionBatch be split</span>
<a id="__codelineno-0-472" name="__codelineno-0-472" href="#__codelineno-0-472"></a>        <span class="c1"># for parallelization.</span>
<a id="__codelineno-0-473" name="__codelineno-0-473" href="#__codelineno-0-473"></a>        <span class="c1"># If both are None, then the main SolutionBatch will be split among the actors.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474" href="#__codelineno-0-474"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">num_subbatches</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">subbatch_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-475" name="__codelineno-0-475" href="#__codelineno-0-475"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-476" name="__codelineno-0-476" href="#__codelineno-0-476"></a>                <span class="sa">f</span><span class="s2">&quot;Encountered both `num_subbatches` and `subbatch_size` as values other than None.&quot;</span>
<a id="__codelineno-0-477" name="__codelineno-0-477" href="#__codelineno-0-477"></a>                <span class="sa">f</span><span class="s2">&quot; num_subbatches=</span><span class="si">{</span><span class="n">num_subbatches</span><span class="si">}</span><span class="s2">, subbatch_size=</span><span class="si">{</span><span class="n">subbatch_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-478" name="__codelineno-0-478" href="#__codelineno-0-478"></a>                <span class="sa">f</span><span class="s2">&quot; Having both of them as values other than None cannot be accepted.&quot;</span>
<a id="__codelineno-0-479" name="__codelineno-0-479" href="#__codelineno-0-479"></a>            <span class="p">)</span>
<a id="__codelineno-0-480" name="__codelineno-0-480" href="#__codelineno-0-480"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">num_subbatches</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_subbatches</span><span class="p">)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481" href="#__codelineno-0-481"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">subbatch_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">subbatch_size</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482" href="#__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483" href="#__codelineno-0-483"></a>        <span class="c1"># Initialize the additional states to be loaded by the remote actor as None.</span>
<a id="__codelineno-0-484" name="__codelineno-0-484" href="#__codelineno-0-484"></a>        <span class="c1"># If there are such additional states for remote actors, the inheriting class can fill this as a list</span>
<a id="__codelineno-0-485" name="__codelineno-0-485" href="#__codelineno-0-485"></a>        <span class="c1"># of dictionaries.</span>
<a id="__codelineno-0-486" name="__codelineno-0-486" href="#__codelineno-0-486"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_remote_states</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-487" name="__codelineno-0-487" href="#__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488" href="#__codelineno-0-488"></a>        <span class="c1"># Initialize a temporary internal variable which stores the resources available in the ray cluster.</span>
<a id="__codelineno-0-489" name="__codelineno-0-489" href="#__codelineno-0-489"></a>        <span class="c1"># Most probably, we are interested in the resources &quot;CPU&quot; and &quot;GPU&quot;.</span>
<a id="__codelineno-0-490" name="__codelineno-0-490" href="#__codelineno-0-490"></a>        <span class="n">ray_resources</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-491" name="__codelineno-0-491" href="#__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492" href="#__codelineno-0-492"></a>        <span class="c1"># The following is an internal helper function which returns the amount of availability for a given</span>
<a id="__codelineno-0-493" name="__codelineno-0-493" href="#__codelineno-0-493"></a>        <span class="c1"># resource in the ray cluster.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494" href="#__codelineno-0-494"></a>        <span class="c1"># If the requested resource is not available at all, None will be returned.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495" href="#__codelineno-0-495"></a>        <span class="k">def</span> <span class="nf">get_ray_resource</span><span class="p">(</span><span class="n">resource_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-496" name="__codelineno-0-496" href="#__codelineno-0-496"></a>            <span class="c1"># Ensure that the ray cluster is initialized</span>
<a id="__codelineno-0-497" name="__codelineno-0-497" href="#__codelineno-0-497"></a>            <span class="n">ensure_ray</span><span class="p">()</span>
<a id="__codelineno-0-498" name="__codelineno-0-498" href="#__codelineno-0-498"></a>            <span class="k">nonlocal</span> <span class="n">ray_resources</span>
<a id="__codelineno-0-499" name="__codelineno-0-499" href="#__codelineno-0-499"></a>            <span class="k">if</span> <span class="n">ray_resources</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-500" name="__codelineno-0-500" href="#__codelineno-0-500"></a>                <span class="c1"># If the ray resource information was not fetched, then fetch them and store them.</span>
<a id="__codelineno-0-501" name="__codelineno-0-501" href="#__codelineno-0-501"></a>                <span class="n">ray_resources</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">available_resources</span><span class="p">()</span>
<a id="__codelineno-0-502" name="__codelineno-0-502" href="#__codelineno-0-502"></a>            <span class="c1"># Return the information regarding the requested resource from the fetched resource information.</span>
<a id="__codelineno-0-503" name="__codelineno-0-503" href="#__codelineno-0-503"></a>            <span class="c1"># If it turns out that the requested resource is not available at all, the result will be None.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504" href="#__codelineno-0-504"></a>            <span class="k">return</span> <span class="n">ray_resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">resource_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-505" name="__codelineno-0-505" href="#__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506" href="#__codelineno-0-506"></a>        <span class="c1"># Annotate the variable that will store the number of actors (to be created when the parallelization</span>
<a id="__codelineno-0-507" name="__codelineno-0-507" href="#__codelineno-0-507"></a>        <span class="c1"># is triggered).</span>
<a id="__codelineno-0-508" name="__codelineno-0-508" href="#__codelineno-0-508"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-509" name="__codelineno-0-509" href="#__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510" href="#__codelineno-0-510"></a>        <span class="k">if</span> <span class="n">num_actors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-511" name="__codelineno-0-511" href="#__codelineno-0-511"></a>            <span class="c1"># If the argument `num_actors` is left as None, then we set `_num_actors` as 0, which means that</span>
<a id="__codelineno-0-512" name="__codelineno-0-512" href="#__codelineno-0-512"></a>            <span class="c1"># there will be no parallelization.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513" href="#__codelineno-0-513"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-514" name="__codelineno-0-514" href="#__codelineno-0-514"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_actors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-515" name="__codelineno-0-515" href="#__codelineno-0-515"></a>            <span class="c1"># This is the case where `num_actors` has a string value</span>
<a id="__codelineno-0-516" name="__codelineno-0-516" href="#__codelineno-0-516"></a>            <span class="k">if</span> <span class="n">num_actors</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;num_cpus&quot;</span><span class="p">):</span>
<a id="__codelineno-0-517" name="__codelineno-0-517" href="#__codelineno-0-517"></a>                <span class="c1"># If the `num_actors` argument was given as &quot;max&quot; or as &quot;num_cpus&quot;, then we first read how many CPUs</span>
<a id="__codelineno-0-518" name="__codelineno-0-518" href="#__codelineno-0-518"></a>                <span class="c1"># are available in the ray cluster, then convert it to integer (via computing its ceil value), and</span>
<a id="__codelineno-0-519" name="__codelineno-0-519" href="#__codelineno-0-519"></a>                <span class="c1"># finally set `_num_actors` as this integer.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520" href="#__codelineno-0-520"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">get_ray_resource</span><span class="p">(</span><span class="s2">&quot;CPU&quot;</span><span class="p">))</span>
<a id="__codelineno-0-521" name="__codelineno-0-521" href="#__codelineno-0-521"></a>            <span class="k">elif</span> <span class="n">num_actors</span> <span class="o">==</span> <span class="s2">&quot;num_gpus&quot;</span><span class="p">:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522" href="#__codelineno-0-522"></a>                <span class="c1"># If the `num_actors` argument was given as &quot;num_gpus&quot;, then we first read how many GPUs are</span>
<a id="__codelineno-0-523" name="__codelineno-0-523" href="#__codelineno-0-523"></a>                <span class="c1"># available in the ray cluster.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524" href="#__codelineno-0-524"></a>                <span class="n">num_gpus</span> <span class="o">=</span> <span class="n">get_ray_resource</span><span class="p">(</span><span class="s2">&quot;GPU&quot;</span><span class="p">)</span>
<a id="__codelineno-0-525" name="__codelineno-0-525" href="#__codelineno-0-525"></a>                <span class="k">if</span> <span class="n">num_gpus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526" href="#__codelineno-0-526"></a>                    <span class="c1"># If there are no GPUs at all, then we raise an error</span>
<a id="__codelineno-0-527" name="__codelineno-0-527" href="#__codelineno-0-527"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-528" name="__codelineno-0-528" href="#__codelineno-0-528"></a>                        <span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_gpus&#39;.&quot;</span>
<a id="__codelineno-0-529" name="__codelineno-0-529" href="#__codelineno-0-529"></a>                        <span class="s2">&quot; However, there does not seem to be any GPU available.&quot;</span>
<a id="__codelineno-0-530" name="__codelineno-0-530" href="#__codelineno-0-530"></a>                    <span class="p">)</span>
<a id="__codelineno-0-531" name="__codelineno-0-531" href="#__codelineno-0-531"></a>                <span class="k">if</span> <span class="n">num_gpus</span> <span class="o">&lt;</span> <span class="mf">1e-4</span><span class="p">:</span>
<a id="__codelineno-0-532" name="__codelineno-0-532" href="#__codelineno-0-532"></a>                    <span class="c1"># If the number of available GPUs are 0 or close to 0, then we raise an error</span>
<a id="__codelineno-0-533" name="__codelineno-0-533" href="#__codelineno-0-533"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-534" name="__codelineno-0-534" href="#__codelineno-0-534"></a>                        <span class="sa">f</span><span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_gpus&#39;.&quot;</span>
<a id="__codelineno-0-535" name="__codelineno-0-535" href="#__codelineno-0-535"></a>                        <span class="sa">f</span><span class="s2">&quot; However, the number of available GPUs are either 0 or close to 0 (= </span><span class="si">{</span><span class="n">num_gpus</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-536" name="__codelineno-0-536" href="#__codelineno-0-536"></a>                    <span class="p">)</span>
<a id="__codelineno-0-537" name="__codelineno-0-537" href="#__codelineno-0-537"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">actor_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;num_gpus&quot;</span> <span class="ow">in</span> <span class="n">actor_config</span><span class="p">):</span>
<a id="__codelineno-0-538" name="__codelineno-0-538" href="#__codelineno-0-538"></a>                    <span class="c1"># With `num_actors` argument given as &quot;num_gpus&quot;, we will also allocate each GPU to an actor.</span>
<a id="__codelineno-0-539" name="__codelineno-0-539" href="#__codelineno-0-539"></a>                    <span class="c1"># If `actor_config` contains an item with key &quot;num_gpus&quot;, then that configuration item would</span>
<a id="__codelineno-0-540" name="__codelineno-0-540" href="#__codelineno-0-540"></a>                    <span class="c1"># conflict with the GPU allocation we are about to do here.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541" href="#__codelineno-0-541"></a>                    <span class="c1"># So, we raise an error.</span>
<a id="__codelineno-0-542" name="__codelineno-0-542" href="#__codelineno-0-542"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-543" name="__codelineno-0-543" href="#__codelineno-0-543"></a>                        <span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_gpus&#39;.&quot;</span>
<a id="__codelineno-0-544" name="__codelineno-0-544" href="#__codelineno-0-544"></a>                        <span class="s2">&quot; With this configuration, the number of GPUs assigned to an actor is automatically determined.&quot;</span>
<a id="__codelineno-0-545" name="__codelineno-0-545" href="#__codelineno-0-545"></a>                        <span class="s2">&quot; However, at the same time, the `actor_config` argument was received with the key &#39;num_gpus&#39;,&quot;</span>
<a id="__codelineno-0-546" name="__codelineno-0-546" href="#__codelineno-0-546"></a>                        <span class="s2">&quot; which causes a conflict.&quot;</span>
<a id="__codelineno-0-547" name="__codelineno-0-547" href="#__codelineno-0-547"></a>                    <span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548" href="#__codelineno-0-548"></a>                <span class="k">if</span> <span class="n">num_gpus_per_actor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-549" name="__codelineno-0-549" href="#__codelineno-0-549"></a>                    <span class="c1"># With `num_actors` argument given as &quot;num_gpus&quot;, we will also allocate each GPU to an actor.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550" href="#__codelineno-0-550"></a>                    <span class="c1"># If the argument `num_gpus_per_actor` is also stated, then such a configuration item would</span>
<a id="__codelineno-0-551" name="__codelineno-0-551" href="#__codelineno-0-551"></a>                    <span class="c1"># conflict with the GPU allocation we are about to do here.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552" href="#__codelineno-0-552"></a>                    <span class="c1"># So, we raise an error.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553" href="#__codelineno-0-553"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-554" name="__codelineno-0-554" href="#__codelineno-0-554"></a>                        <span class="sa">f</span><span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_gpus&#39;.&quot;</span>
<a id="__codelineno-0-555" name="__codelineno-0-555" href="#__codelineno-0-555"></a>                        <span class="sa">f</span><span class="s2">&quot; With this configuration, the number of GPUs assigned to an actor is automatically determined.&quot;</span>
<a id="__codelineno-0-556" name="__codelineno-0-556" href="#__codelineno-0-556"></a>                        <span class="sa">f</span><span class="s2">&quot; However, at the same time, the `num_gpus_per_actor` argument was received with a value other&quot;</span>
<a id="__codelineno-0-557" name="__codelineno-0-557" href="#__codelineno-0-557"></a>                        <span class="sa">f</span><span class="s2">&quot; than None (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">)</span><span class="si">}</span><span class="s2">), which causes a conflict.&quot;</span>
<a id="__codelineno-0-558" name="__codelineno-0-558" href="#__codelineno-0-558"></a>                    <span class="p">)</span>
<a id="__codelineno-0-559" name="__codelineno-0-559" href="#__codelineno-0-559"></a>                <span class="c1"># Set the number of actors as the ceiled integer counterpart of the number of available GPUs</span>
<a id="__codelineno-0-560" name="__codelineno-0-560" href="#__codelineno-0-560"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_gpus</span><span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561" href="#__codelineno-0-561"></a>                <span class="c1"># We assign a GPU for each actor (by overriding the value for the argument `num_gpus_per_actor`).</span>
<a id="__codelineno-0-562" name="__codelineno-0-562" href="#__codelineno-0-562"></a>                <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="n">num_gpus</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span>
<a id="__codelineno-0-563" name="__codelineno-0-563" href="#__codelineno-0-563"></a>            <span class="k">elif</span> <span class="n">num_actors</span> <span class="o">==</span> <span class="s2">&quot;num_devices&quot;</span><span class="p">:</span>
<a id="__codelineno-0-564" name="__codelineno-0-564" href="#__codelineno-0-564"></a>                <span class="c1"># This is the case where `num_actors` has the string value &quot;num_devices&quot;.</span>
<a id="__codelineno-0-565" name="__codelineno-0-565" href="#__codelineno-0-565"></a>
<a id="__codelineno-0-566" name="__codelineno-0-566" href="#__codelineno-0-566"></a>                <span class="c1"># With `num_actors` set as &quot;num_devices&quot;, if there are any GPUs, the behavior is to assign a GPU</span>
<a id="__codelineno-0-567" name="__codelineno-0-567" href="#__codelineno-0-567"></a>                <span class="c1"># to each actor. If there are conflicting configurations regarding how many GPUs are to be assigned</span>
<a id="__codelineno-0-568" name="__codelineno-0-568" href="#__codelineno-0-568"></a>                <span class="c1"># to each actor, then we raise an error.</span>
<a id="__codelineno-0-569" name="__codelineno-0-569" href="#__codelineno-0-569"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">actor_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;num_gpus&quot;</span> <span class="ow">in</span> <span class="n">actor_config</span><span class="p">):</span>
<a id="__codelineno-0-570" name="__codelineno-0-570" href="#__codelineno-0-570"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-571" name="__codelineno-0-571" href="#__codelineno-0-571"></a>                        <span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_devices&#39;.&quot;</span>
<a id="__codelineno-0-572" name="__codelineno-0-572" href="#__codelineno-0-572"></a>                        <span class="s2">&quot; With this configuration, the number of GPUs assigned to an actor is automatically determined.&quot;</span>
<a id="__codelineno-0-573" name="__codelineno-0-573" href="#__codelineno-0-573"></a>                        <span class="s2">&quot; However, at the same time, the `actor_config` argument was received with the key &#39;num_gpus&#39;,&quot;</span>
<a id="__codelineno-0-574" name="__codelineno-0-574" href="#__codelineno-0-574"></a>                        <span class="s2">&quot; which causes a conflict.&quot;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575" href="#__codelineno-0-575"></a>                    <span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576" href="#__codelineno-0-576"></a>                <span class="k">if</span> <span class="n">num_gpus_per_actor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577" href="#__codelineno-0-577"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-578" name="__codelineno-0-578" href="#__codelineno-0-578"></a>                        <span class="sa">f</span><span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_devices&#39;.&quot;</span>
<a id="__codelineno-0-579" name="__codelineno-0-579" href="#__codelineno-0-579"></a>                        <span class="sa">f</span><span class="s2">&quot; With this configuration, the number of GPUs assigned to an actor is automatically determined.&quot;</span>
<a id="__codelineno-0-580" name="__codelineno-0-580" href="#__codelineno-0-580"></a>                        <span class="sa">f</span><span class="s2">&quot; However, at the same time, the `num_gpus_per_actor` argument was received with a value other&quot;</span>
<a id="__codelineno-0-581" name="__codelineno-0-581" href="#__codelineno-0-581"></a>                        <span class="sa">f</span><span class="s2">&quot; than None (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">)</span><span class="si">}</span><span class="s2">), which causes a conflict.&quot;</span>
<a id="__codelineno-0-582" name="__codelineno-0-582" href="#__codelineno-0-582"></a>                    <span class="p">)</span>
<a id="__codelineno-0-583" name="__codelineno-0-583" href="#__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584" href="#__codelineno-0-584"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_device</span> <span class="o">!=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">):</span>
<a id="__codelineno-0-585" name="__codelineno-0-585" href="#__codelineno-0-585"></a>                    <span class="c1"># If the main device is not CPU, then the user most probably wishes to put all the</span>
<a id="__codelineno-0-586" name="__codelineno-0-586" href="#__codelineno-0-586"></a>                    <span class="c1"># computations (both evaluations and the population) on the GPU, without allocating</span>
<a id="__codelineno-0-587" name="__codelineno-0-587" href="#__codelineno-0-587"></a>                    <span class="c1"># any actor.</span>
<a id="__codelineno-0-588" name="__codelineno-0-588" href="#__codelineno-0-588"></a>                    <span class="c1"># So, we set `_num_actors` as None, and overwrite `num_gpus_per_actor` with None.</span>
<a id="__codelineno-0-589" name="__codelineno-0-589" href="#__codelineno-0-589"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-590" name="__codelineno-0-590" href="#__codelineno-0-590"></a>                    <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-591" name="__codelineno-0-591" href="#__codelineno-0-591"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-592" name="__codelineno-0-592" href="#__codelineno-0-592"></a>                    <span class="c1"># If the device argument is &quot;cpu&quot; or left as None, then we assume that actor allocations</span>
<a id="__codelineno-0-593" name="__codelineno-0-593" href="#__codelineno-0-593"></a>                    <span class="c1"># might be desired.</span>
<a id="__codelineno-0-594" name="__codelineno-0-594" href="#__codelineno-0-594"></a>
<a id="__codelineno-0-595" name="__codelineno-0-595" href="#__codelineno-0-595"></a>                    <span class="c1"># Read how many CPUs and GPUs are available in the ray cluster.</span>
<a id="__codelineno-0-596" name="__codelineno-0-596" href="#__codelineno-0-596"></a>                    <span class="n">num_cpus</span> <span class="o">=</span> <span class="n">get_ray_resource</span><span class="p">(</span><span class="s2">&quot;CPU&quot;</span><span class="p">)</span>
<a id="__codelineno-0-597" name="__codelineno-0-597" href="#__codelineno-0-597"></a>                    <span class="n">num_gpus</span> <span class="o">=</span> <span class="n">get_ray_resource</span><span class="p">(</span><span class="s2">&quot;GPU&quot;</span><span class="p">)</span>
<a id="__codelineno-0-598" name="__codelineno-0-598" href="#__codelineno-0-598"></a>
<a id="__codelineno-0-599" name="__codelineno-0-599" href="#__codelineno-0-599"></a>                    <span class="c1"># If we have multiple CPUs, then we continue with the actor allocation procedures.</span>
<a id="__codelineno-0-600" name="__codelineno-0-600" href="#__codelineno-0-600"></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">num_gpus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num_gpus</span> <span class="o">&lt;</span> <span class="mf">1e-4</span><span class="p">):</span>
<a id="__codelineno-0-601" name="__codelineno-0-601" href="#__codelineno-0-601"></a>                        <span class="c1"># If there are no GPUs, then we set the number of actors as the number of CPUs, and we</span>
<a id="__codelineno-0-602" name="__codelineno-0-602" href="#__codelineno-0-602"></a>                        <span class="c1"># set the number of GPUs per actor as None (which means that there will be no GPU</span>
<a id="__codelineno-0-603" name="__codelineno-0-603" href="#__codelineno-0-603"></a>                        <span class="c1"># assignment)</span>
<a id="__codelineno-0-604" name="__codelineno-0-604" href="#__codelineno-0-604"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_cpus</span><span class="p">)</span>
<a id="__codelineno-0-605" name="__codelineno-0-605" href="#__codelineno-0-605"></a>                        <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-606" name="__codelineno-0-606" href="#__codelineno-0-606"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-607" name="__codelineno-0-607" href="#__codelineno-0-607"></a>                        <span class="c1"># If there are GPUs available, then we compute the minimum among the number of CPUs and</span>
<a id="__codelineno-0-608" name="__codelineno-0-608" href="#__codelineno-0-608"></a>                        <span class="c1"># GPUs, and this minimum value becomes the number of actors (so that there can be</span>
<a id="__codelineno-0-609" name="__codelineno-0-609" href="#__codelineno-0-609"></a>                        <span class="c1"># one-to-one mapping between actors and GPUs).</span>
<a id="__codelineno-0-610" name="__codelineno-0-610" href="#__codelineno-0-610"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">num_cpus</span><span class="p">,</span> <span class="n">num_gpus</span><span class="p">))</span>
<a id="__codelineno-0-611" name="__codelineno-0-611" href="#__codelineno-0-611"></a>
<a id="__codelineno-0-612" name="__codelineno-0-612" href="#__codelineno-0-612"></a>                        <span class="c1"># We assign a GPU for each actor (by overriding the value for the argument</span>
<a id="__codelineno-0-613" name="__codelineno-0-613" href="#__codelineno-0-613"></a>                        <span class="c1"># `num_gpus_per_actor`).</span>
<a id="__codelineno-0-614" name="__codelineno-0-614" href="#__codelineno-0-614"></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">&lt;=</span> <span class="n">num_gpus</span><span class="p">:</span>
<a id="__codelineno-0-615" name="__codelineno-0-615" href="#__codelineno-0-615"></a>                            <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-616" name="__codelineno-0-616" href="#__codelineno-0-616"></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-617" name="__codelineno-0-617" href="#__codelineno-0-617"></a>                            <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="n">num_gpus</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span>
<a id="__codelineno-0-618" name="__codelineno-0-618" href="#__codelineno-0-618"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-619" name="__codelineno-0-619" href="#__codelineno-0-619"></a>                <span class="c1"># This is the case where `num_actors` is given as an unexpected string. We raise an error here.</span>
<a id="__codelineno-0-620" name="__codelineno-0-620" href="#__codelineno-0-620"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-621" name="__codelineno-0-621" href="#__codelineno-0-621"></a>                    <span class="sa">f</span><span class="s2">&quot;Invalid string value for `num_actors`: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">num_actors</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-622" name="__codelineno-0-622" href="#__codelineno-0-622"></a>                    <span class="sa">f</span><span class="s2">&quot; The acceptable string values for `num_actors` are &#39;max&#39;, &#39;num_cpus&#39;, &#39;num_gpus&#39;, &#39;num_devices&#39;.&quot;</span>
<a id="__codelineno-0-623" name="__codelineno-0-623" href="#__codelineno-0-623"></a>                <span class="p">)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624" href="#__codelineno-0-624"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-625" name="__codelineno-0-625" href="#__codelineno-0-625"></a>            <span class="c1"># This is the case where `num_actors` has a value which is not a string.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626" href="#__codelineno-0-626"></a>            <span class="c1"># In this case, we make sure that the given value is an integer, and then use this integer as our</span>
<a id="__codelineno-0-627" name="__codelineno-0-627" href="#__codelineno-0-627"></a>            <span class="c1"># number of actors.</span>
<a id="__codelineno-0-628" name="__codelineno-0-628" href="#__codelineno-0-628"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_actors</span><span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629" href="#__codelineno-0-629"></a>
<a id="__codelineno-0-630" name="__codelineno-0-630" href="#__codelineno-0-630"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631" href="#__codelineno-0-631"></a>            <span class="c1"># Creating a single actor does not bring any benefit of parallelization.</span>
<a id="__codelineno-0-632" name="__codelineno-0-632" href="#__codelineno-0-632"></a>            <span class="c1"># Therefore, at the end of all the computations above regarding the number of actors, if it turns out</span>
<a id="__codelineno-0-633" name="__codelineno-0-633" href="#__codelineno-0-633"></a>            <span class="c1"># that the target number of actors is 1, we reduce it to 0 (meaning that no actor will be initialized).</span>
<a id="__codelineno-0-634" name="__codelineno-0-634" href="#__codelineno-0-634"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-635" name="__codelineno-0-635" href="#__codelineno-0-635"></a>
<a id="__codelineno-0-636" name="__codelineno-0-636" href="#__codelineno-0-636"></a>            <span class="c1"># Since we are to allocate no actor, the value of the argument `num_gpus_per_actor` is meaningless.</span>
<a id="__codelineno-0-637" name="__codelineno-0-637" href="#__codelineno-0-637"></a>            <span class="c1"># We therefore overwrite the value of that argument with None.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638" href="#__codelineno-0-638"></a>            <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-639" name="__codelineno-0-639" href="#__codelineno-0-639"></a>
<a id="__codelineno-0-640" name="__codelineno-0-640" href="#__codelineno-0-640"></a>        <span class="c1"># Annotate the variable which will determine how many GPUs are to be assigned to each actor.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641" href="#__codelineno-0-641"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
<a id="__codelineno-0-642" name="__codelineno-0-642" href="#__codelineno-0-642"></a>
<a id="__codelineno-0-643" name="__codelineno-0-643" href="#__codelineno-0-643"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">actor_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;num_gpus&quot;</span> <span class="ow">in</span> <span class="n">actor_config</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">num_gpus_per_actor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-644" name="__codelineno-0-644" href="#__codelineno-0-644"></a>            <span class="c1"># If `actor_config` dictionary has the item &quot;num_gpus&quot; and also `num_gpus_per_actor` is not None,</span>
<a id="__codelineno-0-645" name="__codelineno-0-645" href="#__codelineno-0-645"></a>            <span class="c1"># then there is a conflicting (or redundant) configuration. We raise an error here.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646" href="#__codelineno-0-646"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-647" name="__codelineno-0-647" href="#__codelineno-0-647"></a>                <span class="s1">&#39;The `actor_config` dictionary contains the key &quot;num_gpus&quot;.&#39;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648" href="#__codelineno-0-648"></a>                <span class="s2">&quot; At the same time, `num_gpus_per_actor` has a value other than None.&quot;</span>
<a id="__codelineno-0-649" name="__codelineno-0-649" href="#__codelineno-0-649"></a>                <span class="s2">&quot; These two configurations are conflicting.&quot;</span>
<a id="__codelineno-0-650" name="__codelineno-0-650" href="#__codelineno-0-650"></a>                <span class="s2">&quot; Please specify the number of GPUs per actor either via the `actor_config` dictionary,&quot;</span>
<a id="__codelineno-0-651" name="__codelineno-0-651" href="#__codelineno-0-651"></a>                <span class="s2">&quot; or via the `num_gpus_per_actor` argument, but not via both.&quot;</span>
<a id="__codelineno-0-652" name="__codelineno-0-652" href="#__codelineno-0-652"></a>            <span class="p">)</span>
<a id="__codelineno-0-653" name="__codelineno-0-653" href="#__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654" href="#__codelineno-0-654"></a>        <span class="k">if</span> <span class="n">num_gpus_per_actor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-655" name="__codelineno-0-655" href="#__codelineno-0-655"></a>            <span class="c1"># If the argument `num_gpus_per_actor` is not specified, then we set the attribute</span>
<a id="__codelineno-0-656" name="__codelineno-0-656" href="#__codelineno-0-656"></a>            <span class="c1"># `_num_gpus_per_actor` as None, which means that no GPUs will be assigned to the actors.</span>
<a id="__codelineno-0-657" name="__codelineno-0-657" href="#__codelineno-0-657"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-658" name="__codelineno-0-658" href="#__codelineno-0-658"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-659" name="__codelineno-0-659" href="#__codelineno-0-659"></a>            <span class="c1"># This is the case where `num_gpus_per_actor` is given as a string.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660" href="#__codelineno-0-660"></a>            <span class="k">if</span> <span class="n">num_gpus_per_actor</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-661" name="__codelineno-0-661" href="#__codelineno-0-661"></a>                <span class="c1"># This is the case where `num_gpus_per_actor` is given as &quot;max&quot;.</span>
<a id="__codelineno-0-662" name="__codelineno-0-662" href="#__codelineno-0-662"></a>                <span class="n">num_gpus</span> <span class="o">=</span> <span class="n">get_ray_resource</span><span class="p">(</span><span class="s2">&quot;GPU&quot;</span><span class="p">)</span>
<a id="__codelineno-0-663" name="__codelineno-0-663" href="#__codelineno-0-663"></a>                <span class="k">if</span> <span class="n">num_gpus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-664" name="__codelineno-0-664" href="#__codelineno-0-664"></a>                    <span class="c1"># With `num_gpus_per_actor` as &quot;max&quot;, if there is no GPU available, then we set the attribute</span>
<a id="__codelineno-0-665" name="__codelineno-0-665" href="#__codelineno-0-665"></a>                    <span class="c1"># `_num_gpus_per_actor` as None, which means there will be no GPU assignment to the actors.</span>
<a id="__codelineno-0-666" name="__codelineno-0-666" href="#__codelineno-0-666"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-667" name="__codelineno-0-667" href="#__codelineno-0-667"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668" href="#__codelineno-0-668"></a>                    <span class="c1"># With `num_gpus_per_actor` as &quot;max&quot;, if there are GPUs available, then the available GPUs will</span>
<a id="__codelineno-0-669" name="__codelineno-0-669" href="#__codelineno-0-669"></a>                    <span class="c1"># be shared among the actors.</span>
<a id="__codelineno-0-670" name="__codelineno-0-670" href="#__codelineno-0-670"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="n">num_gpus</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span>
<a id="__codelineno-0-671" name="__codelineno-0-671" href="#__codelineno-0-671"></a>            <span class="k">elif</span> <span class="n">num_gpus_per_actor</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
<a id="__codelineno-0-672" name="__codelineno-0-672" href="#__codelineno-0-672"></a>                <span class="c1"># When `num_gpus_per_actor` is &quot;all&quot;, we also set the attribute `_num_gpus_per_actor` as &quot;all&quot;.</span>
<a id="__codelineno-0-673" name="__codelineno-0-673" href="#__codelineno-0-673"></a>                <span class="c1"># When a remote actor is initialized, the remote actor will see that the Problem instance has its</span>
<a id="__codelineno-0-674" name="__codelineno-0-674" href="#__codelineno-0-674"></a>                <span class="c1"># `_num_gpus_per_actor` set as &quot;all&quot;, and it will remove the environment variable named</span>
<a id="__codelineno-0-675" name="__codelineno-0-675" href="#__codelineno-0-675"></a>                <span class="c1"># &quot;CUDA_VISIBLE_DEVICES&quot; in its own environment.</span>
<a id="__codelineno-0-676" name="__codelineno-0-676" href="#__codelineno-0-676"></a>                <span class="c1"># With &quot;CUDA_VISIBLE_DEVICES&quot; removed, an actor will see all the GPUs available in its own</span>
<a id="__codelineno-0-677" name="__codelineno-0-677" href="#__codelineno-0-677"></a>                <span class="c1"># environment.</span>
<a id="__codelineno-0-678" name="__codelineno-0-678" href="#__codelineno-0-678"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
<a id="__codelineno-0-679" name="__codelineno-0-679" href="#__codelineno-0-679"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-680" name="__codelineno-0-680" href="#__codelineno-0-680"></a>                <span class="c1"># This is the case where `num_gpus_per_actor` argument has an unexpected string value.</span>
<a id="__codelineno-0-681" name="__codelineno-0-681" href="#__codelineno-0-681"></a>                <span class="c1"># We raise an error.</span>
<a id="__codelineno-0-682" name="__codelineno-0-682" href="#__codelineno-0-682"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-683" name="__codelineno-0-683" href="#__codelineno-0-683"></a>                    <span class="sa">f</span><span class="s2">&quot;Invalid string value for `num_gpus_per_actor`: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-684" name="__codelineno-0-684" href="#__codelineno-0-684"></a>                    <span class="sa">f</span><span class="s1">&#39; Acceptable string values for `num_gpus_per_actor` are: &quot;max&quot;, &quot;all&quot;.&#39;</span>
<a id="__codelineno-0-685" name="__codelineno-0-685" href="#__codelineno-0-685"></a>                <span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686" href="#__codelineno-0-686"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-687" name="__codelineno-0-687" href="#__codelineno-0-687"></a>            <span class="c1"># When the argument `num_gpus_per_actor` is set as an integer we just set the attribute</span>
<a id="__codelineno-0-688" name="__codelineno-0-688" href="#__codelineno-0-688"></a>            <span class="c1"># `_num_gpus_per_actor` as this integer.</span>
<a id="__codelineno-0-689" name="__codelineno-0-689" href="#__codelineno-0-689"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="n">num_gpus_per_actor</span>
<a id="__codelineno-0-690" name="__codelineno-0-690" href="#__codelineno-0-690"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691" href="#__codelineno-0-691"></a>            <span class="c1"># For anything else, we assume that `num_gpus_per_actor` is an object that is convertible to float.</span>
<a id="__codelineno-0-692" name="__codelineno-0-692" href="#__codelineno-0-692"></a>            <span class="c1"># Therefore, we convert it to float and store it in the attribute `_num_gpus_per_actor`.</span>
<a id="__codelineno-0-693" name="__codelineno-0-693" href="#__codelineno-0-693"></a>            <span class="c1"># Also, remember that, when `num_actors` is given as &quot;num_gpus&quot; or as &quot;num_devices&quot;,</span>
<a id="__codelineno-0-694" name="__codelineno-0-694" href="#__codelineno-0-694"></a>            <span class="c1"># the code above overrides the value for the argument `num_gpus_per_actor`, which means,</span>
<a id="__codelineno-0-695" name="__codelineno-0-695" href="#__codelineno-0-695"></a>            <span class="c1"># this is the case that is activated when `num_actors` is &quot;num_gpus&quot; or &quot;num_devices&quot;.</span>
<a id="__codelineno-0-696" name="__codelineno-0-696" href="#__codelineno-0-696"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">)</span>
<a id="__codelineno-0-697" name="__codelineno-0-697" href="#__codelineno-0-697"></a>
<a id="__codelineno-0-698" name="__codelineno-0-698" href="#__codelineno-0-698"></a>        <span class="c1"># Initialize the Hook instances (and the related status dictionary for the `_after_eval_hook`)</span>
<a id="__codelineno-0-699" name="__codelineno-0-699" href="#__codelineno-0-699"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_before_eval_hook</span><span class="p">:</span> <span class="n">Hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-700" name="__codelineno-0-700" href="#__codelineno-0-700"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_hook</span><span class="p">:</span> <span class="n">Hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-701" name="__codelineno-0-701" href="#__codelineno-0-701"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-702" name="__codelineno-0-702" href="#__codelineno-0-702"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_remote_hook</span><span class="p">:</span> <span class="n">Hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-703" name="__codelineno-0-703" href="#__codelineno-0-703"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_before_grad_hook</span><span class="p">:</span> <span class="n">Hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-704" name="__codelineno-0-704" href="#__codelineno-0-704"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_after_grad_hook</span><span class="p">:</span> <span class="n">Hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-705" name="__codelineno-0-705" href="#__codelineno-0-705"></a>
<a id="__codelineno-0-706" name="__codelineno-0-706" href="#__codelineno-0-706"></a>        <span class="c1"># Initialize various stats regarding the solutions encountered by this Problem instance.</span>
<a id="__codelineno-0-707" name="__codelineno-0-707" href="#__codelineno-0-707"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_store_solution_stats</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">store_solution_stats</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">bool</span><span class="p">(</span><span class="n">store_solution_stats</span><span class="p">)</span>
<a id="__codelineno-0-708" name="__codelineno-0-708" href="#__codelineno-0-708"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_best</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-709" name="__codelineno-0-709" href="#__codelineno-0-709"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_worst</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-710" name="__codelineno-0-710" href="#__codelineno-0-710"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_best_evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-711" name="__codelineno-0-711" href="#__codelineno-0-711"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_worst_evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-712" name="__codelineno-0-712" href="#__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713" href="#__codelineno-0-713"></a>        <span class="c1"># Initialize the boolean attribute which indicates whether or not this Problem instance (which can be</span>
<a id="__codelineno-0-714" name="__codelineno-0-714" href="#__codelineno-0-714"></a>        <span class="c1"># the main instance or a remote instance on an actor) is &quot;prepared&quot; via the `_prepare` method.</span>
<a id="__codelineno-0-715" name="__codelineno-0-715" href="#__codelineno-0-715"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-716" name="__codelineno-0-716" href="#__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717" href="#__codelineno-0-717"></a>    <span class="k">def</span> <span class="nf">manual_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-718" name="__codelineno-0-718" href="#__codelineno-0-718"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-719" name="__codelineno-0-719" href="#__codelineno-0-719"></a><span class="sd">        Provide a manual seed for the Problem object.</span>
<a id="__codelineno-0-720" name="__codelineno-0-720" href="#__codelineno-0-720"></a>
<a id="__codelineno-0-721" name="__codelineno-0-721" href="#__codelineno-0-721"></a><span class="sd">        If the given seed is None, then the Problem object will remove</span>
<a id="__codelineno-0-722" name="__codelineno-0-722" href="#__codelineno-0-722"></a><span class="sd">        its own stored generator, and start using the global generator</span>
<a id="__codelineno-0-723" name="__codelineno-0-723" href="#__codelineno-0-723"></a><span class="sd">        of PyTorch instead.</span>
<a id="__codelineno-0-724" name="__codelineno-0-724" href="#__codelineno-0-724"></a><span class="sd">        If the given seed is an integer, then the Problem object will</span>
<a id="__codelineno-0-725" name="__codelineno-0-725" href="#__codelineno-0-725"></a><span class="sd">        instantiate its own generator with the given seed.</span>
<a id="__codelineno-0-726" name="__codelineno-0-726" href="#__codelineno-0-726"></a>
<a id="__codelineno-0-727" name="__codelineno-0-727" href="#__codelineno-0-727"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-728" name="__codelineno-0-728" href="#__codelineno-0-728"></a><span class="sd">            seed: None for using the global PyTorch generator; an integer</span>
<a id="__codelineno-0-729" name="__codelineno-0-729" href="#__codelineno-0-729"></a><span class="sd">                for instantiating a new PyTorch generator with this given</span>
<a id="__codelineno-0-730" name="__codelineno-0-730" href="#__codelineno-0-730"></a><span class="sd">                integer seed, specific to this Problem object.</span>
<a id="__codelineno-0-731" name="__codelineno-0-731" href="#__codelineno-0-731"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-732" name="__codelineno-0-732" href="#__codelineno-0-732"></a>        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-733" name="__codelineno-0-733" href="#__codelineno-0-733"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-734" name="__codelineno-0-734" href="#__codelineno-0-734"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-735" name="__codelineno-0-735" href="#__codelineno-0-735"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-736" name="__codelineno-0-736" href="#__codelineno-0-736"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-737" name="__codelineno-0-737" href="#__codelineno-0-737"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<a id="__codelineno-0-738" name="__codelineno-0-738" href="#__codelineno-0-738"></a>
<a id="__codelineno-0-739" name="__codelineno-0-739" href="#__codelineno-0-739"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-740" name="__codelineno-0-740" href="#__codelineno-0-740"></a>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DType</span><span class="p">:</span>
<a id="__codelineno-0-741" name="__codelineno-0-741" href="#__codelineno-0-741"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-742" name="__codelineno-0-742" href="#__codelineno-0-742"></a><span class="sd">        dtype of the Problem object.</span>
<a id="__codelineno-0-743" name="__codelineno-0-743" href="#__codelineno-0-743"></a>
<a id="__codelineno-0-744" name="__codelineno-0-744" href="#__codelineno-0-744"></a><span class="sd">        The decision variables of the optimization problem are of this dtype.</span>
<a id="__codelineno-0-745" name="__codelineno-0-745" href="#__codelineno-0-745"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-746" name="__codelineno-0-746" href="#__codelineno-0-746"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>
<a id="__codelineno-0-747" name="__codelineno-0-747" href="#__codelineno-0-747"></a>
<a id="__codelineno-0-748" name="__codelineno-0-748" href="#__codelineno-0-748"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-749" name="__codelineno-0-749" href="#__codelineno-0-749"></a>    <span class="k">def</span> <span class="nf">device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Device</span><span class="p">:</span>
<a id="__codelineno-0-750" name="__codelineno-0-750" href="#__codelineno-0-750"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-751" name="__codelineno-0-751" href="#__codelineno-0-751"></a><span class="sd">        device of the Problem object.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752" href="#__codelineno-0-752"></a>
<a id="__codelineno-0-753" name="__codelineno-0-753" href="#__codelineno-0-753"></a><span class="sd">        New solutions and populations will be generated in this device.</span>
<a id="__codelineno-0-754" name="__codelineno-0-754" href="#__codelineno-0-754"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-755" name="__codelineno-0-755" href="#__codelineno-0-755"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_device</span>
<a id="__codelineno-0-756" name="__codelineno-0-756" href="#__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757" href="#__codelineno-0-757"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-758" name="__codelineno-0-758" href="#__codelineno-0-758"></a>    <span class="k">def</span> <span class="nf">aux_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Device</span><span class="p">:</span>
<a id="__codelineno-0-759" name="__codelineno-0-759" href="#__codelineno-0-759"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-760" name="__codelineno-0-760" href="#__codelineno-0-760"></a><span class="sd">        Auxiliary device to help with the computations, most commonly for</span>
<a id="__codelineno-0-761" name="__codelineno-0-761" href="#__codelineno-0-761"></a><span class="sd">        speeding up the solution evaluations.</span>
<a id="__codelineno-0-762" name="__codelineno-0-762" href="#__codelineno-0-762"></a>
<a id="__codelineno-0-763" name="__codelineno-0-763" href="#__codelineno-0-763"></a><span class="sd">        An auxiliary device is different than the main device of the Problem</span>
<a id="__codelineno-0-764" name="__codelineno-0-764" href="#__codelineno-0-764"></a><span class="sd">        object (the main device being expressed by the `device` property).</span>
<a id="__codelineno-0-765" name="__codelineno-0-765" href="#__codelineno-0-765"></a><span class="sd">        While the main device of the Problem object determines where the</span>
<a id="__codelineno-0-766" name="__codelineno-0-766" href="#__codelineno-0-766"></a><span class="sd">        solutions and the populations are stored (and also using which device</span>
<a id="__codelineno-0-767" name="__codelineno-0-767" href="#__codelineno-0-767"></a><span class="sd">        should a SearchAlgorithm instance communicate with the problem),</span>
<a id="__codelineno-0-768" name="__codelineno-0-768" href="#__codelineno-0-768"></a><span class="sd">        an auxiliary device is a device that might be used by the Problem</span>
<a id="__codelineno-0-769" name="__codelineno-0-769" href="#__codelineno-0-769"></a><span class="sd">        instance itself for its own computations (e.g. computations defined</span>
<a id="__codelineno-0-770" name="__codelineno-0-770" href="#__codelineno-0-770"></a><span class="sd">        within the methods `_evaluate(...)` or `_evaluate_batch(...)`).</span>
<a id="__codelineno-0-771" name="__codelineno-0-771" href="#__codelineno-0-771"></a>
<a id="__codelineno-0-772" name="__codelineno-0-772" href="#__codelineno-0-772"></a><span class="sd">        If the problem&#39;s main device is something other than &quot;cpu&quot;, that main</span>
<a id="__codelineno-0-773" name="__codelineno-0-773" href="#__codelineno-0-773"></a><span class="sd">        device is also seen as the auxiliary device, and therefore returned</span>
<a id="__codelineno-0-774" name="__codelineno-0-774" href="#__codelineno-0-774"></a><span class="sd">        by this property.</span>
<a id="__codelineno-0-775" name="__codelineno-0-775" href="#__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776" href="#__codelineno-0-776"></a><span class="sd">        If the problem&#39;s main device is &quot;cpu&quot;, then the auxiliary device</span>
<a id="__codelineno-0-777" name="__codelineno-0-777" href="#__codelineno-0-777"></a><span class="sd">        is decided as follows. If `num_gpus_per_actor` of the Problem object</span>
<a id="__codelineno-0-778" name="__codelineno-0-778" href="#__codelineno-0-778"></a><span class="sd">        was set as &quot;all&quot; and if this instance is a remote instance, then the</span>
<a id="__codelineno-0-779" name="__codelineno-0-779" href="#__codelineno-0-779"></a><span class="sd">        auxiliary device is guessed as &quot;cuda:N&quot; where N is the actor index.</span>
<a id="__codelineno-0-780" name="__codelineno-0-780" href="#__codelineno-0-780"></a><span class="sd">        In all other cases, the auxiliary device is &quot;cuda&quot; if cuda is</span>
<a id="__codelineno-0-781" name="__codelineno-0-781" href="#__codelineno-0-781"></a><span class="sd">        available, and &quot;cpu&quot; otherwise.</span>
<a id="__codelineno-0-782" name="__codelineno-0-782" href="#__codelineno-0-782"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-783" name="__codelineno-0-783" href="#__codelineno-0-783"></a>        <span class="n">cpu_device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-784" name="__codelineno-0-784" href="#__codelineno-0-784"></a>        <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">==</span> <span class="n">cpu_device</span><span class="p">:</span>
<a id="__codelineno-0-785" name="__codelineno-0-785" href="#__codelineno-0-785"></a>            <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
<a id="__codelineno-0-786" name="__codelineno-0-786" href="#__codelineno-0-786"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_remote</span><span class="p">:</span>
<a id="__codelineno-0-787" name="__codelineno-0-787" href="#__codelineno-0-787"></a>                    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">actor_index</span><span class="p">)</span>
<a id="__codelineno-0-788" name="__codelineno-0-788" href="#__codelineno-0-788"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-789" name="__codelineno-0-789" href="#__codelineno-0-789"></a>                    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790" href="#__codelineno-0-790"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-791" name="__codelineno-0-791" href="#__codelineno-0-791"></a>                <span class="k">return</span> <span class="n">cpu_device</span>
<a id="__codelineno-0-792" name="__codelineno-0-792" href="#__codelineno-0-792"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-793" name="__codelineno-0-793" href="#__codelineno-0-793"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-794" name="__codelineno-0-794" href="#__codelineno-0-794"></a>
<a id="__codelineno-0-795" name="__codelineno-0-795" href="#__codelineno-0-795"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-796" name="__codelineno-0-796" href="#__codelineno-0-796"></a>    <span class="k">def</span> <span class="nf">eval_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DType</span><span class="p">:</span>
<a id="__codelineno-0-797" name="__codelineno-0-797" href="#__codelineno-0-797"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-798" name="__codelineno-0-798" href="#__codelineno-0-798"></a><span class="sd">        evaluation dtype of the Problem object.</span>
<a id="__codelineno-0-799" name="__codelineno-0-799" href="#__codelineno-0-799"></a>
<a id="__codelineno-0-800" name="__codelineno-0-800" href="#__codelineno-0-800"></a><span class="sd">        The evaluation results of the solutions are stored according to this</span>
<a id="__codelineno-0-801" name="__codelineno-0-801" href="#__codelineno-0-801"></a><span class="sd">        dtype.</span>
<a id="__codelineno-0-802" name="__codelineno-0-802" href="#__codelineno-0-802"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-803" name="__codelineno-0-803" href="#__codelineno-0-803"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_dtype</span>
<a id="__codelineno-0-804" name="__codelineno-0-804" href="#__codelineno-0-804"></a>
<a id="__codelineno-0-805" name="__codelineno-0-805" href="#__codelineno-0-805"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-806" name="__codelineno-0-806" href="#__codelineno-0-806"></a>    <span class="k">def</span> <span class="nf">generator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">]:</span>
<a id="__codelineno-0-807" name="__codelineno-0-807" href="#__codelineno-0-807"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-808" name="__codelineno-0-808" href="#__codelineno-0-808"></a><span class="sd">        Random generator used by this Problem object.</span>
<a id="__codelineno-0-809" name="__codelineno-0-809" href="#__codelineno-0-809"></a>
<a id="__codelineno-0-810" name="__codelineno-0-810" href="#__codelineno-0-810"></a><span class="sd">        Can also be None, which means that the Problem object will use the</span>
<a id="__codelineno-0-811" name="__codelineno-0-811" href="#__codelineno-0-811"></a><span class="sd">        global random generator of PyTorch.</span>
<a id="__codelineno-0-812" name="__codelineno-0-812" href="#__codelineno-0-812"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-813" name="__codelineno-0-813" href="#__codelineno-0-813"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span>
<a id="__codelineno-0-814" name="__codelineno-0-814" href="#__codelineno-0-814"></a>
<a id="__codelineno-0-815" name="__codelineno-0-815" href="#__codelineno-0-815"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-816" name="__codelineno-0-816" href="#__codelineno-0-816"></a>    <span class="k">def</span> <span class="nf">has_own_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-817" name="__codelineno-0-817" href="#__codelineno-0-817"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-818" name="__codelineno-0-818" href="#__codelineno-0-818"></a><span class="sd">        Whether or not the Problem object has its own random generator.</span>
<a id="__codelineno-0-819" name="__codelineno-0-819" href="#__codelineno-0-819"></a>
<a id="__codelineno-0-820" name="__codelineno-0-820" href="#__codelineno-0-820"></a><span class="sd">        If this is True, then the Problem object will use its own</span>
<a id="__codelineno-0-821" name="__codelineno-0-821" href="#__codelineno-0-821"></a><span class="sd">        random generator when creating random values or tensors.</span>
<a id="__codelineno-0-822" name="__codelineno-0-822" href="#__codelineno-0-822"></a><span class="sd">        If this is False, then the Problem object will use the global</span>
<a id="__codelineno-0-823" name="__codelineno-0-823" href="#__codelineno-0-823"></a><span class="sd">        random generator when creating random values or tensors.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824" href="#__codelineno-0-824"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-825" name="__codelineno-0-825" href="#__codelineno-0-825"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-826" name="__codelineno-0-826" href="#__codelineno-0-826"></a>
<a id="__codelineno-0-827" name="__codelineno-0-827" href="#__codelineno-0-827"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-828" name="__codelineno-0-828" href="#__codelineno-0-828"></a>    <span class="k">def</span> <span class="nf">objective_sense</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectiveSense</span><span class="p">:</span>
<a id="__codelineno-0-829" name="__codelineno-0-829" href="#__codelineno-0-829"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-830" name="__codelineno-0-830" href="#__codelineno-0-830"></a><span class="sd">        Get the objective sense.</span>
<a id="__codelineno-0-831" name="__codelineno-0-831" href="#__codelineno-0-831"></a>
<a id="__codelineno-0-832" name="__codelineno-0-832" href="#__codelineno-0-832"></a><span class="sd">        If the problem is single-objective, then a single string is returned.</span>
<a id="__codelineno-0-833" name="__codelineno-0-833" href="#__codelineno-0-833"></a><span class="sd">        If the problem is multi-objective, then the objective senses will be</span>
<a id="__codelineno-0-834" name="__codelineno-0-834" href="#__codelineno-0-834"></a><span class="sd">        returned in a list.</span>
<a id="__codelineno-0-835" name="__codelineno-0-835" href="#__codelineno-0-835"></a>
<a id="__codelineno-0-836" name="__codelineno-0-836" href="#__codelineno-0-836"></a><span class="sd">        The returned string in the single-objective case, or each returned</span>
<a id="__codelineno-0-837" name="__codelineno-0-837" href="#__codelineno-0-837"></a><span class="sd">        string in the multi-objective case, is &quot;min&quot; or &quot;max&quot;.</span>
<a id="__codelineno-0-838" name="__codelineno-0-838" href="#__codelineno-0-838"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-839" name="__codelineno-0-839" href="#__codelineno-0-839"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-840" name="__codelineno-0-840" href="#__codelineno-0-840"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-841" name="__codelineno-0-841" href="#__codelineno-0-841"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842" href="#__codelineno-0-842"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">senses</span>
<a id="__codelineno-0-843" name="__codelineno-0-843" href="#__codelineno-0-843"></a>
<a id="__codelineno-0-844" name="__codelineno-0-844" href="#__codelineno-0-844"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-845" name="__codelineno-0-845" href="#__codelineno-0-845"></a>    <span class="k">def</span> <span class="nf">senses</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-846" name="__codelineno-0-846" href="#__codelineno-0-846"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-847" name="__codelineno-0-847" href="#__codelineno-0-847"></a><span class="sd">        Get the objective senses.</span>
<a id="__codelineno-0-848" name="__codelineno-0-848" href="#__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849" href="#__codelineno-0-849"></a><span class="sd">        The return value is a list of strings, each string being</span>
<a id="__codelineno-0-850" name="__codelineno-0-850" href="#__codelineno-0-850"></a><span class="sd">        &quot;min&quot; or &quot;max&quot;.</span>
<a id="__codelineno-0-851" name="__codelineno-0-851" href="#__codelineno-0-851"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-852" name="__codelineno-0-852" href="#__codelineno-0-852"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_senses</span>
<a id="__codelineno-0-853" name="__codelineno-0-853" href="#__codelineno-0-853"></a>
<a id="__codelineno-0-854" name="__codelineno-0-854" href="#__codelineno-0-854"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-855" name="__codelineno-0-855" href="#__codelineno-0-855"></a>    <span class="k">def</span> <span class="nf">is_single_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-856" name="__codelineno-0-856" href="#__codelineno-0-856"></a>        <span class="sd">&quot;&quot;&quot;Whether or not the problem is single-objective&quot;&quot;&quot;</span>
<a id="__codelineno-0-857" name="__codelineno-0-857" href="#__codelineno-0-857"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-858" name="__codelineno-0-858" href="#__codelineno-0-858"></a>
<a id="__codelineno-0-859" name="__codelineno-0-859" href="#__codelineno-0-859"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-860" name="__codelineno-0-860" href="#__codelineno-0-860"></a>    <span class="k">def</span> <span class="nf">is_multi_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-861" name="__codelineno-0-861" href="#__codelineno-0-861"></a>        <span class="sd">&quot;&quot;&quot;Whether or not the problem is multi-objective&quot;&quot;&quot;</span>
<a id="__codelineno-0-862" name="__codelineno-0-862" href="#__codelineno-0-862"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-863" name="__codelineno-0-863" href="#__codelineno-0-863"></a>
<a id="__codelineno-0-864" name="__codelineno-0-864" href="#__codelineno-0-864"></a>    <span class="k">def</span> <span class="nf">get_obj_order_descending</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<a id="__codelineno-0-865" name="__codelineno-0-865" href="#__codelineno-0-865"></a>        <span class="sd">&quot;&quot;&quot;When sorting the solutions from best to worst according to each objective i, is the ordering descending?&quot;&quot;&quot;</span>
<a id="__codelineno-0-866" name="__codelineno-0-866" href="#__codelineno-0-866"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-867" name="__codelineno-0-867" href="#__codelineno-0-867"></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">:</span>
<a id="__codelineno-0-868" name="__codelineno-0-868" href="#__codelineno-0-868"></a>            <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
<a id="__codelineno-0-869" name="__codelineno-0-869" href="#__codelineno-0-869"></a>                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870" href="#__codelineno-0-870"></a>            <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-871" name="__codelineno-0-871" href="#__codelineno-0-871"></a>                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-872" name="__codelineno-0-872" href="#__codelineno-0-872"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-873" name="__codelineno-0-873" href="#__codelineno-0-873"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid sense: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-874" name="__codelineno-0-874" href="#__codelineno-0-874"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-875" name="__codelineno-0-875" href="#__codelineno-0-875"></a>
<a id="__codelineno-0-876" name="__codelineno-0-876" href="#__codelineno-0-876"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-877" name="__codelineno-0-877" href="#__codelineno-0-877"></a>    <span class="k">def</span> <span class="nf">solution_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-878" name="__codelineno-0-878" href="#__codelineno-0-878"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-879" name="__codelineno-0-879" href="#__codelineno-0-879"></a><span class="sd">        Get the solution length.</span>
<a id="__codelineno-0-880" name="__codelineno-0-880" href="#__codelineno-0-880"></a>
<a id="__codelineno-0-881" name="__codelineno-0-881" href="#__codelineno-0-881"></a><span class="sd">        Problems with `dtype=None` do not have solution lengths.</span>
<a id="__codelineno-0-882" name="__codelineno-0-882" href="#__codelineno-0-882"></a><span class="sd">        For such problems, this property returns None.</span>
<a id="__codelineno-0-883" name="__codelineno-0-883" href="#__codelineno-0-883"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-884" name="__codelineno-0-884" href="#__codelineno-0-884"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solution_length</span>
<a id="__codelineno-0-885" name="__codelineno-0-885" href="#__codelineno-0-885"></a>
<a id="__codelineno-0-886" name="__codelineno-0-886" href="#__codelineno-0-886"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-887" name="__codelineno-0-887" href="#__codelineno-0-887"></a>    <span class="k">def</span> <span class="nf">eval_data_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-888" name="__codelineno-0-888" href="#__codelineno-0-888"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-889" name="__codelineno-0-889" href="#__codelineno-0-889"></a><span class="sd">        Length of the extra evaluation data vector for each solution.</span>
<a id="__codelineno-0-890" name="__codelineno-0-890" href="#__codelineno-0-890"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-891" name="__codelineno-0-891" href="#__codelineno-0-891"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_data_length</span>
<a id="__codelineno-0-892" name="__codelineno-0-892" href="#__codelineno-0-892"></a>
<a id="__codelineno-0-893" name="__codelineno-0-893" href="#__codelineno-0-893"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-894" name="__codelineno-0-894" href="#__codelineno-0-894"></a>    <span class="k">def</span> <span class="nf">initial_lower_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-895" name="__codelineno-0-895" href="#__codelineno-0-895"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-896" name="__codelineno-0-896" href="#__codelineno-0-896"></a><span class="sd">        Initial lower bounds, for when initializing a new solution.</span>
<a id="__codelineno-0-897" name="__codelineno-0-897" href="#__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898" href="#__codelineno-0-898"></a><span class="sd">        If such a bound was declared during the initialization phase,</span>
<a id="__codelineno-0-899" name="__codelineno-0-899" href="#__codelineno-0-899"></a><span class="sd">        the returned value is a torch tensor (in the form of a vector</span>
<a id="__codelineno-0-900" name="__codelineno-0-900" href="#__codelineno-0-900"></a><span class="sd">        or in the form of a scalar).</span>
<a id="__codelineno-0-901" name="__codelineno-0-901" href="#__codelineno-0-901"></a><span class="sd">        If no such bound was declared, the returned value is None.</span>
<a id="__codelineno-0-902" name="__codelineno-0-902" href="#__codelineno-0-902"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-903" name="__codelineno-0-903" href="#__codelineno-0-903"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_lower_bounds</span>
<a id="__codelineno-0-904" name="__codelineno-0-904" href="#__codelineno-0-904"></a>
<a id="__codelineno-0-905" name="__codelineno-0-905" href="#__codelineno-0-905"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-906" name="__codelineno-0-906" href="#__codelineno-0-906"></a>    <span class="k">def</span> <span class="nf">initial_upper_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-907" name="__codelineno-0-907" href="#__codelineno-0-907"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-908" name="__codelineno-0-908" href="#__codelineno-0-908"></a><span class="sd">        Initial upper bounds, for when initializing a new solution.</span>
<a id="__codelineno-0-909" name="__codelineno-0-909" href="#__codelineno-0-909"></a>
<a id="__codelineno-0-910" name="__codelineno-0-910" href="#__codelineno-0-910"></a><span class="sd">        If such a bound was declared during the initialization phase,</span>
<a id="__codelineno-0-911" name="__codelineno-0-911" href="#__codelineno-0-911"></a><span class="sd">        the returned value is a torch tensor (in the form of a vector</span>
<a id="__codelineno-0-912" name="__codelineno-0-912" href="#__codelineno-0-912"></a><span class="sd">        or in the form of a scalar).</span>
<a id="__codelineno-0-913" name="__codelineno-0-913" href="#__codelineno-0-913"></a><span class="sd">        If no such bound was declared, the returned value is None.</span>
<a id="__codelineno-0-914" name="__codelineno-0-914" href="#__codelineno-0-914"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-915" name="__codelineno-0-915" href="#__codelineno-0-915"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_upper_bounds</span>
<a id="__codelineno-0-916" name="__codelineno-0-916" href="#__codelineno-0-916"></a>
<a id="__codelineno-0-917" name="__codelineno-0-917" href="#__codelineno-0-917"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-918" name="__codelineno-0-918" href="#__codelineno-0-918"></a>    <span class="k">def</span> <span class="nf">lower_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-919" name="__codelineno-0-919" href="#__codelineno-0-919"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-920" name="__codelineno-0-920" href="#__codelineno-0-920"></a><span class="sd">        Lower bounds for the allowed values of a solution.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921" href="#__codelineno-0-921"></a>
<a id="__codelineno-0-922" name="__codelineno-0-922" href="#__codelineno-0-922"></a><span class="sd">        If such a bound was declared during the initialization phase,</span>
<a id="__codelineno-0-923" name="__codelineno-0-923" href="#__codelineno-0-923"></a><span class="sd">        the returned value is a torch tensor (in the form of a vector</span>
<a id="__codelineno-0-924" name="__codelineno-0-924" href="#__codelineno-0-924"></a><span class="sd">        or in the form of a scalar).</span>
<a id="__codelineno-0-925" name="__codelineno-0-925" href="#__codelineno-0-925"></a><span class="sd">        If no such bound was declared, the returned value is None.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926" href="#__codelineno-0-926"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-927" name="__codelineno-0-927" href="#__codelineno-0-927"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lower_bounds</span>
<a id="__codelineno-0-928" name="__codelineno-0-928" href="#__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929" href="#__codelineno-0-929"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-930" name="__codelineno-0-930" href="#__codelineno-0-930"></a>    <span class="k">def</span> <span class="nf">upper_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-931" name="__codelineno-0-931" href="#__codelineno-0-931"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-932" name="__codelineno-0-932" href="#__codelineno-0-932"></a><span class="sd">        Upper bounds for the allowed values of a solution.</span>
<a id="__codelineno-0-933" name="__codelineno-0-933" href="#__codelineno-0-933"></a>
<a id="__codelineno-0-934" name="__codelineno-0-934" href="#__codelineno-0-934"></a><span class="sd">        If such a bound was declared during the initialization phase,</span>
<a id="__codelineno-0-935" name="__codelineno-0-935" href="#__codelineno-0-935"></a><span class="sd">        the returned value is a torch tensor (in the form of a vector</span>
<a id="__codelineno-0-936" name="__codelineno-0-936" href="#__codelineno-0-936"></a><span class="sd">        or in the form of a scalar).</span>
<a id="__codelineno-0-937" name="__codelineno-0-937" href="#__codelineno-0-937"></a><span class="sd">        If no such bound was declared, the returned value is None.</span>
<a id="__codelineno-0-938" name="__codelineno-0-938" href="#__codelineno-0-938"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-939" name="__codelineno-0-939" href="#__codelineno-0-939"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_upper_bounds</span>
<a id="__codelineno-0-940" name="__codelineno-0-940" href="#__codelineno-0-940"></a>
<a id="__codelineno-0-941" name="__codelineno-0-941" href="#__codelineno-0-941"></a>    <span class="k">def</span> <span class="nf">generate_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_solutions</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">]:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942" href="#__codelineno-0-942"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-943" name="__codelineno-0-943" href="#__codelineno-0-943"></a><span class="sd">        Generate decision values.</span>
<a id="__codelineno-0-944" name="__codelineno-0-944" href="#__codelineno-0-944"></a>
<a id="__codelineno-0-945" name="__codelineno-0-945" href="#__codelineno-0-945"></a><span class="sd">        This function returns a tensor containing the decision values</span>
<a id="__codelineno-0-946" name="__codelineno-0-946" href="#__codelineno-0-946"></a><span class="sd">        for `n` new solutions, `n` being the integer passed as the `num_rows`</span>
<a id="__codelineno-0-947" name="__codelineno-0-947" href="#__codelineno-0-947"></a><span class="sd">        argument.</span>
<a id="__codelineno-0-948" name="__codelineno-0-948" href="#__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949" href="#__codelineno-0-949"></a><span class="sd">        For numeric problems, this function generates the decision values</span>
<a id="__codelineno-0-950" name="__codelineno-0-950" href="#__codelineno-0-950"></a><span class="sd">        which respect `initial_bounds` (or `bounds`, if `initial_bounds`</span>
<a id="__codelineno-0-951" name="__codelineno-0-951" href="#__codelineno-0-951"></a><span class="sd">        was not provided).</span>
<a id="__codelineno-0-952" name="__codelineno-0-952" href="#__codelineno-0-952"></a><span class="sd">        If this type of initialization is not desired, one can override</span>
<a id="__codelineno-0-953" name="__codelineno-0-953" href="#__codelineno-0-953"></a><span class="sd">        this function and define a manual initialization scheme in the</span>
<a id="__codelineno-0-954" name="__codelineno-0-954" href="#__codelineno-0-954"></a><span class="sd">        inheriting subclass.</span>
<a id="__codelineno-0-955" name="__codelineno-0-955" href="#__codelineno-0-955"></a>
<a id="__codelineno-0-956" name="__codelineno-0-956" href="#__codelineno-0-956"></a><span class="sd">        For non-numeric problems, it is expected that the inheriting subclass</span>
<a id="__codelineno-0-957" name="__codelineno-0-957" href="#__codelineno-0-957"></a><span class="sd">        will override the method `_fill(...)`.</span>
<a id="__codelineno-0-958" name="__codelineno-0-958" href="#__codelineno-0-958"></a>
<a id="__codelineno-0-959" name="__codelineno-0-959" href="#__codelineno-0-959"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-960" name="__codelineno-0-960" href="#__codelineno-0-960"></a><span class="sd">            num_solutions: For how many solutions will new decision values be</span>
<a id="__codelineno-0-961" name="__codelineno-0-961" href="#__codelineno-0-961"></a><span class="sd">                generated.</span>
<a id="__codelineno-0-962" name="__codelineno-0-962" href="#__codelineno-0-962"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-963" name="__codelineno-0-963" href="#__codelineno-0-963"></a><span class="sd">            A PyTorch tensor for numeric problems, an ObjectArray for</span>
<a id="__codelineno-0-964" name="__codelineno-0-964" href="#__codelineno-0-964"></a><span class="sd">            non-numeric problems.</span>
<a id="__codelineno-0-965" name="__codelineno-0-965" href="#__codelineno-0-965"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-966" name="__codelineno-0-966" href="#__codelineno-0-966"></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_empty</span><span class="p">(</span><span class="n">num_solutions</span><span class="o">=</span><span class="n">num_solutions</span><span class="p">)</span>
<a id="__codelineno-0-967" name="__codelineno-0-967" href="#__codelineno-0-967"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-968" name="__codelineno-0-968" href="#__codelineno-0-968"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-969" name="__codelineno-0-969" href="#__codelineno-0-969"></a>
<a id="__codelineno-0-970" name="__codelineno-0-970" href="#__codelineno-0-970"></a>    <span class="k">def</span> <span class="nf">_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">):</span>
<a id="__codelineno-0-971" name="__codelineno-0-971" href="#__codelineno-0-971"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-972" name="__codelineno-0-972" href="#__codelineno-0-972"></a><span class="sd">        Fill the provided `values` tensor with new decision values.</span>
<a id="__codelineno-0-973" name="__codelineno-0-973" href="#__codelineno-0-973"></a>
<a id="__codelineno-0-974" name="__codelineno-0-974" href="#__codelineno-0-974"></a><span class="sd">        Inheriting subclasses can override this method to specialize how</span>
<a id="__codelineno-0-975" name="__codelineno-0-975" href="#__codelineno-0-975"></a><span class="sd">        new solutions are generated.</span>
<a id="__codelineno-0-976" name="__codelineno-0-976" href="#__codelineno-0-976"></a>
<a id="__codelineno-0-977" name="__codelineno-0-977" href="#__codelineno-0-977"></a><span class="sd">        For numeric problems, this method already has an implementation</span>
<a id="__codelineno-0-978" name="__codelineno-0-978" href="#__codelineno-0-978"></a><span class="sd">        which samples the initial decision values uniformly from the</span>
<a id="__codelineno-0-979" name="__codelineno-0-979" href="#__codelineno-0-979"></a><span class="sd">        interval expressed by `initial_bounds` attribute.</span>
<a id="__codelineno-0-980" name="__codelineno-0-980" href="#__codelineno-0-980"></a><span class="sd">        For non-numeric problems, overriding this method is mandatory.</span>
<a id="__codelineno-0-981" name="__codelineno-0-981" href="#__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982" href="#__codelineno-0-982"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-983" name="__codelineno-0-983" href="#__codelineno-0-983"></a><span class="sd">            values: The tensor which is to be filled with the new decision</span>
<a id="__codelineno-0-984" name="__codelineno-0-984" href="#__codelineno-0-984"></a><span class="sd">                values.</span>
<a id="__codelineno-0-985" name="__codelineno-0-985" href="#__codelineno-0-985"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-986" name="__codelineno-0-986" href="#__codelineno-0-986"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="nb">object</span><span class="p">:</span>
<a id="__codelineno-0-987" name="__codelineno-0-987" href="#__codelineno-0-987"></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
<a id="__codelineno-0-988" name="__codelineno-0-988" href="#__codelineno-0-988"></a>                <span class="s2">&quot;The dtype of this problem is object, therefore a manual implementation of the&quot;</span>
<a id="__codelineno-0-989" name="__codelineno-0-989" href="#__codelineno-0-989"></a>                <span class="s2">&quot; method `_fill(...)` needs to be provided by the inheriting class.&quot;</span>
<a id="__codelineno-0-990" name="__codelineno-0-990" href="#__codelineno-0-990"></a>            <span class="p">)</span>
<a id="__codelineno-0-991" name="__codelineno-0-991" href="#__codelineno-0-991"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-992" name="__codelineno-0-992" href="#__codelineno-0-992"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_uniform</span><span class="p">(</span>
<a id="__codelineno-0-993" name="__codelineno-0-993" href="#__codelineno-0-993"></a>                <span class="n">out</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
<a id="__codelineno-0-994" name="__codelineno-0-994" href="#__codelineno-0-994"></a>                <span class="n">lb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_lower_bounds</span><span class="p">,</span>
<a id="__codelineno-0-995" name="__codelineno-0-995" href="#__codelineno-0-995"></a>                <span class="n">ub</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_upper_bounds</span><span class="p">,</span>
<a id="__codelineno-0-996" name="__codelineno-0-996" href="#__codelineno-0-996"></a>            <span class="p">)</span>
<a id="__codelineno-0-997" name="__codelineno-0-997" href="#__codelineno-0-997"></a>
<a id="__codelineno-0-998" name="__codelineno-0-998" href="#__codelineno-0-998"></a>    <span class="k">def</span> <span class="nf">generate_batch</span><span class="p">(</span>
<a id="__codelineno-0-999" name="__codelineno-0-999" href="#__codelineno-0-999"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000" href="#__codelineno-0-1000"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001" href="#__codelineno-0-1001"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002" href="#__codelineno-0-1002"></a>        <span class="n">empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003" href="#__codelineno-0-1003"></a>        <span class="n">center</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004" href="#__codelineno-0-1004"></a>        <span class="n">stdev</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005" href="#__codelineno-0-1005"></a>        <span class="n">symmetric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006" href="#__codelineno-0-1006"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007" href="#__codelineno-0-1007"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008" href="#__codelineno-0-1008"></a><span class="sd">        Generate a new SolutionBatch.</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009" href="#__codelineno-0-1009"></a>
<a id="__codelineno-0-1010" name="__codelineno-0-1010" href="#__codelineno-0-1010"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011" href="#__codelineno-0-1011"></a><span class="sd">            popsize: Number of solutions that will be contained in the new</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012" href="#__codelineno-0-1012"></a><span class="sd">                batch.</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013" href="#__codelineno-0-1013"></a><span class="sd">            empty: Set this as True if you would like to receive the solutions</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014" href="#__codelineno-0-1014"></a><span class="sd">                un-initialized.</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015" href="#__codelineno-0-1015"></a><span class="sd">            center: Center point of the Gaussian distribution from which</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016" href="#__codelineno-0-1016"></a><span class="sd">                the decision values will be sampled, as a scalar or as a</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017" href="#__codelineno-0-1017"></a><span class="sd">                1-dimensional vector.</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018" href="#__codelineno-0-1018"></a><span class="sd">                Can also be left as None.</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019" href="#__codelineno-0-1019"></a><span class="sd">                If `center` is None and `stdev` is None, all the decision</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020" href="#__codelineno-0-1020"></a><span class="sd">                values will be sampled from the interval specified by</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021" href="#__codelineno-0-1021"></a><span class="sd">                `initial_bounds` (or by `bounds` if `initial_bounds` was not</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022" href="#__codelineno-0-1022"></a><span class="sd">                specified).</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023" href="#__codelineno-0-1023"></a><span class="sd">                If `center` is None and `stdev` is not None, a center point</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024" href="#__codelineno-0-1024"></a><span class="sd">                will be sampled from within the interval specified by</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025" href="#__codelineno-0-1025"></a><span class="sd">                `initial_bounds` or `bounds`, and the decision values will be</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026" href="#__codelineno-0-1026"></a><span class="sd">                sampled from a Gaussian distribution around this center point.</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027" href="#__codelineno-0-1027"></a><span class="sd">            stdev: Can be None (default) if the SolutionBatch is to contain</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028" href="#__codelineno-0-1028"></a><span class="sd">                decision values sampled from the interval specified by</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029" href="#__codelineno-0-1029"></a><span class="sd">                `initial_bounds` (or by `bounds` if `initial_bounds` was not</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030" href="#__codelineno-0-1030"></a><span class="sd">                provided during the initialization phase).</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031" href="#__codelineno-0-1031"></a><span class="sd">                Alternatively, a scalar or a 1-dimensional vector specifying</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032" href="#__codelineno-0-1032"></a><span class="sd">                the standard deviation of the Gaussian distribution from which</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033" href="#__codelineno-0-1033"></a><span class="sd">                the decision values will be sampled.</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034" href="#__codelineno-0-1034"></a><span class="sd">            symmetric: To be used only when `stdev` is not None.</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035" href="#__codelineno-0-1035"></a><span class="sd">                If `symmetric` is True, decision values will be sampled from</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036" href="#__codelineno-0-1036"></a><span class="sd">                the Gaussian distribution in a symmetric (i.e. antithetic)</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037" href="#__codelineno-0-1037"></a><span class="sd">                manner.</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038" href="#__codelineno-0-1038"></a><span class="sd">                Otherwise, the decision values will be sampled in the</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039" href="#__codelineno-0-1039"></a><span class="sd">                non-antithetic manner.</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040" href="#__codelineno-0-1040"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041" href="#__codelineno-0-1041"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">center</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">stdev</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042" href="#__codelineno-0-1042"></a>            <span class="k">if</span> <span class="n">symmetric</span><span class="p">:</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043" href="#__codelineno-0-1043"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044" href="#__codelineno-0-1044"></a>                    <span class="sa">f</span><span class="s2">&quot;The argument `symmetric` can be set as True only when `center` and `stdev` are provided.&quot;</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045" href="#__codelineno-0-1045"></a>                    <span class="sa">f</span><span class="s2">&quot; Although `center` and `stdev` are None, `symmetric` was received as </span><span class="si">{</span><span class="n">symmetric</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046" href="#__codelineno-0-1046"></a>                <span class="p">)</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047" href="#__codelineno-0-1047"></a>            <span class="k">return</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="n">empty</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048" href="#__codelineno-0-1048"></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">center</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">stdev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049" href="#__codelineno-0-1049"></a>            <span class="k">if</span> <span class="n">empty</span><span class="p">:</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050" href="#__codelineno-0-1050"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051" href="#__codelineno-0-1051"></a>                    <span class="sa">f</span><span class="s2">&quot;When `center` and `stdev` are provided, the argument `empty` must be False.&quot;</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052" href="#__codelineno-0-1052"></a>                    <span class="sa">f</span><span class="s2">&quot; However, the received value for `empty` is </span><span class="si">{</span><span class="n">empty</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053" href="#__codelineno-0-1053"></a>                <span class="p">)</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054" href="#__codelineno-0-1054"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055" href="#__codelineno-0-1055"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">make_gaussian</span><span class="p">(</span><span class="n">out</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">access_values</span><span class="p">(),</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">stdev</span><span class="o">=</span><span class="n">stdev</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="n">symmetric</span><span class="p">)</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056" href="#__codelineno-0-1056"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057" href="#__codelineno-0-1057"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058" href="#__codelineno-0-1058"></a>                <span class="sa">f</span><span class="s2">&quot;The arguments `center` and `stdev` were expected to be None or non-None at the same time.&quot;</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059" href="#__codelineno-0-1059"></a>                <span class="sa">f</span><span class="s2">&quot; Received `center`: </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060" href="#__codelineno-0-1060"></a>                <span class="sa">f</span><span class="s2">&quot; Received `stdev`: </span><span class="si">{</span><span class="n">stdev</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061" href="#__codelineno-0-1061"></a>            <span class="p">)</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062" href="#__codelineno-0-1062"></a>
<a id="__codelineno-0-1063" name="__codelineno-0-1063" href="#__codelineno-0-1063"></a>    <span class="k">def</span> <span class="nf">_parallelize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064" href="#__codelineno-0-1064"></a>        <span class="sd">&quot;&quot;&quot;Create ray actors for parallelizing the solution evaluations.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065" href="#__codelineno-0-1065"></a>
<a id="__codelineno-0-1066" name="__codelineno-0-1066" href="#__codelineno-0-1066"></a>        <span class="c1"># If the problem was explicitly configured for</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067" href="#__codelineno-0-1067"></a>        <span class="c1"># NOT having parallelization, leave this function.</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068" href="#__codelineno-0-1068"></a>        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069" href="#__codelineno-0-1069"></a>            <span class="k">return</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070" href="#__codelineno-0-1070"></a>
<a id="__codelineno-0-1071" name="__codelineno-0-1071" href="#__codelineno-0-1071"></a>        <span class="c1"># If this problem object is a remote one,</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072" href="#__codelineno-0-1072"></a>        <span class="c1"># leave this function</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073" href="#__codelineno-0-1073"></a>        <span class="c1"># (because we do not want the remote worker</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074" href="#__codelineno-0-1074"></a>        <span class="c1"># to parallelize itself further)</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075" href="#__codelineno-0-1075"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actor_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076" href="#__codelineno-0-1076"></a>            <span class="k">return</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077" href="#__codelineno-0-1077"></a>
<a id="__codelineno-0-1078" name="__codelineno-0-1078" href="#__codelineno-0-1078"></a>        <span class="c1"># If the actors list is not None, then this means</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079" href="#__codelineno-0-1079"></a>        <span class="c1"># that the initialization of the parallelization mechanism</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080" href="#__codelineno-0-1080"></a>        <span class="c1"># was already completed. So, leave this function.</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081" href="#__codelineno-0-1081"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082" href="#__codelineno-0-1082"></a>            <span class="k">return</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083" href="#__codelineno-0-1083"></a>
<a id="__codelineno-0-1084" name="__codelineno-0-1084" href="#__codelineno-0-1084"></a>        <span class="c1"># Make sure that ray is initialized</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085" href="#__codelineno-0-1085"></a>        <span class="n">ensure_ray</span><span class="p">()</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086" href="#__codelineno-0-1086"></a>        <span class="n">number_of_actors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087" href="#__codelineno-0-1087"></a>
<a id="__codelineno-0-1088" name="__codelineno-0-1088" href="#__codelineno-0-1088"></a>        <span class="c1"># numpy&#39;s RandomState uses 32-bit unsigned integers</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089" href="#__codelineno-0-1089"></a>        <span class="c1"># for random seeds.</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090" href="#__codelineno-0-1090"></a>        <span class="c1"># So, the following value is the exclusive upper bound</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091" href="#__codelineno-0-1091"></a>        <span class="c1"># for a random seed.</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092" href="#__codelineno-0-1092"></a>        <span class="n">supremum_seed</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093" href="#__codelineno-0-1093"></a>
<a id="__codelineno-0-1094" name="__codelineno-0-1094" href="#__codelineno-0-1094"></a>        <span class="c1"># Generate an integer from the main problem object&#39;s</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095" href="#__codelineno-0-1095"></a>        <span class="c1"># random_state. From this integer, further seed integers</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096" href="#__codelineno-0-1096"></a>        <span class="c1"># will be computed, and these generated seeds will be</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097" href="#__codelineno-0-1097"></a>        <span class="c1"># used by the remote actors.</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098" href="#__codelineno-0-1098"></a>        <span class="n">base_seed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">make_randint</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(),</span> <span class="n">n</span><span class="o">=</span><span class="n">supremum_seed</span><span class="p">))</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099" href="#__codelineno-0-1099"></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100" href="#__codelineno-0-1100"></a>        <span class="c1"># The following function returns a seed number for the actor</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101" href="#__codelineno-0-1101"></a>        <span class="c1"># number i.</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102" href="#__codelineno-0-1102"></a>        <span class="k">def</span> <span class="nf">generate_actor_seed</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103" href="#__codelineno-0-1103"></a>            <span class="k">nonlocal</span> <span class="n">base_seed</span><span class="p">,</span> <span class="n">supremum_seed</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104" href="#__codelineno-0-1104"></a>            <span class="k">return</span> <span class="p">(</span><span class="n">base_seed</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">%</span> <span class="n">supremum_seed</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105" href="#__codelineno-0-1105"></a>
<a id="__codelineno-0-1106" name="__codelineno-0-1106" href="#__codelineno-0-1106"></a>        <span class="n">all_seeds</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107" href="#__codelineno-0-1107"></a>        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108" href="#__codelineno-0-1108"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_actors</span><span class="p">):</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109" href="#__codelineno-0-1109"></a>            <span class="n">actor_seeds</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110" href="#__codelineno-0-1110"></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111" href="#__codelineno-0-1111"></a>                <span class="n">actor_seeds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generate_actor_seed</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112" href="#__codelineno-0-1112"></a>                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113" href="#__codelineno-0-1113"></a>            <span class="n">all_seeds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">actor_seeds</span><span class="p">))</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114" href="#__codelineno-0-1114"></a>
<a id="__codelineno-0-1115" name="__codelineno-0-1115" href="#__codelineno-0-1115"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remote_states</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116" href="#__codelineno-0-1116"></a>            <span class="n">remote_states</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_actors</span><span class="p">)]</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117" href="#__codelineno-0-1117"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118" href="#__codelineno-0-1118"></a>            <span class="n">remote_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remote_states</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119" href="#__codelineno-0-1119"></a>
<a id="__codelineno-0-1120" name="__codelineno-0-1120" href="#__codelineno-0-1120"></a>        <span class="c1"># Prepare the necessary actor config</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121" href="#__codelineno-0-1121"></a>        <span class="n">config_per_actor</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122" href="#__codelineno-0-1122"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actor_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123" href="#__codelineno-0-1123"></a>            <span class="n">config_per_actor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_config</span><span class="p">)</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124" href="#__codelineno-0-1124"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125" href="#__codelineno-0-1125"></a>            <span class="n">config_per_actor</span><span class="p">[</span><span class="s2">&quot;num_gpus&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126" href="#__codelineno-0-1126"></a>
<a id="__codelineno-0-1127" name="__codelineno-0-1127" href="#__codelineno-0-1127"></a>        <span class="c1"># Generate the actors, each with a unique seed.</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128" href="#__codelineno-0-1128"></a>        <span class="k">if</span> <span class="n">config_per_actor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129" href="#__codelineno-0-1129"></a>            <span class="n">actors</span> <span class="o">=</span> <span class="p">[</span><span class="n">EvaluationActor</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">all_seeds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">remote_states</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_actors</span><span class="p">)]</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130" href="#__codelineno-0-1130"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131" href="#__codelineno-0-1131"></a>            <span class="n">actors</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132" href="#__codelineno-0-1132"></a>                <span class="n">EvaluationActor</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">config_per_actor</span><span class="p">)</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">all_seeds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">remote_states</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133" href="#__codelineno-0-1133"></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_actors</span><span class="p">)</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134" href="#__codelineno-0-1134"></a>            <span class="p">]</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135" href="#__codelineno-0-1135"></a>
<a id="__codelineno-0-1136" name="__codelineno-0-1136" href="#__codelineno-0-1136"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="o">=</span> <span class="n">actors</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137" href="#__codelineno-0-1137"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_pool</span> <span class="o">=</span> <span class="n">ActorPool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">)</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138" href="#__codelineno-0-1138"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_remote_states</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139" href="#__codelineno-0-1139"></a>
<a id="__codelineno-0-1140" name="__codelineno-0-1140" href="#__codelineno-0-1140"></a>    <span class="k">def</span> <span class="nf">all_remote_problems</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AllRemoteProblems</span><span class="p">:</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141" href="#__codelineno-0-1141"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142" href="#__codelineno-0-1142"></a><span class="sd">        Get an accessor which is used for running a method</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143" href="#__codelineno-0-1143"></a><span class="sd">        on all remote clones of this Problem object.</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144" href="#__codelineno-0-1144"></a>
<a id="__codelineno-0-1145" name="__codelineno-0-1145" href="#__codelineno-0-1145"></a><span class="sd">        For example, given a Problem object named `my_problem`,</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146" href="#__codelineno-0-1146"></a><span class="sd">        also assuming that this Problem object is parallelized,</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147" href="#__codelineno-0-1147"></a><span class="sd">        and therefore has `n` remote actors, a method `f()`</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148" href="#__codelineno-0-1148"></a><span class="sd">        can be executed on all the remote instances as follows:</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149" href="#__codelineno-0-1149"></a>
<a id="__codelineno-0-1150" name="__codelineno-0-1150" href="#__codelineno-0-1150"></a><span class="sd">            results = my_problem.all_remote_problems().f()</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151" href="#__codelineno-0-1151"></a>
<a id="__codelineno-0-1152" name="__codelineno-0-1152" href="#__codelineno-0-1152"></a><span class="sd">        The variable `results` is a list of length `n`, the i-th</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153" href="#__codelineno-0-1153"></a><span class="sd">        item of the list belonging to the method f&#39;s result</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154" href="#__codelineno-0-1154"></a><span class="sd">        from the i-th actor.</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155" href="#__codelineno-0-1155"></a>
<a id="__codelineno-0-1156" name="__codelineno-0-1156" href="#__codelineno-0-1156"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157" href="#__codelineno-0-1157"></a><span class="sd">            A method accessor for all the remote Problem objects.</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158" href="#__codelineno-0-1158"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159" href="#__codelineno-0-1159"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parallelize</span><span class="p">()</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160" href="#__codelineno-0-1160"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_remote</span><span class="p">:</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161" href="#__codelineno-0-1161"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162" href="#__codelineno-0-1162"></a>                <span class="s2">&quot;The method `all_remote_problems()` can only be used on the main (i.e. non-remote)&quot;</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163" href="#__codelineno-0-1163"></a>                <span class="s2">&quot; Problem instance.&quot;</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164" href="#__codelineno-0-1164"></a>                <span class="s2">&quot; However, this Problem instance is on a remote actor.&quot;</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165" href="#__codelineno-0-1165"></a>            <span class="p">)</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166" href="#__codelineno-0-1166"></a>        <span class="k">return</span> <span class="n">AllRemoteProblems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">)</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167" href="#__codelineno-0-1167"></a>
<a id="__codelineno-0-1168" name="__codelineno-0-1168" href="#__codelineno-0-1168"></a>    <span class="k">def</span> <span class="nf">all_remote_envs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AllRemoteEnvs</span><span class="p">:</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169" href="#__codelineno-0-1169"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170" href="#__codelineno-0-1170"></a><span class="sd">        Get an accessor which is used for running a method</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171" href="#__codelineno-0-1171"></a><span class="sd">        on all remote reinforcement learning environments.</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172" href="#__codelineno-0-1172"></a>
<a id="__codelineno-0-1173" name="__codelineno-0-1173" href="#__codelineno-0-1173"></a><span class="sd">        This method can only be used on parallelized Problem</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174" href="#__codelineno-0-1174"></a><span class="sd">        objects which have their `get_env()` methods defined.</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175" href="#__codelineno-0-1175"></a><span class="sd">        For example, one can use this feature on a parallelized</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176" href="#__codelineno-0-1176"></a><span class="sd">        GymProblem.</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177" href="#__codelineno-0-1177"></a>
<a id="__codelineno-0-1178" name="__codelineno-0-1178" href="#__codelineno-0-1178"></a><span class="sd">        As an example, let us consider a parallelized GymProblem</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179" href="#__codelineno-0-1179"></a><span class="sd">        object named `my_problem`. Given that `my_problem` has</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180" href="#__codelineno-0-1180"></a><span class="sd">        `n` remote actors, a method `f()` can be executed</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181" href="#__codelineno-0-1181"></a><span class="sd">        on all remote reinforcement learning environments as</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182" href="#__codelineno-0-1182"></a><span class="sd">        follows:</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183" href="#__codelineno-0-1183"></a>
<a id="__codelineno-0-1184" name="__codelineno-0-1184" href="#__codelineno-0-1184"></a><span class="sd">            results = my_problem.all_remote_envs().f()</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185" href="#__codelineno-0-1185"></a>
<a id="__codelineno-0-1186" name="__codelineno-0-1186" href="#__codelineno-0-1186"></a><span class="sd">        The variable `results` is a list of length `n`, the i-th</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187" href="#__codelineno-0-1187"></a><span class="sd">        item of the list belonging to the method f&#39;s result</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188" href="#__codelineno-0-1188"></a><span class="sd">        from the i-th actor.</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189" href="#__codelineno-0-1189"></a>
<a id="__codelineno-0-1190" name="__codelineno-0-1190" href="#__codelineno-0-1190"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191" href="#__codelineno-0-1191"></a><span class="sd">            A method accessor for all the remote reinforcement</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192" href="#__codelineno-0-1192"></a><span class="sd">            learning environments.</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193" href="#__codelineno-0-1193"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194" href="#__codelineno-0-1194"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parallelize</span><span class="p">()</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195" href="#__codelineno-0-1195"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_remote</span><span class="p">:</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196" href="#__codelineno-0-1196"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197" href="#__codelineno-0-1197"></a>                <span class="s2">&quot;The method `all_remote_envs()` can only be used on the main (i.e. non-remote)&quot;</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198" href="#__codelineno-0-1198"></a>                <span class="s2">&quot; Problem instance.&quot;</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199" href="#__codelineno-0-1199"></a>                <span class="s2">&quot; However, this Problem instance is on a remote actor.&quot;</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200" href="#__codelineno-0-1200"></a>            <span class="p">)</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201" href="#__codelineno-0-1201"></a>        <span class="k">return</span> <span class="n">AllRemoteEnvs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">)</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202" href="#__codelineno-0-1202"></a>
<a id="__codelineno-0-1203" name="__codelineno-0-1203" href="#__codelineno-0-1203"></a>    <span class="k">def</span> <span class="nf">kill_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204" href="#__codelineno-0-1204"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205" href="#__codelineno-0-1205"></a><span class="sd">        Kill all the remote actors used by the Problem instance.</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206" href="#__codelineno-0-1206"></a>
<a id="__codelineno-0-1207" name="__codelineno-0-1207" href="#__codelineno-0-1207"></a><span class="sd">        One might use this method to release the resources used by the</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208" href="#__codelineno-0-1208"></a><span class="sd">        remote actors.</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209" href="#__codelineno-0-1209"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210" href="#__codelineno-0-1210"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211" href="#__codelineno-0-1211"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212" href="#__codelineno-0-1212"></a>                <span class="s2">&quot;The method `kill_actors()` can only be used on the main (i.e. non-remote)&quot;</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213" href="#__codelineno-0-1213"></a>                <span class="s2">&quot; Problem instance.&quot;</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214" href="#__codelineno-0-1214"></a>                <span class="s2">&quot; However, this Problem instance is on a remote actor.&quot;</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215" href="#__codelineno-0-1215"></a>            <span class="p">)</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216" href="#__codelineno-0-1216"></a>        <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">:</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217" href="#__codelineno-0-1217"></a>            <span class="n">ray</span><span class="o">.</span><span class="n">kill</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218" href="#__codelineno-0-1218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219" href="#__codelineno-0-1219"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_pool</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220" href="#__codelineno-0-1220"></a>
<a id="__codelineno-0-1221" name="__codelineno-0-1221" href="#__codelineno-0-1221"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222" href="#__codelineno-0-1222"></a>    <span class="k">def</span> <span class="nf">num_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223" href="#__codelineno-0-1223"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224" href="#__codelineno-0-1224"></a><span class="sd">        Number of actors (to be) used for parallelization.</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225" href="#__codelineno-0-1225"></a><span class="sd">        If the problem is configured for no parallelization,</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226" href="#__codelineno-0-1226"></a><span class="sd">        the result will be 0.</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227" href="#__codelineno-0-1227"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228" href="#__codelineno-0-1228"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229" href="#__codelineno-0-1229"></a>
<a id="__codelineno-0-1230" name="__codelineno-0-1230" href="#__codelineno-0-1230"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231" href="#__codelineno-0-1231"></a>    <span class="k">def</span> <span class="nf">actors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]:</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232" href="#__codelineno-0-1232"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233" href="#__codelineno-0-1233"></a><span class="sd">        Get the ray actors, if the Problem object is distributed.</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234" href="#__codelineno-0-1234"></a><span class="sd">        If the Problem object is not distributed and therefore</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235" href="#__codelineno-0-1235"></a><span class="sd">        has no actors, then, the result will be None.</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236" href="#__codelineno-0-1236"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237" href="#__codelineno-0-1237"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238" href="#__codelineno-0-1238"></a>
<a id="__codelineno-0-1239" name="__codelineno-0-1239" href="#__codelineno-0-1239"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240" href="#__codelineno-0-1240"></a>    <span class="k">def</span> <span class="nf">actor_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241" href="#__codelineno-0-1241"></a>        <span class="sd">&quot;&quot;&quot;Return the actor index if this is a remote worker.</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242" href="#__codelineno-0-1242"></a><span class="sd">        If this is not a remote worker, return None.</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243" href="#__codelineno-0-1243"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244" href="#__codelineno-0-1244"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actor_index</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245" href="#__codelineno-0-1245"></a>
<a id="__codelineno-0-1246" name="__codelineno-0-1246" href="#__codelineno-0-1246"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247" href="#__codelineno-0-1247"></a>    <span class="k">def</span> <span class="nf">is_remote</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248" href="#__codelineno-0-1248"></a>        <span class="sd">&quot;&quot;&quot;Returns True if this problem object lives in a remote ray actor.</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249" href="#__codelineno-0-1249"></a><span class="sd">        Otherwise, returns False.</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250" href="#__codelineno-0-1250"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251" href="#__codelineno-0-1251"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actor_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252" href="#__codelineno-0-1252"></a>
<a id="__codelineno-0-1253" name="__codelineno-0-1253" href="#__codelineno-0-1253"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254" href="#__codelineno-0-1254"></a>    <span class="k">def</span> <span class="nf">is_main</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255" href="#__codelineno-0-1255"></a>        <span class="sd">&quot;&quot;&quot;Returns True if this problem object lives in the main process</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256" href="#__codelineno-0-1256"></a><span class="sd">        and not in a remote actor.</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257" href="#__codelineno-0-1257"></a><span class="sd">        Otherwise, returns False.</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258" href="#__codelineno-0-1258"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259" href="#__codelineno-0-1259"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actor_index</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260" href="#__codelineno-0-1260"></a>
<a id="__codelineno-0-1261" name="__codelineno-0-1261" href="#__codelineno-0-1261"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262" href="#__codelineno-0-1262"></a>    <span class="k">def</span> <span class="nf">before_eval_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hook</span><span class="p">:</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263" href="#__codelineno-0-1263"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264" href="#__codelineno-0-1264"></a><span class="sd">        Get the Hook which stores the functions to call just before</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265" href="#__codelineno-0-1265"></a><span class="sd">        evaluating a SolutionBatch.</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266" href="#__codelineno-0-1266"></a>
<a id="__codelineno-0-1267" name="__codelineno-0-1267" href="#__codelineno-0-1267"></a><span class="sd">        The functions to be stored in this hook are expected to</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268" href="#__codelineno-0-1268"></a><span class="sd">        accept one positional argument, that one argument being the</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269" href="#__codelineno-0-1269"></a><span class="sd">        SolutionBatch which is about to be evaluated.</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270" href="#__codelineno-0-1270"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271" href="#__codelineno-0-1271"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before_eval_hook</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272" href="#__codelineno-0-1272"></a>
<a id="__codelineno-0-1273" name="__codelineno-0-1273" href="#__codelineno-0-1273"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274" href="#__codelineno-0-1274"></a>    <span class="k">def</span> <span class="nf">after_eval_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hook</span><span class="p">:</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275" href="#__codelineno-0-1275"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276" href="#__codelineno-0-1276"></a><span class="sd">        Get the Hook which stores the functions to call just after</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277" href="#__codelineno-0-1277"></a><span class="sd">        evaluating a SolutionBatch.</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278" href="#__codelineno-0-1278"></a>
<a id="__codelineno-0-1279" name="__codelineno-0-1279" href="#__codelineno-0-1279"></a><span class="sd">        The functions to be stored in this hook are expected to</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280" href="#__codelineno-0-1280"></a><span class="sd">        accept one argument, that one argument being the SolutionBatch</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281" href="#__codelineno-0-1281"></a><span class="sd">        whose evaluation has just been completed.</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282" href="#__codelineno-0-1282"></a>
<a id="__codelineno-0-1283" name="__codelineno-0-1283" href="#__codelineno-0-1283"></a><span class="sd">        The dictionaries returned by the functions in this hook</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284" href="#__codelineno-0-1284"></a><span class="sd">        are accumulated, and reported in the status dictionary of this</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285" href="#__codelineno-0-1285"></a><span class="sd">        problem object.</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286" href="#__codelineno-0-1286"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287" href="#__codelineno-0-1287"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_hook</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288" href="#__codelineno-0-1288"></a>
<a id="__codelineno-0-1289" name="__codelineno-0-1289" href="#__codelineno-0-1289"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290" href="#__codelineno-0-1290"></a>    <span class="k">def</span> <span class="nf">before_grad_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hook</span><span class="p">:</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291" href="#__codelineno-0-1291"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292" href="#__codelineno-0-1292"></a><span class="sd">        Get the Hook which stores the functions to call just before</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293" href="#__codelineno-0-1293"></a><span class="sd">        its `sample_and_compute_gradients(...)` operation.</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294" href="#__codelineno-0-1294"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295" href="#__codelineno-0-1295"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before_grad_hook</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296" href="#__codelineno-0-1296"></a>
<a id="__codelineno-0-1297" name="__codelineno-0-1297" href="#__codelineno-0-1297"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298" href="#__codelineno-0-1298"></a>    <span class="k">def</span> <span class="nf">after_grad_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hook</span><span class="p">:</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299" href="#__codelineno-0-1299"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300" href="#__codelineno-0-1300"></a><span class="sd">        Get the Hook which stores the functions to call just after</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301" href="#__codelineno-0-1301"></a><span class="sd">        its `sample_and_compute_gradients(...)` operation.</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302" href="#__codelineno-0-1302"></a>
<a id="__codelineno-0-1303" name="__codelineno-0-1303" href="#__codelineno-0-1303"></a><span class="sd">        The functions to be stored in this hook are expected to</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304" href="#__codelineno-0-1304"></a><span class="sd">        accept one argument, that one argument being the gradients</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305" href="#__codelineno-0-1305"></a><span class="sd">        dictionary (which was produced by the Problem object,</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306" href="#__codelineno-0-1306"></a><span class="sd">        but not yet followed by the search algorithm).</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307" href="#__codelineno-0-1307"></a>
<a id="__codelineno-0-1308" name="__codelineno-0-1308" href="#__codelineno-0-1308"></a><span class="sd">        The dictionaries returned by the functions in this hook</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309" href="#__codelineno-0-1309"></a><span class="sd">        are accumulated, and reported in the status dictionary of this</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310" href="#__codelineno-0-1310"></a><span class="sd">        problem object.</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311" href="#__codelineno-0-1311"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312" href="#__codelineno-0-1312"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grad_hook</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313" href="#__codelineno-0-1313"></a>
<a id="__codelineno-0-1314" name="__codelineno-0-1314" href="#__codelineno-0-1314"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315" href="#__codelineno-0-1315"></a>    <span class="k">def</span> <span class="nf">remote_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hook</span><span class="p">:</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316" href="#__codelineno-0-1316"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317" href="#__codelineno-0-1317"></a><span class="sd">        Get the Hook which stores the functions to call when this</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318" href="#__codelineno-0-1318"></a><span class="sd">        Problem object is (re)created on a remote actor.</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319" href="#__codelineno-0-1319"></a>
<a id="__codelineno-0-1320" name="__codelineno-0-1320" href="#__codelineno-0-1320"></a><span class="sd">        The functions in this hook should expect one positional</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321" href="#__codelineno-0-1321"></a><span class="sd">        argument, that is the Problem object itself.</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322" href="#__codelineno-0-1322"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323" href="#__codelineno-0-1323"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remote_hook</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324" href="#__codelineno-0-1324"></a>
<a id="__codelineno-0-1325" name="__codelineno-0-1325" href="#__codelineno-0-1325"></a>    <span class="k">def</span> <span class="nf">_make_sync_data_for_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326" href="#__codelineno-0-1326"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327" href="#__codelineno-0-1327"></a><span class="sd">        Override this function for providing synchronization between</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328" href="#__codelineno-0-1328"></a><span class="sd">        the main process and the remote actors.</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329" href="#__codelineno-0-1329"></a>
<a id="__codelineno-0-1330" name="__codelineno-0-1330" href="#__codelineno-0-1330"></a><span class="sd">        The responsibility of this function is to prepare and return the</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331" href="#__codelineno-0-1331"></a><span class="sd">        data to be sent to the remote actors for synchronization.</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332" href="#__codelineno-0-1332"></a>
<a id="__codelineno-0-1333" name="__codelineno-0-1333" href="#__codelineno-0-1333"></a><span class="sd">        If this function returns NotImplemented, then there will be no</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334" href="#__codelineno-0-1334"></a><span class="sd">        syncing.</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335" href="#__codelineno-0-1335"></a><span class="sd">        If this function returns None, there will be no data sent to the</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336" href="#__codelineno-0-1336"></a><span class="sd">        actors for syncing, however, syncing will still be enabled, and</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337" href="#__codelineno-0-1337"></a><span class="sd">        the main actor will ask for sync data from the remote actors</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338" href="#__codelineno-0-1338"></a><span class="sd">        after their jobs are finished.</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339" href="#__codelineno-0-1339"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340" href="#__codelineno-0-1340"></a>        <span class="k">return</span> <span class="bp">NotImplemented</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341" href="#__codelineno-0-1341"></a>
<a id="__codelineno-0-1342" name="__codelineno-0-1342" href="#__codelineno-0-1342"></a>    <span class="k">def</span> <span class="nf">_use_sync_data_from_main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">received</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343" href="#__codelineno-0-1343"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344" href="#__codelineno-0-1344"></a><span class="sd">        Override this function for providing synchronization between</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345" href="#__codelineno-0-1345"></a><span class="sd">        the main process and the remote actors.</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346" href="#__codelineno-0-1346"></a>
<a id="__codelineno-0-1347" name="__codelineno-0-1347" href="#__codelineno-0-1347"></a><span class="sd">        The responsibility of this function is to update the state</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348" href="#__codelineno-0-1348"></a><span class="sd">        of the remote Problem object according to the synchronization</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349" href="#__codelineno-0-1349"></a><span class="sd">        data received by the main process.</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350" href="#__codelineno-0-1350"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351" href="#__codelineno-0-1351"></a>        <span class="k">pass</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352" href="#__codelineno-0-1352"></a>
<a id="__codelineno-0-1353" name="__codelineno-0-1353" href="#__codelineno-0-1353"></a>    <span class="k">def</span> <span class="nf">_make_sync_data_for_main</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354" href="#__codelineno-0-1354"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355" href="#__codelineno-0-1355"></a><span class="sd">        Override this function for providing synchronization between</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356" href="#__codelineno-0-1356"></a><span class="sd">        the main process and the remote actors.</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357" href="#__codelineno-0-1357"></a>
<a id="__codelineno-0-1358" name="__codelineno-0-1358" href="#__codelineno-0-1358"></a><span class="sd">        The responsibility of this function is to prepare and return the</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359" href="#__codelineno-0-1359"></a><span class="sd">        data to be sent to the main Problem object by a remote actor.</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360" href="#__codelineno-0-1360"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361" href="#__codelineno-0-1361"></a>        <span class="k">return</span> <span class="bp">NotImplemented</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362" href="#__codelineno-0-1362"></a>
<a id="__codelineno-0-1363" name="__codelineno-0-1363" href="#__codelineno-0-1363"></a>    <span class="k">def</span> <span class="nf">_use_sync_data_from_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">received</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364" href="#__codelineno-0-1364"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365" href="#__codelineno-0-1365"></a><span class="sd">        Override this function for providing synchronization between</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366" href="#__codelineno-0-1366"></a><span class="sd">        the main process and the remote actors.</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367" href="#__codelineno-0-1367"></a>
<a id="__codelineno-0-1368" name="__codelineno-0-1368" href="#__codelineno-0-1368"></a><span class="sd">        The responsibility of this function is to update the state</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369" href="#__codelineno-0-1369"></a><span class="sd">        of the main Problem object according to the synchronization</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370" href="#__codelineno-0-1370"></a><span class="sd">        data received by the remote actors.</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371" href="#__codelineno-0-1371"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372" href="#__codelineno-0-1372"></a>        <span class="k">pass</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373" href="#__codelineno-0-1373"></a>
<a id="__codelineno-0-1374" name="__codelineno-0-1374" href="#__codelineno-0-1374"></a>    <span class="k">def</span> <span class="nf">_make_pickle_data_for_main</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375" href="#__codelineno-0-1375"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376" href="#__codelineno-0-1376"></a><span class="sd">        Override this function for preserving the state of a remote</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377" href="#__codelineno-0-1377"></a><span class="sd">        actor in the main state dictionary when pickling a parallelized</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378" href="#__codelineno-0-1378"></a><span class="sd">        problem.</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379" href="#__codelineno-0-1379"></a>
<a id="__codelineno-0-1380" name="__codelineno-0-1380" href="#__codelineno-0-1380"></a><span class="sd">        The responsibility of this function is to return the state</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381" href="#__codelineno-0-1381"></a><span class="sd">        of a problem object which lives in a remote actor.</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382" href="#__codelineno-0-1382"></a>
<a id="__codelineno-0-1383" name="__codelineno-0-1383" href="#__codelineno-0-1383"></a><span class="sd">        If the remote clones of this problem do not need to be stateful</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384" href="#__codelineno-0-1384"></a><span class="sd">        then you probably do not need to override this method.</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385" href="#__codelineno-0-1385"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1386" name="__codelineno-0-1386" href="#__codelineno-0-1386"></a>        <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387" href="#__codelineno-0-1387"></a>
<a id="__codelineno-0-1388" name="__codelineno-0-1388" href="#__codelineno-0-1388"></a>    <span class="k">def</span> <span class="nf">_use_pickle_data_from_main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389" href="#__codelineno-0-1389"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390" href="#__codelineno-0-1390"></a><span class="sd">        Override this function for re-creating the internal state of</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391" href="#__codelineno-0-1391"></a><span class="sd">        a problem instance living in a remote actor, by using the</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392" href="#__codelineno-0-1392"></a><span class="sd">        given state dictionary.</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393" href="#__codelineno-0-1393"></a>
<a id="__codelineno-0-1394" name="__codelineno-0-1394" href="#__codelineno-0-1394"></a><span class="sd">        If the remote clones of this problem do not need to be stateful</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395" href="#__codelineno-0-1395"></a><span class="sd">        then you probably do not need to override this method.</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396" href="#__codelineno-0-1396"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397" href="#__codelineno-0-1397"></a>        <span class="k">pass</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398" href="#__codelineno-0-1398"></a>
<a id="__codelineno-0-1399" name="__codelineno-0-1399" href="#__codelineno-0-1399"></a>    <span class="k">def</span> <span class="nf">_sync_before</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400" href="#__codelineno-0-1400"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401" href="#__codelineno-0-1401"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402" href="#__codelineno-0-1402"></a>
<a id="__codelineno-0-1403" name="__codelineno-0-1403" href="#__codelineno-0-1403"></a>        <span class="n">to_send</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_sync_data_for_actors</span><span class="p">()</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404" href="#__codelineno-0-1404"></a>        <span class="k">if</span> <span class="n">to_send</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405" href="#__codelineno-0-1405"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406" href="#__codelineno-0-1406"></a>
<a id="__codelineno-0-1407" name="__codelineno-0-1407" href="#__codelineno-0-1407"></a>        <span class="k">if</span> <span class="n">to_send</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408" href="#__codelineno-0-1408"></a>            <span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="n">actor</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;_use_sync_data_from_main&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">to_send</span><span class="p">],</span> <span class="p">{})</span> <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">])</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409" href="#__codelineno-0-1409"></a>
<a id="__codelineno-0-1410" name="__codelineno-0-1410" href="#__codelineno-0-1410"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411" href="#__codelineno-0-1411"></a>
<a id="__codelineno-0-1412" name="__codelineno-0-1412" href="#__codelineno-0-1412"></a>    <span class="k">def</span> <span class="nf">_sync_after</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413" href="#__codelineno-0-1413"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414" href="#__codelineno-0-1414"></a>            <span class="k">return</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415" href="#__codelineno-0-1415"></a>
<a id="__codelineno-0-1416" name="__codelineno-0-1416" href="#__codelineno-0-1416"></a>        <span class="n">received</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="n">actor</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;_make_sync_data_for_main&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{})</span> <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">])</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417" href="#__codelineno-0-1417"></a>
<a id="__codelineno-0-1418" name="__codelineno-0-1418" href="#__codelineno-0-1418"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_use_sync_data_from_actors</span><span class="p">(</span><span class="n">received</span><span class="p">)</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419" href="#__codelineno-0-1419"></a>
<a id="__codelineno-0-1420" name="__codelineno-0-1420" href="#__codelineno-0-1420"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421" href="#__codelineno-0-1421"></a>    <span class="k">def</span> <span class="nf">_get_best_and_worst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422" href="#__codelineno-0-1422"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_store_solution_stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423" href="#__codelineno-0-1423"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_store_solution_stats</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424" href="#__codelineno-0-1424"></a>
<a id="__codelineno-0-1425" name="__codelineno-0-1425" href="#__codelineno-0-1425"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_store_solution_stats</span><span class="p">:</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426" href="#__codelineno-0-1426"></a>            <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427" href="#__codelineno-0-1427"></a>
<a id="__codelineno-0-1428" name="__codelineno-0-1428" href="#__codelineno-0-1428"></a>        <span class="n">senses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">senses</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429" href="#__codelineno-0-1429"></a>        <span class="n">nobjs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">senses</span><span class="p">)</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430" href="#__codelineno-0-1430"></a>
<a id="__codelineno-0-1431" name="__codelineno-0-1431" href="#__codelineno-0-1431"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_best</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432" href="#__codelineno-0-1432"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_best_evals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_empty</span><span class="p">(</span><span class="n">nobjs</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">batch</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">use_eval_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1433" name="__codelineno-0-1433" href="#__codelineno-0-1433"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_worst_evals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_empty</span><span class="p">(</span><span class="n">nobjs</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">batch</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">use_eval_dtype</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434" href="#__codelineno-0-1434"></a>            <span class="k">for</span> <span class="n">i_obj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nobjs</span><span class="p">):</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435" href="#__codelineno-0-1435"></a>                <span class="k">if</span> <span class="n">senses</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436" href="#__codelineno-0-1436"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_best_evals</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437" href="#__codelineno-0-1437"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_worst_evals</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438" href="#__codelineno-0-1438"></a>                <span class="k">elif</span> <span class="n">senses</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439" href="#__codelineno-0-1439"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_best_evals</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440" href="#__codelineno-0-1440"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_worst_evals</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441" href="#__codelineno-0-1441"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442" href="#__codelineno-0-1442"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid sense: </span><span class="si">{</span><span class="n">senses</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443" href="#__codelineno-0-1443"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_best</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">nobjs</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444" href="#__codelineno-0-1444"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_worst</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">nobjs</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445" href="#__codelineno-0-1445"></a>
<a id="__codelineno-0-1446" name="__codelineno-0-1446" href="#__codelineno-0-1446"></a>        <span class="k">def</span> <span class="nf">first_is_better</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">i_obj</span><span class="p">):</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447" href="#__codelineno-0-1447"></a>            <span class="k">if</span> <span class="n">senses</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448" href="#__codelineno-0-1448"></a>                <span class="k">return</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449" href="#__codelineno-0-1449"></a>            <span class="k">elif</span> <span class="n">senses</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450" href="#__codelineno-0-1450"></a>                <span class="k">return</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451" href="#__codelineno-0-1451"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452" href="#__codelineno-0-1452"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid sense: </span><span class="si">{</span><span class="n">senses</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1453" name="__codelineno-0-1453" href="#__codelineno-0-1453"></a>
<a id="__codelineno-0-1454" name="__codelineno-0-1454" href="#__codelineno-0-1454"></a>        <span class="k">def</span> <span class="nf">first_is_worse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">i_obj</span><span class="p">):</span>
<a id="__codelineno-0-1455" name="__codelineno-0-1455" href="#__codelineno-0-1455"></a>            <span class="k">if</span> <span class="n">senses</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456" href="#__codelineno-0-1456"></a>                <span class="k">return</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span>
<a id="__codelineno-0-1457" name="__codelineno-0-1457" href="#__codelineno-0-1457"></a>            <span class="k">elif</span> <span class="n">senses</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458" href="#__codelineno-0-1458"></a>                <span class="k">return</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span>
<a id="__codelineno-0-1459" name="__codelineno-0-1459" href="#__codelineno-0-1459"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460" href="#__codelineno-0-1460"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid sense: </span><span class="si">{</span><span class="n">senses</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461" href="#__codelineno-0-1461"></a>
<a id="__codelineno-0-1462" name="__codelineno-0-1462" href="#__codelineno-0-1462"></a>        <span class="n">best_sln_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch</span><span class="o">.</span><span class="n">argbest</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nobjs</span><span class="p">)]</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463" href="#__codelineno-0-1463"></a>        <span class="n">worst_sln_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch</span><span class="o">.</span><span class="n">argworst</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nobjs</span><span class="p">)]</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464" href="#__codelineno-0-1464"></a>
<a id="__codelineno-0-1465" name="__codelineno-0-1465" href="#__codelineno-0-1465"></a>        <span class="k">for</span> <span class="n">i_obj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nobjs</span><span class="p">):</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466" href="#__codelineno-0-1466"></a>            <span class="n">best_sln_index</span> <span class="o">=</span> <span class="n">best_sln_indices</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467" href="#__codelineno-0-1467"></a>            <span class="n">worst_sln_index</span> <span class="o">=</span> <span class="n">worst_sln_indices</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468" href="#__codelineno-0-1468"></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">access_evals</span><span class="p">(</span><span class="n">i_obj</span><span class="p">)</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469" href="#__codelineno-0-1469"></a>            <span class="n">best_score</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">best_sln_index</span><span class="p">]</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470" href="#__codelineno-0-1470"></a>            <span class="n">worst_score</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">worst_sln_index</span><span class="p">]</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471" href="#__codelineno-0-1471"></a>            <span class="k">if</span> <span class="n">first_is_better</span><span class="p">(</span><span class="n">best_score</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_best_evals</span><span class="p">[</span><span class="n">i_obj</span><span class="p">],</span> <span class="n">i_obj</span><span class="p">):</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472" href="#__codelineno-0-1472"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_best_evals</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_score</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473" href="#__codelineno-0-1473"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_best</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="n">best_sln_index</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474" href="#__codelineno-0-1474"></a>            <span class="k">if</span> <span class="n">first_is_worse</span><span class="p">(</span><span class="n">worst_score</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_worst_evals</span><span class="p">[</span><span class="n">i_obj</span><span class="p">],</span> <span class="n">i_obj</span><span class="p">):</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475" href="#__codelineno-0-1475"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_worst_evals</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">worst_score</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476" href="#__codelineno-0-1476"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_worst</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="n">worst_sln_index</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477" href="#__codelineno-0-1477"></a>
<a id="__codelineno-0-1478" name="__codelineno-0-1478" href="#__codelineno-0-1478"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479" href="#__codelineno-0-1479"></a>
<a id="__codelineno-0-1480" name="__codelineno-0-1480" href="#__codelineno-0-1480"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">senses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481" href="#__codelineno-0-1481"></a>            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482" href="#__codelineno-0-1482"></a>                <span class="n">best</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_best</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483" href="#__codelineno-0-1483"></a>                <span class="n">worst</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_worst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484" href="#__codelineno-0-1484"></a>                <span class="n">best_eval</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_best</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">evaluation</span><span class="p">),</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485" href="#__codelineno-0-1485"></a>                <span class="n">worst_eval</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_worst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">evaluation</span><span class="p">),</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486" href="#__codelineno-0-1486"></a>            <span class="p">)</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487" href="#__codelineno-0-1487"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488" href="#__codelineno-0-1488"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;best&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_best</span><span class="p">,</span> <span class="s2">&quot;worst&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_worst</span><span class="p">}</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489" href="#__codelineno-0-1489"></a>
<a id="__codelineno-0-1490" name="__codelineno-0-1490" href="#__codelineno-0-1490"></a>    <span class="k">def</span> <span class="nf">compare_solutions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491" href="#__codelineno-0-1491"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492" href="#__codelineno-0-1492"></a><span class="sd">        Compare two solutions.</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493" href="#__codelineno-0-1493"></a><span class="sd">        It is assumed that both solutions are already evaluated.</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494" href="#__codelineno-0-1494"></a>
<a id="__codelineno-0-1495" name="__codelineno-0-1495" href="#__codelineno-0-1495"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496" href="#__codelineno-0-1496"></a><span class="sd">            a: The first solution.</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497" href="#__codelineno-0-1497"></a><span class="sd">            b: The second solution.</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498" href="#__codelineno-0-1498"></a><span class="sd">            obj_index: The objective index according to which the comparison</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499" href="#__codelineno-0-1499"></a><span class="sd">                will be made.</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500" href="#__codelineno-0-1500"></a><span class="sd">                Can be left as None if the problem is single-objective.</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501" href="#__codelineno-0-1501"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1502" name="__codelineno-0-1502" href="#__codelineno-0-1502"></a><span class="sd">            A positive number if `a` is better;</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503" href="#__codelineno-0-1503"></a><span class="sd">            a negative number if `b` is better;</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504" href="#__codelineno-0-1504"></a><span class="sd">            0 if there is a tie.</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505" href="#__codelineno-0-1505"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506" href="#__codelineno-0-1506"></a>        <span class="n">senses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">senses</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507" href="#__codelineno-0-1507"></a>        <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-1508" name="__codelineno-0-1508" href="#__codelineno-0-1508"></a>        <span class="n">sense</span> <span class="o">=</span> <span class="n">senses</span><span class="p">[</span><span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509" href="#__codelineno-0-1509"></a>
<a id="__codelineno-0-1510" name="__codelineno-0-1510" href="#__codelineno-0-1510"></a>        <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-1511" name="__codelineno-0-1511" href="#__codelineno-0-1511"></a>            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">evals</span><span class="p">[</span><span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512" href="#__codelineno-0-1512"></a>
<a id="__codelineno-0-1513" name="__codelineno-0-1513" href="#__codelineno-0-1513"></a>        <span class="k">if</span> <span class="n">sense</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1514" name="__codelineno-0-1514" href="#__codelineno-0-1514"></a>            <span class="k">return</span> <span class="n">score</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="n">score</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515" href="#__codelineno-0-1515"></a>        <span class="k">elif</span> <span class="n">sense</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516" href="#__codelineno-0-1516"></a>            <span class="k">return</span> <span class="n">score</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">score</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517" href="#__codelineno-0-1517"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1518" name="__codelineno-0-1518" href="#__codelineno-0-1518"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unrecognized sense: &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">sense</span><span class="p">))</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519" href="#__codelineno-0-1519"></a>
<a id="__codelineno-0-1520" name="__codelineno-0-1520" href="#__codelineno-0-1520"></a>    <span class="k">def</span> <span class="nf">is_better</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1521" name="__codelineno-0-1521" href="#__codelineno-0-1521"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1522" name="__codelineno-0-1522" href="#__codelineno-0-1522"></a><span class="sd">        Check whether or not the first solution is better.</span>
<a id="__codelineno-0-1523" name="__codelineno-0-1523" href="#__codelineno-0-1523"></a><span class="sd">        It is assumed that both solutions are already evaluated.</span>
<a id="__codelineno-0-1524" name="__codelineno-0-1524" href="#__codelineno-0-1524"></a>
<a id="__codelineno-0-1525" name="__codelineno-0-1525" href="#__codelineno-0-1525"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1526" name="__codelineno-0-1526" href="#__codelineno-0-1526"></a><span class="sd">            a: The first solution.</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527" href="#__codelineno-0-1527"></a><span class="sd">            b: The second solution.</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528" href="#__codelineno-0-1528"></a><span class="sd">            obj_index: The objective index according to which the comparison</span>
<a id="__codelineno-0-1529" name="__codelineno-0-1529" href="#__codelineno-0-1529"></a><span class="sd">                will be made.</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530" href="#__codelineno-0-1530"></a><span class="sd">                Can be left as None if the problem is single-objective.</span>
<a id="__codelineno-0-1531" name="__codelineno-0-1531" href="#__codelineno-0-1531"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1532" name="__codelineno-0-1532" href="#__codelineno-0-1532"></a><span class="sd">            True if `a` is better; False otherwise.</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533" href="#__codelineno-0-1533"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534" href="#__codelineno-0-1534"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_solutions</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535" href="#__codelineno-0-1535"></a>
<a id="__codelineno-0-1536" name="__codelineno-0-1536" href="#__codelineno-0-1536"></a>    <span class="k">def</span> <span class="nf">is_worse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537" href="#__codelineno-0-1537"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538" href="#__codelineno-0-1538"></a><span class="sd">        Check whether or not the first solution is worse.</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539" href="#__codelineno-0-1539"></a><span class="sd">        It is assumed that both solutions are already evaluated.</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540" href="#__codelineno-0-1540"></a>
<a id="__codelineno-0-1541" name="__codelineno-0-1541" href="#__codelineno-0-1541"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542" href="#__codelineno-0-1542"></a><span class="sd">            a: The first solution.</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543" href="#__codelineno-0-1543"></a><span class="sd">            b: The second solution.</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544" href="#__codelineno-0-1544"></a><span class="sd">            obj_index: The objective index according to which the comparison</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545" href="#__codelineno-0-1545"></a><span class="sd">                will be made.</span>
<a id="__codelineno-0-1546" name="__codelineno-0-1546" href="#__codelineno-0-1546"></a><span class="sd">                Can be left as None if the problem is single-objective.</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547" href="#__codelineno-0-1547"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548" href="#__codelineno-0-1548"></a><span class="sd">            True if `a` is worse; False otherwise.</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549" href="#__codelineno-0-1549"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550" href="#__codelineno-0-1550"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_solutions</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551" href="#__codelineno-0-1551"></a>
<a id="__codelineno-0-1552" name="__codelineno-0-1552" href="#__codelineno-0-1552"></a>    <span class="k">def</span> <span class="nf">_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553" href="#__codelineno-0-1553"></a>        <span class="sd">&quot;&quot;&quot;Prepare a worker instance of the problem for evaluation. To be overridden by the user&quot;&quot;&quot;</span>
<a id="__codelineno-0-1554" name="__codelineno-0-1554" href="#__codelineno-0-1554"></a>        <span class="k">pass</span>
<a id="__codelineno-0-1555" name="__codelineno-0-1555" href="#__codelineno-0-1555"></a>
<a id="__codelineno-0-1556" name="__codelineno-0-1556" href="#__codelineno-0-1556"></a>    <span class="k">def</span> <span class="nf">_prepare_main</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1557" name="__codelineno-0-1557" href="#__codelineno-0-1557"></a>        <span class="sd">&quot;&quot;&quot;Prepare the main instance of the problem for evaluation.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558" href="#__codelineno-0-1558"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_share_attributes</span><span class="p">()</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559" href="#__codelineno-0-1559"></a>
<a id="__codelineno-0-1560" name="__codelineno-0-1560" href="#__codelineno-0-1560"></a>    <span class="k">def</span> <span class="nf">_start_preparations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561" href="#__codelineno-0-1561"></a>        <span class="sd">&quot;&quot;&quot;Prepare the problem for evaluation. Calls self._prepare() if the self._prepared flag is not True.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562" href="#__codelineno-0-1562"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepared</span><span class="p">:</span>
<a id="__codelineno-0-1563" name="__codelineno-0-1563" href="#__codelineno-0-1563"></a>
<a id="__codelineno-0-1564" name="__codelineno-0-1564" href="#__codelineno-0-1564"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565" href="#__codelineno-0-1565"></a>                <span class="c1"># Call prepare method for any problem class that is expected to do work</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566" href="#__codelineno-0-1566"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_prepare</span><span class="p">()</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567" href="#__codelineno-0-1567"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568" href="#__codelineno-0-1568"></a>                <span class="c1"># Call share method to distribute shared attributes to actors</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569" href="#__codelineno-0-1569"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_main</span><span class="p">()</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570" href="#__codelineno-0-1570"></a>
<a id="__codelineno-0-1571" name="__codelineno-0-1571" href="#__codelineno-0-1571"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_prepared</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572" href="#__codelineno-0-1572"></a>
<a id="__codelineno-0-1573" name="__codelineno-0-1573" href="#__codelineno-0-1573"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574" href="#__codelineno-0-1574"></a>    <span class="k">def</span> <span class="nf">_nonserialized_attribs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575" href="#__codelineno-0-1575"></a>        <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-1576" name="__codelineno-0-1576" href="#__codelineno-0-1576"></a>
<a id="__codelineno-0-1577" name="__codelineno-0-1577" href="#__codelineno-0-1577"></a>    <span class="k">def</span> <span class="nf">_share_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578" href="#__codelineno-0-1578"></a>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579" href="#__codelineno-0-1579"></a>            <span class="k">for</span> <span class="n">attrib_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shared_attribs</span><span class="p">:</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580" href="#__codelineno-0-1580"></a>                <span class="n">obj_ref</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib_name</span><span class="p">))</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581" href="#__codelineno-0-1581"></a>                <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span><span class="p">:</span>
<a id="__codelineno-0-1582" name="__codelineno-0-1582" href="#__codelineno-0-1582"></a>                    <span class="n">actor</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;put_ray_object&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{</span><span class="s2">&quot;obj_ref&quot;</span><span class="p">:</span> <span class="n">obj_ref</span><span class="p">,</span> <span class="s2">&quot;attrib_name&quot;</span><span class="p">:</span> <span class="n">attrib_name</span><span class="p">})</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583" href="#__codelineno-0-1583"></a>
<a id="__codelineno-0-1584" name="__codelineno-0-1584" href="#__codelineno-0-1584"></a>    <span class="k">def</span> <span class="nf">put_ray_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_ref</span><span class="p">:</span> <span class="n">ray</span><span class="o">.</span><span class="n">ObjectRef</span><span class="p">,</span> <span class="n">attrib_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585" href="#__codelineno-0-1585"></a>        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib_name</span><span class="p">,</span> <span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">obj_ref</span><span class="p">))</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586" href="#__codelineno-0-1586"></a>
<a id="__codelineno-0-1587" name="__codelineno-0-1587" href="#__codelineno-0-1587"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588" href="#__codelineno-0-1588"></a>    <span class="k">def</span> <span class="nf">_shared_attribs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589" href="#__codelineno-0-1589"></a>        <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590" href="#__codelineno-0-1590"></a>
<a id="__codelineno-0-1591" name="__codelineno-0-1591" href="#__codelineno-0-1591"></a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;SolutionBatch&quot;</span><span class="p">,</span> <span class="s2">&quot;Solution&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592" href="#__codelineno-0-1592"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593" href="#__codelineno-0-1593"></a><span class="sd">        Evaluate the given Solution or SolutionBatch.</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594" href="#__codelineno-0-1594"></a>
<a id="__codelineno-0-1595" name="__codelineno-0-1595" href="#__codelineno-0-1595"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596" href="#__codelineno-0-1596"></a><span class="sd">            batch: The SolutionBatch to be evaluated.</span>
<a id="__codelineno-0-1597" name="__codelineno-0-1597" href="#__codelineno-0-1597"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598" href="#__codelineno-0-1598"></a>
<a id="__codelineno-0-1599" name="__codelineno-0-1599" href="#__codelineno-0-1599"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600" href="#__codelineno-0-1600"></a>            <span class="n">batch</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_batch</span><span class="p">()</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601" href="#__codelineno-0-1601"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602" href="#__codelineno-0-1602"></a>            <span class="n">batch</span> <span class="o">=</span> <span class="n">x</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603" href="#__codelineno-0-1603"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1604" name="__codelineno-0-1604" href="#__codelineno-0-1604"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605" href="#__codelineno-0-1605"></a>                <span class="sa">f</span><span class="s2">&quot;The method `evaluate(...)` expected a Solution or a SolutionBatch as its argument.&quot;</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606" href="#__codelineno-0-1606"></a>                <span class="sa">f</span><span class="s2">&quot; However, the received object is </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">, which is of type </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607" href="#__codelineno-0-1607"></a>            <span class="p">)</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608" href="#__codelineno-0-1608"></a>
<a id="__codelineno-0-1609" name="__codelineno-0-1609" href="#__codelineno-0-1609"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parallelize</span><span class="p">()</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610" href="#__codelineno-0-1610"></a>
<a id="__codelineno-0-1611" name="__codelineno-0-1611" href="#__codelineno-0-1611"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612" href="#__codelineno-0-1612"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">before_eval_hook</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613" href="#__codelineno-0-1613"></a>
<a id="__codelineno-0-1614" name="__codelineno-0-1614" href="#__codelineno-0-1614"></a>        <span class="n">must_sync_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sync_before</span><span class="p">()</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615" href="#__codelineno-0-1615"></a>
<a id="__codelineno-0-1616" name="__codelineno-0-1616" href="#__codelineno-0-1616"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_start_preparations</span><span class="p">()</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617" href="#__codelineno-0-1617"></a>
<a id="__codelineno-0-1618" name="__codelineno-0-1618" href="#__codelineno-0-1618"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_all</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619" href="#__codelineno-0-1619"></a>
<a id="__codelineno-0-1620" name="__codelineno-0-1620" href="#__codelineno-0-1620"></a>        <span class="k">if</span> <span class="n">must_sync_after</span><span class="p">:</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621" href="#__codelineno-0-1621"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_after</span><span class="p">()</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622" href="#__codelineno-0-1622"></a>
<a id="__codelineno-0-1623" name="__codelineno-0-1623" href="#__codelineno-0-1623"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624" href="#__codelineno-0-1624"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625" href="#__codelineno-0-1625"></a>
<a id="__codelineno-0-1626" name="__codelineno-0-1626" href="#__codelineno-0-1626"></a>            <span class="n">best_and_worst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_best_and_worst</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627" href="#__codelineno-0-1627"></a>            <span class="k">if</span> <span class="n">best_and_worst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1628" name="__codelineno-0-1628" href="#__codelineno-0-1628"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">best_and_worst</span><span class="p">)</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629" href="#__codelineno-0-1629"></a>
<a id="__codelineno-0-1630" name="__codelineno-0-1630" href="#__codelineno-0-1630"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">after_eval_hook</span><span class="o">.</span><span class="n">accumulate_dict</span><span class="p">(</span><span class="n">batch</span><span class="p">))</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631" href="#__codelineno-0-1631"></a>
<a id="__codelineno-0-1632" name="__codelineno-0-1632" href="#__codelineno-0-1632"></a>    <span class="k">def</span> <span class="nf">_evaluate_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633" href="#__codelineno-0-1633"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634" href="#__codelineno-0-1634"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635" href="#__codelineno-0-1635"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1636" name="__codelineno-0-1636" href="#__codelineno-0-1636"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_subbatches</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637" href="#__codelineno-0-1637"></a>                <span class="n">pieces</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_subbatches</span><span class="p">)</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638" href="#__codelineno-0-1638"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1639" name="__codelineno-0-1639" href="#__codelineno-0-1639"></a>                <span class="n">pieces</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">max_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="p">)</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640" href="#__codelineno-0-1640"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641" href="#__codelineno-0-1641"></a>                <span class="n">pieces</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">))</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642" href="#__codelineno-0-1642"></a>            <span class="c1"># mapresult = self._actor_pool.map(lambda a, v: a.evaluate_batch.remote(v), list(pieces))</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643" href="#__codelineno-0-1643"></a>            <span class="c1"># for i, evals in enumerate(mapresult):</span>
<a id="__codelineno-0-1644" name="__codelineno-0-1644" href="#__codelineno-0-1644"></a>            <span class="c1">#    row_begin, row_end = pieces.indices_of(i)</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645" href="#__codelineno-0-1645"></a>            <span class="c1">#    batch._evdata[row_begin:row_end, :] = evals</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646" href="#__codelineno-0-1646"></a>
<a id="__codelineno-0-1647" name="__codelineno-0-1647" href="#__codelineno-0-1647"></a>            <span class="n">mapresult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actor_pool</span><span class="o">.</span><span class="n">map_unordered</span><span class="p">(</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648" href="#__codelineno-0-1648"></a>                <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">evaluate_batch_piece</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">pieces</span><span class="p">))</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649" href="#__codelineno-0-1649"></a>            <span class="p">)</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650" href="#__codelineno-0-1650"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">evals</span> <span class="ow">in</span> <span class="n">mapresult</span><span class="p">:</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651" href="#__codelineno-0-1651"></a>                <span class="n">row_begin</span><span class="p">,</span> <span class="n">row_end</span> <span class="o">=</span> <span class="n">pieces</span><span class="o">.</span><span class="n">indices_of</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652" href="#__codelineno-0-1652"></a>                <span class="n">batch</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">row_begin</span><span class="p">:</span><span class="n">row_end</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">evals</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653" href="#__codelineno-0-1653"></a>
<a id="__codelineno-0-1654" name="__codelineno-0-1654" href="#__codelineno-0-1654"></a>    <span class="k">def</span> <span class="nf">_evaluate_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655" href="#__codelineno-0-1655"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vectorized</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_objective_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656" href="#__codelineno-0-1656"></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objective_func</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657" href="#__codelineno-0-1657"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
<a id="__codelineno-0-1658" name="__codelineno-0-1658" href="#__codelineno-0-1658"></a>                <span class="n">batch</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="o">*</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659" href="#__codelineno-0-1659"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1660" name="__codelineno-0-1660" href="#__codelineno-0-1660"></a>                <span class="n">batch</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-1661" name="__codelineno-0-1661" href="#__codelineno-0-1661"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1662" name="__codelineno-0-1662" href="#__codelineno-0-1662"></a>            <span class="k">for</span> <span class="n">sln</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">:</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663" href="#__codelineno-0-1663"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate</span><span class="p">(</span><span class="n">sln</span><span class="p">)</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664" href="#__codelineno-0-1664"></a>
<a id="__codelineno-0-1665" name="__codelineno-0-1665" href="#__codelineno-0-1665"></a>    <span class="k">def</span> <span class="nf">_evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666" href="#__codelineno-0-1666"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objective_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667" href="#__codelineno-0-1667"></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objective_func</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668" href="#__codelineno-0-1668"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669" href="#__codelineno-0-1669"></a>                <span class="n">solution</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="o">*</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670" href="#__codelineno-0-1670"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671" href="#__codelineno-0-1671"></a>                <span class="n">solution</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672" href="#__codelineno-0-1672"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673" href="#__codelineno-0-1673"></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674" href="#__codelineno-0-1674"></a>
<a id="__codelineno-0-1675" name="__codelineno-0-1675" href="#__codelineno-0-1675"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676" href="#__codelineno-0-1676"></a>    <span class="k">def</span> <span class="nf">stores_solution_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677" href="#__codelineno-0-1677"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678" href="#__codelineno-0-1678"></a><span class="sd">        Whether or not the best and worst solutions are kept.</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679" href="#__codelineno-0-1679"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680" href="#__codelineno-0-1680"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_store_solution_stats</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681" href="#__codelineno-0-1681"></a>
<a id="__codelineno-0-1682" name="__codelineno-0-1682" href="#__codelineno-0-1682"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683" href="#__codelineno-0-1683"></a>    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684" href="#__codelineno-0-1684"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685" href="#__codelineno-0-1685"></a><span class="sd">        Status dictionary of the problem object, updated after the last</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686" href="#__codelineno-0-1686"></a><span class="sd">        evaluation operation.</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687" href="#__codelineno-0-1687"></a>
<a id="__codelineno-0-1688" name="__codelineno-0-1688" href="#__codelineno-0-1688"></a><span class="sd">        The dictionaries returned by the functions in `after_eval_hook`</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689" href="#__codelineno-0-1689"></a><span class="sd">        are accumulated, and reported in this status dictionary.</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690" href="#__codelineno-0-1690"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691" href="#__codelineno-0-1691"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692" href="#__codelineno-0-1692"></a>
<a id="__codelineno-0-1693" name="__codelineno-0-1693" href="#__codelineno-0-1693"></a>    <span class="k">def</span> <span class="nf">ensure_numeric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694" href="#__codelineno-0-1694"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695" href="#__codelineno-0-1695"></a><span class="sd">        Ensure that the problem has a numeric dtype.</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696" href="#__codelineno-0-1696"></a>
<a id="__codelineno-0-1697" name="__codelineno-0-1697" href="#__codelineno-0-1697"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698" href="#__codelineno-0-1698"></a><span class="sd">            ValueError: if the problem has a non-numeric dtype.</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699" href="#__codelineno-0-1699"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700" href="#__codelineno-0-1700"></a>        <span class="k">if</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701" href="#__codelineno-0-1701"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected a problem with numeric dtype, but the dtype is object.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702" href="#__codelineno-0-1702"></a>
<a id="__codelineno-0-1703" name="__codelineno-0-1703" href="#__codelineno-0-1703"></a>    <span class="k">def</span> <span class="nf">ensure_unbounded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704" href="#__codelineno-0-1704"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705" href="#__codelineno-0-1705"></a><span class="sd">        Ensure that the problem has no strict lower and upper bounds.</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706" href="#__codelineno-0-1706"></a>
<a id="__codelineno-0-1707" name="__codelineno-0-1707" href="#__codelineno-0-1707"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708" href="#__codelineno-0-1708"></a><span class="sd">            ValueError: if the problem has strict lower and upper bounds.</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709" href="#__codelineno-0-1709"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710" href="#__codelineno-0-1710"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711" href="#__codelineno-0-1711"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected an unbounded problem, but this problem has lower and/or upper bounds.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712" href="#__codelineno-0-1712"></a>
<a id="__codelineno-0-1713" name="__codelineno-0-1713" href="#__codelineno-0-1713"></a>    <span class="k">def</span> <span class="nf">ensure_single_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714" href="#__codelineno-0-1714"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715" href="#__codelineno-0-1715"></a><span class="sd">        Ensure that the problem has only one objective.</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716" href="#__codelineno-0-1716"></a>
<a id="__codelineno-0-1717" name="__codelineno-0-1717" href="#__codelineno-0-1717"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718" href="#__codelineno-0-1718"></a><span class="sd">            ValueError: if the problem is multi-objective.</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719" href="#__codelineno-0-1719"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720" href="#__codelineno-0-1720"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721" href="#__codelineno-0-1721"></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722" href="#__codelineno-0-1722"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected a single-objective problem, but this problem has </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> objectives.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723" href="#__codelineno-0-1723"></a>
<a id="__codelineno-0-1724" name="__codelineno-0-1724" href="#__codelineno-0-1724"></a>    <span class="k">def</span> <span class="nf">normalize_obj_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-1725" name="__codelineno-0-1725" href="#__codelineno-0-1725"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726" href="#__codelineno-0-1726"></a><span class="sd">        Normalize the objective index.</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727" href="#__codelineno-0-1727"></a>
<a id="__codelineno-0-1728" name="__codelineno-0-1728" href="#__codelineno-0-1728"></a><span class="sd">        If the provided index is non-negative, it is ensured that the index</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729" href="#__codelineno-0-1729"></a><span class="sd">        is valid.</span>
<a id="__codelineno-0-1730" name="__codelineno-0-1730" href="#__codelineno-0-1730"></a>
<a id="__codelineno-0-1731" name="__codelineno-0-1731" href="#__codelineno-0-1731"></a><span class="sd">        If the provided index is negative, the objectives are counted in the</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732" href="#__codelineno-0-1732"></a><span class="sd">        reverse order, and the corresponding non-negative index is returned.</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733" href="#__codelineno-0-1733"></a><span class="sd">        For example, -1 is converted to a non-negative integer corresponding to</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734" href="#__codelineno-0-1734"></a><span class="sd">        the last objective.</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735" href="#__codelineno-0-1735"></a>
<a id="__codelineno-0-1736" name="__codelineno-0-1736" href="#__codelineno-0-1736"></a><span class="sd">        If the provided index is None and if the problem is single-objective,</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737" href="#__codelineno-0-1737"></a><span class="sd">        the returned value is 0, which represents the only objective.</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738" href="#__codelineno-0-1738"></a>
<a id="__codelineno-0-1739" name="__codelineno-0-1739" href="#__codelineno-0-1739"></a><span class="sd">        If the provided index is None and if the problem is multi-objective,</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740" href="#__codelineno-0-1740"></a><span class="sd">        an error is raised.</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741" href="#__codelineno-0-1741"></a>
<a id="__codelineno-0-1742" name="__codelineno-0-1742" href="#__codelineno-0-1742"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743" href="#__codelineno-0-1743"></a><span class="sd">            obj_index: The non-normalized objective index.</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744" href="#__codelineno-0-1744"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745" href="#__codelineno-0-1745"></a><span class="sd">            The normalized objective index, as a non-negative integer.</span>
<a id="__codelineno-0-1746" name="__codelineno-0-1746" href="#__codelineno-0-1746"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747" href="#__codelineno-0-1747"></a>        <span class="k">if</span> <span class="n">obj_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748" href="#__codelineno-0-1748"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1749" name="__codelineno-0-1749" href="#__codelineno-0-1749"></a>                <span class="k">return</span> <span class="mi">0</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750" href="#__codelineno-0-1750"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751" href="#__codelineno-0-1751"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752" href="#__codelineno-0-1752"></a>                    <span class="s2">&quot;This problem is multi-objective, therefore, an explicit objective index was expected.&quot;</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753" href="#__codelineno-0-1753"></a>                    <span class="s2">&quot; However, `obj_index` was found to be None.&quot;</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754" href="#__codelineno-0-1754"></a>                <span class="p">)</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755" href="#__codelineno-0-1755"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756" href="#__codelineno-0-1756"></a>            <span class="n">obj_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757" href="#__codelineno-0-1757"></a>            <span class="k">if</span> <span class="n">obj_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1758" name="__codelineno-0-1758" href="#__codelineno-0-1758"></a>                <span class="n">obj_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span> <span class="o">+</span> <span class="n">obj_index</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759" href="#__codelineno-0-1759"></a>            <span class="k">if</span> <span class="n">obj_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">obj_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">):</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760" href="#__codelineno-0-1760"></a>                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Objective index out of range.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761" href="#__codelineno-0-1761"></a>            <span class="k">return</span> <span class="n">obj_index</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762" href="#__codelineno-0-1762"></a>
<a id="__codelineno-0-1763" name="__codelineno-0-1763" href="#__codelineno-0-1763"></a>    <span class="k">def</span> <span class="nf">_get_cloned_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">memo</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764" href="#__codelineno-0-1764"></a>        <span class="c1"># Collect the inner states of the remote Problem clones</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765" href="#__codelineno-0-1765"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766" href="#__codelineno-0-1766"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_remote_states</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767" href="#__codelineno-0-1767"></a>                <span class="p">[</span><span class="n">actor</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="s2">&quot;_make_pickle_data_for_main&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{})</span> <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">]</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768" href="#__codelineno-0-1768"></a>            <span class="p">)</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769" href="#__codelineno-0-1769"></a>
<a id="__codelineno-0-1770" name="__codelineno-0-1770" href="#__codelineno-0-1770"></a>        <span class="c1"># Prepare the main state dictionary</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771" href="#__codelineno-0-1771"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772" href="#__codelineno-0-1772"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773" href="#__codelineno-0-1773"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;_actors&quot;</span><span class="p">,</span> <span class="s2">&quot;_actor_pool&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nonserialized_attribs</span><span class="p">:</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774" href="#__codelineno-0-1774"></a>                <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775" href="#__codelineno-0-1775"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776" href="#__codelineno-0-1776"></a>                <span class="n">v_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777" href="#__codelineno-0-1777"></a>                <span class="k">if</span> <span class="n">v_id</span> <span class="ow">in</span> <span class="n">memo</span><span class="p">:</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778" href="#__codelineno-0-1778"></a>                    <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">memo</span><span class="p">[</span><span class="n">v_id</span><span class="p">]</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779" href="#__codelineno-0-1779"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780" href="#__codelineno-0-1780"></a>                    <span class="k">with</span> <span class="n">_no_grad_if_basic_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781" href="#__codelineno-0-1781"></a>                        <span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">deep_clone</span><span class="p">(</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782" href="#__codelineno-0-1782"></a>                            <span class="n">v</span><span class="p">,</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783" href="#__codelineno-0-1783"></a>                            <span class="n">otherwise_deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784" href="#__codelineno-0-1784"></a>                            <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">,</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785" href="#__codelineno-0-1785"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786" href="#__codelineno-0-1786"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-1787" name="__codelineno-0-1787" href="#__codelineno-0-1787"></a>
<a id="__codelineno-0-1788" name="__codelineno-0-1788" href="#__codelineno-0-1788"></a>    <span class="k">def</span> <span class="nf">_get_local_interaction_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789" href="#__codelineno-0-1789"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790" href="#__codelineno-0-1790"></a><span class="sd">        Get the number of simulator interactions this Problem encountered.</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791" href="#__codelineno-0-1791"></a>
<a id="__codelineno-0-1792" name="__codelineno-0-1792" href="#__codelineno-0-1792"></a><span class="sd">        For problems focused on reinforcement learning, it is expected</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793" href="#__codelineno-0-1793"></a><span class="sd">        that the subclass overrides this method to describe its own way</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794" href="#__codelineno-0-1794"></a><span class="sd">        of getting the local interaction count.</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795" href="#__codelineno-0-1795"></a>
<a id="__codelineno-0-1796" name="__codelineno-0-1796" href="#__codelineno-0-1796"></a><span class="sd">        When working on parallelized problems, what is returned here is</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797" href="#__codelineno-0-1797"></a><span class="sd">        not necessarily synchronized with the other parallelized instance.</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798" href="#__codelineno-0-1798"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1799" name="__codelineno-0-1799" href="#__codelineno-0-1799"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800" href="#__codelineno-0-1800"></a>
<a id="__codelineno-0-1801" name="__codelineno-0-1801" href="#__codelineno-0-1801"></a>    <span class="k">def</span> <span class="nf">_get_local_episode_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802" href="#__codelineno-0-1802"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1803" name="__codelineno-0-1803" href="#__codelineno-0-1803"></a><span class="sd">        Get the number of episodes this Problem encountered.</span>
<a id="__codelineno-0-1804" name="__codelineno-0-1804" href="#__codelineno-0-1804"></a>
<a id="__codelineno-0-1805" name="__codelineno-0-1805" href="#__codelineno-0-1805"></a><span class="sd">        For problems focused on reinforcement learning, it is expected</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806" href="#__codelineno-0-1806"></a><span class="sd">        that the subclass overrides this method to describe its own way</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807" href="#__codelineno-0-1807"></a><span class="sd">        of getting the local episode count.</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808" href="#__codelineno-0-1808"></a>
<a id="__codelineno-0-1809" name="__codelineno-0-1809" href="#__codelineno-0-1809"></a><span class="sd">        When working on parallelized problems, what is returned here is</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810" href="#__codelineno-0-1810"></a><span class="sd">        not necessarily synchronized with the other parallelized instance.</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811" href="#__codelineno-0-1811"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812" href="#__codelineno-0-1812"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813" href="#__codelineno-0-1813"></a>
<a id="__codelineno-0-1814" name="__codelineno-0-1814" href="#__codelineno-0-1814"></a>    <span class="k">def</span> <span class="nf">sample_and_compute_gradients</span><span class="p">(</span>
<a id="__codelineno-0-1815" name="__codelineno-0-1815" href="#__codelineno-0-1815"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816" href="#__codelineno-0-1816"></a>        <span class="n">distribution</span><span class="p">,</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817" href="#__codelineno-0-1817"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818" href="#__codelineno-0-1818"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819" href="#__codelineno-0-1819"></a>        <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1820" name="__codelineno-0-1820" href="#__codelineno-0-1820"></a>        <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821" href="#__codelineno-0-1821"></a>        <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822" href="#__codelineno-0-1822"></a>        <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823" href="#__codelineno-0-1823"></a>        <span class="n">with_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824" href="#__codelineno-0-1824"></a>        <span class="n">ensure_even_popsize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825" href="#__codelineno-0-1825"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-1826" name="__codelineno-0-1826" href="#__codelineno-0-1826"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827" href="#__codelineno-0-1827"></a><span class="sd">        Sample new solutions from the distribution and compute gradients.</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828" href="#__codelineno-0-1828"></a>
<a id="__codelineno-0-1829" name="__codelineno-0-1829" href="#__codelineno-0-1829"></a><span class="sd">        The distribution can then be updated according to the computed</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830" href="#__codelineno-0-1830"></a><span class="sd">        gradients.</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831" href="#__codelineno-0-1831"></a>
<a id="__codelineno-0-1832" name="__codelineno-0-1832" href="#__codelineno-0-1832"></a><span class="sd">        If the problem is not parallelized, and `with_stats` is False,</span>
<a id="__codelineno-0-1833" name="__codelineno-0-1833" href="#__codelineno-0-1833"></a><span class="sd">        then the result will be a single dictionary of gradients.</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834" href="#__codelineno-0-1834"></a><span class="sd">        For example, in the case of a Gaussian distribution, the returned</span>
<a id="__codelineno-0-1835" name="__codelineno-0-1835" href="#__codelineno-0-1835"></a><span class="sd">        gradients dictionary would look like this:</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836" href="#__codelineno-0-1836"></a>
<a id="__codelineno-0-1837" name="__codelineno-0-1837" href="#__codelineno-0-1837"></a><span class="sd">            {</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838" href="#__codelineno-0-1838"></a><span class="sd">                &quot;mu&quot;: ...,     # the gradient for the mean</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839" href="#__codelineno-0-1839"></a><span class="sd">                &quot;sigma&quot;: ...,  # the gradient for the standard deviation</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840" href="#__codelineno-0-1840"></a><span class="sd">            }</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841" href="#__codelineno-0-1841"></a>
<a id="__codelineno-0-1842" name="__codelineno-0-1842" href="#__codelineno-0-1842"></a><span class="sd">        If the problem is not parallelized, and `with_stats` is True,</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843" href="#__codelineno-0-1843"></a><span class="sd">        then the result will be a dictionary which contains in itself</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844" href="#__codelineno-0-1844"></a><span class="sd">        the gradients dictionary, and additional elements for providing</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845" href="#__codelineno-0-1845"></a><span class="sd">        further information. In the case of a Gaussian distribution,</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846" href="#__codelineno-0-1846"></a><span class="sd">        the returned dictionary with additional stats would look like</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847" href="#__codelineno-0-1847"></a><span class="sd">        this:</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848" href="#__codelineno-0-1848"></a>
<a id="__codelineno-0-1849" name="__codelineno-0-1849" href="#__codelineno-0-1849"></a><span class="sd">            {</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850" href="#__codelineno-0-1850"></a><span class="sd">                &quot;gradients&quot;: {</span>
<a id="__codelineno-0-1851" name="__codelineno-0-1851" href="#__codelineno-0-1851"></a><span class="sd">                    &quot;mu&quot;: ...,     # the gradient for the mean</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852" href="#__codelineno-0-1852"></a><span class="sd">                    &quot;sigma&quot;: ...,  # the gradient for the standard deviation</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853" href="#__codelineno-0-1853"></a><span class="sd">                },</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854" href="#__codelineno-0-1854"></a><span class="sd">                &quot;num_solutions&quot;: ...,  # how many solutions were sampled</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855" href="#__codelineno-0-1855"></a><span class="sd">                &quot;mean_eval&quot;: ...,      # Mean of all evaluations</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856" href="#__codelineno-0-1856"></a><span class="sd">            }</span>
<a id="__codelineno-0-1857" name="__codelineno-0-1857" href="#__codelineno-0-1857"></a>
<a id="__codelineno-0-1858" name="__codelineno-0-1858" href="#__codelineno-0-1858"></a><span class="sd">        If the problem is parallelized, then the gradient computation will</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859" href="#__codelineno-0-1859"></a><span class="sd">        be distributed among the remote actors. In more details, each actor</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860" href="#__codelineno-0-1860"></a><span class="sd">        will sample its own solutions (such that the total population size</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861" href="#__codelineno-0-1861"></a><span class="sd">        across all remote actors will be near the provided `popsize`)</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862" href="#__codelineno-0-1862"></a><span class="sd">        and will compute its own gradients, and will produce its own</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863" href="#__codelineno-0-1863"></a><span class="sd">        additional stats (if `with_stats` is given as True).</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864" href="#__codelineno-0-1864"></a><span class="sd">        These remote results will then be collected by the main process,</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865" href="#__codelineno-0-1865"></a><span class="sd">        and the final result of this method will be a list of dictionaries,</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866" href="#__codelineno-0-1866"></a><span class="sd">        each dictionary being the result of a remote gradient computation.</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867" href="#__codelineno-0-1867"></a>
<a id="__codelineno-0-1868" name="__codelineno-0-1868" href="#__codelineno-0-1868"></a><span class="sd">        The sampled solutions are temporary, and will not be kept</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869" href="#__codelineno-0-1869"></a><span class="sd">        (and will not be returned).</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870" href="#__codelineno-0-1870"></a>
<a id="__codelineno-0-1871" name="__codelineno-0-1871" href="#__codelineno-0-1871"></a><span class="sd">        To customize how solutions are sampled and how gradients are</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872" href="#__codelineno-0-1872"></a><span class="sd">        computed, one is encouraged to override</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873" href="#__codelineno-0-1873"></a><span class="sd">        `_sample_and_compute_gradients(...)` (instead of overriding this</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874" href="#__codelineno-0-1874"></a><span class="sd">        method directly.</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875" href="#__codelineno-0-1875"></a>
<a id="__codelineno-0-1876" name="__codelineno-0-1876" href="#__codelineno-0-1876"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877" href="#__codelineno-0-1877"></a><span class="sd">            distribution: The search distribution from which the solutions</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878" href="#__codelineno-0-1878"></a><span class="sd">                will be sampled, and according to which the gradients will</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879" href="#__codelineno-0-1879"></a><span class="sd">                be computed.</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880" href="#__codelineno-0-1880"></a><span class="sd">            popsize: The number of solutions which will be sampled.</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881" href="#__codelineno-0-1881"></a><span class="sd">            num_interactions: Number of simulator interactions that must</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882" href="#__codelineno-0-1882"></a><span class="sd">                be completed (more solutions will be sampled until this</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883" href="#__codelineno-0-1883"></a><span class="sd">                threshold is reached). This argument is to be used when</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884" href="#__codelineno-0-1884"></a><span class="sd">                the problem has characteristics similar to reinforcement</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885" href="#__codelineno-0-1885"></a><span class="sd">                learning, and an adaptive population size, depending on</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886" href="#__codelineno-0-1886"></a><span class="sd">                the interactions made, is desired.</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887" href="#__codelineno-0-1887"></a><span class="sd">                Otherwise, one can leave this argument as None, in which</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888" href="#__codelineno-0-1888"></a><span class="sd">                case, there will not be any threshold based on number</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889" href="#__codelineno-0-1889"></a><span class="sd">                of interactions.</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890" href="#__codelineno-0-1890"></a><span class="sd">            popsize_max: To be used when `num_interactions` is provided,</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891" href="#__codelineno-0-1891"></a><span class="sd">                as an additional criterion for ending the solution sampling</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892" href="#__codelineno-0-1892"></a><span class="sd">                phase. This argument can be used to prevent the population</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893" href="#__codelineno-0-1893"></a><span class="sd">                size from growing too much while trying to satisfy the</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894" href="#__codelineno-0-1894"></a><span class="sd">                `num_interactions`. If not needed, `popsize_max` can be left</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895" href="#__codelineno-0-1895"></a><span class="sd">                as None.</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896" href="#__codelineno-0-1896"></a><span class="sd">            obj_index: Index of the objective according to which the gradients</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897" href="#__codelineno-0-1897"></a><span class="sd">                will be computed. Can be left as None if the problem has only</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898" href="#__codelineno-0-1898"></a><span class="sd">                one objective.</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899" href="#__codelineno-0-1899"></a><span class="sd">            ranking_method: The solution ranking method to be used when</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900" href="#__codelineno-0-1900"></a><span class="sd">                computing the gradients.</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901" href="#__codelineno-0-1901"></a><span class="sd">                If not specified, the raw fitnesses will be used.</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902" href="#__codelineno-0-1902"></a><span class="sd">            with_stats: If given as False, then the results dictionary will</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903" href="#__codelineno-0-1903"></a><span class="sd">                only contain the gradients information. If given as True,</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904" href="#__codelineno-0-1904"></a><span class="sd">                then the results dictionary will contain within itself</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905" href="#__codelineno-0-1905"></a><span class="sd">                the gradients dictionary, and also additional elements for</span>
<a id="__codelineno-0-1906" name="__codelineno-0-1906" href="#__codelineno-0-1906"></a><span class="sd">                providing further information.</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907" href="#__codelineno-0-1907"></a><span class="sd">                The default is True.</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908" href="#__codelineno-0-1908"></a><span class="sd">            ensure_even_popsize: If `ensure_even_popsize` is True and the</span>
<a id="__codelineno-0-1909" name="__codelineno-0-1909" href="#__codelineno-0-1909"></a><span class="sd">                problem is not parallelized, then a `popsize` given as an odd</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910" href="#__codelineno-0-1910"></a><span class="sd">                number will cause an error. If `ensure_even_popsize` is True</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911" href="#__codelineno-0-1911"></a><span class="sd">                and the problem is parallelized, then the remote actors will</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912" href="#__codelineno-0-1912"></a><span class="sd">                sample their own sub-populations in such a way that their</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913" href="#__codelineno-0-1913"></a><span class="sd">                sizes are even.</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914" href="#__codelineno-0-1914"></a><span class="sd">                If `ensure_even_popsize` is False, whether or not the</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915" href="#__codelineno-0-1915"></a><span class="sd">                `popsize` is even will not be checked.</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916" href="#__codelineno-0-1916"></a><span class="sd">                When the provided `distribution` is a symmetric (or</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917" href="#__codelineno-0-1917"></a><span class="sd">                &quot;mirrored&quot;, or &quot;antithetic&quot;), then this argument must be</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918" href="#__codelineno-0-1918"></a><span class="sd">                given as True.</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919" href="#__codelineno-0-1919"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920" href="#__codelineno-0-1920"></a><span class="sd">            A results dictionary when the problem is not parallelized,</span>
<a id="__codelineno-0-1921" name="__codelineno-0-1921" href="#__codelineno-0-1921"></a><span class="sd">            or list of results dictionaries when the problem is parallelized.</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922" href="#__codelineno-0-1922"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1923" name="__codelineno-0-1923" href="#__codelineno-0-1923"></a>
<a id="__codelineno-0-1924" name="__codelineno-0-1924" href="#__codelineno-0-1924"></a>        <span class="c1"># For problems which are configured for parallelization, make sure that the actors are created.</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925" href="#__codelineno-0-1925"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parallelize</span><span class="p">()</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926" href="#__codelineno-0-1926"></a>
<a id="__codelineno-0-1927" name="__codelineno-0-1927" href="#__codelineno-0-1927"></a>        <span class="c1"># Below we check if there is an inconsistency in arguments.</span>
<a id="__codelineno-0-1928" name="__codelineno-0-1928" href="#__codelineno-0-1928"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">num_interactions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">popsize_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929" href="#__codelineno-0-1929"></a>            <span class="c1"># If `num_interactions` is None, then we assume that the user does not wish an adaptive population size.</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930" href="#__codelineno-0-1930"></a>            <span class="c1"># However, at the same time, if `popsize_max` is not None, then there is an inconsistency,</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931" href="#__codelineno-0-1931"></a>            <span class="c1"># because, `popsize_max` without `num_interactions` (therefore without adaptive population size)</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932" href="#__codelineno-0-1932"></a>            <span class="c1"># does not make sense.</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933" href="#__codelineno-0-1933"></a>            <span class="c1"># This is probably a configuration error, so, we inform the user by raising an error.</span>
<a id="__codelineno-0-1934" name="__codelineno-0-1934" href="#__codelineno-0-1934"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935" href="#__codelineno-0-1935"></a>                <span class="sa">f</span><span class="s2">&quot;`popsize_max` was expected as None, because `num_interactions` is None.&quot;</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936" href="#__codelineno-0-1936"></a>                <span class="sa">f</span><span class="s2">&quot; However, `popsize_max` was found as </span><span class="si">{</span><span class="n">popsize_max</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937" href="#__codelineno-0-1937"></a>            <span class="p">)</span>
<a id="__codelineno-0-1938" name="__codelineno-0-1938" href="#__codelineno-0-1938"></a>
<a id="__codelineno-0-1939" name="__codelineno-0-1939" href="#__codelineno-0-1939"></a>        <span class="c1"># The problem instance in the main process should trigger the `before_grad_hook`.</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940" href="#__codelineno-0-1940"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-1941" name="__codelineno-0-1941" href="#__codelineno-0-1941"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_before_grad_hook</span><span class="p">()</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942" href="#__codelineno-0-1942"></a>
<a id="__codelineno-0-1943" name="__codelineno-0-1943" href="#__codelineno-0-1943"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-1944" name="__codelineno-0-1944" href="#__codelineno-0-1944"></a>            <span class="c1"># If this is the main process and the problem is parallelized, then we need to split the request</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945" href="#__codelineno-0-1945"></a>            <span class="c1"># into multiple tasks, and then execute those tasks in parallel using the problem&#39;s actor pool.</span>
<a id="__codelineno-0-1946" name="__codelineno-0-1946" href="#__codelineno-0-1946"></a>
<a id="__codelineno-0-1947" name="__codelineno-0-1947" href="#__codelineno-0-1947"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948" href="#__codelineno-0-1948"></a>                <span class="c1"># If `subbatch_size` is provided, then we first make sure that `popsize` is divisible by</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949" href="#__codelineno-0-1949"></a>                <span class="c1"># `subbatch_size`</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950" href="#__codelineno-0-1950"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">popsize</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951" href="#__codelineno-0-1951"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952" href="#__codelineno-0-1952"></a>                        <span class="sa">f</span><span class="s2">&quot;This Problem was created with `subbatch_size` as </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953" href="#__codelineno-0-1953"></a>                        <span class="sa">f</span><span class="s2">&quot; When doing remote gradient computation, the requested population size must be divisible by&quot;</span>
<a id="__codelineno-0-1954" name="__codelineno-0-1954" href="#__codelineno-0-1954"></a>                        <span class="sa">f</span><span class="s2">&quot; the `subbatch_size`.&quot;</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955" href="#__codelineno-0-1955"></a>                        <span class="sa">f</span><span class="s2">&quot; However, the requested population size is </span><span class="si">{</span><span class="n">popsize</span><span class="si">}</span><span class="s2">, and the remainder after dividing it&quot;</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956" href="#__codelineno-0-1956"></a>                        <span class="sa">f</span><span class="s2">&quot; by `subbatch_size` is not 0 (it is </span><span class="si">{</span><span class="n">popsize</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957" href="#__codelineno-0-1957"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958" href="#__codelineno-0-1958"></a>                <span class="c1"># After making sure that `popsize` and `subbatch_size` configurations are compatible, we declare that</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959" href="#__codelineno-0-1959"></a>                <span class="c1"># we are going to have n tasks, each task imposing a sample size of `subbatch_size`.</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960" href="#__codelineno-0-1960"></a>                <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">popsize</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="p">)</span>
<a id="__codelineno-0-1961" name="__codelineno-0-1961" href="#__codelineno-0-1961"></a>                <span class="n">popsize_per_task</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962" href="#__codelineno-0-1962"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_subbatches</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963" href="#__codelineno-0-1963"></a>                <span class="c1"># If `num_subbatches` is provided, then we are going to have n tasks where n is equal to the given</span>
<a id="__codelineno-0-1964" name="__codelineno-0-1964" href="#__codelineno-0-1964"></a>                <span class="c1"># `num_subbatches`.</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965" href="#__codelineno-0-1965"></a>                <span class="n">popsize_per_task</span> <span class="o">=</span> <span class="n">split_workload</span><span class="p">(</span><span class="n">popsize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_subbatches</span><span class="p">)</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966" href="#__codelineno-0-1966"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1967" name="__codelineno-0-1967" href="#__codelineno-0-1967"></a>                <span class="c1"># If neither `subbatch_size` nor `num_subbatches` is given, then we will split the workload in such</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968" href="#__codelineno-0-1968"></a>                <span class="c1"># a way that each actor will have its share.</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969" href="#__codelineno-0-1969"></a>                <span class="n">popsize_per_task</span> <span class="o">=</span> <span class="n">split_workload</span><span class="p">(</span><span class="n">popsize</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">))</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970" href="#__codelineno-0-1970"></a>
<a id="__codelineno-0-1971" name="__codelineno-0-1971" href="#__codelineno-0-1971"></a>            <span class="k">if</span> <span class="n">ensure_even_popsize</span><span class="p">:</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972" href="#__codelineno-0-1972"></a>                <span class="c1"># If `ensure_even_popsize` argument is True, then we need to make sure that each tasks&#39;s popsize is</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973" href="#__codelineno-0-1973"></a>                <span class="c1"># an even number.</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974" href="#__codelineno-0-1974"></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">popsize_per_task</span><span class="p">)):</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975" href="#__codelineno-0-1975"></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">popsize_per_task</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1976" name="__codelineno-0-1976" href="#__codelineno-0-1976"></a>                        <span class="c1"># If the i-th actor&#39;s assigned popsize is not even, increase its assigned popsize by 1.</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977" href="#__codelineno-0-1977"></a>                        <span class="n">popsize_per_task</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978" href="#__codelineno-0-1978"></a>
<a id="__codelineno-0-1979" name="__codelineno-0-1979" href="#__codelineno-0-1979"></a>            <span class="c1"># The number of tasks is finally determined by the length of `popsize_per_task` list we created above.</span>
<a id="__codelineno-0-1980" name="__codelineno-0-1980" href="#__codelineno-0-1980"></a>            <span class="n">num_tasks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">popsize_per_task</span><span class="p">)</span>
<a id="__codelineno-0-1981" name="__codelineno-0-1981" href="#__codelineno-0-1981"></a>
<a id="__codelineno-0-1982" name="__codelineno-0-1982" href="#__codelineno-0-1982"></a>            <span class="k">if</span> <span class="n">num_interactions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983" href="#__codelineno-0-1983"></a>                <span class="c1"># If the argument `num_interactions` is not given, then, for each task, we declare that</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984" href="#__codelineno-0-1984"></a>                <span class="c1"># `num_interactions` is None.</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985" href="#__codelineno-0-1985"></a>                <span class="n">num_inter_per_task</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tasks</span><span class="p">)]</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986" href="#__codelineno-0-1986"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987" href="#__codelineno-0-1987"></a>                <span class="c1"># If the argument `num_interactions` is given, then we compute each task&#39;s target number of</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988" href="#__codelineno-0-1988"></a>                <span class="c1"># interactions from its sample size.</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989" href="#__codelineno-0-1989"></a>                <span class="n">num_inter_per_task</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990" href="#__codelineno-0-1990"></a>                    <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">popsize_per_task</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">popsize</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_interactions</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tasks</span><span class="p">)</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991" href="#__codelineno-0-1991"></a>                <span class="p">]</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992" href="#__codelineno-0-1992"></a>
<a id="__codelineno-0-1993" name="__codelineno-0-1993" href="#__codelineno-0-1993"></a>            <span class="k">if</span> <span class="n">popsize_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994" href="#__codelineno-0-1994"></a>                <span class="c1"># If the argument `popsize_max` is not given, then, for each task, we declare that</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995" href="#__codelineno-0-1995"></a>                <span class="c1"># `popsize_max` is None.</span>
<a id="__codelineno-0-1996" name="__codelineno-0-1996" href="#__codelineno-0-1996"></a>                <span class="n">popsize_max_per_task</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tasks</span><span class="p">)]</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997" href="#__codelineno-0-1997"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998" href="#__codelineno-0-1998"></a>                <span class="c1"># If the argument `popsize_max` is given, then we compute each task&#39;s target maximum population size</span>
<a id="__codelineno-0-1999" name="__codelineno-0-1999" href="#__codelineno-0-1999"></a>                <span class="c1"># from its sample size.</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000" href="#__codelineno-0-2000"></a>                <span class="n">popsize_max_per_task</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2001" name="__codelineno-0-2001" href="#__codelineno-0-2001"></a>                    <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">popsize_per_task</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">popsize</span><span class="p">)</span> <span class="o">*</span> <span class="n">popsize_max</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tasks</span><span class="p">)</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002" href="#__codelineno-0-2002"></a>                <span class="p">]</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003" href="#__codelineno-0-2003"></a>
<a id="__codelineno-0-2004" name="__codelineno-0-2004" href="#__codelineno-0-2004"></a>            <span class="c1"># We trigger the synchronization between the main process and the remote actors.</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005" href="#__codelineno-0-2005"></a>            <span class="c1"># If this problem instance has nothing to synchronize, then `must_sync_after` will be False.</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006" href="#__codelineno-0-2006"></a>            <span class="n">must_sync_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sync_before</span><span class="p">()</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007" href="#__codelineno-0-2007"></a>
<a id="__codelineno-0-2008" name="__codelineno-0-2008" href="#__codelineno-0-2008"></a>            <span class="c1"># Because we want to send the distribution to remote actors, we first copy the distribution to cpu</span>
<a id="__codelineno-0-2009" name="__codelineno-0-2009" href="#__codelineno-0-2009"></a>            <span class="c1"># (unless it is already on cpu)</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010" href="#__codelineno-0-2010"></a>            <span class="n">dist_on_cpu</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2011" name="__codelineno-0-2011" href="#__codelineno-0-2011"></a>
<a id="__codelineno-0-2012" name="__codelineno-0-2012" href="#__codelineno-0-2012"></a>            <span class="c1"># Here, we use our actor pool to execute our tasks in parallel.</span>
<a id="__codelineno-0-2013" name="__codelineno-0-2013" href="#__codelineno-0-2013"></a>            <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<a id="__codelineno-0-2014" name="__codelineno-0-2014" href="#__codelineno-0-2014"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_actor_pool</span><span class="o">.</span><span class="n">map_unordered</span><span class="p">(</span>
<a id="__codelineno-0-2015" name="__codelineno-0-2015" href="#__codelineno-0-2015"></a>                    <span class="p">(</span>
<a id="__codelineno-0-2016" name="__codelineno-0-2016" href="#__codelineno-0-2016"></a>                        <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span>
<a id="__codelineno-0-2017" name="__codelineno-0-2017" href="#__codelineno-0-2017"></a>                            <span class="s2">&quot;_sample_and_compute_gradients&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2018" name="__codelineno-0-2018" href="#__codelineno-0-2018"></a>                            <span class="p">[</span><span class="n">dist_on_cpu</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
<a id="__codelineno-0-2019" name="__codelineno-0-2019" href="#__codelineno-0-2019"></a>                            <span class="p">{</span>
<a id="__codelineno-0-2020" name="__codelineno-0-2020" href="#__codelineno-0-2020"></a>                                <span class="s2">&quot;obj_index&quot;</span><span class="p">:</span> <span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-2021" name="__codelineno-0-2021" href="#__codelineno-0-2021"></a>                                <span class="s2">&quot;num_interactions&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-2022" name="__codelineno-0-2022" href="#__codelineno-0-2022"></a>                                <span class="s2">&quot;popsize_max&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-0-2023" name="__codelineno-0-2023" href="#__codelineno-0-2023"></a>                                <span class="s2">&quot;ranking_method&quot;</span><span class="p">:</span> <span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-2024" name="__codelineno-0-2024" href="#__codelineno-0-2024"></a>                            <span class="p">},</span>
<a id="__codelineno-0-2025" name="__codelineno-0-2025" href="#__codelineno-0-2025"></a>                        <span class="p">)</span>
<a id="__codelineno-0-2026" name="__codelineno-0-2026" href="#__codelineno-0-2026"></a>                    <span class="p">),</span>
<a id="__codelineno-0-2027" name="__codelineno-0-2027" href="#__codelineno-0-2027"></a>                    <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">popsize_per_task</span><span class="p">,</span> <span class="n">num_inter_per_task</span><span class="p">,</span> <span class="n">popsize_max_per_task</span><span class="p">)),</span>
<a id="__codelineno-0-2028" name="__codelineno-0-2028" href="#__codelineno-0-2028"></a>                <span class="p">)</span>
<a id="__codelineno-0-2029" name="__codelineno-0-2029" href="#__codelineno-0-2029"></a>            <span class="p">)</span>
<a id="__codelineno-0-2030" name="__codelineno-0-2030" href="#__codelineno-0-2030"></a>
<a id="__codelineno-0-2031" name="__codelineno-0-2031" href="#__codelineno-0-2031"></a>            <span class="c1"># At this point, all the tensors within our collected results are on the CPU.</span>
<a id="__codelineno-0-2032" name="__codelineno-0-2032" href="#__codelineno-0-2032"></a>
<a id="__codelineno-0-2033" name="__codelineno-0-2033" href="#__codelineno-0-2033"></a>            <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">!=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">):</span>
<a id="__codelineno-0-2034" name="__codelineno-0-2034" href="#__codelineno-0-2034"></a>                <span class="c1"># If the main device of this problem instance is not CPU, then we move the tensors to the main device.</span>
<a id="__codelineno-0-2035" name="__codelineno-0-2035" href="#__codelineno-0-2035"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">cast_tensors_in_container</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-2036" name="__codelineno-0-2036" href="#__codelineno-0-2036"></a>
<a id="__codelineno-0-2037" name="__codelineno-0-2037" href="#__codelineno-0-2037"></a>            <span class="k">if</span> <span class="n">must_sync_after</span><span class="p">:</span>
<a id="__codelineno-0-2038" name="__codelineno-0-2038" href="#__codelineno-0-2038"></a>                <span class="c1"># If a post-gradient synchronization is required, we trigger the synchronization operations.</span>
<a id="__codelineno-0-2039" name="__codelineno-0-2039" href="#__codelineno-0-2039"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sync_after</span><span class="p">()</span>
<a id="__codelineno-0-2040" name="__codelineno-0-2040" href="#__codelineno-0-2040"></a>
<a id="__codelineno-0-2041" name="__codelineno-0-2041" href="#__codelineno-0-2041"></a>            <span class="c1"># ####################################################</span>
<a id="__codelineno-0-2042" name="__codelineno-0-2042" href="#__codelineno-0-2042"></a>            <span class="c1"># # If this is the main process and the problem is parallelized, then we need to split the workload among</span>
<a id="__codelineno-0-2043" name="__codelineno-0-2043" href="#__codelineno-0-2043"></a>            <span class="c1"># # the remote actors, and then request each of them to compute their gradients.</span>
<a id="__codelineno-0-2044" name="__codelineno-0-2044" href="#__codelineno-0-2044"></a>            <span class="c1">#</span>
<a id="__codelineno-0-2045" name="__codelineno-0-2045" href="#__codelineno-0-2045"></a>            <span class="c1"># # We begin by getting the number of actors, and computing the `popsize` for each actor.</span>
<a id="__codelineno-0-2046" name="__codelineno-0-2046" href="#__codelineno-0-2046"></a>            <span class="c1"># num_actors = len(self._actors)</span>
<a id="__codelineno-0-2047" name="__codelineno-0-2047" href="#__codelineno-0-2047"></a>            <span class="c1"># popsize_per_actor = split_workload(popsize, num_actors)</span>
<a id="__codelineno-0-2048" name="__codelineno-0-2048" href="#__codelineno-0-2048"></a>            <span class="c1">#</span>
<a id="__codelineno-0-2049" name="__codelineno-0-2049" href="#__codelineno-0-2049"></a>            <span class="c1"># if ensure_even_popsize:</span>
<a id="__codelineno-0-2050" name="__codelineno-0-2050" href="#__codelineno-0-2050"></a>            <span class="c1">#     # If `ensure_even_popsize` argument is True, then we need to make sure that each actor&#39;s popsize is</span>
<a id="__codelineno-0-2051" name="__codelineno-0-2051" href="#__codelineno-0-2051"></a>            <span class="c1">#     # an even number.</span>
<a id="__codelineno-0-2052" name="__codelineno-0-2052" href="#__codelineno-0-2052"></a>            <span class="c1">#     for i in range(len(popsize_per_actor)):</span>
<a id="__codelineno-0-2053" name="__codelineno-0-2053" href="#__codelineno-0-2053"></a>            <span class="c1">#         if (popsize_per_actor[i] % 2) != 0:</span>
<a id="__codelineno-0-2054" name="__codelineno-0-2054" href="#__codelineno-0-2054"></a>            <span class="c1">#             # If the i-th actor&#39;s assigned popsize is not even, increase its assigned popsize by 1.</span>
<a id="__codelineno-0-2055" name="__codelineno-0-2055" href="#__codelineno-0-2055"></a>            <span class="c1">#             popsize_per_actor[i] += 1</span>
<a id="__codelineno-0-2056" name="__codelineno-0-2056" href="#__codelineno-0-2056"></a>            <span class="c1">#</span>
<a id="__codelineno-0-2057" name="__codelineno-0-2057" href="#__codelineno-0-2057"></a>            <span class="c1"># if num_interactions is None:</span>
<a id="__codelineno-0-2058" name="__codelineno-0-2058" href="#__codelineno-0-2058"></a>            <span class="c1">#     # If `num_interactions` is None, then the `num_interactions` argument for each actor must also be</span>
<a id="__codelineno-0-2059" name="__codelineno-0-2059" href="#__codelineno-0-2059"></a>            <span class="c1">#     # passed as None.</span>
<a id="__codelineno-0-2060" name="__codelineno-0-2060" href="#__codelineno-0-2060"></a>            <span class="c1">#     num_int_per_actor = [None] * num_actors</span>
<a id="__codelineno-0-2061" name="__codelineno-0-2061" href="#__codelineno-0-2061"></a>            <span class="c1"># else:</span>
<a id="__codelineno-0-2062" name="__codelineno-0-2062" href="#__codelineno-0-2062"></a>            <span class="c1">#     # If `num_interactions` is not None, then we split the `num_interactions` workload among the actors.</span>
<a id="__codelineno-0-2063" name="__codelineno-0-2063" href="#__codelineno-0-2063"></a>            <span class="c1">#     num_int_per_actor = split_workload(num_interactions, num_actors)</span>
<a id="__codelineno-0-2064" name="__codelineno-0-2064" href="#__codelineno-0-2064"></a>            <span class="c1">#</span>
<a id="__codelineno-0-2065" name="__codelineno-0-2065" href="#__codelineno-0-2065"></a>            <span class="c1"># if popsize_max is None:</span>
<a id="__codelineno-0-2066" name="__codelineno-0-2066" href="#__codelineno-0-2066"></a>            <span class="c1">#     # If `popsize_max` is None, then the `popsize_max` argument for each actor must also be None.</span>
<a id="__codelineno-0-2067" name="__codelineno-0-2067" href="#__codelineno-0-2067"></a>            <span class="c1">#     popsize_max_per_actor = [None] * num_actors</span>
<a id="__codelineno-0-2068" name="__codelineno-0-2068" href="#__codelineno-0-2068"></a>            <span class="c1"># else:</span>
<a id="__codelineno-0-2069" name="__codelineno-0-2069" href="#__codelineno-0-2069"></a>            <span class="c1">#     # If `popsize_max` is not None, then we split the `popsize_max` workload among the actors.</span>
<a id="__codelineno-0-2070" name="__codelineno-0-2070" href="#__codelineno-0-2070"></a>            <span class="c1">#     popsize_max_per_actor = split_workload(popsize_max, num_actors)</span>
<a id="__codelineno-0-2071" name="__codelineno-0-2071" href="#__codelineno-0-2071"></a>            <span class="c1">#</span>
<a id="__codelineno-0-2072" name="__codelineno-0-2072" href="#__codelineno-0-2072"></a>            <span class="c1"># # We trigger the synchronization between the main process and the remote actors.</span>
<a id="__codelineno-0-2073" name="__codelineno-0-2073" href="#__codelineno-0-2073"></a>            <span class="c1"># # If this problem instance has nothing to synchronize, then `must_sync_after` will be False.</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074" href="#__codelineno-0-2074"></a>            <span class="c1"># must_sync_after = self._sync_before()</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075" href="#__codelineno-0-2075"></a>            <span class="c1">#</span>
<a id="__codelineno-0-2076" name="__codelineno-0-2076" href="#__codelineno-0-2076"></a>            <span class="c1"># # Because we want to send the distribution to remote actors, we first copy the distribution to cpu</span>
<a id="__codelineno-0-2077" name="__codelineno-0-2077" href="#__codelineno-0-2077"></a>            <span class="c1"># # (unless it is already on cpu)</span>
<a id="__codelineno-0-2078" name="__codelineno-0-2078" href="#__codelineno-0-2078"></a>            <span class="c1"># dist_on_cpu = distribution.to(&quot;cpu&quot;)</span>
<a id="__codelineno-0-2079" name="__codelineno-0-2079" href="#__codelineno-0-2079"></a>            <span class="c1">#</span>
<a id="__codelineno-0-2080" name="__codelineno-0-2080" href="#__codelineno-0-2080"></a>            <span class="c1"># # To each actor, we send the request of computing the gradients, and then collect the results</span>
<a id="__codelineno-0-2081" name="__codelineno-0-2081" href="#__codelineno-0-2081"></a>            <span class="c1"># result = ray.get(</span>
<a id="__codelineno-0-2082" name="__codelineno-0-2082" href="#__codelineno-0-2082"></a>            <span class="c1">#     [</span>
<a id="__codelineno-0-2083" name="__codelineno-0-2083" href="#__codelineno-0-2083"></a>            <span class="c1">#         self._actors[i].call.remote(</span>
<a id="__codelineno-0-2084" name="__codelineno-0-2084" href="#__codelineno-0-2084"></a>            <span class="c1">#             &quot;_gradient_computation_helper&quot;,</span>
<a id="__codelineno-0-2085" name="__codelineno-0-2085" href="#__codelineno-0-2085"></a>            <span class="c1">#             [dist_on_cpu, popsize_per_actor[i]],</span>
<a id="__codelineno-0-2086" name="__codelineno-0-2086" href="#__codelineno-0-2086"></a>            <span class="c1">#             dict(</span>
<a id="__codelineno-0-2087" name="__codelineno-0-2087" href="#__codelineno-0-2087"></a>            <span class="c1">#                 num_interactions=num_int_per_actor[i],</span>
<a id="__codelineno-0-2088" name="__codelineno-0-2088" href="#__codelineno-0-2088"></a>            <span class="c1">#                 popsize_max=popsize_max_per_actor[i],</span>
<a id="__codelineno-0-2089" name="__codelineno-0-2089" href="#__codelineno-0-2089"></a>            <span class="c1">#                 obj_index=obj_index,</span>
<a id="__codelineno-0-2090" name="__codelineno-0-2090" href="#__codelineno-0-2090"></a>            <span class="c1">#                 ranking_method=ranking_method,</span>
<a id="__codelineno-0-2091" name="__codelineno-0-2091" href="#__codelineno-0-2091"></a>            <span class="c1">#                 with_stats=with_stats,</span>
<a id="__codelineno-0-2092" name="__codelineno-0-2092" href="#__codelineno-0-2092"></a>            <span class="c1">#                 move_results_to_device=&quot;cpu&quot;,</span>
<a id="__codelineno-0-2093" name="__codelineno-0-2093" href="#__codelineno-0-2093"></a>            <span class="c1">#             ),</span>
<a id="__codelineno-0-2094" name="__codelineno-0-2094" href="#__codelineno-0-2094"></a>            <span class="c1">#         )</span>
<a id="__codelineno-0-2095" name="__codelineno-0-2095" href="#__codelineno-0-2095"></a>            <span class="c1">#         for i in range(num_actors)</span>
<a id="__codelineno-0-2096" name="__codelineno-0-2096" href="#__codelineno-0-2096"></a>            <span class="c1">#     ]</span>
<a id="__codelineno-0-2097" name="__codelineno-0-2097" href="#__codelineno-0-2097"></a>            <span class="c1"># )</span>
<a id="__codelineno-0-2098" name="__codelineno-0-2098" href="#__codelineno-0-2098"></a>            <span class="c1">#</span>
<a id="__codelineno-0-2099" name="__codelineno-0-2099" href="#__codelineno-0-2099"></a>            <span class="c1"># # At this point, all the tensors within our collected results are on the CPU.</span>
<a id="__codelineno-0-2100" name="__codelineno-0-2100" href="#__codelineno-0-2100"></a>            <span class="c1">#</span>
<a id="__codelineno-0-2101" name="__codelineno-0-2101" href="#__codelineno-0-2101"></a>            <span class="c1"># if torch.device(self.device) != torch.device(&quot;cpu&quot;):</span>
<a id="__codelineno-0-2102" name="__codelineno-0-2102" href="#__codelineno-0-2102"></a>            <span class="c1">#     # If the main device of this problem instance is not CPU, then we move the tensors to the main device.</span>
<a id="__codelineno-0-2103" name="__codelineno-0-2103" href="#__codelineno-0-2103"></a>            <span class="c1">#     result = cast_tensors_in_container(result, device=device)</span>
<a id="__codelineno-0-2104" name="__codelineno-0-2104" href="#__codelineno-0-2104"></a>            <span class="c1">#</span>
<a id="__codelineno-0-2105" name="__codelineno-0-2105" href="#__codelineno-0-2105"></a>            <span class="c1"># if must_sync_after:</span>
<a id="__codelineno-0-2106" name="__codelineno-0-2106" href="#__codelineno-0-2106"></a>            <span class="c1">#     # If a post-gradient synchronization is required, we trigger the synchronization operations.</span>
<a id="__codelineno-0-2107" name="__codelineno-0-2107" href="#__codelineno-0-2107"></a>            <span class="c1">#     self._sync_after()</span>
<a id="__codelineno-0-2108" name="__codelineno-0-2108" href="#__codelineno-0-2108"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2109" name="__codelineno-0-2109" href="#__codelineno-0-2109"></a>            <span class="c1"># If the problem is not parallelized, then we request this instance itself to compute the gradients.</span>
<a id="__codelineno-0-2110" name="__codelineno-0-2110" href="#__codelineno-0-2110"></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gradient_computation_helper</span><span class="p">(</span>
<a id="__codelineno-0-2111" name="__codelineno-0-2111" href="#__codelineno-0-2111"></a>                <span class="n">distribution</span><span class="p">,</span>
<a id="__codelineno-0-2112" name="__codelineno-0-2112" href="#__codelineno-0-2112"></a>                <span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113" href="#__codelineno-0-2113"></a>                <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-2114" name="__codelineno-0-2114" href="#__codelineno-0-2114"></a>                <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-2115" name="__codelineno-0-2115" href="#__codelineno-0-2115"></a>                <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116" href="#__codelineno-0-2116"></a>                <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-2117" name="__codelineno-0-2117" href="#__codelineno-0-2117"></a>                <span class="n">with_stats</span><span class="o">=</span><span class="n">with_stats</span><span class="p">,</span>
<a id="__codelineno-0-2118" name="__codelineno-0-2118" href="#__codelineno-0-2118"></a>            <span class="p">)</span>
<a id="__codelineno-0-2119" name="__codelineno-0-2119" href="#__codelineno-0-2119"></a>
<a id="__codelineno-0-2120" name="__codelineno-0-2120" href="#__codelineno-0-2120"></a>        <span class="c1"># The problem instance in the main process should trigger the `after_grad_hook`.</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121" href="#__codelineno-0-2121"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-2122" name="__codelineno-0-2122" href="#__codelineno-0-2122"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grad_hook</span><span class="o">.</span><span class="n">accumulate_dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123" href="#__codelineno-0-2123"></a>
<a id="__codelineno-0-2124" name="__codelineno-0-2124" href="#__codelineno-0-2124"></a>        <span class="c1"># We finally return the results</span>
<a id="__codelineno-0-2125" name="__codelineno-0-2125" href="#__codelineno-0-2125"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126" href="#__codelineno-0-2126"></a>
<a id="__codelineno-0-2127" name="__codelineno-0-2127" href="#__codelineno-0-2127"></a>    <span class="k">def</span> <span class="nf">_gradient_computation_helper</span><span class="p">(</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128" href="#__codelineno-0-2128"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2129" name="__codelineno-0-2129" href="#__codelineno-0-2129"></a>        <span class="n">distribution</span><span class="p">,</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130" href="#__codelineno-0-2130"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131" href="#__codelineno-0-2131"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-2132" name="__codelineno-0-2132" href="#__codelineno-0-2132"></a>        <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133" href="#__codelineno-0-2133"></a>        <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2134" name="__codelineno-0-2134" href="#__codelineno-0-2134"></a>        <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2135" name="__codelineno-0-2135" href="#__codelineno-0-2135"></a>        <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2136" name="__codelineno-0-2136" href="#__codelineno-0-2136"></a>        <span class="n">with_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137" href="#__codelineno-0-2137"></a>        <span class="n">move_results_to_device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2138" name="__codelineno-0-2138" href="#__codelineno-0-2138"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-2139" name="__codelineno-0-2139" href="#__codelineno-0-2139"></a>        <span class="c1"># This is a helper method which makes sure that the provided distribution is in the correct dtype and device.</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140" href="#__codelineno-0-2140"></a>        <span class="c1"># This method also makes sure that the results are moved to the desired device.</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141" href="#__codelineno-0-2141"></a>
<a id="__codelineno-0-2142" name="__codelineno-0-2142" href="#__codelineno-0-2142"></a>        <span class="c1"># At first, we make sure that the objective index is normalized</span>
<a id="__codelineno-0-2143" name="__codelineno-0-2143" href="#__codelineno-0-2143"></a>        <span class="c1"># (for example, the objective -1 is converted to the index of the last objective).</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144" href="#__codelineno-0-2144"></a>        <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-2145" name="__codelineno-0-2145" href="#__codelineno-0-2145"></a>
<a id="__codelineno-0-2146" name="__codelineno-0-2146" href="#__codelineno-0-2146"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">device</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">):</span>
<a id="__codelineno-0-2147" name="__codelineno-0-2147" href="#__codelineno-0-2147"></a>            <span class="c1"># Make sure that the distribution is in the correct dtype and device</span>
<a id="__codelineno-0-2148" name="__codelineno-0-2148" href="#__codelineno-0-2148"></a>            <span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">modified_copy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149" href="#__codelineno-0-2149"></a>
<a id="__codelineno-0-2150" name="__codelineno-0-2150" href="#__codelineno-0-2150"></a>        <span class="c1"># Call the protected method responsible for sampling solutions and computing the gradients</span>
<a id="__codelineno-0-2151" name="__codelineno-0-2151" href="#__codelineno-0-2151"></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_and_compute_gradients</span><span class="p">(</span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152" href="#__codelineno-0-2152"></a>            <span class="n">distribution</span><span class="p">,</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153" href="#__codelineno-0-2153"></a>            <span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-2154" name="__codelineno-0-2154" href="#__codelineno-0-2154"></a>            <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155" href="#__codelineno-0-2155"></a>            <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156" href="#__codelineno-0-2156"></a>            <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157" href="#__codelineno-0-2157"></a>            <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-2158" name="__codelineno-0-2158" href="#__codelineno-0-2158"></a>        <span class="p">)</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159" href="#__codelineno-0-2159"></a>
<a id="__codelineno-0-2160" name="__codelineno-0-2160" href="#__codelineno-0-2160"></a>        <span class="k">if</span> <span class="n">move_results_to_device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161" href="#__codelineno-0-2161"></a>            <span class="c1"># If `move_results_to_device` is provided, move the results to the desired device</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162" href="#__codelineno-0-2162"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">cast_tensors_in_container</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">move_results_to_device</span><span class="p">)</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163" href="#__codelineno-0-2163"></a>
<a id="__codelineno-0-2164" name="__codelineno-0-2164" href="#__codelineno-0-2164"></a>        <span class="c1"># Finally, return the result</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165" href="#__codelineno-0-2165"></a>        <span class="k">if</span> <span class="n">with_stats</span><span class="p">:</span>
<a id="__codelineno-0-2166" name="__codelineno-0-2166" href="#__codelineno-0-2166"></a>            <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167" href="#__codelineno-0-2167"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168" href="#__codelineno-0-2168"></a>            <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;gradients&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169" href="#__codelineno-0-2169"></a>
<a id="__codelineno-0-2170" name="__codelineno-0-2170" href="#__codelineno-0-2170"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171" href="#__codelineno-0-2171"></a>    <span class="k">def</span> <span class="nf">_grad_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Device</span><span class="p">:</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172" href="#__codelineno-0-2172"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173" href="#__codelineno-0-2173"></a><span class="sd">        Get the device in which new solutions will be made in distributed mode.</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174" href="#__codelineno-0-2174"></a>
<a id="__codelineno-0-2175" name="__codelineno-0-2175" href="#__codelineno-0-2175"></a><span class="sd">        In more details, in distributed mode, each actor creates its own</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176" href="#__codelineno-0-2176"></a><span class="sd">        sub-populations, evaluates them, and computes its own gradient</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177" href="#__codelineno-0-2177"></a><span class="sd">        (all such actor gradients eventually being collected by the</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178" href="#__codelineno-0-2178"></a><span class="sd">        distribution-based search algorithm in the main process).</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179" href="#__codelineno-0-2179"></a><span class="sd">        For some problem types, it can make sense for the remote actors to</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180" href="#__codelineno-0-2180"></a><span class="sd">        create their temporary sub-populations on another device</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181" href="#__codelineno-0-2181"></a><span class="sd">        (e.g. on the GPU that is allocated specifically for them).</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182" href="#__codelineno-0-2182"></a><span class="sd">        For such situations, one is encouraged to override this property</span>
<a id="__codelineno-0-2183" name="__codelineno-0-2183" href="#__codelineno-0-2183"></a><span class="sd">        and make it return whatever device is to be used.</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184" href="#__codelineno-0-2184"></a>
<a id="__codelineno-0-2185" name="__codelineno-0-2185" href="#__codelineno-0-2185"></a><span class="sd">        Note that this property is used by the default implementation of the</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186" href="#__codelineno-0-2186"></a><span class="sd">        method named `_sample_and_compute_grad(...)`. If the method named</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187" href="#__codelineno-0-2187"></a><span class="sd">        `_sample_and_compute_grad(...)` is overriden, this property might not</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188" href="#__codelineno-0-2188"></a><span class="sd">        be called at all.</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189" href="#__codelineno-0-2189"></a>
<a id="__codelineno-0-2190" name="__codelineno-0-2190" href="#__codelineno-0-2190"></a><span class="sd">        This is the not-yet-overriden implementation in the Problem class,</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191" href="#__codelineno-0-2191"></a><span class="sd">        and returns the main device.</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192" href="#__codelineno-0-2192"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193" href="#__codelineno-0-2193"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194" href="#__codelineno-0-2194"></a>
<a id="__codelineno-0-2195" name="__codelineno-0-2195" href="#__codelineno-0-2195"></a>    <span class="k">def</span> <span class="nf">_sample_and_compute_gradients</span><span class="p">(</span>
<a id="__codelineno-0-2196" name="__codelineno-0-2196" href="#__codelineno-0-2196"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197" href="#__codelineno-0-2197"></a>        <span class="n">distribution</span><span class="p">,</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198" href="#__codelineno-0-2198"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199" href="#__codelineno-0-2199"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200" href="#__codelineno-0-2200"></a>        <span class="n">obj_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-2201" name="__codelineno-0-2201" href="#__codelineno-0-2201"></a>        <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202" href="#__codelineno-0-2202"></a>        <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2203" name="__codelineno-0-2203" href="#__codelineno-0-2203"></a>        <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204" href="#__codelineno-0-2204"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205" href="#__codelineno-0-2205"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206" href="#__codelineno-0-2206"></a><span class="sd">        This method contains the description of how the solutions are sampled</span>
<a id="__codelineno-0-2207" name="__codelineno-0-2207" href="#__codelineno-0-2207"></a><span class="sd">        and the gradients are computed according to the given distribution.</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208" href="#__codelineno-0-2208"></a>
<a id="__codelineno-0-2209" name="__codelineno-0-2209" href="#__codelineno-0-2209"></a><span class="sd">        One might override this method for customizing the procedure of</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210" href="#__codelineno-0-2210"></a><span class="sd">        sampling solutions and the gradient computation, but this method does</span>
<a id="__codelineno-0-2211" name="__codelineno-0-2211" href="#__codelineno-0-2211"></a><span class="sd">        have a default implementation.</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212" href="#__codelineno-0-2212"></a>
<a id="__codelineno-0-2213" name="__codelineno-0-2213" href="#__codelineno-0-2213"></a><span class="sd">        This returns a dictionary which contains the gradients for the given</span>
<a id="__codelineno-0-2214" name="__codelineno-0-2214" href="#__codelineno-0-2214"></a><span class="sd">        distribution, and also further information. For example, considering</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215" href="#__codelineno-0-2215"></a><span class="sd">        a Gaussian distribution with parameters &#39;mu&#39; and &#39;sigma&#39;, the result</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216" href="#__codelineno-0-2216"></a><span class="sd">        is expected to look like this:</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217" href="#__codelineno-0-2217"></a>
<a id="__codelineno-0-2218" name="__codelineno-0-2218" href="#__codelineno-0-2218"></a><span class="sd">            {</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219" href="#__codelineno-0-2219"></a><span class="sd">                &quot;gradients&quot;: {</span>
<a id="__codelineno-0-2220" name="__codelineno-0-2220" href="#__codelineno-0-2220"></a><span class="sd">                    &quot;mu&quot;: ...,     # the gradient for the mean (tensor)</span>
<a id="__codelineno-0-2221" name="__codelineno-0-2221" href="#__codelineno-0-2221"></a><span class="sd">                    &quot;sigma&quot;: ...,  # the gradient for the std.dev. (tensor)</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222" href="#__codelineno-0-2222"></a><span class="sd">                },</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223" href="#__codelineno-0-2223"></a><span class="sd">                &quot;num_solutions&quot;: ...,  # how many solutions were sampled (int)</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224" href="#__codelineno-0-2224"></a><span class="sd">                &quot;mean_eval&quot;: ...,      # Mean of all evaluations (float)</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225" href="#__codelineno-0-2225"></a><span class="sd">            }</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226" href="#__codelineno-0-2226"></a>
<a id="__codelineno-0-2227" name="__codelineno-0-2227" href="#__codelineno-0-2227"></a><span class="sd">        A customized version of this method can add more items to the outer</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228" href="#__codelineno-0-2228"></a><span class="sd">        dictionary.</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229" href="#__codelineno-0-2229"></a>
<a id="__codelineno-0-2230" name="__codelineno-0-2230" href="#__codelineno-0-2230"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-2231" name="__codelineno-0-2231" href="#__codelineno-0-2231"></a><span class="sd">            distribution: The search distribution from which the solutions</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232" href="#__codelineno-0-2232"></a><span class="sd">                will be sampled and according to which the gradients will</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233" href="#__codelineno-0-2233"></a><span class="sd">                be computed. This method assumes that `distribution` is</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234" href="#__codelineno-0-2234"></a><span class="sd">                given with this problem instance&#39;s dtype, and in this problem</span>
<a id="__codelineno-0-2235" name="__codelineno-0-2235" href="#__codelineno-0-2235"></a><span class="sd">                instance&#39;s device.</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236" href="#__codelineno-0-2236"></a><span class="sd">            popsize: Number of solutions to sample.</span>
<a id="__codelineno-0-2237" name="__codelineno-0-2237" href="#__codelineno-0-2237"></a><span class="sd">            obj_index: Objective index, expected as an integer.</span>
<a id="__codelineno-0-2238" name="__codelineno-0-2238" href="#__codelineno-0-2238"></a><span class="sd">            num_interactions: Number of simulator interactions that must be</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239" href="#__codelineno-0-2239"></a><span class="sd">                reached before computing the gradients.</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240" href="#__codelineno-0-2240"></a><span class="sd">                Having this argument as an integer implies that adaptive</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241" href="#__codelineno-0-2241"></a><span class="sd">                population is requested: more solutions are to be sampled</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242" href="#__codelineno-0-2242"></a><span class="sd">                until this number of simulator interactions are made.</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243" href="#__codelineno-0-2243"></a><span class="sd">                Can also be None if this threshold is not needed.</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244" href="#__codelineno-0-2244"></a><span class="sd">            popsize_max: Maximum population size for when the population</span>
<a id="__codelineno-0-2245" name="__codelineno-0-2245" href="#__codelineno-0-2245"></a><span class="sd">                size is adaptive (where the adaptiveness is enabled when</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246" href="#__codelineno-0-2246"></a><span class="sd">                `num_interactions` is not None).</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247" href="#__codelineno-0-2247"></a><span class="sd">                Can be left as None if a maximum population size limit</span>
<a id="__codelineno-0-2248" name="__codelineno-0-2248" href="#__codelineno-0-2248"></a><span class="sd">                is not needed.</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249" href="#__codelineno-0-2249"></a><span class="sd">            ranking_method: Ranking method to be used when computing the</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250" href="#__codelineno-0-2250"></a><span class="sd">                gradients. Can be left as None, in which case the raw</span>
<a id="__codelineno-0-2251" name="__codelineno-0-2251" href="#__codelineno-0-2251"></a><span class="sd">                fitnesses will be used.</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252" href="#__codelineno-0-2252"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253" href="#__codelineno-0-2253"></a><span class="sd">            A dictionary which contains the gradients, number of solutions,</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254" href="#__codelineno-0-2254"></a><span class="sd">            mean of all the evaluation results, and optionally further</span>
<a id="__codelineno-0-2255" name="__codelineno-0-2255" href="#__codelineno-0-2255"></a><span class="sd">            items (if customized to do so).</span>
<a id="__codelineno-0-2256" name="__codelineno-0-2256" href="#__codelineno-0-2256"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257" href="#__codelineno-0-2257"></a>
<a id="__codelineno-0-2258" name="__codelineno-0-2258" href="#__codelineno-0-2258"></a>        <span class="c1"># Annotate the variable which will store the temporary SolutionBatch for computing the local gradient.</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259" href="#__codelineno-0-2259"></a>        <span class="n">resulting_batch</span><span class="p">:</span> <span class="n">SolutionBatch</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260" href="#__codelineno-0-2260"></a>
<a id="__codelineno-0-2261" name="__codelineno-0-2261" href="#__codelineno-0-2261"></a>        <span class="c1"># Get the device in which the new solutions will be made.</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262" href="#__codelineno-0-2262"></a>        <span class="n">grad_device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grad_device</span><span class="p">)</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263" href="#__codelineno-0-2263"></a>        <span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">grad_device</span><span class="p">)</span>
<a id="__codelineno-0-2264" name="__codelineno-0-2264" href="#__codelineno-0-2264"></a>
<a id="__codelineno-0-2265" name="__codelineno-0-2265" href="#__codelineno-0-2265"></a>        <span class="c1"># Below we define an inner utility function which samples and evaluates a new SolutionBatch.</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266" href="#__codelineno-0-2266"></a>        <span class="c1"># This newly evaluated SolutionBatch is returned.</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267" href="#__codelineno-0-2267"></a>        <span class="k">def</span> <span class="nf">sample_evaluated_batch</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-0-2268" name="__codelineno-0-2268" href="#__codelineno-0-2268"></a>            <span class="n">batch</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">grad_device</span><span class="p">)</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269" href="#__codelineno-0-2269"></a>            <span class="n">distribution</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">out</span><span class="o">=</span><span class="n">batch</span><span class="o">.</span><span class="n">access_values</span><span class="p">(),</span> <span class="n">generator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270" href="#__codelineno-0-2270"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271" href="#__codelineno-0-2271"></a>            <span class="k">return</span> <span class="n">batch</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272" href="#__codelineno-0-2272"></a>
<a id="__codelineno-0-2273" name="__codelineno-0-2273" href="#__codelineno-0-2273"></a>        <span class="k">if</span> <span class="n">num_interactions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274" href="#__codelineno-0-2274"></a>            <span class="c1"># If a `num_interactions` threshold is not given (i.e. is left as None), then we assume that an adaptive</span>
<a id="__codelineno-0-2275" name="__codelineno-0-2275" href="#__codelineno-0-2275"></a>            <span class="c1"># population is not desired.</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276" href="#__codelineno-0-2276"></a>            <span class="c1"># We therefore simply sample and evaluate a single SolutionBatch, and declare it as our main batch.</span>
<a id="__codelineno-0-2277" name="__codelineno-0-2277" href="#__codelineno-0-2277"></a>            <span class="n">resulting_batch</span> <span class="o">=</span> <span class="n">sample_evaluated_batch</span><span class="p">()</span>
<a id="__codelineno-0-2278" name="__codelineno-0-2278" href="#__codelineno-0-2278"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2279" name="__codelineno-0-2279" href="#__codelineno-0-2279"></a>            <span class="c1"># If we have a `num_interactions` threshold, then we might have to sample more than one SolutionBatch</span>
<a id="__codelineno-0-2280" name="__codelineno-0-2280" href="#__codelineno-0-2280"></a>            <span class="c1"># (until `num_interactions` is reached).</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281" href="#__codelineno-0-2281"></a>            <span class="c1"># We start by defining a list (`batches`) which is to store all the batches we will sample.</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282" href="#__codelineno-0-2282"></a>            <span class="n">batches</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283" href="#__codelineno-0-2283"></a>
<a id="__codelineno-0-2284" name="__codelineno-0-2284" href="#__codelineno-0-2284"></a>            <span class="c1"># We will have to count the number of all simulator interactions that we have encountered during the</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285" href="#__codelineno-0-2285"></a>            <span class="c1"># execution of this method. So, to count it correctly, we first get the interaction count that we already</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286" href="#__codelineno-0-2286"></a>            <span class="c1"># have before sampling and evaluating our new solutions.</span>
<a id="__codelineno-0-2287" name="__codelineno-0-2287" href="#__codelineno-0-2287"></a>            <span class="n">interaction_count_at_first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_local_interaction_count</span><span class="p">()</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288" href="#__codelineno-0-2288"></a>
<a id="__codelineno-0-2289" name="__codelineno-0-2289" href="#__codelineno-0-2289"></a>            <span class="c1"># Below is an inner function which returns how many simulator interactions we have done so far.</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290" href="#__codelineno-0-2290"></a>            <span class="c1"># It makes use of the variable `interaction_count_at_first` defined above.</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291" href="#__codelineno-0-2291"></a>            <span class="k">def</span> <span class="nf">current_num_interactions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292" href="#__codelineno-0-2292"></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_local_interaction_count</span><span class="p">()</span> <span class="o">-</span> <span class="n">interaction_count_at_first</span>
<a id="__codelineno-0-2293" name="__codelineno-0-2293" href="#__codelineno-0-2293"></a>
<a id="__codelineno-0-2294" name="__codelineno-0-2294" href="#__codelineno-0-2294"></a>            <span class="c1"># We also keep track of the total number of solutions.</span>
<a id="__codelineno-0-2295" name="__codelineno-0-2295" href="#__codelineno-0-2295"></a>            <span class="c1"># We might need this if there is a `popsize_max` threshold.</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296" href="#__codelineno-0-2296"></a>            <span class="n">current_popsize</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-2297" name="__codelineno-0-2297" href="#__codelineno-0-2297"></a>
<a id="__codelineno-0-2298" name="__codelineno-0-2298" href="#__codelineno-0-2298"></a>            <span class="c1"># The main loop of the adaptive sampling.</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299" href="#__codelineno-0-2299"></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300" href="#__codelineno-0-2300"></a>                <span class="c1"># Sample and evaluate a new SolutionBatch, and add it to our batches list.</span>
<a id="__codelineno-0-2301" name="__codelineno-0-2301" href="#__codelineno-0-2301"></a>                <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample_evaluated_batch</span><span class="p">())</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302" href="#__codelineno-0-2302"></a>
<a id="__codelineno-0-2303" name="__codelineno-0-2303" href="#__codelineno-0-2303"></a>                <span class="c1"># Increase our total population size by the size of the most recent batch.</span>
<a id="__codelineno-0-2304" name="__codelineno-0-2304" href="#__codelineno-0-2304"></a>                <span class="n">current_popsize</span> <span class="o">+=</span> <span class="n">popsize</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305" href="#__codelineno-0-2305"></a>
<a id="__codelineno-0-2306" name="__codelineno-0-2306" href="#__codelineno-0-2306"></a>                <span class="k">if</span> <span class="n">current_num_interactions</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">num_interactions</span><span class="p">:</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307" href="#__codelineno-0-2307"></a>                    <span class="c1"># If the number of interactions has reached or exceeded the `num_interactions` threshold,</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308" href="#__codelineno-0-2308"></a>                    <span class="c1"># we exit the loop.</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309" href="#__codelineno-0-2309"></a>                    <span class="k">break</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310" href="#__codelineno-0-2310"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">popsize_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">current_popsize</span> <span class="o">&gt;=</span> <span class="n">popsize_max</span><span class="p">):</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311" href="#__codelineno-0-2311"></a>                    <span class="c1"># If we have `popsize_max` threshold and our total population size have reached or exceeded</span>
<a id="__codelineno-0-2312" name="__codelineno-0-2312" href="#__codelineno-0-2312"></a>                    <span class="c1"># the `popsize_max` threshold, we exit the loop.</span>
<a id="__codelineno-0-2313" name="__codelineno-0-2313" href="#__codelineno-0-2313"></a>                    <span class="k">break</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314" href="#__codelineno-0-2314"></a>
<a id="__codelineno-0-2315" name="__codelineno-0-2315" href="#__codelineno-0-2315"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-2316" name="__codelineno-0-2316" href="#__codelineno-0-2316"></a>                <span class="c1"># If we have only one batch in our batches list, that batch can be declared as our main batch.</span>
<a id="__codelineno-0-2317" name="__codelineno-0-2317" href="#__codelineno-0-2317"></a>                <span class="n">resulting_batch</span> <span class="o">=</span> <span class="n">batches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318" href="#__codelineno-0-2318"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2319" name="__codelineno-0-2319" href="#__codelineno-0-2319"></a>                <span class="c1"># If we have multiple batches in our batches list, we concatenate all those batches and</span>
<a id="__codelineno-0-2320" name="__codelineno-0-2320" href="#__codelineno-0-2320"></a>                <span class="c1"># declare the result of the concatenation as our main batch.</span>
<a id="__codelineno-0-2321" name="__codelineno-0-2321" href="#__codelineno-0-2321"></a>                <span class="n">resulting_batch</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span>
<a id="__codelineno-0-2322" name="__codelineno-0-2322" href="#__codelineno-0-2322"></a>
<a id="__codelineno-0-2323" name="__codelineno-0-2323" href="#__codelineno-0-2323"></a>        <span class="c1"># We take the solutions (`samples`) and the fitnesses from our main batch.</span>
<a id="__codelineno-0-2324" name="__codelineno-0-2324" href="#__codelineno-0-2324"></a>        <span class="n">samples</span> <span class="o">=</span> <span class="n">resulting_batch</span><span class="o">.</span><span class="n">access_values</span><span class="p">(</span><span class="n">keep_evals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2325" name="__codelineno-0-2325" href="#__codelineno-0-2325"></a>        <span class="n">fitnesses</span> <span class="o">=</span> <span class="n">resulting_batch</span><span class="o">.</span><span class="n">access_evals</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-2326" name="__codelineno-0-2326" href="#__codelineno-0-2326"></a>
<a id="__codelineno-0-2327" name="__codelineno-0-2327" href="#__codelineno-0-2327"></a>        <span class="c1"># With the help of `samples` and `fitnesses`, we now compute our gradients.</span>
<a id="__codelineno-0-2328" name="__codelineno-0-2328" href="#__codelineno-0-2328"></a>        <span class="n">grads</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">compute_gradients</span><span class="p">(</span>
<a id="__codelineno-0-2329" name="__codelineno-0-2329" href="#__codelineno-0-2329"></a>            <span class="n">samples</span><span class="p">,</span> <span class="n">fitnesses</span><span class="p">,</span> <span class="n">objective_sense</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">[</span><span class="n">obj_index</span><span class="p">],</span> <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span>
<a id="__codelineno-0-2330" name="__codelineno-0-2330" href="#__codelineno-0-2330"></a>        <span class="p">)</span>
<a id="__codelineno-0-2331" name="__codelineno-0-2331" href="#__codelineno-0-2331"></a>
<a id="__codelineno-0-2332" name="__codelineno-0-2332" href="#__codelineno-0-2332"></a>        <span class="k">if</span> <span class="n">grad_device</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">:</span>
<a id="__codelineno-0-2333" name="__codelineno-0-2333" href="#__codelineno-0-2333"></a>            <span class="n">grads</span> <span class="o">=</span> <span class="n">cast_tensors_in_container</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-2334" name="__codelineno-0-2334" href="#__codelineno-0-2334"></a>
<a id="__codelineno-0-2335" name="__codelineno-0-2335" href="#__codelineno-0-2335"></a>        <span class="c1"># Finally, we return the result, which is a dictionary containing the gradients and further information.</span>
<a id="__codelineno-0-2336" name="__codelineno-0-2336" href="#__codelineno-0-2336"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-2337" name="__codelineno-0-2337" href="#__codelineno-0-2337"></a>            <span class="s2">&quot;gradients&quot;</span><span class="p">:</span> <span class="n">grads</span><span class="p">,</span>
<a id="__codelineno-0-2338" name="__codelineno-0-2338" href="#__codelineno-0-2338"></a>            <span class="s2">&quot;num_solutions&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">resulting_batch</span><span class="p">),</span>
<a id="__codelineno-0-2339" name="__codelineno-0-2339" href="#__codelineno-0-2339"></a>            <span class="s2">&quot;mean_eval&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">resulting_batch</span><span class="o">.</span><span class="n">access_evals</span><span class="p">(</span><span class="n">obj_index</span><span class="p">))),</span>
<a id="__codelineno-0-2340" name="__codelineno-0-2340" href="#__codelineno-0-2340"></a>        <span class="p">}</span>
<a id="__codelineno-0-2341" name="__codelineno-0-2341" href="#__codelineno-0-2341"></a>
<a id="__codelineno-0-2342" name="__codelineno-0-2342" href="#__codelineno-0-2342"></a>    <span class="k">def</span> <span class="nf">is_on_cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2343" name="__codelineno-0-2343" href="#__codelineno-0-2343"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2344" name="__codelineno-0-2344" href="#__codelineno-0-2344"></a><span class="sd">        Whether or not the Problem object has its device set as &quot;cpu&quot;.</span>
<a id="__codelineno-0-2345" name="__codelineno-0-2345" href="#__codelineno-0-2345"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2346" name="__codelineno-0-2346" href="#__codelineno-0-2346"></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.actor_index" class="doc doc-heading">
<code class="highlight language-python"><span class="n">actor_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.actor_index" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return the actor index if this is a remote worker.
If this is not a remote worker, return None.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.actors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.actors" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the ray actors, if the Problem object is distributed.
If the Problem object is not distributed and therefore
has no actors, then, the result will be None.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.after_eval_hook" class="doc doc-heading">
<code class="highlight language-python"><span class="n">after_eval_hook</span><span class="p">:</span> <span class="n">Hook</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.after_eval_hook" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the Hook which stores the functions to call just after
evaluating a SolutionBatch.</p>
<p>The functions to be stored in this hook are expected to
accept one argument, that one argument being the SolutionBatch
whose evaluation has just been completed.</p>
<p>The dictionaries returned by the functions in this hook
are accumulated, and reported in the status dictionary of this
problem object.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.after_grad_hook" class="doc doc-heading">
<code class="highlight language-python"><span class="n">after_grad_hook</span><span class="p">:</span> <span class="n">Hook</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.after_grad_hook" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the Hook which stores the functions to call just after
its <code>sample_and_compute_gradients(...)</code> operation.</p>
<p>The functions to be stored in this hook are expected to
accept one argument, that one argument being the gradients
dictionary (which was produced by the Problem object,
but not yet followed by the search algorithm).</p>
<p>The dictionaries returned by the functions in this hook
are accumulated, and reported in the status dictionary of this
problem object.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.aux_device" class="doc doc-heading">
<code class="highlight language-python"><span class="n">aux_device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.aux_device" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Auxiliary device to help with the computations, most commonly for
speeding up the solution evaluations.</p>
<p>An auxiliary device is different than the main device of the Problem
object (the main device being expressed by the <code>device</code> property).
While the main device of the Problem object determines where the
solutions and the populations are stored (and also using which device
should a SearchAlgorithm instance communicate with the problem),
an auxiliary device is a device that might be used by the Problem
instance itself for its own computations (e.g. computations defined
within the methods <code>_evaluate(...)</code> or <code>_evaluate_batch(...)</code>).</p>
<p>If the problem's main device is something other than "cpu", that main
device is also seen as the auxiliary device, and therefore returned
by this property.</p>
<p>If the problem's main device is "cpu", then the auxiliary device
is decided as follows. If <code>num_gpus_per_actor</code> of the Problem object
was set as "all" and if this instance is a remote instance, then the
auxiliary device is guessed as "cuda:N" where N is the actor index.
In all other cases, the auxiliary device is "cuda" if cuda is
available, and "cpu" otherwise.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.before_eval_hook" class="doc doc-heading">
<code class="highlight language-python"><span class="n">before_eval_hook</span><span class="p">:</span> <span class="n">Hook</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.before_eval_hook" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the Hook which stores the functions to call just before
evaluating a SolutionBatch.</p>
<p>The functions to be stored in this hook are expected to
accept one positional argument, that one argument being the
SolutionBatch which is about to be evaluated.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.before_grad_hook" class="doc doc-heading">
<code class="highlight language-python"><span class="n">before_grad_hook</span><span class="p">:</span> <span class="n">Hook</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.before_grad_hook" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the Hook which stores the functions to call just before
its <code>sample_and_compute_gradients(...)</code> operation.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.device" class="doc doc-heading">
<code class="highlight language-python"><span class="n">device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.device" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>device of the Problem object.</p>
<p>New solutions and populations will be generated in this device.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.dtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">Type</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.dtype" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>dtype of the Problem object.</p>
<p>The decision variables of the optimization problem are of this dtype.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.eval_data_length" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_data_length</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.eval_data_length" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Length of the extra evaluation data vector for each solution.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.eval_dtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">Type</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.eval_dtype" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>evaluation dtype of the Problem object.</p>
<p>The evaluation results of the solutions are stored according to this
dtype.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.generator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">_C</span><span class="o">.</span><span class="n">Generator</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.generator" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Random generator used by this Problem object.</p>
<p>Can also be None, which means that the Problem object will use the
global random generator of PyTorch.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.has_own_generator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">has_own_generator</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.has_own_generator" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Whether or not the Problem object has its own random generator.</p>
<p>If this is True, then the Problem object will use its own
random generator when creating random values or tensors.
If this is False, then the Problem object will use the global
random generator when creating random values or tensors.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.initial_lower_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">initial_lower_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.initial_lower_bounds" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Initial lower bounds, for when initializing a new solution.</p>
<p>If such a bound was declared during the initialization phase,
the returned value is a torch tensor (in the form of a vector
or in the form of a scalar).
If no such bound was declared, the returned value is None.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.initial_upper_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">initial_upper_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.initial_upper_bounds" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Initial upper bounds, for when initializing a new solution.</p>
<p>If such a bound was declared during the initialization phase,
the returned value is a torch tensor (in the form of a vector
or in the form of a scalar).
If no such bound was declared, the returned value is None.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.is_main" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_main</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.is_main" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns True if this problem object lives in the main process
and not in a remote actor.
Otherwise, returns False.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.is_multi_objective" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_multi_objective</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.is_multi_objective" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Whether or not the problem is multi-objective</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.is_remote" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_remote</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.is_remote" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns True if this problem object lives in a remote ray actor.
Otherwise, returns False.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.is_single_objective" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_single_objective</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.is_single_objective" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Whether or not the problem is single-objective</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.lower_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lower_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.lower_bounds" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Lower bounds for the allowed values of a solution.</p>
<p>If such a bound was declared during the initialization phase,
the returned value is a torch tensor (in the form of a vector
or in the form of a scalar).
If no such bound was declared, the returned value is None.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.num_actors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">num_actors</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.num_actors" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Number of actors (to be) used for parallelization.
If the problem is configured for no parallelization,
the result will be 0.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.objective_sense" class="doc doc-heading">
<code class="highlight language-python"><span class="n">objective_sense</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.objective_sense" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the objective sense.</p>
<p>If the problem is single-objective, then a single string is returned.
If the problem is multi-objective, then the objective senses will be
returned in a list.</p>
<p>The returned string in the single-objective case, or each returned
string in the multi-objective case, is "min" or "max".</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.remote_hook" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remote_hook</span><span class="p">:</span> <span class="n">Hook</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.remote_hook" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the Hook which stores the functions to call when this
Problem object is (re)created on a remote actor.</p>
<p>The functions in this hook should expect one positional
argument, that is the Problem object itself.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.senses" class="doc doc-heading">
<code class="highlight language-python"><span class="n">senses</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.senses" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the objective senses.</p>
<p>The return value is a list of strings, each string being
"min" or "max".</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.solution_length" class="doc doc-heading">
<code class="highlight language-python"><span class="n">solution_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.solution_length" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the solution length.</p>
<p>Problems with <code>dtype=None</code> do not have solution lengths.
For such problems, this property returns None.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.status" class="doc doc-heading">
<code class="highlight language-python"><span class="n">status</span><span class="p">:</span> <span class="nb">dict</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.status" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Status dictionary of the problem object, updated after the last
evaluation operation.</p>
<p>The dictionaries returned by the functions in <code>after_eval_hook</code>
are accumulated, and reported in this status dictionary.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.stores_solution_stats" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stores_solution_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.stores_solution_stats" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Whether or not the best and worst solutions are kept.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Problem.upper_bounds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">upper_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Problem.upper_bounds" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Upper bounds for the allowed values of a solution.</p>
<p>If such a bound was declared during the initialization phase,
the returned value is a torch tensor (in the form of a vector
or in the form of a scalar).
If no such bound was declared, the returned value is None.</p>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">objective_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">initial_bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">solution_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eval_dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eval_data_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_actors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">actor_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_gpus_per_actor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_subbatches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subbatch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">store_solution_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.Problem.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p><code>__init__(...)</code>: Initialize the Problem object.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>objective_sense</code></td>
        <td><code>Union[str, Iterable[str]]</code></td>
        <td><p>A string, or a sequence of strings.
For a single-objective problem, a single string
("min" or "max", for minimization or maximization)
is enough.
For a problem with <code>n</code> objectives, a sequence
of strings, of length <code>n</code>, is required, each string
in the sequence being "min" or "max".
This argument specifies the goal of the optimization.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>initial_bounds</code></td>
        <td><code>Union[Iterable[Union[float, Iterable[float], torch.Tensor]], evotorch.core.BoundsPair]</code></td>
        <td><p>In which interval will the values of a
new solution will be initialized.
Expected as a tuple, each element being either a
scalar, or a vector of length <code>n</code>, <code>n</code> being the
length of a solution.
If a manual solution initialization is preferred
(instead of an interval-based initialization),
one can leave <code>initial_bounds</code> as None, and override
the <code>generate_values(...)</code> method instead in the
inheriting subclass.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>bounds</code></td>
        <td><code>Union[Iterable[Union[float, Iterable[float], torch.Tensor]], evotorch.core.BoundsPair]</code></td>
        <td><p>Interval in which all the solutions must always
reside.
Expected as a tuple, each element being either a
scalar, or a vector of length <code>n</code>, <code>n</code> being the
length of a solution.
This argument is optional, and can be left as None
if one does not wish to declare hard bounds on the
decision values of the problem.
If <code>bounds</code> is specified, <code>initial_bounds</code> is missing,
and <code>generate_values(...)</code> is not overriden, then
<code>bounds</code> will also serve as the <code>initial_bounds</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>solution_length</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Length of a solution.
Required for all fixed-length numeric optimization
problems.
For variable-length problems (which might or might not
be numeric), one is expected to leave <code>solution_length</code>
as None, and declare <code>dtype</code> as <code>object</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dtype</code></td>
        <td><code>Union[str, torch.dtype, numpy.dtype, Type]</code></td>
        <td><p>dtype (data type) of the data stored by a solution.
Can be given as a string (e.g. "float32"),
or as a numpy dtype (e.g. <code>numpy.dtype("float32")</code>),
or as a PyTorch dtype (e.g. <code>torch.float32</code>).
Alternatively, if the problem is variable-length
and/or non-numeric, one is expected to declare <code>dtype</code>
as <code>object</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>eval_dtype</code></td>
        <td><code>Union[str, torch.dtype, numpy.dtype, Type]</code></td>
        <td><p>dtype to be used for storing the evaluations
(or fitnesses, or scores, or costs, or losses)
of the solutions.
Can be given as a string (e.g. "float32"),
or as a numpy dtype (e.g. <code>numpy.dtype("float32")</code>),
or as a PyTorch dtype (e.g. <code>torch.float32</code>).
<code>eval_dtype</code> must always refer to a "float" data type,
therefore, <code>object</code> is not accepted as a valid <code>eval_dtype</code>.
If <code>eval_dtype</code> is not specified (i.e. left as None),
then the following actions are taken to determine the
<code>eval_dtype</code>:
if <code>dtype</code> is "float16", <code>eval_dtype</code> becomes "float16";
if <code>dtype</code> is "bfloat16", <code>eval_dtype</code> becomes "bfloat16";
if <code>dtype</code> is "float32", <code>eval_dtype</code> becomes "float32";
if <code>dtype</code> is "float64", <code>eval_dtype</code> becomes "float64";
and for any other <code>dtype</code>, <code>eval_dtype</code> becomes "float32".</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>device</code></td>
        <td><code>Union[str, torch.device]</code></td>
        <td><p>Default device in which a new population will be
generated. For non-numeric problems, this must be "cpu".
For numeric problems, this can be any device supported
by PyTorch (e.g. "cuda").</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>eval_data_length</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>In addition to evaluation results
(which are (un)fitnesses, or scores, or costs, or losses),
each solution can store extra evaluation data.
If storage of such extra evaluation data is required,
one can set this argument to an integer bigger than 0.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>seed</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Random seed to be used by the random number generator
attached to the problem object.
If left as None, no random number generator will be
attached, and the global random number generator of
PyTorch will be used instead.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>num_actors</code></td>
        <td><code>Union[int, str]</code></td>
        <td><p>Number of actors to create for parallelized
evaluation of the solutions.
Certain string values are also accepted.
When given as "max" or as "num_cpus", the number of actors
will be equal to the number of all available CPUs in the ray
cluster.
When given as "num_gpus", the number of actors will be
equal to the number of all available GPUs in the ray
cluster, and each actor will be assigned a GPU.
There is also an option, "num_devices", which means that
both the numbers of CPUs and GPUs will be analyzed, and
new actors and GPUs for them will be allocated,
in a one-to-one mapping manner, if possible.
In more details, with <code>num_actors="num_devices"</code>, if
<code>device</code> is given as a GPU device, then it will be inferred
that the user wishes to put everything (including the
population) on a single GPU, and therefore there won't be
any allocation of actors nor GPUs.
With <code>num_actors="num_devices"</code> and with <code>device</code> set as
"cpu" (or as left as None), if there are multiple CPUs
and multiple GPUs, then <code>n</code> actors will be allocated
where <code>n</code> is the minimum among the number of CPUs
and the number of GPUs, so that there can be one-to-one
mapping between CPUs and GPUs (i.e. such that each actor
can be assigned an entire GPU).
If <code>num_actors</code> is given as "num_gpus" or "num_devices",
the argument <code>num_gpus_per_actor</code> must not be used,
and the <code>actor_config</code> dictionary must not contain the
key "num_gpus".
If <code>num_actors</code> is given as something other than "num_gpus"
or "num_devices", and if you wish to assign GPUs to each
actor, then please see the argument <code>num_gpus_per_actor</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>actor_config</code></td>
        <td><code>Optional[dict]</code></td>
        <td><p>A dictionary, representing the keyword arguments
to be passed to the options(...) used when creating the
ray actor objects. To be used for explicitly allocating
resources per each actor.
For example, for declaring that each actor is to use a GPU,
one can pass <code>actor_config=dict(num_gpus=1)</code>.
Can also be given as None (which is the default),
if no such options are to be passed.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>num_gpus_per_actor</code></td>
        <td><code>Union[int, float, str]</code></td>
        <td><p>Number of GPUs to be allocated by each
remote actor.
The default behavior is to NOT allocate any GPU at all
(which is the default behavior of the ray library as well).
When given as a number <code>n</code>, each actor will be given
<code>n</code> GPUs (where <code>n</code> can be an integer, or can be a <code>float</code>
for fractional allocation).
When given as a string "max", then the available GPUs
across the entire ray cluster (or within the local computer
in the simplest cases) will be equally distributed among
the actors.
When given as a string "all", then each actor will have
access to all the GPUs (this will be achieved by suppressing
the environment variable <code>CUDA_VISIBLE_DEVICES</code> for each
actor).
When the problem is not distributed (i.e. when there are
no actors), this argument is expected to be left as None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>num_subbatches</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>If <code>num_subbatches</code> is None (assuming that
<code>subbatch_size</code> is also None), then, when evaluating a
population, the population will be split into n pieces, <code>n</code>
being the number of actors, and each actor will evaluate
its assigned piece. If <code>num_subbatches</code> is an integer <code>m</code>,
then the population will be split into <code>m</code> pieces,
and actors will continually accept the next unevaluated
piece as they finish their current tasks.
The arguments <code>num_subbatches</code> and <code>subbatch_size</code> cannot
be given values other than None at the same time.
While using a distributed algorithm, this argument determines
how many sub-batches will be generated, and therefore,
how many gradients will be computed by the remote actors.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>subbatch_size</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>If <code>subbatch_size</code> is None (assuming that
<code>num_subbatches</code> is also None), then, when evaluating a
population, the population will be split into <code>n</code> pieces, <code>n</code>
being the number of actors, and each actor will evaluate its
assigned piece. If <code>subbatch_size</code> is an integer <code>m</code>,
then the population will be split into pieces of size <code>m</code>,
and actors will continually accept the next unevaluated
piece as they finish their current tasks.
When there can be significant difference across the solutions
in terms of computational requirements, specifying a
<code>subbatch_size</code> can be beneficial, because, while one
actor is busy with a subbatch containing computationally
challenging solutions, other actors can accept more
tasks and save time.
The arguments <code>num_subbatches</code> and <code>subbatch_size</code> cannot
be given values other than None at the same time.
While using a distributed algorithm, this argument determines
the size of a sub-batch (or sub-population) sampled by a
remote actor for computing a gradient.
In distributed mode, it is expected that the population size
is divisible by <code>subbatch_size</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>store_solution_stats</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>Whether or not the problem object should
keep track of the best and worst solutions.
Can also be left as None (which is the default behavior),
in which case, it will store the best and worst solutions
only when the first solution batch it encounters is on the
cpu. This default behavior is to ensure that there is no
transfer between the cpu and a foreign computation device
(like the gpu) just for the sake of keeping the best and
the worst solutions.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">objective_sense</span><span class="p">:</span> <span class="n">ObjectiveSense</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">objective_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">initial_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundsPairLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BoundsPairLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">solution_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">eval_dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">eval_data_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">num_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">num_gpus_per_actor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">store_solution_stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">vectorized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">    `__init__(...)`: Initialize the Problem object.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">        objective_sense: A string, or a sequence of strings.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">            For a single-objective problem, a single string</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="sd">            (&quot;min&quot; or &quot;max&quot;, for minimization or maximization)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">            is enough.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">            For a problem with `n` objectives, a sequence</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="sd">            of strings, of length `n`, is required, each string</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="sd">            in the sequence being &quot;min&quot; or &quot;max&quot;.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="sd">            This argument specifies the goal of the optimization.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="sd">        initial_bounds: In which interval will the values of a</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="sd">            new solution will be initialized.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="sd">            Expected as a tuple, each element being either a</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="sd">            scalar, or a vector of length `n`, `n` being the</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="sd">            length of a solution.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="sd">            If a manual solution initialization is preferred</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="sd">            (instead of an interval-based initialization),</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="sd">            one can leave `initial_bounds` as None, and override</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="sd">            the `generate_values(...)` method instead in the</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="sd">            inheriting subclass.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="sd">        bounds: Interval in which all the solutions must always</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="sd">            reside.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="sd">            Expected as a tuple, each element being either a</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="sd">            scalar, or a vector of length `n`, `n` being the</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="sd">            length of a solution.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="sd">            This argument is optional, and can be left as None</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="sd">            if one does not wish to declare hard bounds on the</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="sd">            decision values of the problem.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="sd">            If `bounds` is specified, `initial_bounds` is missing,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="sd">            and `generate_values(...)` is not overriden, then</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="sd">            `bounds` will also serve as the `initial_bounds`.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="sd">        solution_length: Length of a solution.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a><span class="sd">            Required for all fixed-length numeric optimization</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span class="sd">            problems.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a><span class="sd">            For variable-length problems (which might or might not</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="sd">            be numeric), one is expected to leave `solution_length`</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a><span class="sd">            as None, and declare `dtype` as `object`.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a><span class="sd">        dtype: dtype (data type) of the data stored by a solution.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a><span class="sd">            Can be given as a string (e.g. &quot;float32&quot;),</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a><span class="sd">            or as a numpy dtype (e.g. `numpy.dtype(&quot;float32&quot;)`),</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a><span class="sd">            or as a PyTorch dtype (e.g. `torch.float32`).</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a><span class="sd">            Alternatively, if the problem is variable-length</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a><span class="sd">            and/or non-numeric, one is expected to declare `dtype`</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a><span class="sd">            as `object`.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a><span class="sd">        eval_dtype: dtype to be used for storing the evaluations</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a><span class="sd">            (or fitnesses, or scores, or costs, or losses)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a><span class="sd">            of the solutions.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a><span class="sd">            Can be given as a string (e.g. &quot;float32&quot;),</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a><span class="sd">            or as a numpy dtype (e.g. `numpy.dtype(&quot;float32&quot;)`),</span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a><span class="sd">            or as a PyTorch dtype (e.g. `torch.float32`).</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a><span class="sd">            `eval_dtype` must always refer to a &quot;float&quot; data type,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a><span class="sd">            therefore, `object` is not accepted as a valid `eval_dtype`.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a><span class="sd">            If `eval_dtype` is not specified (i.e. left as None),</span>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a><span class="sd">            then the following actions are taken to determine the</span>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a><span class="sd">            `eval_dtype`:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a><span class="sd">            if `dtype` is &quot;float16&quot;, `eval_dtype` becomes &quot;float16&quot;;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a><span class="sd">            if `dtype` is &quot;bfloat16&quot;, `eval_dtype` becomes &quot;bfloat16&quot;;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a><span class="sd">            if `dtype` is &quot;float32&quot;, `eval_dtype` becomes &quot;float32&quot;;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a><span class="sd">            if `dtype` is &quot;float64&quot;, `eval_dtype` becomes &quot;float64&quot;;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="sd">            and for any other `dtype`, `eval_dtype` becomes &quot;float32&quot;.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="sd">        device: Default device in which a new population will be</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="sd">            generated. For non-numeric problems, this must be &quot;cpu&quot;.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a><span class="sd">            For numeric problems, this can be any device supported</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a><span class="sd">            by PyTorch (e.g. &quot;cuda&quot;).</span>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a><span class="sd">        eval_data_length: In addition to evaluation results</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a><span class="sd">            (which are (un)fitnesses, or scores, or costs, or losses),</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="sd">            each solution can store extra evaluation data.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a><span class="sd">            If storage of such extra evaluation data is required,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a><span class="sd">            one can set this argument to an integer bigger than 0.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a><span class="sd">        seed: Random seed to be used by the random number generator</span>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a><span class="sd">            attached to the problem object.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a><span class="sd">            If left as None, no random number generator will be</span>
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a><span class="sd">            attached, and the global random number generator of</span>
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a><span class="sd">            PyTorch will be used instead.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a><span class="sd">        num_actors: Number of actors to create for parallelized</span>
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a><span class="sd">            evaluation of the solutions.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a><span class="sd">            Certain string values are also accepted.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a><span class="sd">            When given as &quot;max&quot; or as &quot;num_cpus&quot;, the number of actors</span>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a><span class="sd">            will be equal to the number of all available CPUs in the ray</span>
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a><span class="sd">            cluster.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a><span class="sd">            When given as &quot;num_gpus&quot;, the number of actors will be</span>
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a><span class="sd">            equal to the number of all available GPUs in the ray</span>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a><span class="sd">            cluster, and each actor will be assigned a GPU.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a><span class="sd">            There is also an option, &quot;num_devices&quot;, which means that</span>
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a><span class="sd">            both the numbers of CPUs and GPUs will be analyzed, and</span>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a><span class="sd">            new actors and GPUs for them will be allocated,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a><span class="sd">            in a one-to-one mapping manner, if possible.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a><span class="sd">            In more details, with `num_actors=&quot;num_devices&quot;`, if</span>
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a><span class="sd">            `device` is given as a GPU device, then it will be inferred</span>
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a><span class="sd">            that the user wishes to put everything (including the</span>
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a><span class="sd">            population) on a single GPU, and therefore there won&#39;t be</span>
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a><span class="sd">            any allocation of actors nor GPUs.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a><span class="sd">            With `num_actors=&quot;num_devices&quot;` and with `device` set as</span>
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a><span class="sd">            &quot;cpu&quot; (or as left as None), if there are multiple CPUs</span>
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a><span class="sd">            and multiple GPUs, then `n` actors will be allocated</span>
<a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a><span class="sd">            where `n` is the minimum among the number of CPUs</span>
<a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a><span class="sd">            and the number of GPUs, so that there can be one-to-one</span>
<a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a><span class="sd">            mapping between CPUs and GPUs (i.e. such that each actor</span>
<a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a><span class="sd">            can be assigned an entire GPU).</span>
<a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a><span class="sd">            If `num_actors` is given as &quot;num_gpus&quot; or &quot;num_devices&quot;,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a><span class="sd">            the argument `num_gpus_per_actor` must not be used,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a><span class="sd">            and the `actor_config` dictionary must not contain the</span>
<a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a><span class="sd">            key &quot;num_gpus&quot;.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a><span class="sd">            If `num_actors` is given as something other than &quot;num_gpus&quot;</span>
<a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a><span class="sd">            or &quot;num_devices&quot;, and if you wish to assign GPUs to each</span>
<a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a><span class="sd">            actor, then please see the argument `num_gpus_per_actor`.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a><span class="sd">        actor_config: A dictionary, representing the keyword arguments</span>
<a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a><span class="sd">            to be passed to the options(...) used when creating the</span>
<a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a><span class="sd">            ray actor objects. To be used for explicitly allocating</span>
<a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a><span class="sd">            resources per each actor.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a><span class="sd">            For example, for declaring that each actor is to use a GPU,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a><span class="sd">            one can pass `actor_config=dict(num_gpus=1)`.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a><span class="sd">            Can also be given as None (which is the default),</span>
<a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a><span class="sd">            if no such options are to be passed.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a><span class="sd">        num_gpus_per_actor: Number of GPUs to be allocated by each</span>
<a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a><span class="sd">            remote actor.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a><span class="sd">            The default behavior is to NOT allocate any GPU at all</span>
<a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a><span class="sd">            (which is the default behavior of the ray library as well).</span>
<a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a><span class="sd">            When given as a number `n`, each actor will be given</span>
<a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a><span class="sd">            `n` GPUs (where `n` can be an integer, or can be a `float`</span>
<a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a><span class="sd">            for fractional allocation).</span>
<a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a><span class="sd">            When given as a string &quot;max&quot;, then the available GPUs</span>
<a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a><span class="sd">            across the entire ray cluster (or within the local computer</span>
<a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a><span class="sd">            in the simplest cases) will be equally distributed among</span>
<a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a><span class="sd">            the actors.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a><span class="sd">            When given as a string &quot;all&quot;, then each actor will have</span>
<a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a><span class="sd">            access to all the GPUs (this will be achieved by suppressing</span>
<a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a><span class="sd">            the environment variable `CUDA_VISIBLE_DEVICES` for each</span>
<a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a><span class="sd">            actor).</span>
<a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a><span class="sd">            When the problem is not distributed (i.e. when there are</span>
<a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a><span class="sd">            no actors), this argument is expected to be left as None.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a><span class="sd">        num_subbatches: If `num_subbatches` is None (assuming that</span>
<a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a><span class="sd">            `subbatch_size` is also None), then, when evaluating a</span>
<a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a><span class="sd">            population, the population will be split into n pieces, `n`</span>
<a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a><span class="sd">            being the number of actors, and each actor will evaluate</span>
<a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a><span class="sd">            its assigned piece. If `num_subbatches` is an integer `m`,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a><span class="sd">            then the population will be split into `m` pieces,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a><span class="sd">            and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a><span class="sd">            piece as they finish their current tasks.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a><span class="sd">            The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a><span class="sd">            be given values other than None at the same time.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a><span class="sd">            While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a><span class="sd">            how many sub-batches will be generated, and therefore,</span>
<a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a><span class="sd">            how many gradients will be computed by the remote actors.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a><span class="sd">        subbatch_size: If `subbatch_size` is None (assuming that</span>
<a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a><span class="sd">            `num_subbatches` is also None), then, when evaluating a</span>
<a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a><span class="sd">            population, the population will be split into `n` pieces, `n`</span>
<a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a><span class="sd">            being the number of actors, and each actor will evaluate its</span>
<a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a><span class="sd">            assigned piece. If `subbatch_size` is an integer `m`,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a><span class="sd">            then the population will be split into pieces of size `m`,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a><span class="sd">            and actors will continually accept the next unevaluated</span>
<a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a><span class="sd">            piece as they finish their current tasks.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a><span class="sd">            When there can be significant difference across the solutions</span>
<a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a><span class="sd">            in terms of computational requirements, specifying a</span>
<a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a><span class="sd">            `subbatch_size` can be beneficial, because, while one</span>
<a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a><span class="sd">            actor is busy with a subbatch containing computationally</span>
<a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a><span class="sd">            challenging solutions, other actors can accept more</span>
<a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a><span class="sd">            tasks and save time.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a><span class="sd">            The arguments `num_subbatches` and `subbatch_size` cannot</span>
<a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a><span class="sd">            be given values other than None at the same time.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a><span class="sd">            While using a distributed algorithm, this argument determines</span>
<a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a><span class="sd">            the size of a sub-batch (or sub-population) sampled by a</span>
<a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a><span class="sd">            remote actor for computing a gradient.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a><span class="sd">            In distributed mode, it is expected that the population size</span>
<a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a><span class="sd">            is divisible by `subbatch_size`.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a><span class="sd">        store_solution_stats: Whether or not the problem object should</span>
<a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a><span class="sd">            keep track of the best and worst solutions.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a><span class="sd">            Can also be left as None (which is the default behavior),</span>
<a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a><span class="sd">            in which case, it will store the best and worst solutions</span>
<a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a><span class="sd">            only when the first solution batch it encounters is on the</span>
<a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a><span class="sd">            cpu. This default behavior is to ensure that there is no</span>
<a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a><span class="sd">            transfer between the cpu and a foreign computation device</span>
<a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a><span class="sd">            (like the gpu) just for the sake of keeping the best and</span>
<a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a><span class="sd">            the worst solutions.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a>    <span class="c1"># Set the dtype for the decision variables of the Problem</span>
<a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a>    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span>
<a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a>    <span class="k">elif</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="nb">object</span>
<a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a>    <span class="c1"># Set the dtype for the solution evaluations (i.e. fitnesses and evaluation data)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a>    <span class="k">if</span> <span class="n">eval_dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a>        <span class="c1"># If an `eval_dtype` is explicitly stated, then accept it as the `_eval_dtype` of the Problem</span>
<a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_eval_dtype</span> <span class="o">=</span> <span class="n">to_torch_dtype</span><span class="p">(</span><span class="n">eval_dtype</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a>        <span class="c1"># This is the case where an `eval_dtype` is not explicitly stated by the user.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a>        <span class="c1"># We need to choose a default.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="ow">in</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
<a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a>            <span class="c1"># If the `dtype` of the problem is a non-32-bit float type (i.e. float16, bfloat16, float64)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a>            <span class="c1"># then we use that as our `_eval_dtype` as well.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_eval_dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>
<a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a>            <span class="c1"># For any other `dtype`, we use float32 as our `_eval_dtype`.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_eval_dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span>
<a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a>    <span class="c1"># Set the main device of the Problem object</span>
<a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a>    <span class="c1"># Declare the internal variable that might store the random number generator</span>
<a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a>    <span class="c1"># Set the seed of the Problem object, if a seed is provided</span>
<a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a>    <span class="c1"># Declare the internal variables that will store the bounds and the solution length</span>
<a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_initial_lower_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_initial_upper_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_lower_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_upper_bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_solution_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="ow">is</span> <span class="nb">object</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a>        <span class="c1"># If dtype is given as `object`, then there are some runtime sanity checks to perform</span>
<a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a>        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">initial_bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a>            <span class="c1"># With dtype as object, if bounds are given then we raise an error.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a>            <span class="c1"># This is because the `object` dtype implies that the decision values are not necessarily numeric,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a>            <span class="c1"># and therefore, we cannot have the guarantee of satisfying numeric bounds.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a>                <span class="sa">f</span><span class="s2">&quot;With dtype as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">, expected to receive `initial_bounds` and/or `bounds` as None.&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a>                <span class="sa">f</span><span class="s2">&quot; However, one or both of them is/are set as value(s) other than None.&quot;</span>
<a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a>            <span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a>        <span class="k">if</span> <span class="n">solution_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a>            <span class="c1"># With dtype as object, if `solution_length` is provided, then we raise an error.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a>            <span class="c1"># This is because the `object` dtype implies that the solutions can be expressed via various</span>
<a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a>            <span class="c1"># containers, each with its own length, and therefore, a fixed solution length cannot be guaranteed.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a>                <span class="sa">f</span><span class="s2">&quot;With dtype as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">, expected to receive `solution_length` as None.&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a>                <span class="sa">f</span><span class="s2">&quot; However, received `solution_length` as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">solution_length</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a>            <span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a>        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_device</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a>            <span class="c1"># With dtype as object, if `device` is something other than &quot;cpu&quot;, then we raise an error.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a>            <span class="c1"># This is because the `object` dtype implies that the decision values are stored by an ObjectArray,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a>            <span class="c1"># whose device is always &quot;cpu&quot;.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a>                <span class="sa">f</span><span class="s2">&quot;With dtype as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">, expected to receive `device` as &#39;cpu&#39;.&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a>                <span class="sa">f</span><span class="s2">&quot; However, received `device` as </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">device</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a>            <span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a>        <span class="c1"># If dtype is something other than `object`, then we need to properly store the given numeric bounds,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a>        <span class="c1"># and also perform some sanity checks.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a>        <span class="n">initbnd_tuple_name</span> <span class="o">=</span> <span class="s2">&quot;initial_bounds&quot;</span>
<a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a>        <span class="n">bnd_tuple_name</span> <span class="o">=</span> <span class="s2">&quot;bounds&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">initial_bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a>            <span class="c1"># With a numeric dtype, if no boundary is provided at all, then we cannot know how to initialize</span>
<a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a>            <span class="c1"># the solutions. With such a lack of information, we raise an error.</span>
<a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a>                <span class="sa">f</span><span class="s2">&quot;Together with a numeric dtype (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">),&quot;</span>
<a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a>                <span class="sa">f</span><span class="s2">&quot; expected to receive `initial_bounds` and/or `bounds` as something other than None.&quot;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a>                <span class="sa">f</span><span class="s2">&quot; However, both `initial_bounds` and `bounds` are None.&quot;</span>
<a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a>            <span class="p">)</span>
<a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">initial_bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a>            <span class="c1"># With a numeric dtype, if strict bounds are given but initial bounds are not given, then we assume</span>
<a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a>            <span class="c1"># that the strict bounds also serve as the initial bounds.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a>            <span class="c1"># Therefore, we take clones of the strict bounds and use this clones as the initial bounds.</span>
<a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a>            <span class="n">initial_bounds</span> <span class="o">=</span> <span class="n">clone</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a>            <span class="n">initbnd_tuple_name</span> <span class="o">=</span> <span class="s2">&quot;bounds&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a>        <span class="k">if</span> <span class="n">solution_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a>            <span class="c1"># With a numeric dtype, if solution length is missing, then we raise an error.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a>                <span class="sa">f</span><span class="s2">&quot;Together with a numeric dtype (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">}</span><span class="s2">),&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a>                <span class="sa">f</span><span class="s2">&quot; expected to receive `solution_length` as an integer.&quot;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a>                <span class="sa">f</span><span class="s2">&quot; However, `solution_length` is None.&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a>            <span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a>            <span class="c1"># With a numeric dtype, if a solution length is provided, we make sure that it is integer.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a>            <span class="n">solution_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">solution_length</span><span class="p">)</span>
<a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a>        <span class="c1"># Store the solution length</span>
<a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_solution_length</span> <span class="o">=</span> <span class="n">solution_length</span>
<a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a>        <span class="c1"># Below is an internal helper function for some common operations for the (strict) bounds</span>
<a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a>        <span class="c1"># and for the initial bounds.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a>        <span class="k">def</span> <span class="nf">process_bounds</span><span class="p">(</span><span class="n">bounds_tuple</span><span class="p">:</span> <span class="n">BoundsPairLike</span><span class="p">,</span> <span class="n">tuple_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BoundsPair</span><span class="p">:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a>            <span class="c1"># This function receives the bounds_tuple (a tuple containing lower and upper bounds),</span>
<a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a>            <span class="c1"># and the string name of the bounds argument (&quot;bounds&quot; or &quot;initial_bounds&quot;).</span>
<a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a>            <span class="c1"># What is returned is the bounds expressed as PyTorch tensors in the correct dtype and device.</span>
<a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a>            <span class="k">nonlocal</span> <span class="n">solution_length</span>
<a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a>            <span class="c1"># Extract the lower and upper bounds from the received bounds tuple.</span>
<a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a>            <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">bounds_tuple</span>
<a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a>            <span class="c1"># Make sure that the lower and upper bounds are expressed as tensors of correct dtype and device.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313" href="#__codelineno-0-313"></a>            <span class="n">lb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_tensor</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314" href="#__codelineno-0-314"></a>            <span class="n">ub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_tensor</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315" href="#__codelineno-0-315"></a>
<a id="__codelineno-0-316" name="__codelineno-0-316" href="#__codelineno-0-316"></a>            <span class="k">for</span> <span class="n">bound_array</span> <span class="ow">in</span> <span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">):</span>  <span class="c1"># For each boundary tensor (lb and ub)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317" href="#__codelineno-0-317"></a>                <span class="k">if</span> <span class="n">bound_array</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-318" name="__codelineno-0-318" href="#__codelineno-0-318"></a>                    <span class="c1"># If the boundary tensor is not as scalar and is not a 1-dimensional vector, then raise an</span>
<a id="__codelineno-0-319" name="__codelineno-0-319" href="#__codelineno-0-319"></a>                    <span class="c1"># error.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320" href="#__codelineno-0-320"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-321" name="__codelineno-0-321" href="#__codelineno-0-321"></a>                        <span class="sa">f</span><span class="s2">&quot;Lower and upper bounds are expected as scalars or as 1-dimensional vectors.&quot;</span>
<a id="__codelineno-0-322" name="__codelineno-0-322" href="#__codelineno-0-322"></a>                        <span class="sa">f</span><span class="s2">&quot; However, these given boundaries have incompatible shape:&quot;</span>
<a id="__codelineno-0-323" name="__codelineno-0-323" href="#__codelineno-0-323"></a>                        <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">bound_array</span><span class="si">}</span><span class="s2"> (of shape </span><span class="si">{</span><span class="n">bound_array</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-324" name="__codelineno-0-324" href="#__codelineno-0-324"></a>                    <span class="p">)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325" href="#__codelineno-0-325"></a>                <span class="k">if</span> <span class="n">bound_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326" href="#__codelineno-0-326"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bound_array</span><span class="p">)</span> <span class="o">!=</span> <span class="n">solution_length</span><span class="p">:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327" href="#__codelineno-0-327"></a>                        <span class="c1"># In the case where the boundary tensor is a 1-dimensional vector, if this vector&#39;s length</span>
<a id="__codelineno-0-328" name="__codelineno-0-328" href="#__codelineno-0-328"></a>                        <span class="c1"># is not equal to the solution length, then we raise an error.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329" href="#__codelineno-0-329"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-330" name="__codelineno-0-330" href="#__codelineno-0-330"></a>                            <span class="sa">f</span><span class="s2">&quot;When boundaries are expressed as 1-dimensional vectors, their length are&quot;</span>
<a id="__codelineno-0-331" name="__codelineno-0-331" href="#__codelineno-0-331"></a>                            <span class="sa">f</span><span class="s2">&quot; expected as the solution length of the Problem object.&quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332" href="#__codelineno-0-332"></a>                            <span class="sa">f</span><span class="s2">&quot; However, while the problem&#39;s solution length is </span><span class="si">{</span><span class="n">solution_length</span><span class="si">}</span><span class="s2">,&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333" href="#__codelineno-0-333"></a>                            <span class="sa">f</span><span class="s2">&quot; these given boundaries have incompatible length:&quot;</span>
<a id="__codelineno-0-334" name="__codelineno-0-334" href="#__codelineno-0-334"></a>                            <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">bound_array</span><span class="si">}</span><span class="s2"> (of length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bound_array</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335" href="#__codelineno-0-335"></a>                        <span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336" href="#__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337" href="#__codelineno-0-337"></a>            <span class="c1"># Return the processed forms of the lower and upper boundary tensors.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338" href="#__codelineno-0-338"></a>            <span class="k">return</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span>
<a id="__codelineno-0-339" name="__codelineno-0-339" href="#__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340" href="#__codelineno-0-340"></a>        <span class="c1"># Process the initial bounds with the help of the internal function `process_bounds(...)`</span>
<a id="__codelineno-0-341" name="__codelineno-0-341" href="#__codelineno-0-341"></a>        <span class="n">init_lb</span><span class="p">,</span> <span class="n">init_ub</span> <span class="o">=</span> <span class="n">process_bounds</span><span class="p">(</span><span class="n">initial_bounds</span><span class="p">,</span> <span class="n">initbnd_tuple_name</span><span class="p">)</span>
<a id="__codelineno-0-342" name="__codelineno-0-342" href="#__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343" href="#__codelineno-0-343"></a>        <span class="c1"># Store the processed initial bounds</span>
<a id="__codelineno-0-344" name="__codelineno-0-344" href="#__codelineno-0-344"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_lower_bounds</span> <span class="o">=</span> <span class="n">init_lb</span>
<a id="__codelineno-0-345" name="__codelineno-0-345" href="#__codelineno-0-345"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_upper_bounds</span> <span class="o">=</span> <span class="n">init_ub</span>
<a id="__codelineno-0-346" name="__codelineno-0-346" href="#__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347" href="#__codelineno-0-347"></a>        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348" href="#__codelineno-0-348"></a>            <span class="c1"># If there are strict bounds, then process those bounds with the help of `process_bounds(...)`.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349" href="#__codelineno-0-349"></a>            <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">process_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">bnd_tuple_name</span><span class="p">)</span>
<a id="__codelineno-0-350" name="__codelineno-0-350" href="#__codelineno-0-350"></a>            <span class="c1"># Store the processed bounds</span>
<a id="__codelineno-0-351" name="__codelineno-0-351" href="#__codelineno-0-351"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lower_bounds</span> <span class="o">=</span> <span class="n">lb</span>
<a id="__codelineno-0-352" name="__codelineno-0-352" href="#__codelineno-0-352"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_upper_bounds</span> <span class="o">=</span> <span class="n">ub</span>
<a id="__codelineno-0-353" name="__codelineno-0-353" href="#__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354" href="#__codelineno-0-354"></a>    <span class="c1"># Annotate the variable that will store the objective sense(s) of the problem</span>
<a id="__codelineno-0-355" name="__codelineno-0-355" href="#__codelineno-0-355"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_objective_sense</span><span class="p">:</span> <span class="n">ObjectiveSense</span>
<a id="__codelineno-0-356" name="__codelineno-0-356" href="#__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357" href="#__codelineno-0-357"></a>    <span class="c1"># Below is an internal function which makes sure that a provided objective sense has a valid value</span>
<a id="__codelineno-0-358" name="__codelineno-0-358" href="#__codelineno-0-358"></a>    <span class="c1"># (where valid values are &quot;min&quot; or &quot;max&quot;)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359" href="#__codelineno-0-359"></a>    <span class="k">def</span> <span class="nf">validate_sense</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-360" name="__codelineno-0-360" href="#__codelineno-0-360"></a>        <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">):</span>
<a id="__codelineno-0-361" name="__codelineno-0-361" href="#__codelineno-0-361"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-362" name="__codelineno-0-362" href="#__codelineno-0-362"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid objective sense: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-363" name="__codelineno-0-363" href="#__codelineno-0-363"></a>                <span class="sa">f</span><span class="s2">&quot;Instead, please provide the objective sense as &#39;min&#39; or &#39;max&#39;.&quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364" href="#__codelineno-0-364"></a>            <span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365" href="#__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366" href="#__codelineno-0-366"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">):</span>
<a id="__codelineno-0-367" name="__codelineno-0-367" href="#__codelineno-0-367"></a>        <span class="c1"># If the provided objective sense is not a sequence, then convert it to a single-element list</span>
<a id="__codelineno-0-368" name="__codelineno-0-368" href="#__codelineno-0-368"></a>        <span class="n">senses</span> <span class="o">=</span> <span class="p">[</span><span class="n">objective_sense</span><span class="p">]</span>
<a id="__codelineno-0-369" name="__codelineno-0-369" href="#__codelineno-0-369"></a>        <span class="n">num_senses</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-370" name="__codelineno-0-370" href="#__codelineno-0-370"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371" href="#__codelineno-0-371"></a>        <span class="c1"># If the provided objective sense is a sequence, then take a list copy of it</span>
<a id="__codelineno-0-372" name="__codelineno-0-372" href="#__codelineno-0-372"></a>        <span class="n">senses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span>
<a id="__codelineno-0-373" name="__codelineno-0-373" href="#__codelineno-0-373"></a>        <span class="n">num_senses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374" href="#__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375" href="#__codelineno-0-375"></a>        <span class="c1"># Ensure that each provided objective sense is valid</span>
<a id="__codelineno-0-376" name="__codelineno-0-376" href="#__codelineno-0-376"></a>        <span class="k">for</span> <span class="n">sense</span> <span class="ow">in</span> <span class="n">senses</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377" href="#__codelineno-0-377"></a>            <span class="n">validate_sense</span><span class="p">(</span><span class="n">sense</span><span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378" href="#__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379" href="#__codelineno-0-379"></a>        <span class="k">if</span> <span class="n">num_senses</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380" href="#__codelineno-0-380"></a>            <span class="c1"># If the given sequence of objective senses is empty, then we raise an error.</span>
<a id="__codelineno-0-381" name="__codelineno-0-381" href="#__codelineno-0-381"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-382" name="__codelineno-0-382" href="#__codelineno-0-382"></a>                <span class="s2">&quot;Encountered an empty sequence via `objective_sense`.&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383" href="#__codelineno-0-383"></a>                <span class="s2">&quot; For a single-objective problem, please set `objective_sense` as &#39;min&#39; or &#39;max&#39;.&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384" href="#__codelineno-0-384"></a>                <span class="s2">&quot; For a multi-objective problem, please set `objective_sense` as a sequence,&quot;</span>
<a id="__codelineno-0-385" name="__codelineno-0-385" href="#__codelineno-0-385"></a>                <span class="s2">&quot; each element being &#39;min&#39; or &#39;max&#39;.&quot;</span>
<a id="__codelineno-0-386" name="__codelineno-0-386" href="#__codelineno-0-386"></a>            <span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387" href="#__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388" href="#__codelineno-0-388"></a>    <span class="c1"># Store the objective senses</span>
<a id="__codelineno-0-389" name="__codelineno-0-389" href="#__codelineno-0-389"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_senses</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">senses</span>
<a id="__codelineno-0-390" name="__codelineno-0-390" href="#__codelineno-0-390"></a>
<a id="__codelineno-0-391" name="__codelineno-0-391" href="#__codelineno-0-391"></a>    <span class="c1"># Store the provided objective function (which can be None)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392" href="#__codelineno-0-392"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_objective_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="n">objective_func</span>
<a id="__codelineno-0-393" name="__codelineno-0-393" href="#__codelineno-0-393"></a>
<a id="__codelineno-0-394" name="__codelineno-0-394" href="#__codelineno-0-394"></a>    <span class="c1"># Store the information which indicates whether or not the given objective function is vectorized</span>
<a id="__codelineno-0-395" name="__codelineno-0-395" href="#__codelineno-0-395"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_vectorized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">vectorized</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396" href="#__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397" href="#__codelineno-0-397"></a>    <span class="c1"># If the evaluation data length is explicitly stated, then convert it to an integer and store it.</span>
<a id="__codelineno-0-398" name="__codelineno-0-398" href="#__codelineno-0-398"></a>    <span class="c1"># Otherwise, store the evaluation data length as 0.</span>
<a id="__codelineno-0-399" name="__codelineno-0-399" href="#__codelineno-0-399"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_eval_data_length</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">eval_data_length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">eval_data_length</span><span class="p">)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400" href="#__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401" href="#__codelineno-0-401"></a>    <span class="c1"># Initialize the actor index.</span>
<a id="__codelineno-0-402" name="__codelineno-0-402" href="#__codelineno-0-402"></a>    <span class="c1"># If the problem is configured to be parallelized and the parallelization is triggered, then each remote</span>
<a id="__codelineno-0-403" name="__codelineno-0-403" href="#__codelineno-0-403"></a>    <span class="c1"># copy will have a different integer value for `_actor_index`.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404" href="#__codelineno-0-404"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_actor_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-405" name="__codelineno-0-405" href="#__codelineno-0-405"></a>
<a id="__codelineno-0-406" name="__codelineno-0-406" href="#__codelineno-0-406"></a>    <span class="c1"># Initialize the variable that might store the list of actors as None.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407" href="#__codelineno-0-407"></a>    <span class="c1"># If the problem is configured to be parallelized and the parallelization is triggered, then this variable</span>
<a id="__codelineno-0-408" name="__codelineno-0-408" href="#__codelineno-0-408"></a>    <span class="c1"># will store references to the remote actors (each remote actor storing its own copy of this Problem</span>
<a id="__codelineno-0-409" name="__codelineno-0-409" href="#__codelineno-0-409"></a>    <span class="c1"># instance).</span>
<a id="__codelineno-0-410" name="__codelineno-0-410" href="#__codelineno-0-410"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-411" name="__codelineno-0-411" href="#__codelineno-0-411"></a>
<a id="__codelineno-0-412" name="__codelineno-0-412" href="#__codelineno-0-412"></a>    <span class="c1"># Initialize the variable that might store the ray ActorPool.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413" href="#__codelineno-0-413"></a>    <span class="c1"># If the problem is configured to be parallelized and the parallelization is triggered, then this variable</span>
<a id="__codelineno-0-414" name="__codelineno-0-414" href="#__codelineno-0-414"></a>    <span class="c1"># will store the ray ActorPool that is generated out of the remote actors.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415" href="#__codelineno-0-415"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_actor_pool</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ActorPool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-416" name="__codelineno-0-416" href="#__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417" href="#__codelineno-0-417"></a>    <span class="c1"># Store the ray actor configuration dictionary provided by the user (if any).</span>
<a id="__codelineno-0-418" name="__codelineno-0-418" href="#__codelineno-0-418"></a>    <span class="c1"># When (or if) the parallelization is triggered, each actor will be created with this given configuration.</span>
<a id="__codelineno-0-419" name="__codelineno-0-419" href="#__codelineno-0-419"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_actor_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">actor_config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">deepcopy</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">actor_config</span><span class="p">))</span>
<a id="__codelineno-0-420" name="__codelineno-0-420" href="#__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421" href="#__codelineno-0-421"></a>    <span class="c1"># If given, store the sub-batch size or number of sub-batches.</span>
<a id="__codelineno-0-422" name="__codelineno-0-422" href="#__codelineno-0-422"></a>    <span class="c1"># When the problem is parallelized, a sub-batch size determines the maximum size for a SolutionBatch</span>
<a id="__codelineno-0-423" name="__codelineno-0-423" href="#__codelineno-0-423"></a>    <span class="c1"># that will be sent to a remote actor for parallel solution evaluation.</span>
<a id="__codelineno-0-424" name="__codelineno-0-424" href="#__codelineno-0-424"></a>    <span class="c1"># Alternatively, num_subbatches determines into how many pieces will a SolutionBatch be split</span>
<a id="__codelineno-0-425" name="__codelineno-0-425" href="#__codelineno-0-425"></a>    <span class="c1"># for parallelization.</span>
<a id="__codelineno-0-426" name="__codelineno-0-426" href="#__codelineno-0-426"></a>    <span class="c1"># If both are None, then the main SolutionBatch will be split among the actors.</span>
<a id="__codelineno-0-427" name="__codelineno-0-427" href="#__codelineno-0-427"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_subbatches</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">subbatch_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-428" name="__codelineno-0-428" href="#__codelineno-0-428"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-429" name="__codelineno-0-429" href="#__codelineno-0-429"></a>            <span class="sa">f</span><span class="s2">&quot;Encountered both `num_subbatches` and `subbatch_size` as values other than None.&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430" href="#__codelineno-0-430"></a>            <span class="sa">f</span><span class="s2">&quot; num_subbatches=</span><span class="si">{</span><span class="n">num_subbatches</span><span class="si">}</span><span class="s2">, subbatch_size=</span><span class="si">{</span><span class="n">subbatch_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-431" name="__codelineno-0-431" href="#__codelineno-0-431"></a>            <span class="sa">f</span><span class="s2">&quot; Having both of them as values other than None cannot be accepted.&quot;</span>
<a id="__codelineno-0-432" name="__codelineno-0-432" href="#__codelineno-0-432"></a>        <span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433" href="#__codelineno-0-433"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_num_subbatches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">num_subbatches</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_subbatches</span><span class="p">)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434" href="#__codelineno-0-434"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">subbatch_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">subbatch_size</span><span class="p">)</span>
<a id="__codelineno-0-435" name="__codelineno-0-435" href="#__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436" href="#__codelineno-0-436"></a>    <span class="c1"># Initialize the additional states to be loaded by the remote actor as None.</span>
<a id="__codelineno-0-437" name="__codelineno-0-437" href="#__codelineno-0-437"></a>    <span class="c1"># If there are such additional states for remote actors, the inheriting class can fill this as a list</span>
<a id="__codelineno-0-438" name="__codelineno-0-438" href="#__codelineno-0-438"></a>    <span class="c1"># of dictionaries.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439" href="#__codelineno-0-439"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_remote_states</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-440" name="__codelineno-0-440" href="#__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441" href="#__codelineno-0-441"></a>    <span class="c1"># Initialize a temporary internal variable which stores the resources available in the ray cluster.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442" href="#__codelineno-0-442"></a>    <span class="c1"># Most probably, we are interested in the resources &quot;CPU&quot; and &quot;GPU&quot;.</span>
<a id="__codelineno-0-443" name="__codelineno-0-443" href="#__codelineno-0-443"></a>    <span class="n">ray_resources</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-444" name="__codelineno-0-444" href="#__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445" href="#__codelineno-0-445"></a>    <span class="c1"># The following is an internal helper function which returns the amount of availability for a given</span>
<a id="__codelineno-0-446" name="__codelineno-0-446" href="#__codelineno-0-446"></a>    <span class="c1"># resource in the ray cluster.</span>
<a id="__codelineno-0-447" name="__codelineno-0-447" href="#__codelineno-0-447"></a>    <span class="c1"># If the requested resource is not available at all, None will be returned.</span>
<a id="__codelineno-0-448" name="__codelineno-0-448" href="#__codelineno-0-448"></a>    <span class="k">def</span> <span class="nf">get_ray_resource</span><span class="p">(</span><span class="n">resource_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449" href="#__codelineno-0-449"></a>        <span class="c1"># Ensure that the ray cluster is initialized</span>
<a id="__codelineno-0-450" name="__codelineno-0-450" href="#__codelineno-0-450"></a>        <span class="n">ensure_ray</span><span class="p">()</span>
<a id="__codelineno-0-451" name="__codelineno-0-451" href="#__codelineno-0-451"></a>        <span class="k">nonlocal</span> <span class="n">ray_resources</span>
<a id="__codelineno-0-452" name="__codelineno-0-452" href="#__codelineno-0-452"></a>        <span class="k">if</span> <span class="n">ray_resources</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453" href="#__codelineno-0-453"></a>            <span class="c1"># If the ray resource information was not fetched, then fetch them and store them.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454" href="#__codelineno-0-454"></a>            <span class="n">ray_resources</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">available_resources</span><span class="p">()</span>
<a id="__codelineno-0-455" name="__codelineno-0-455" href="#__codelineno-0-455"></a>        <span class="c1"># Return the information regarding the requested resource from the fetched resource information.</span>
<a id="__codelineno-0-456" name="__codelineno-0-456" href="#__codelineno-0-456"></a>        <span class="c1"># If it turns out that the requested resource is not available at all, the result will be None.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457" href="#__codelineno-0-457"></a>        <span class="k">return</span> <span class="n">ray_resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">resource_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458" href="#__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459" href="#__codelineno-0-459"></a>    <span class="c1"># Annotate the variable that will store the number of actors (to be created when the parallelization</span>
<a id="__codelineno-0-460" name="__codelineno-0-460" href="#__codelineno-0-460"></a>    <span class="c1"># is triggered).</span>
<a id="__codelineno-0-461" name="__codelineno-0-461" href="#__codelineno-0-461"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-462" name="__codelineno-0-462" href="#__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463" href="#__codelineno-0-463"></a>    <span class="k">if</span> <span class="n">num_actors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464" href="#__codelineno-0-464"></a>        <span class="c1"># If the argument `num_actors` is left as None, then we set `_num_actors` as 0, which means that</span>
<a id="__codelineno-0-465" name="__codelineno-0-465" href="#__codelineno-0-465"></a>        <span class="c1"># there will be no parallelization.</span>
<a id="__codelineno-0-466" name="__codelineno-0-466" href="#__codelineno-0-466"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-467" name="__codelineno-0-467" href="#__codelineno-0-467"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_actors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-468" name="__codelineno-0-468" href="#__codelineno-0-468"></a>        <span class="c1"># This is the case where `num_actors` has a string value</span>
<a id="__codelineno-0-469" name="__codelineno-0-469" href="#__codelineno-0-469"></a>        <span class="k">if</span> <span class="n">num_actors</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;num_cpus&quot;</span><span class="p">):</span>
<a id="__codelineno-0-470" name="__codelineno-0-470" href="#__codelineno-0-470"></a>            <span class="c1"># If the `num_actors` argument was given as &quot;max&quot; or as &quot;num_cpus&quot;, then we first read how many CPUs</span>
<a id="__codelineno-0-471" name="__codelineno-0-471" href="#__codelineno-0-471"></a>            <span class="c1"># are available in the ray cluster, then convert it to integer (via computing its ceil value), and</span>
<a id="__codelineno-0-472" name="__codelineno-0-472" href="#__codelineno-0-472"></a>            <span class="c1"># finally set `_num_actors` as this integer.</span>
<a id="__codelineno-0-473" name="__codelineno-0-473" href="#__codelineno-0-473"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">get_ray_resource</span><span class="p">(</span><span class="s2">&quot;CPU&quot;</span><span class="p">))</span>
<a id="__codelineno-0-474" name="__codelineno-0-474" href="#__codelineno-0-474"></a>        <span class="k">elif</span> <span class="n">num_actors</span> <span class="o">==</span> <span class="s2">&quot;num_gpus&quot;</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475" href="#__codelineno-0-475"></a>            <span class="c1"># If the `num_actors` argument was given as &quot;num_gpus&quot;, then we first read how many GPUs are</span>
<a id="__codelineno-0-476" name="__codelineno-0-476" href="#__codelineno-0-476"></a>            <span class="c1"># available in the ray cluster.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477" href="#__codelineno-0-477"></a>            <span class="n">num_gpus</span> <span class="o">=</span> <span class="n">get_ray_resource</span><span class="p">(</span><span class="s2">&quot;GPU&quot;</span><span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478" href="#__codelineno-0-478"></a>            <span class="k">if</span> <span class="n">num_gpus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479" href="#__codelineno-0-479"></a>                <span class="c1"># If there are no GPUs at all, then we raise an error</span>
<a id="__codelineno-0-480" name="__codelineno-0-480" href="#__codelineno-0-480"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-481" name="__codelineno-0-481" href="#__codelineno-0-481"></a>                    <span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_gpus&#39;.&quot;</span>
<a id="__codelineno-0-482" name="__codelineno-0-482" href="#__codelineno-0-482"></a>                    <span class="s2">&quot; However, there does not seem to be any GPU available.&quot;</span>
<a id="__codelineno-0-483" name="__codelineno-0-483" href="#__codelineno-0-483"></a>                <span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484" href="#__codelineno-0-484"></a>            <span class="k">if</span> <span class="n">num_gpus</span> <span class="o">&lt;</span> <span class="mf">1e-4</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485" href="#__codelineno-0-485"></a>                <span class="c1"># If the number of available GPUs are 0 or close to 0, then we raise an error</span>
<a id="__codelineno-0-486" name="__codelineno-0-486" href="#__codelineno-0-486"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-487" name="__codelineno-0-487" href="#__codelineno-0-487"></a>                    <span class="sa">f</span><span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_gpus&#39;.&quot;</span>
<a id="__codelineno-0-488" name="__codelineno-0-488" href="#__codelineno-0-488"></a>                    <span class="sa">f</span><span class="s2">&quot; However, the number of available GPUs are either 0 or close to 0 (= </span><span class="si">{</span><span class="n">num_gpus</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-489" name="__codelineno-0-489" href="#__codelineno-0-489"></a>                <span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490" href="#__codelineno-0-490"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">actor_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;num_gpus&quot;</span> <span class="ow">in</span> <span class="n">actor_config</span><span class="p">):</span>
<a id="__codelineno-0-491" name="__codelineno-0-491" href="#__codelineno-0-491"></a>                <span class="c1"># With `num_actors` argument given as &quot;num_gpus&quot;, we will also allocate each GPU to an actor.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492" href="#__codelineno-0-492"></a>                <span class="c1"># If `actor_config` contains an item with key &quot;num_gpus&quot;, then that configuration item would</span>
<a id="__codelineno-0-493" name="__codelineno-0-493" href="#__codelineno-0-493"></a>                <span class="c1"># conflict with the GPU allocation we are about to do here.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494" href="#__codelineno-0-494"></a>                <span class="c1"># So, we raise an error.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495" href="#__codelineno-0-495"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-496" name="__codelineno-0-496" href="#__codelineno-0-496"></a>                    <span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_gpus&#39;.&quot;</span>
<a id="__codelineno-0-497" name="__codelineno-0-497" href="#__codelineno-0-497"></a>                    <span class="s2">&quot; With this configuration, the number of GPUs assigned to an actor is automatically determined.&quot;</span>
<a id="__codelineno-0-498" name="__codelineno-0-498" href="#__codelineno-0-498"></a>                    <span class="s2">&quot; However, at the same time, the `actor_config` argument was received with the key &#39;num_gpus&#39;,&quot;</span>
<a id="__codelineno-0-499" name="__codelineno-0-499" href="#__codelineno-0-499"></a>                    <span class="s2">&quot; which causes a conflict.&quot;</span>
<a id="__codelineno-0-500" name="__codelineno-0-500" href="#__codelineno-0-500"></a>                <span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501" href="#__codelineno-0-501"></a>            <span class="k">if</span> <span class="n">num_gpus_per_actor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502" href="#__codelineno-0-502"></a>                <span class="c1"># With `num_actors` argument given as &quot;num_gpus&quot;, we will also allocate each GPU to an actor.</span>
<a id="__codelineno-0-503" name="__codelineno-0-503" href="#__codelineno-0-503"></a>                <span class="c1"># If the argument `num_gpus_per_actor` is also stated, then such a configuration item would</span>
<a id="__codelineno-0-504" name="__codelineno-0-504" href="#__codelineno-0-504"></a>                <span class="c1"># conflict with the GPU allocation we are about to do here.</span>
<a id="__codelineno-0-505" name="__codelineno-0-505" href="#__codelineno-0-505"></a>                <span class="c1"># So, we raise an error.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506" href="#__codelineno-0-506"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-507" name="__codelineno-0-507" href="#__codelineno-0-507"></a>                    <span class="sa">f</span><span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_gpus&#39;.&quot;</span>
<a id="__codelineno-0-508" name="__codelineno-0-508" href="#__codelineno-0-508"></a>                    <span class="sa">f</span><span class="s2">&quot; With this configuration, the number of GPUs assigned to an actor is automatically determined.&quot;</span>
<a id="__codelineno-0-509" name="__codelineno-0-509" href="#__codelineno-0-509"></a>                    <span class="sa">f</span><span class="s2">&quot; However, at the same time, the `num_gpus_per_actor` argument was received with a value other&quot;</span>
<a id="__codelineno-0-510" name="__codelineno-0-510" href="#__codelineno-0-510"></a>                    <span class="sa">f</span><span class="s2">&quot; than None (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">)</span><span class="si">}</span><span class="s2">), which causes a conflict.&quot;</span>
<a id="__codelineno-0-511" name="__codelineno-0-511" href="#__codelineno-0-511"></a>                <span class="p">)</span>
<a id="__codelineno-0-512" name="__codelineno-0-512" href="#__codelineno-0-512"></a>            <span class="c1"># Set the number of actors as the ceiled integer counterpart of the number of available GPUs</span>
<a id="__codelineno-0-513" name="__codelineno-0-513" href="#__codelineno-0-513"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_gpus</span><span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514" href="#__codelineno-0-514"></a>            <span class="c1"># We assign a GPU for each actor (by overriding the value for the argument `num_gpus_per_actor`).</span>
<a id="__codelineno-0-515" name="__codelineno-0-515" href="#__codelineno-0-515"></a>            <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="n">num_gpus</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span>
<a id="__codelineno-0-516" name="__codelineno-0-516" href="#__codelineno-0-516"></a>        <span class="k">elif</span> <span class="n">num_actors</span> <span class="o">==</span> <span class="s2">&quot;num_devices&quot;</span><span class="p">:</span>
<a id="__codelineno-0-517" name="__codelineno-0-517" href="#__codelineno-0-517"></a>            <span class="c1"># This is the case where `num_actors` has the string value &quot;num_devices&quot;.</span>
<a id="__codelineno-0-518" name="__codelineno-0-518" href="#__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519" href="#__codelineno-0-519"></a>            <span class="c1"># With `num_actors` set as &quot;num_devices&quot;, if there are any GPUs, the behavior is to assign a GPU</span>
<a id="__codelineno-0-520" name="__codelineno-0-520" href="#__codelineno-0-520"></a>            <span class="c1"># to each actor. If there are conflicting configurations regarding how many GPUs are to be assigned</span>
<a id="__codelineno-0-521" name="__codelineno-0-521" href="#__codelineno-0-521"></a>            <span class="c1"># to each actor, then we raise an error.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522" href="#__codelineno-0-522"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">actor_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;num_gpus&quot;</span> <span class="ow">in</span> <span class="n">actor_config</span><span class="p">):</span>
<a id="__codelineno-0-523" name="__codelineno-0-523" href="#__codelineno-0-523"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-524" name="__codelineno-0-524" href="#__codelineno-0-524"></a>                    <span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_devices&#39;.&quot;</span>
<a id="__codelineno-0-525" name="__codelineno-0-525" href="#__codelineno-0-525"></a>                    <span class="s2">&quot; With this configuration, the number of GPUs assigned to an actor is automatically determined.&quot;</span>
<a id="__codelineno-0-526" name="__codelineno-0-526" href="#__codelineno-0-526"></a>                    <span class="s2">&quot; However, at the same time, the `actor_config` argument was received with the key &#39;num_gpus&#39;,&quot;</span>
<a id="__codelineno-0-527" name="__codelineno-0-527" href="#__codelineno-0-527"></a>                    <span class="s2">&quot; which causes a conflict.&quot;</span>
<a id="__codelineno-0-528" name="__codelineno-0-528" href="#__codelineno-0-528"></a>                <span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529" href="#__codelineno-0-529"></a>            <span class="k">if</span> <span class="n">num_gpus_per_actor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-530" name="__codelineno-0-530" href="#__codelineno-0-530"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-531" name="__codelineno-0-531" href="#__codelineno-0-531"></a>                    <span class="sa">f</span><span class="s2">&quot;The argument `num_actors` was encountered as &#39;num_devices&#39;.&quot;</span>
<a id="__codelineno-0-532" name="__codelineno-0-532" href="#__codelineno-0-532"></a>                    <span class="sa">f</span><span class="s2">&quot; With this configuration, the number of GPUs assigned to an actor is automatically determined.&quot;</span>
<a id="__codelineno-0-533" name="__codelineno-0-533" href="#__codelineno-0-533"></a>                    <span class="sa">f</span><span class="s2">&quot; However, at the same time, the `num_gpus_per_actor` argument was received with a value other&quot;</span>
<a id="__codelineno-0-534" name="__codelineno-0-534" href="#__codelineno-0-534"></a>                    <span class="sa">f</span><span class="s2">&quot; than None (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">)</span><span class="si">}</span><span class="s2">), which causes a conflict.&quot;</span>
<a id="__codelineno-0-535" name="__codelineno-0-535" href="#__codelineno-0-535"></a>                <span class="p">)</span>
<a id="__codelineno-0-536" name="__codelineno-0-536" href="#__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537" href="#__codelineno-0-537"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_device</span> <span class="o">!=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">):</span>
<a id="__codelineno-0-538" name="__codelineno-0-538" href="#__codelineno-0-538"></a>                <span class="c1"># If the main device is not CPU, then the user most probably wishes to put all the</span>
<a id="__codelineno-0-539" name="__codelineno-0-539" href="#__codelineno-0-539"></a>                <span class="c1"># computations (both evaluations and the population) on the GPU, without allocating</span>
<a id="__codelineno-0-540" name="__codelineno-0-540" href="#__codelineno-0-540"></a>                <span class="c1"># any actor.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541" href="#__codelineno-0-541"></a>                <span class="c1"># So, we set `_num_actors` as None, and overwrite `num_gpus_per_actor` with None.</span>
<a id="__codelineno-0-542" name="__codelineno-0-542" href="#__codelineno-0-542"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-543" name="__codelineno-0-543" href="#__codelineno-0-543"></a>                <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-544" name="__codelineno-0-544" href="#__codelineno-0-544"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-545" name="__codelineno-0-545" href="#__codelineno-0-545"></a>                <span class="c1"># If the device argument is &quot;cpu&quot; or left as None, then we assume that actor allocations</span>
<a id="__codelineno-0-546" name="__codelineno-0-546" href="#__codelineno-0-546"></a>                <span class="c1"># might be desired.</span>
<a id="__codelineno-0-547" name="__codelineno-0-547" href="#__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548" href="#__codelineno-0-548"></a>                <span class="c1"># Read how many CPUs and GPUs are available in the ray cluster.</span>
<a id="__codelineno-0-549" name="__codelineno-0-549" href="#__codelineno-0-549"></a>                <span class="n">num_cpus</span> <span class="o">=</span> <span class="n">get_ray_resource</span><span class="p">(</span><span class="s2">&quot;CPU&quot;</span><span class="p">)</span>
<a id="__codelineno-0-550" name="__codelineno-0-550" href="#__codelineno-0-550"></a>                <span class="n">num_gpus</span> <span class="o">=</span> <span class="n">get_ray_resource</span><span class="p">(</span><span class="s2">&quot;GPU&quot;</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551" href="#__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552" href="#__codelineno-0-552"></a>                <span class="c1"># If we have multiple CPUs, then we continue with the actor allocation procedures.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553" href="#__codelineno-0-553"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">num_gpus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num_gpus</span> <span class="o">&lt;</span> <span class="mf">1e-4</span><span class="p">):</span>
<a id="__codelineno-0-554" name="__codelineno-0-554" href="#__codelineno-0-554"></a>                    <span class="c1"># If there are no GPUs, then we set the number of actors as the number of CPUs, and we</span>
<a id="__codelineno-0-555" name="__codelineno-0-555" href="#__codelineno-0-555"></a>                    <span class="c1"># set the number of GPUs per actor as None (which means that there will be no GPU</span>
<a id="__codelineno-0-556" name="__codelineno-0-556" href="#__codelineno-0-556"></a>                    <span class="c1"># assignment)</span>
<a id="__codelineno-0-557" name="__codelineno-0-557" href="#__codelineno-0-557"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_cpus</span><span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558" href="#__codelineno-0-558"></a>                    <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-559" name="__codelineno-0-559" href="#__codelineno-0-559"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-560" name="__codelineno-0-560" href="#__codelineno-0-560"></a>                    <span class="c1"># If there are GPUs available, then we compute the minimum among the number of CPUs and</span>
<a id="__codelineno-0-561" name="__codelineno-0-561" href="#__codelineno-0-561"></a>                    <span class="c1"># GPUs, and this minimum value becomes the number of actors (so that there can be</span>
<a id="__codelineno-0-562" name="__codelineno-0-562" href="#__codelineno-0-562"></a>                    <span class="c1"># one-to-one mapping between actors and GPUs).</span>
<a id="__codelineno-0-563" name="__codelineno-0-563" href="#__codelineno-0-563"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">num_cpus</span><span class="p">,</span> <span class="n">num_gpus</span><span class="p">))</span>
<a id="__codelineno-0-564" name="__codelineno-0-564" href="#__codelineno-0-564"></a>
<a id="__codelineno-0-565" name="__codelineno-0-565" href="#__codelineno-0-565"></a>                    <span class="c1"># We assign a GPU for each actor (by overriding the value for the argument</span>
<a id="__codelineno-0-566" name="__codelineno-0-566" href="#__codelineno-0-566"></a>                    <span class="c1"># `num_gpus_per_actor`).</span>
<a id="__codelineno-0-567" name="__codelineno-0-567" href="#__codelineno-0-567"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">&lt;=</span> <span class="n">num_gpus</span><span class="p">:</span>
<a id="__codelineno-0-568" name="__codelineno-0-568" href="#__codelineno-0-568"></a>                        <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-569" name="__codelineno-0-569" href="#__codelineno-0-569"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570" href="#__codelineno-0-570"></a>                        <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="n">num_gpus</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span>
<a id="__codelineno-0-571" name="__codelineno-0-571" href="#__codelineno-0-571"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572" href="#__codelineno-0-572"></a>            <span class="c1"># This is the case where `num_actors` is given as an unexpected string. We raise an error here.</span>
<a id="__codelineno-0-573" name="__codelineno-0-573" href="#__codelineno-0-573"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-574" name="__codelineno-0-574" href="#__codelineno-0-574"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid string value for `num_actors`: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">num_actors</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575" href="#__codelineno-0-575"></a>                <span class="sa">f</span><span class="s2">&quot; The acceptable string values for `num_actors` are &#39;max&#39;, &#39;num_cpus&#39;, &#39;num_gpus&#39;, &#39;num_devices&#39;.&quot;</span>
<a id="__codelineno-0-576" name="__codelineno-0-576" href="#__codelineno-0-576"></a>            <span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577" href="#__codelineno-0-577"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-578" name="__codelineno-0-578" href="#__codelineno-0-578"></a>        <span class="c1"># This is the case where `num_actors` has a value which is not a string.</span>
<a id="__codelineno-0-579" name="__codelineno-0-579" href="#__codelineno-0-579"></a>        <span class="c1"># In this case, we make sure that the given value is an integer, and then use this integer as our</span>
<a id="__codelineno-0-580" name="__codelineno-0-580" href="#__codelineno-0-580"></a>        <span class="c1"># number of actors.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581" href="#__codelineno-0-581"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_actors</span><span class="p">)</span>
<a id="__codelineno-0-582" name="__codelineno-0-582" href="#__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583" href="#__codelineno-0-583"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-584" name="__codelineno-0-584" href="#__codelineno-0-584"></a>        <span class="c1"># Creating a single actor does not bring any benefit of parallelization.</span>
<a id="__codelineno-0-585" name="__codelineno-0-585" href="#__codelineno-0-585"></a>        <span class="c1"># Therefore, at the end of all the computations above regarding the number of actors, if it turns out</span>
<a id="__codelineno-0-586" name="__codelineno-0-586" href="#__codelineno-0-586"></a>        <span class="c1"># that the target number of actors is 1, we reduce it to 0 (meaning that no actor will be initialized).</span>
<a id="__codelineno-0-587" name="__codelineno-0-587" href="#__codelineno-0-587"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-588" name="__codelineno-0-588" href="#__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589" href="#__codelineno-0-589"></a>        <span class="c1"># Since we are to allocate no actor, the value of the argument `num_gpus_per_actor` is meaningless.</span>
<a id="__codelineno-0-590" name="__codelineno-0-590" href="#__codelineno-0-590"></a>        <span class="c1"># We therefore overwrite the value of that argument with None.</span>
<a id="__codelineno-0-591" name="__codelineno-0-591" href="#__codelineno-0-591"></a>        <span class="n">num_gpus_per_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-592" name="__codelineno-0-592" href="#__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593" href="#__codelineno-0-593"></a>    <span class="c1"># Annotate the variable which will determine how many GPUs are to be assigned to each actor.</span>
<a id="__codelineno-0-594" name="__codelineno-0-594" href="#__codelineno-0-594"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
<a id="__codelineno-0-595" name="__codelineno-0-595" href="#__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596" href="#__codelineno-0-596"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">actor_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;num_gpus&quot;</span> <span class="ow">in</span> <span class="n">actor_config</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">num_gpus_per_actor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-597" name="__codelineno-0-597" href="#__codelineno-0-597"></a>        <span class="c1"># If `actor_config` dictionary has the item &quot;num_gpus&quot; and also `num_gpus_per_actor` is not None,</span>
<a id="__codelineno-0-598" name="__codelineno-0-598" href="#__codelineno-0-598"></a>        <span class="c1"># then there is a conflicting (or redundant) configuration. We raise an error here.</span>
<a id="__codelineno-0-599" name="__codelineno-0-599" href="#__codelineno-0-599"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-600" name="__codelineno-0-600" href="#__codelineno-0-600"></a>            <span class="s1">&#39;The `actor_config` dictionary contains the key &quot;num_gpus&quot;.&#39;</span>
<a id="__codelineno-0-601" name="__codelineno-0-601" href="#__codelineno-0-601"></a>            <span class="s2">&quot; At the same time, `num_gpus_per_actor` has a value other than None.&quot;</span>
<a id="__codelineno-0-602" name="__codelineno-0-602" href="#__codelineno-0-602"></a>            <span class="s2">&quot; These two configurations are conflicting.&quot;</span>
<a id="__codelineno-0-603" name="__codelineno-0-603" href="#__codelineno-0-603"></a>            <span class="s2">&quot; Please specify the number of GPUs per actor either via the `actor_config` dictionary,&quot;</span>
<a id="__codelineno-0-604" name="__codelineno-0-604" href="#__codelineno-0-604"></a>            <span class="s2">&quot; or via the `num_gpus_per_actor` argument, but not via both.&quot;</span>
<a id="__codelineno-0-605" name="__codelineno-0-605" href="#__codelineno-0-605"></a>        <span class="p">)</span>
<a id="__codelineno-0-606" name="__codelineno-0-606" href="#__codelineno-0-606"></a>
<a id="__codelineno-0-607" name="__codelineno-0-607" href="#__codelineno-0-607"></a>    <span class="k">if</span> <span class="n">num_gpus_per_actor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-608" name="__codelineno-0-608" href="#__codelineno-0-608"></a>        <span class="c1"># If the argument `num_gpus_per_actor` is not specified, then we set the attribute</span>
<a id="__codelineno-0-609" name="__codelineno-0-609" href="#__codelineno-0-609"></a>        <span class="c1"># `_num_gpus_per_actor` as None, which means that no GPUs will be assigned to the actors.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610" href="#__codelineno-0-610"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-611" name="__codelineno-0-611" href="#__codelineno-0-611"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-612" name="__codelineno-0-612" href="#__codelineno-0-612"></a>        <span class="c1"># This is the case where `num_gpus_per_actor` is given as a string.</span>
<a id="__codelineno-0-613" name="__codelineno-0-613" href="#__codelineno-0-613"></a>        <span class="k">if</span> <span class="n">num_gpus_per_actor</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-614" name="__codelineno-0-614" href="#__codelineno-0-614"></a>            <span class="c1"># This is the case where `num_gpus_per_actor` is given as &quot;max&quot;.</span>
<a id="__codelineno-0-615" name="__codelineno-0-615" href="#__codelineno-0-615"></a>            <span class="n">num_gpus</span> <span class="o">=</span> <span class="n">get_ray_resource</span><span class="p">(</span><span class="s2">&quot;GPU&quot;</span><span class="p">)</span>
<a id="__codelineno-0-616" name="__codelineno-0-616" href="#__codelineno-0-616"></a>            <span class="k">if</span> <span class="n">num_gpus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-617" name="__codelineno-0-617" href="#__codelineno-0-617"></a>                <span class="c1"># With `num_gpus_per_actor` as &quot;max&quot;, if there is no GPU available, then we set the attribute</span>
<a id="__codelineno-0-618" name="__codelineno-0-618" href="#__codelineno-0-618"></a>                <span class="c1"># `_num_gpus_per_actor` as None, which means there will be no GPU assignment to the actors.</span>
<a id="__codelineno-0-619" name="__codelineno-0-619" href="#__codelineno-0-619"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-620" name="__codelineno-0-620" href="#__codelineno-0-620"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-621" name="__codelineno-0-621" href="#__codelineno-0-621"></a>                <span class="c1"># With `num_gpus_per_actor` as &quot;max&quot;, if there are GPUs available, then the available GPUs will</span>
<a id="__codelineno-0-622" name="__codelineno-0-622" href="#__codelineno-0-622"></a>                <span class="c1"># be shared among the actors.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623" href="#__codelineno-0-623"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="n">num_gpus</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_actors</span>
<a id="__codelineno-0-624" name="__codelineno-0-624" href="#__codelineno-0-624"></a>        <span class="k">elif</span> <span class="n">num_gpus_per_actor</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
<a id="__codelineno-0-625" name="__codelineno-0-625" href="#__codelineno-0-625"></a>            <span class="c1"># When `num_gpus_per_actor` is &quot;all&quot;, we also set the attribute `_num_gpus_per_actor` as &quot;all&quot;.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626" href="#__codelineno-0-626"></a>            <span class="c1"># When a remote actor is initialized, the remote actor will see that the Problem instance has its</span>
<a id="__codelineno-0-627" name="__codelineno-0-627" href="#__codelineno-0-627"></a>            <span class="c1"># `_num_gpus_per_actor` set as &quot;all&quot;, and it will remove the environment variable named</span>
<a id="__codelineno-0-628" name="__codelineno-0-628" href="#__codelineno-0-628"></a>            <span class="c1"># &quot;CUDA_VISIBLE_DEVICES&quot; in its own environment.</span>
<a id="__codelineno-0-629" name="__codelineno-0-629" href="#__codelineno-0-629"></a>            <span class="c1"># With &quot;CUDA_VISIBLE_DEVICES&quot; removed, an actor will see all the GPUs available in its own</span>
<a id="__codelineno-0-630" name="__codelineno-0-630" href="#__codelineno-0-630"></a>            <span class="c1"># environment.</span>
<a id="__codelineno-0-631" name="__codelineno-0-631" href="#__codelineno-0-631"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
<a id="__codelineno-0-632" name="__codelineno-0-632" href="#__codelineno-0-632"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-633" name="__codelineno-0-633" href="#__codelineno-0-633"></a>            <span class="c1"># This is the case where `num_gpus_per_actor` argument has an unexpected string value.</span>
<a id="__codelineno-0-634" name="__codelineno-0-634" href="#__codelineno-0-634"></a>            <span class="c1"># We raise an error.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635" href="#__codelineno-0-635"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-636" name="__codelineno-0-636" href="#__codelineno-0-636"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid string value for `num_gpus_per_actor`: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-637" name="__codelineno-0-637" href="#__codelineno-0-637"></a>                <span class="sa">f</span><span class="s1">&#39; Acceptable string values for `num_gpus_per_actor` are: &quot;max&quot;, &quot;all&quot;.&#39;</span>
<a id="__codelineno-0-638" name="__codelineno-0-638" href="#__codelineno-0-638"></a>            <span class="p">)</span>
<a id="__codelineno-0-639" name="__codelineno-0-639" href="#__codelineno-0-639"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-640" name="__codelineno-0-640" href="#__codelineno-0-640"></a>        <span class="c1"># When the argument `num_gpus_per_actor` is set as an integer we just set the attribute</span>
<a id="__codelineno-0-641" name="__codelineno-0-641" href="#__codelineno-0-641"></a>        <span class="c1"># `_num_gpus_per_actor` as this integer.</span>
<a id="__codelineno-0-642" name="__codelineno-0-642" href="#__codelineno-0-642"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="n">num_gpus_per_actor</span>
<a id="__codelineno-0-643" name="__codelineno-0-643" href="#__codelineno-0-643"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-644" name="__codelineno-0-644" href="#__codelineno-0-644"></a>        <span class="c1"># For anything else, we assume that `num_gpus_per_actor` is an object that is convertible to float.</span>
<a id="__codelineno-0-645" name="__codelineno-0-645" href="#__codelineno-0-645"></a>        <span class="c1"># Therefore, we convert it to float and store it in the attribute `_num_gpus_per_actor`.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646" href="#__codelineno-0-646"></a>        <span class="c1"># Also, remember that, when `num_actors` is given as &quot;num_gpus&quot; or as &quot;num_devices&quot;,</span>
<a id="__codelineno-0-647" name="__codelineno-0-647" href="#__codelineno-0-647"></a>        <span class="c1"># the code above overrides the value for the argument `num_gpus_per_actor`, which means,</span>
<a id="__codelineno-0-648" name="__codelineno-0-648" href="#__codelineno-0-648"></a>        <span class="c1"># this is the case that is activated when `num_actors` is &quot;num_gpus&quot; or &quot;num_devices&quot;.</span>
<a id="__codelineno-0-649" name="__codelineno-0-649" href="#__codelineno-0-649"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_gpus_per_actor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num_gpus_per_actor</span><span class="p">)</span>
<a id="__codelineno-0-650" name="__codelineno-0-650" href="#__codelineno-0-650"></a>
<a id="__codelineno-0-651" name="__codelineno-0-651" href="#__codelineno-0-651"></a>    <span class="c1"># Initialize the Hook instances (and the related status dictionary for the `_after_eval_hook`)</span>
<a id="__codelineno-0-652" name="__codelineno-0-652" href="#__codelineno-0-652"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_before_eval_hook</span><span class="p">:</span> <span class="n">Hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-653" name="__codelineno-0-653" href="#__codelineno-0-653"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_hook</span><span class="p">:</span> <span class="n">Hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-654" name="__codelineno-0-654" href="#__codelineno-0-654"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-655" name="__codelineno-0-655" href="#__codelineno-0-655"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_remote_hook</span><span class="p">:</span> <span class="n">Hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-656" name="__codelineno-0-656" href="#__codelineno-0-656"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_before_grad_hook</span><span class="p">:</span> <span class="n">Hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-657" name="__codelineno-0-657" href="#__codelineno-0-657"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_after_grad_hook</span><span class="p">:</span> <span class="n">Hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">()</span>
<a id="__codelineno-0-658" name="__codelineno-0-658" href="#__codelineno-0-658"></a>
<a id="__codelineno-0-659" name="__codelineno-0-659" href="#__codelineno-0-659"></a>    <span class="c1"># Initialize various stats regarding the solutions encountered by this Problem instance.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660" href="#__codelineno-0-660"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_store_solution_stats</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">store_solution_stats</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">bool</span><span class="p">(</span><span class="n">store_solution_stats</span><span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661" href="#__codelineno-0-661"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_best</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-662" name="__codelineno-0-662" href="#__codelineno-0-662"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_worst</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-663" name="__codelineno-0-663" href="#__codelineno-0-663"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_best_evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-664" name="__codelineno-0-664" href="#__codelineno-0-664"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_worst_evals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-665" name="__codelineno-0-665" href="#__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666" href="#__codelineno-0-666"></a>    <span class="c1"># Initialize the boolean attribute which indicates whether or not this Problem instance (which can be</span>
<a id="__codelineno-0-667" name="__codelineno-0-667" href="#__codelineno-0-667"></a>    <span class="c1"># the main instance or a remote instance on an actor) is &quot;prepared&quot; via the `_prepare` method.</span>
<a id="__codelineno-0-668" name="__codelineno-0-668" href="#__codelineno-0-668"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_prepared</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.all_remote_envs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">all_remote_envs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.all_remote_envs" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get an accessor which is used for running a method
on all remote reinforcement learning environments.</p>
<p>This method can only be used on parallelized Problem
objects which have their <code>get_env()</code> methods defined.
For example, one can use this feature on a parallelized
GymProblem.</p>
<p>As an example, let us consider a parallelized GymProblem
object named <code>my_problem</code>. Given that <code>my_problem</code> has
<code>n</code> remote actors, a method <code>f()</code> can be executed
on all remote reinforcement learning environments as
follows:</p>
<div class="highlight"><pre><span></span><code>results = my_problem.all_remote_envs().f()
</code></pre></div>
<p>The variable <code>results</code> is a list of length <code>n</code>, the i-th
item of the list belonging to the method f's result
from the i-th actor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>AllRemoteEnvs</code></td>
      <td><p>A method accessor for all the remote reinforcement
learning environments.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">all_remote_envs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AllRemoteEnvs</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Get an accessor which is used for running a method</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    on all remote reinforcement learning environments.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    This method can only be used on parallelized Problem</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    objects which have their `get_env()` methods defined.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    For example, one can use this feature on a parallelized</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    GymProblem.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    As an example, let us consider a parallelized GymProblem</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    object named `my_problem`. Given that `my_problem` has</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">    `n` remote actors, a method `f()` can be executed</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    on all remote reinforcement learning environments as</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    follows:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">        results = my_problem.all_remote_envs().f()</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    The variable `results` is a list of length `n`, the i-th</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">    item of the list belonging to the method f&#39;s result</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">    from the i-th actor.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">        A method accessor for all the remote reinforcement</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">        learning environments.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_parallelize</span><span class="p">()</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_remote</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>            <span class="s2">&quot;The method `all_remote_envs()` can only be used on the main (i.e. non-remote)&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>            <span class="s2">&quot; Problem instance.&quot;</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>            <span class="s2">&quot; However, this Problem instance is on a remote actor.&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>        <span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="k">return</span> <span class="n">AllRemoteEnvs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.all_remote_problems" class="doc doc-heading">
<code class="highlight language-python"><span class="n">all_remote_problems</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.all_remote_problems" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get an accessor which is used for running a method
on all remote clones of this Problem object.</p>
<p>For example, given a Problem object named <code>my_problem</code>,
also assuming that this Problem object is parallelized,
and therefore has <code>n</code> remote actors, a method <code>f()</code>
can be executed on all the remote instances as follows:</p>
<div class="highlight"><pre><span></span><code>results = my_problem.all_remote_problems().f()
</code></pre></div>
<p>The variable <code>results</code> is a list of length <code>n</code>, the i-th
item of the list belonging to the method f's result
from the i-th actor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>AllRemoteProblems</code></td>
      <td><p>A method accessor for all the remote Problem objects.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">all_remote_problems</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AllRemoteProblems</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Get an accessor which is used for running a method</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    on all remote clones of this Problem object.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    For example, given a Problem object named `my_problem`,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    also assuming that this Problem object is parallelized,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    and therefore has `n` remote actors, a method `f()`</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    can be executed on all the remote instances as follows:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">        results = my_problem.all_remote_problems().f()</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">    The variable `results` is a list of length `n`, the i-th</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    item of the list belonging to the method f&#39;s result</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    from the i-th actor.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">        A method accessor for all the remote Problem objects.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_parallelize</span><span class="p">()</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_remote</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>            <span class="s2">&quot;The method `all_remote_problems()` can only be used on the main (i.e. non-remote)&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>            <span class="s2">&quot; Problem instance.&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>            <span class="s2">&quot; However, this Problem instance is on a remote actor.&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>        <span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    <span class="k">return</span> <span class="n">AllRemoteProblems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.compare_solutions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compare_solutions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.compare_solutions" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Compare two solutions.
It is assumed that both solutions are already evaluated.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>a</code></td>
        <td><code>Solution</code></td>
        <td><p>The first solution.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>b</code></td>
        <td><code>Solution</code></td>
        <td><p>The second solution.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>The objective index according to which the comparison
will be made.
Can be left as None if the problem is single-objective.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>A positive number if <code>a</code> is better;
a negative number if <code>b</code> is better;
0 if there is a tie.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">compare_solutions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Compare two solutions.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    It is assumed that both solutions are already evaluated.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">        a: The first solution.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">        b: The second solution.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">        obj_index: The objective index according to which the comparison</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">            will be made.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">            Can be left as None if the problem is single-objective.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">        A positive number if `a` is better;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">        a negative number if `b` is better;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">        0 if there is a tie.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">senses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">senses</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">sense</span> <span class="o">=</span> <span class="n">senses</span><span class="p">[</span><span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">evals</span><span class="p">[</span><span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="k">if</span> <span class="n">sense</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>        <span class="k">return</span> <span class="n">score</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="n">score</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="k">elif</span> <span class="n">sense</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="k">return</span> <span class="n">score</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">score</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unrecognized sense: &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">sense</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.ensure_numeric" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ensure_numeric</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.ensure_numeric" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Ensure that the problem has a numeric dtype.</p>

<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the problem has a non-numeric dtype.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">ensure_numeric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Ensure that the problem has a numeric dtype.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">        ValueError: if the problem has a non-numeric dtype.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">if</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected a problem with numeric dtype, but the dtype is object.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.ensure_single_objective" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ensure_single_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.ensure_single_objective" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Ensure that the problem has only one objective.</p>

<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the problem is multi-objective.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">ensure_single_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Ensure that the problem has only one objective.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">        ValueError: if the problem is multi-objective.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected a single-objective problem, but this problem has </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> objectives.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.ensure_unbounded" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ensure_unbounded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.ensure_unbounded" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Ensure that the problem has no strict lower and upper bounds.</p>

<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the problem has strict lower and upper bounds.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">ensure_unbounded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Ensure that the problem has no strict lower and upper bounds.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">        ValueError: if the problem has strict lower and upper bounds.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_bounds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected an unbounded problem, but this problem has lower and/or upper bounds.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.evaluate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.evaluate" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Evaluate the given Solution or SolutionBatch.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>batch</code></td>
        <td></td>
        <td><p>The SolutionBatch to be evaluated.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;SolutionBatch&quot;</span><span class="p">,</span> <span class="s2">&quot;Solution&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Evaluate the given Solution or SolutionBatch.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">        batch: The SolutionBatch to be evaluated.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Solution</span><span class="p">):</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="n">batch</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_batch</span><span class="p">()</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        <span class="n">batch</span> <span class="o">=</span> <span class="n">x</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>            <span class="sa">f</span><span class="s2">&quot;The method `evaluate(...)` expected a Solution or a SolutionBatch as its argument.&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>            <span class="sa">f</span><span class="s2">&quot; However, the received object is </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">, which is of type </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        <span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_parallelize</span><span class="p">()</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">before_eval_hook</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="n">must_sync_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sync_before</span><span class="p">()</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_start_preparations</span><span class="p">()</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_all</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="k">if</span> <span class="n">must_sync_after</span><span class="p">:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_after</span><span class="p">()</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>        <span class="n">best_and_worst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_best_and_worst</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>        <span class="k">if</span> <span class="n">best_and_worst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">best_and_worst</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">after_eval_hook</span><span class="o">.</span><span class="n">accumulate_dict</span><span class="p">(</span><span class="n">batch</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.generate_batch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">popsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdev</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.generate_batch" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Generate a new SolutionBatch.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>popsize</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of solutions that will be contained in the new
batch.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>empty</code></td>
        <td><code>bool</code></td>
        <td><p>Set this as True if you would like to receive the solutions
un-initialized.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>center</code></td>
        <td><code>Union[float, Iterable[float], torch.Tensor]</code></td>
        <td><p>Center point of the Gaussian distribution from which
the decision values will be sampled, as a scalar or as a
1-dimensional vector.
Can also be left as None.
If <code>center</code> is None and <code>stdev</code> is None, all the decision
values will be sampled from the interval specified by
<code>initial_bounds</code> (or by <code>bounds</code> if <code>initial_bounds</code> was not
specified).
If <code>center</code> is None and <code>stdev</code> is not None, a center point
will be sampled from within the interval specified by
<code>initial_bounds</code> or <code>bounds</code>, and the decision values will be
sampled from a Gaussian distribution around this center point.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>stdev</code></td>
        <td><code>Union[float, Iterable[float], torch.Tensor]</code></td>
        <td><p>Can be None (default) if the SolutionBatch is to contain
decision values sampled from the interval specified by
<code>initial_bounds</code> (or by <code>bounds</code> if <code>initial_bounds</code> was not
provided during the initialization phase).
Alternatively, a scalar or a 1-dimensional vector specifying
the standard deviation of the Gaussian distribution from which
the decision values will be sampled.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>symmetric</code></td>
        <td><code>bool</code></td>
        <td><p>To be used only when <code>stdev</code> is not None.
If <code>symmetric</code> is True, decision values will be sampled from
the Gaussian distribution in a symmetric (i.e. antithetic)
manner.
Otherwise, the decision values will be sampled in the
non-antithetic manner.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">generate_batch</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">center</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">stdev</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealOrVector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">symmetric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    Generate a new SolutionBatch.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">        popsize: Number of solutions that will be contained in the new</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">            batch.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">        empty: Set this as True if you would like to receive the solutions</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">            un-initialized.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">        center: Center point of the Gaussian distribution from which</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">            the decision values will be sampled, as a scalar or as a</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">            1-dimensional vector.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">            Can also be left as None.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">            If `center` is None and `stdev` is None, all the decision</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">            values will be sampled from the interval specified by</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">            `initial_bounds` (or by `bounds` if `initial_bounds` was not</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">            specified).</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">            If `center` is None and `stdev` is not None, a center point</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">            will be sampled from within the interval specified by</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="sd">            `initial_bounds` or `bounds`, and the decision values will be</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">            sampled from a Gaussian distribution around this center point.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">        stdev: Can be None (default) if the SolutionBatch is to contain</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="sd">            decision values sampled from the interval specified by</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="sd">            `initial_bounds` (or by `bounds` if `initial_bounds` was not</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="sd">            provided during the initialization phase).</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="sd">            Alternatively, a scalar or a 1-dimensional vector specifying</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="sd">            the standard deviation of the Gaussian distribution from which</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="sd">            the decision values will be sampled.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="sd">        symmetric: To be used only when `stdev` is not None.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="sd">            If `symmetric` is True, decision values will be sampled from</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="sd">            the Gaussian distribution in a symmetric (i.e. antithetic)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="sd">            manner.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="sd">            Otherwise, the decision values will be sampled in the</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="sd">            non-antithetic manner.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">center</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">stdev</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>        <span class="k">if</span> <span class="n">symmetric</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>                <span class="sa">f</span><span class="s2">&quot;The argument `symmetric` can be set as True only when `center` and `stdev` are provided.&quot;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>                <span class="sa">f</span><span class="s2">&quot; Although `center` and `stdev` are None, `symmetric` was received as </span><span class="si">{</span><span class="n">symmetric</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>            <span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>        <span class="k">return</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="n">empty</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">center</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">stdev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>        <span class="k">if</span> <span class="n">empty</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>                <span class="sa">f</span><span class="s2">&quot;When `center` and `stdev` are provided, the argument `empty` must be False.&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>                <span class="sa">f</span><span class="s2">&quot; However, the received value for `empty` is </span><span class="si">{</span><span class="n">empty</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>            <span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">make_gaussian</span><span class="p">(</span><span class="n">out</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">access_values</span><span class="p">(),</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">stdev</span><span class="o">=</span><span class="n">stdev</span><span class="p">,</span> <span class="n">symmetric</span><span class="o">=</span><span class="n">symmetric</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>            <span class="sa">f</span><span class="s2">&quot;The arguments `center` and `stdev` were expected to be None or non-None at the same time.&quot;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>            <span class="sa">f</span><span class="s2">&quot; Received `center`: </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>            <span class="sa">f</span><span class="s2">&quot; Received `stdev`: </span><span class="si">{</span><span class="n">stdev</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.generate_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_solutions</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.generate_values" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Generate decision values.</p>
<p>This function returns a tensor containing the decision values
for <code>n</code> new solutions, <code>n</code> being the integer passed as the <code>num_rows</code>
argument.</p>
<p>For numeric problems, this function generates the decision values
which respect <code>initial_bounds</code> (or <code>bounds</code>, if <code>initial_bounds</code>
was not provided).
If this type of initialization is not desired, one can override
this function and define a manual initialization scheme in the
inheriting subclass.</p>
<p>For non-numeric problems, it is expected that the inheriting subclass
will override the method <code>_fill(...)</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>num_solutions</code></td>
        <td><code>int</code></td>
        <td><p>For how many solutions will new decision values be
generated.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[torch.Tensor, evotorch.tools.objectarray.ObjectArray]</code></td>
      <td><p>A PyTorch tensor for numeric problems, an ObjectArray for
non-numeric problems.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">generate_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_solutions</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">]:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Generate decision values.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    This function returns a tensor containing the decision values</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    for `n` new solutions, `n` being the integer passed as the `num_rows`</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    argument.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    For numeric problems, this function generates the decision values</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    which respect `initial_bounds` (or `bounds`, if `initial_bounds`</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    was not provided).</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    If this type of initialization is not desired, one can override</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">    this function and define a manual initialization scheme in the</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    inheriting subclass.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    For non-numeric problems, it is expected that the inheriting subclass</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    will override the method `_fill(...)`.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">        num_solutions: For how many solutions will new decision values be</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">            generated.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">        A PyTorch tensor for numeric problems, an ObjectArray for</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">        non-numeric problems.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_empty</span><span class="p">(</span><span class="n">num_solutions</span><span class="o">=</span><span class="n">num_solutions</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.get_obj_order_descending" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_obj_order_descending</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.get_obj_order_descending" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>When sorting the solutions from best to worst according to each objective i, is the ordering descending?</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">get_obj_order_descending</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;When sorting the solutions from best to worst according to each objective i, is the ordering descending?&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid sense: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.is_better" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_better</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.is_better" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Check whether or not the first solution is better.
It is assumed that both solutions are already evaluated.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>a</code></td>
        <td><code>Solution</code></td>
        <td><p>The first solution.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>b</code></td>
        <td><code>Solution</code></td>
        <td><p>The second solution.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>The objective index according to which the comparison
will be made.
Can be left as None if the problem is single-objective.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if <code>a</code> is better; False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">is_better</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Check whether or not the first solution is better.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    It is assumed that both solutions are already evaluated.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">        a: The first solution.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">        b: The second solution.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">        obj_index: The objective index according to which the comparison</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">            will be made.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">            Can be left as None if the problem is single-objective.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">        True if `a` is better; False otherwise.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_solutions</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.is_on_cpu" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_on_cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.is_on_cpu" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Whether or not the Problem object has its device set as "cpu".</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">is_on_cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Whether or not the Problem object has its device set as &quot;cpu&quot;.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.is_worse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_worse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.is_worse" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Check whether or not the first solution is worse.
It is assumed that both solutions are already evaluated.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>a</code></td>
        <td><code>Solution</code></td>
        <td><p>The first solution.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>b</code></td>
        <td><code>Solution</code></td>
        <td><p>The second solution.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>The objective index according to which the comparison
will be made.
Can be left as None if the problem is single-objective.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if <code>a</code> is worse; False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">is_worse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="s2">&quot;Solution&quot;</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Check whether or not the first solution is worse.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    It is assumed that both solutions are already evaluated.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">        a: The first solution.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">        b: The second solution.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">        obj_index: The objective index according to which the comparison</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">            will be made.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">            Can be left as None if the problem is single-objective.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">        True if `a` is worse; False otherwise.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_solutions</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.kill_actors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">kill_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.kill_actors" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Kill all the remote actors used by the Problem instance.</p>
<p>One might use this method to release the resources used by the
remote actors.</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">kill_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Kill all the remote actors used by the Problem instance.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    One might use this method to release the resources used by the</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    remote actors.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>            <span class="s2">&quot;The method `kill_actors()` can only be used on the main (i.e. non-remote)&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>            <span class="s2">&quot; Problem instance.&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>            <span class="s2">&quot; However, this Problem instance is on a remote actor.&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        <span class="n">ray</span><span class="o">.</span><span class="n">kill</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_actor_pool</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.manual_seed" class="doc doc-heading">
<code class="highlight language-python"><span class="n">manual_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.manual_seed" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Provide a manual seed for the Problem object.</p>
<p>If the given seed is None, then the Problem object will remove
its own stored generator, and start using the global generator
of PyTorch instead.
If the given seed is an integer, then the Problem object will
instantiate its own generator with the given seed.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>seed</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>None for using the global PyTorch generator; an integer
for instantiating a new PyTorch generator with this given
integer seed, specific to this Problem object.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">manual_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Provide a manual seed for the Problem object.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    If the given seed is None, then the Problem object will remove</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    its own stored generator, and start using the global generator</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    of PyTorch instead.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    If the given seed is an integer, then the Problem object will</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    instantiate its own generator with the given seed.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">        seed: None for using the global PyTorch generator; an integer</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">            for instantiating a new PyTorch generator with this given</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">            integer seed, specific to this Problem object.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.normalize_obj_index" class="doc doc-heading">
<code class="highlight language-python"><span class="n">normalize_obj_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.normalize_obj_index" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Normalize the objective index.</p>
<p>If the provided index is non-negative, it is ensured that the index
is valid.</p>
<p>If the provided index is negative, the objectives are counted in the
reverse order, and the corresponding non-negative index is returned.
For example, -1 is converted to a non-negative integer corresponding to
the last objective.</p>
<p>If the provided index is None and if the problem is single-objective,
the returned value is 0, which represents the only objective.</p>
<p>If the provided index is None and if the problem is multi-objective,
an error is raised.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>The non-normalized objective index.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>int</code></td>
      <td><p>The normalized objective index, as a non-negative integer.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">normalize_obj_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Normalize the objective index.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    If the provided index is non-negative, it is ensured that the index</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    is valid.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    If the provided index is negative, the objectives are counted in the</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    reverse order, and the corresponding non-negative index is returned.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    For example, -1 is converted to a non-negative integer corresponding to</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    the last objective.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">    If the provided index is None and if the problem is single-objective,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    the returned value is 0, which represents the only objective.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    If the provided index is None and if the problem is multi-objective,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    an error is raised.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">        obj_index: The non-normalized objective index.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">        The normalized objective index, as a non-negative integer.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="k">if</span> <span class="n">obj_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>            <span class="k">return</span> <span class="mi">0</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>                <span class="s2">&quot;This problem is multi-objective, therefore, an explicit objective index was expected.&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>                <span class="s2">&quot; However, `obj_index` was found to be None.&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>            <span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>        <span class="n">obj_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>        <span class="k">if</span> <span class="n">obj_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>            <span class="n">obj_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span> <span class="o">+</span> <span class="n">obj_index</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>        <span class="k">if</span> <span class="n">obj_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">obj_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">):</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Objective index out of range.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>        <span class="k">return</span> <span class="n">obj_index</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Problem.sample_and_compute_gradients" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sample_and_compute_gradients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">popsize</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">num_interactions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">popsize_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ensure_even_popsize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#evotorch.core.Problem.sample_and_compute_gradients" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Sample new solutions from the distribution and compute gradients.</p>
<p>The distribution can then be updated according to the computed
gradients.</p>
<p>If the problem is not parallelized, and <code>with_stats</code> is False,
then the result will be a single dictionary of gradients.
For example, in the case of a Gaussian distribution, the returned
gradients dictionary would look like this:</p>
<div class="highlight"><pre><span></span><code>{
    &quot;mu&quot;: ...,     # the gradient for the mean
    &quot;sigma&quot;: ...,  # the gradient for the standard deviation
}
</code></pre></div>
<p>If the problem is not parallelized, and <code>with_stats</code> is True,
then the result will be a dictionary which contains in itself
the gradients dictionary, and additional elements for providing
further information. In the case of a Gaussian distribution,
the returned dictionary with additional stats would look like
this:</p>
<div class="highlight"><pre><span></span><code>{
    &quot;gradients&quot;: {
        &quot;mu&quot;: ...,     # the gradient for the mean
        &quot;sigma&quot;: ...,  # the gradient for the standard deviation
    },
    &quot;num_solutions&quot;: ...,  # how many solutions were sampled
    &quot;mean_eval&quot;: ...,      # Mean of all evaluations
}
</code></pre></div>
<p>If the problem is parallelized, then the gradient computation will
be distributed among the remote actors. In more details, each actor
will sample its own solutions (such that the total population size
across all remote actors will be near the provided <code>popsize</code>)
and will compute its own gradients, and will produce its own
additional stats (if <code>with_stats</code> is given as True).
These remote results will then be collected by the main process,
and the final result of this method will be a list of dictionaries,
each dictionary being the result of a remote gradient computation.</p>
<p>The sampled solutions are temporary, and will not be kept
(and will not be returned).</p>
<p>To customize how solutions are sampled and how gradients are
computed, one is encouraged to override
<code>_sample_and_compute_gradients(...)</code> (instead of overriding this
method directly.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>distribution</code></td>
        <td></td>
        <td><p>The search distribution from which the solutions
will be sampled, and according to which the gradients will
be computed.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>popsize</code></td>
        <td><code>int</code></td>
        <td><p>The number of solutions which will be sampled.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_interactions</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of simulator interactions that must
be completed (more solutions will be sampled until this
threshold is reached). This argument is to be used when
the problem has characteristics similar to reinforcement
learning, and an adaptive population size, depending on
the interactions made, is desired.
Otherwise, one can leave this argument as None, in which
case, there will not be any threshold based on number
of interactions.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>popsize_max</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>To be used when <code>num_interactions</code> is provided,
as an additional criterion for ending the solution sampling
phase. This argument can be used to prevent the population
size from growing too much while trying to satisfy the
<code>num_interactions</code>. If not needed, <code>popsize_max</code> can be left
as None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Index of the objective according to which the gradients
will be computed. Can be left as None if the problem has only
one objective.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ranking_method</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The solution ranking method to be used when
computing the gradients.
If not specified, the raw fitnesses will be used.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>with_stats</code></td>
        <td><code>bool</code></td>
        <td><p>If given as False, then the results dictionary will
only contain the gradients information. If given as True,
then the results dictionary will contain within itself
the gradients dictionary, and also additional elements for
providing further information.
The default is True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>ensure_even_popsize</code></td>
        <td><code>bool</code></td>
        <td><p>If <code>ensure_even_popsize</code> is True and the
problem is not parallelized, then a <code>popsize</code> given as an odd
number will cause an error. If <code>ensure_even_popsize</code> is True
and the problem is parallelized, then the remote actors will
sample their own sub-populations in such a way that their
sizes are even.
If <code>ensure_even_popsize</code> is False, whether or not the
<code>popsize</code> is even will not be checked.
When the provided <code>distribution</code> is a symmetric (or
"mirrored", or "antithetic"), then this argument must be
given as True.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[list, dict]</code></td>
      <td><p>A results dictionary when the problem is not parallelized,
or list of results dictionaries when the problem is parallelized.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">sample_and_compute_gradients</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">distribution</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">popsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">num_interactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">popsize_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">with_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">ensure_even_popsize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    Sample new solutions from the distribution and compute gradients.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    The distribution can then be updated according to the computed</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    gradients.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    If the problem is not parallelized, and `with_stats` is False,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">    then the result will be a single dictionary of gradients.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">    For example, in the case of a Gaussian distribution, the returned</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">    gradients dictionary would look like this:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">        {</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">            &quot;mu&quot;: ...,     # the gradient for the mean</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">            &quot;sigma&quot;: ...,  # the gradient for the standard deviation</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">        }</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">    If the problem is not parallelized, and `with_stats` is True,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">    then the result will be a dictionary which contains in itself</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="sd">    the gradients dictionary, and additional elements for providing</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="sd">    further information. In the case of a Gaussian distribution,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="sd">    the returned dictionary with additional stats would look like</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="sd">    this:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="sd">        {</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="sd">            &quot;gradients&quot;: {</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="sd">                &quot;mu&quot;: ...,     # the gradient for the mean</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="sd">                &quot;sigma&quot;: ...,  # the gradient for the standard deviation</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="sd">            },</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="sd">            &quot;num_solutions&quot;: ...,  # how many solutions were sampled</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="sd">            &quot;mean_eval&quot;: ...,      # Mean of all evaluations</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="sd">        }</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="sd">    If the problem is parallelized, then the gradient computation will</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="sd">    be distributed among the remote actors. In more details, each actor</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="sd">    will sample its own solutions (such that the total population size</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="sd">    across all remote actors will be near the provided `popsize`)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="sd">    and will compute its own gradients, and will produce its own</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="sd">    additional stats (if `with_stats` is given as True).</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="sd">    These remote results will then be collected by the main process,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="sd">    and the final result of this method will be a list of dictionaries,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="sd">    each dictionary being the result of a remote gradient computation.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="sd">    The sampled solutions are temporary, and will not be kept</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a><span class="sd">    (and will not be returned).</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a><span class="sd">    To customize how solutions are sampled and how gradients are</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="sd">    computed, one is encouraged to override</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a><span class="sd">    `_sample_and_compute_gradients(...)` (instead of overriding this</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a><span class="sd">    method directly.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a><span class="sd">        distribution: The search distribution from which the solutions</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a><span class="sd">            will be sampled, and according to which the gradients will</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a><span class="sd">            be computed.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a><span class="sd">        popsize: The number of solutions which will be sampled.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a><span class="sd">        num_interactions: Number of simulator interactions that must</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a><span class="sd">            be completed (more solutions will be sampled until this</span>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a><span class="sd">            threshold is reached). This argument is to be used when</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a><span class="sd">            the problem has characteristics similar to reinforcement</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a><span class="sd">            learning, and an adaptive population size, depending on</span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a><span class="sd">            the interactions made, is desired.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a><span class="sd">            Otherwise, one can leave this argument as None, in which</span>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a><span class="sd">            case, there will not be any threshold based on number</span>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a><span class="sd">            of interactions.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a><span class="sd">        popsize_max: To be used when `num_interactions` is provided,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a><span class="sd">            as an additional criterion for ending the solution sampling</span>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a><span class="sd">            phase. This argument can be used to prevent the population</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a><span class="sd">            size from growing too much while trying to satisfy the</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a><span class="sd">            `num_interactions`. If not needed, `popsize_max` can be left</span>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a><span class="sd">            as None.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="sd">        obj_index: Index of the objective according to which the gradients</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="sd">            will be computed. Can be left as None if the problem has only</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="sd">            one objective.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a><span class="sd">        ranking_method: The solution ranking method to be used when</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a><span class="sd">            computing the gradients.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a><span class="sd">            If not specified, the raw fitnesses will be used.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a><span class="sd">        with_stats: If given as False, then the results dictionary will</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="sd">            only contain the gradients information. If given as True,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a><span class="sd">            then the results dictionary will contain within itself</span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a><span class="sd">            the gradients dictionary, and also additional elements for</span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a><span class="sd">            providing further information.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a><span class="sd">            The default is True.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a><span class="sd">        ensure_even_popsize: If `ensure_even_popsize` is True and the</span>
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a><span class="sd">            problem is not parallelized, then a `popsize` given as an odd</span>
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a><span class="sd">            number will cause an error. If `ensure_even_popsize` is True</span>
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a><span class="sd">            and the problem is parallelized, then the remote actors will</span>
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a><span class="sd">            sample their own sub-populations in such a way that their</span>
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a><span class="sd">            sizes are even.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a><span class="sd">            If `ensure_even_popsize` is False, whether or not the</span>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a><span class="sd">            `popsize` is even will not be checked.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a><span class="sd">            When the provided `distribution` is a symmetric (or</span>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a><span class="sd">            &quot;mirrored&quot;, or &quot;antithetic&quot;), then this argument must be</span>
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a><span class="sd">            given as True.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a><span class="sd">        A results dictionary when the problem is not parallelized,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a><span class="sd">        or list of results dictionaries when the problem is parallelized.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>    <span class="c1"># For problems which are configured for parallelization, make sure that the actors are created.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_parallelize</span><span class="p">()</span>
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>    <span class="c1"># Below we check if there is an inconsistency in arguments.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_interactions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">popsize_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>        <span class="c1"># If `num_interactions` is None, then we assume that the user does not wish an adaptive population size.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>        <span class="c1"># However, at the same time, if `popsize_max` is not None, then there is an inconsistency,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a>        <span class="c1"># because, `popsize_max` without `num_interactions` (therefore without adaptive population size)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a>        <span class="c1"># does not make sense.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a>        <span class="c1"># This is probably a configuration error, so, we inform the user by raising an error.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a>            <span class="sa">f</span><span class="s2">&quot;`popsize_max` was expected as None, because `num_interactions` is None.&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a>            <span class="sa">f</span><span class="s2">&quot; However, `popsize_max` was found as </span><span class="si">{</span><span class="n">popsize_max</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a>        <span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a>    <span class="c1"># The problem instance in the main process should trigger the `before_grad_hook`.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_before_grad_hook</span><span class="p">()</span>
<a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a>        <span class="c1"># If this is the main process and the problem is parallelized, then we need to split the request</span>
<a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a>        <span class="c1"># into multiple tasks, and then execute those tasks in parallel using the problem&#39;s actor pool.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a>            <span class="c1"># If `subbatch_size` is provided, then we first make sure that `popsize` is divisible by</span>
<a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a>            <span class="c1"># `subbatch_size`</span>
<a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">popsize</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a>                    <span class="sa">f</span><span class="s2">&quot;This Problem was created with `subbatch_size` as </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a>                    <span class="sa">f</span><span class="s2">&quot; When doing remote gradient computation, the requested population size must be divisible by&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a>                    <span class="sa">f</span><span class="s2">&quot; the `subbatch_size`.&quot;</span>
<a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a>                    <span class="sa">f</span><span class="s2">&quot; However, the requested population size is </span><span class="si">{</span><span class="n">popsize</span><span class="si">}</span><span class="s2">, and the remainder after dividing it&quot;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a>                    <span class="sa">f</span><span class="s2">&quot; by `subbatch_size` is not 0 (it is </span><span class="si">{</span><span class="n">popsize</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a>                <span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a>            <span class="c1"># After making sure that `popsize` and `subbatch_size` configurations are compatible, we declare that</span>
<a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a>            <span class="c1"># we are going to have n tasks, each task imposing a sample size of `subbatch_size`.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">popsize</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a>            <span class="n">popsize_per_task</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_subbatch_size</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_subbatches</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a>            <span class="c1"># If `num_subbatches` is provided, then we are going to have n tasks where n is equal to the given</span>
<a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a>            <span class="c1"># `num_subbatches`.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a>            <span class="n">popsize_per_task</span> <span class="o">=</span> <span class="n">split_workload</span><span class="p">(</span><span class="n">popsize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_subbatches</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a>            <span class="c1"># If neither `subbatch_size` nor `num_subbatches` is given, then we will split the workload in such</span>
<a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>            <span class="c1"># a way that each actor will have its share.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a>            <span class="n">popsize_per_task</span> <span class="o">=</span> <span class="n">split_workload</span><span class="p">(</span><span class="n">popsize</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">))</span>
<a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a>        <span class="k">if</span> <span class="n">ensure_even_popsize</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a>            <span class="c1"># If `ensure_even_popsize` argument is True, then we need to make sure that each tasks&#39;s popsize is</span>
<a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a>            <span class="c1"># an even number.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">popsize_per_task</span><span class="p">)):</span>
<a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">popsize_per_task</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a>                    <span class="c1"># If the i-th actor&#39;s assigned popsize is not even, increase its assigned popsize by 1.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a>                    <span class="n">popsize_per_task</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a>        <span class="c1"># The number of tasks is finally determined by the length of `popsize_per_task` list we created above.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a>        <span class="n">num_tasks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">popsize_per_task</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a>        <span class="k">if</span> <span class="n">num_interactions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a>            <span class="c1"># If the argument `num_interactions` is not given, then, for each task, we declare that</span>
<a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a>            <span class="c1"># `num_interactions` is None.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a>            <span class="n">num_inter_per_task</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tasks</span><span class="p">)]</span>
<a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a>            <span class="c1"># If the argument `num_interactions` is given, then we compute each task&#39;s target number of</span>
<a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a>            <span class="c1"># interactions from its sample size.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a>            <span class="n">num_inter_per_task</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a>                <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">popsize_per_task</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">popsize</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_interactions</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tasks</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a>            <span class="p">]</span>
<a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a>        <span class="k">if</span> <span class="n">popsize_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a>            <span class="c1"># If the argument `popsize_max` is not given, then, for each task, we declare that</span>
<a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a>            <span class="c1"># `popsize_max` is None.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a>            <span class="n">popsize_max_per_task</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tasks</span><span class="p">)]</span>
<a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a>            <span class="c1"># If the argument `popsize_max` is given, then we compute each task&#39;s target maximum population size</span>
<a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a>            <span class="c1"># from its sample size.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a>            <span class="n">popsize_max_per_task</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a>                <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">popsize_per_task</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">popsize</span><span class="p">)</span> <span class="o">*</span> <span class="n">popsize_max</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tasks</span><span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a>            <span class="p">]</span>
<a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a>        <span class="c1"># We trigger the synchronization between the main process and the remote actors.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a>        <span class="c1"># If this problem instance has nothing to synchronize, then `must_sync_after` will be False.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a>        <span class="n">must_sync_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sync_before</span><span class="p">()</span>
<a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a>        <span class="c1"># Because we want to send the distribution to remote actors, we first copy the distribution to cpu</span>
<a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a>        <span class="c1"># (unless it is already on cpu)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a>        <span class="n">dist_on_cpu</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a>        <span class="c1"># Here, we use our actor pool to execute our tasks in parallel.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a>        <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_actor_pool</span><span class="o">.</span><span class="n">map_unordered</span><span class="p">(</span>
<a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a>                <span class="p">(</span>
<a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a>                    <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span>
<a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a>                        <span class="s2">&quot;_sample_and_compute_gradients&quot;</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a>                        <span class="p">[</span><span class="n">dist_on_cpu</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
<a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a>                        <span class="p">{</span>
<a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a>                            <span class="s2">&quot;obj_index&quot;</span><span class="p">:</span> <span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a>                            <span class="s2">&quot;num_interactions&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a>                            <span class="s2">&quot;popsize_max&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a>                            <span class="s2">&quot;ranking_method&quot;</span><span class="p">:</span> <span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a>                        <span class="p">},</span>
<a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a>                    <span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a>                <span class="p">),</span>
<a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a>                <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">popsize_per_task</span><span class="p">,</span> <span class="n">num_inter_per_task</span><span class="p">,</span> <span class="n">popsize_max_per_task</span><span class="p">)),</span>
<a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a>            <span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a>        <span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a>        <span class="c1"># At this point, all the tensors within our collected results are on the CPU.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a>        <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span> <span class="o">!=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">):</span>
<a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a>            <span class="c1"># If the main device of this problem instance is not CPU, then we move the tensors to the main device.</span>
<a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">cast_tensors_in_container</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a>        <span class="k">if</span> <span class="n">must_sync_after</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a>            <span class="c1"># If a post-gradient synchronization is required, we trigger the synchronization operations.</span>
<a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_after</span><span class="p">()</span>
<a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a>        <span class="c1"># ####################################################</span>
<a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a>        <span class="c1"># # If this is the main process and the problem is parallelized, then we need to split the workload among</span>
<a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a>        <span class="c1"># # the remote actors, and then request each of them to compute their gradients.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a>        <span class="c1">#</span>
<a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a>        <span class="c1"># # We begin by getting the number of actors, and computing the `popsize` for each actor.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a>        <span class="c1"># num_actors = len(self._actors)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a>        <span class="c1"># popsize_per_actor = split_workload(popsize, num_actors)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a>        <span class="c1">#</span>
<a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a>        <span class="c1"># if ensure_even_popsize:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a>        <span class="c1">#     # If `ensure_even_popsize` argument is True, then we need to make sure that each actor&#39;s popsize is</span>
<a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a>        <span class="c1">#     # an even number.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a>        <span class="c1">#     for i in range(len(popsize_per_actor)):</span>
<a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a>        <span class="c1">#         if (popsize_per_actor[i] % 2) != 0:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a>        <span class="c1">#             # If the i-th actor&#39;s assigned popsize is not even, increase its assigned popsize by 1.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a>        <span class="c1">#             popsize_per_actor[i] += 1</span>
<a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a>        <span class="c1">#</span>
<a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a>        <span class="c1"># if num_interactions is None:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a>        <span class="c1">#     # If `num_interactions` is None, then the `num_interactions` argument for each actor must also be</span>
<a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a>        <span class="c1">#     # passed as None.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a>        <span class="c1">#     num_int_per_actor = [None] * num_actors</span>
<a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a>        <span class="c1"># else:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a>        <span class="c1">#     # If `num_interactions` is not None, then we split the `num_interactions` workload among the actors.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a>        <span class="c1">#     num_int_per_actor = split_workload(num_interactions, num_actors)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a>        <span class="c1">#</span>
<a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a>        <span class="c1"># if popsize_max is None:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a>        <span class="c1">#     # If `popsize_max` is None, then the `popsize_max` argument for each actor must also be None.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a>        <span class="c1">#     popsize_max_per_actor = [None] * num_actors</span>
<a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a>        <span class="c1"># else:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a>        <span class="c1">#     # If `popsize_max` is not None, then we split the `popsize_max` workload among the actors.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a>        <span class="c1">#     popsize_max_per_actor = split_workload(popsize_max, num_actors)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a>        <span class="c1">#</span>
<a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a>        <span class="c1"># # We trigger the synchronization between the main process and the remote actors.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a>        <span class="c1"># # If this problem instance has nothing to synchronize, then `must_sync_after` will be False.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a>        <span class="c1"># must_sync_after = self._sync_before()</span>
<a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a>        <span class="c1">#</span>
<a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a>        <span class="c1"># # Because we want to send the distribution to remote actors, we first copy the distribution to cpu</span>
<a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a>        <span class="c1"># # (unless it is already on cpu)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a>        <span class="c1"># dist_on_cpu = distribution.to(&quot;cpu&quot;)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a>        <span class="c1">#</span>
<a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a>        <span class="c1"># # To each actor, we send the request of computing the gradients, and then collect the results</span>
<a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a>        <span class="c1"># result = ray.get(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a>        <span class="c1">#     [</span>
<a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a>        <span class="c1">#         self._actors[i].call.remote(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a>        <span class="c1">#             &quot;_gradient_computation_helper&quot;,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a>        <span class="c1">#             [dist_on_cpu, popsize_per_actor[i]],</span>
<a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a>        <span class="c1">#             dict(</span>
<a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a>        <span class="c1">#                 num_interactions=num_int_per_actor[i],</span>
<a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a>        <span class="c1">#                 popsize_max=popsize_max_per_actor[i],</span>
<a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a>        <span class="c1">#                 obj_index=obj_index,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a>        <span class="c1">#                 ranking_method=ranking_method,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a>        <span class="c1">#                 with_stats=with_stats,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a>        <span class="c1">#                 move_results_to_device=&quot;cpu&quot;,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a>        <span class="c1">#             ),</span>
<a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a>        <span class="c1">#         )</span>
<a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a>        <span class="c1">#         for i in range(num_actors)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a>        <span class="c1">#     ]</span>
<a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a>        <span class="c1"># )</span>
<a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a>        <span class="c1">#</span>
<a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a>        <span class="c1"># # At this point, all the tensors within our collected results are on the CPU.</span>
<a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a>        <span class="c1">#</span>
<a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a>        <span class="c1"># if torch.device(self.device) != torch.device(&quot;cpu&quot;):</span>
<a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a>        <span class="c1">#     # If the main device of this problem instance is not CPU, then we move the tensors to the main device.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a>        <span class="c1">#     result = cast_tensors_in_container(result, device=device)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a>        <span class="c1">#</span>
<a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a>        <span class="c1"># if must_sync_after:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a>        <span class="c1">#     # If a post-gradient synchronization is required, we trigger the synchronization operations.</span>
<a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a>        <span class="c1">#     self._sync_after()</span>
<a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a>        <span class="c1"># If the problem is not parallelized, then we request this instance itself to compute the gradients.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gradient_computation_helper</span><span class="p">(</span>
<a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a>            <span class="n">distribution</span><span class="p">,</span>
<a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a>            <span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a>            <span class="n">popsize_max</span><span class="o">=</span><span class="n">popsize_max</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a>            <span class="n">obj_index</span><span class="o">=</span><span class="n">obj_index</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a>            <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a>            <span class="n">num_interactions</span><span class="o">=</span><span class="n">num_interactions</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a>            <span class="n">with_stats</span><span class="o">=</span><span class="n">with_stats</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a>        <span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a>    <span class="c1"># The problem instance in the main process should trigger the `after_grad_hook`.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_main</span><span class="p">:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_after_eval_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grad_hook</span><span class="o">.</span><span class="n">accumulate_dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a>    <span class="c1"># We finally return the results</span>
<a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.RemoteMethod" class="doc doc-heading">
        <code>
RemoteMethod        </code>



<a href="#evotorch.core.RemoteMethod" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Representation of a method on a remote actor's contained Problem
or reinforcement learning environment</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span> <span class="nc">RemoteMethod</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Representation of a method on a remote actor&#39;s contained Problem</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    or reinforcement learning environment</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actors</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">on_env</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_method_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">method_name</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span> <span class="o">=</span> <span class="n">actors</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_on_env</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">on_env</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="k">def</span> <span class="nf">invoke</span><span class="p">(</span><span class="n">actor</span><span class="p">):</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_env</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>                <span class="k">return</span> <span class="n">actor</span><span class="o">.</span><span class="n">call_on_env</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_method_name</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>                <span class="k">return</span> <span class="n">actor</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_method_name</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="k">return</span> <span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="n">invoke</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span> <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actors</span><span class="p">])</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_env</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>            <span class="n">further</span> <span class="o">=</span> <span class="s2">&quot;, on_env=True&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>            <span class="n">further</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_method_name</span><span class="p">)</span><span class="si">}{</span><span class="n">further</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.Solution" class="doc doc-heading">
        <code>
Solution            (<a class="autorefs autorefs-internal" title="evotorch.tools.cloning.Serializable" href="../tools/cloning/#evotorch.tools.cloning.Serializable">Serializable</a>)
        </code>



<a href="#evotorch.core.Solution" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Representation of a single Solution.</p>
<p>A Solution can be a reference to a row of a SolutionBatch
(in which case it shares its storage with the SolutionBatch),
or can be an independent solution.
When the Solution shares its storage with a SolutionBatch,
any modifications to its decision values and/or evaluation
results will affect its parent SolutionBatch as well.</p>
<p>When a Solution object is cloned (via its <code>clone()</code> method,
or via the functions <code>copy.copy(...)</code> and <code>copy.deepcopy(...)</code>,
a new independent Solution object will be created.
This new independent copy will NOT share its storage with
its original SolutionBatch anymore.</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span> <span class="nc">Solution</span><span class="p">(</span><span class="n">Serializable</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Representation of a single Solution.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    A Solution can be a reference to a row of a SolutionBatch</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    (in which case it shares its storage with the SolutionBatch),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    or can be an independent solution.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    When the Solution shares its storage with a SolutionBatch,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    any modifications to its decision values and/or evaluation</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    results will affect its parent SolutionBatch as well.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    When a Solution object is cloned (via its `clone()` method,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">    or via the functions `copy.copy(...)` and `copy.deepcopy(...)`,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    a new independent Solution object will be created.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    This new independent copy will NOT share its storage with</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    its original SolutionBatch anymore.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">        `__init__(...)`: Initialize the Solution object.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">            parent: The parent SolutionBatch which stores the Solution.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">            index: Index of the solution in SolutionBatch.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>                <span class="sa">f</span><span class="s2">&quot;Expected a SolutionBatch as a parent, but encountered </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span><span class="si">}</span><span class="s2">,&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>                <span class="sa">f</span><span class="s2">&quot; which is of type </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>            <span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>        <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>            <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">+</span> <span class="n">index</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent</span><span class="p">))):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid index: </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="p">:</span> <span class="n">SolutionBatch</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">index</span> <span class="p">:</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    <span class="k">def</span> <span class="nf">access_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">keep_evals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="sd">        Access the decision values tensor of the solution.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="sd">        The received tensor will be mutable.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="sd">        By default, it will be assumed that the user wishes to</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="sd">        obtain this tensor to change the decision values, and therefore,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="sd">        the evaluation results associated with this solution will be</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="sd">        cleared (i.e. will be NaN).</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="sd">            keep_evals: When this is set to True, the evaluation results</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="sd">                associated with this solution will be kept (i.e. will NOT</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="sd">                be cleared).</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="sd">            The decision values tensor of the solution.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">access_values</span><span class="p">(</span><span class="n">keep_evals</span><span class="o">=</span><span class="n">keep_evals</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>    <span class="k">def</span> <span class="nf">access_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a><span class="sd">        Access the evaluation results of the solution.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a><span class="sd">        The received tensor will be mutable.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a><span class="sd">            The evaluation results tensor of the solution.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">access_evals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a><span class="sd">        Decision values of the solution</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>    <span class="k">def</span> <span class="nf">evals</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a><span class="sd">        Evaluation results of the solution in a 1-dimensional tensor.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">evals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>    <span class="k">def</span> <span class="nf">evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="sd">        Get the evaluation result.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a><span class="sd">        If the problem is single-objective and the problem does not</span>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a><span class="sd">        allocate any space for extra evaluation data, then a scalar</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a><span class="sd">        is returned.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="sd">        Otherwise, this property becomes equivalent to the `evals`</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a><span class="sd">        property, and a 1-dimensional tensor is returned.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evals</span>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>    <span class="k">def</span> <span class="nf">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a><span class="sd">        Set the decision values of the Solution.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a><span class="sd">        Note that modifying the decision values will result in the</span>
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a><span class="sd">        evaluation results being getting cleared (in more details,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a><span class="sd">        the evaluation results tensor will be filled with NaN values).</span>
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a><span class="sd">            values: New decision values for this Solution.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>        <span class="k">if</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>            <span class="n">value_tensor</span> <span class="o">=</span> <span class="n">ObjectArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>            <span class="n">value_tensor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>            <span class="n">value_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="n">value_tensor</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>    <span class="k">def</span> <span class="nf">set_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">eval_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a><span class="sd">        Set the evaluation results of the Solution.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a><span class="sd">            evals: New evaluation result(s) for the Solution.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a><span class="sd">                For single-objective problems, this argument can be given</span>
<a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a><span class="sd">                as a scalar.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a><span class="sd">                When this argument is given as a scalar (for single-objective</span>
<a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a><span class="sd">                cases) or as a tensor which is long enough to cover for</span>
<a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a><span class="sd">                all the objectives but not for the extra evaluation data,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a><span class="sd">                then the extra evaluation data will be cleared</span>
<a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a><span class="sd">                (in more details, extra evaluation data will be filled with</span>
<a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a><span class="sd">                NaN values).</span>
<a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a><span class="sd">            eval_data: Optionally, the argument `eval_data` can be used to</span>
<a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a><span class="sd">                specify extra evaluation data separately.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a><span class="sd">                `eval_data` is expected as a 1-dimensional sequence.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a>        <span class="n">evals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a>        <span class="k">if</span> <span class="n">evals</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a>            <span class="n">evals</span> <span class="o">=</span> <span class="n">evals</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a>                <span class="sa">f</span><span class="s2">&quot;`set_evals(...)` method of a Solution expects a 1-dimensional or a 2-dimensional&quot;</span>
<a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a>                <span class="sa">f</span><span class="s2">&quot; evaluation tensor. However, the received evaluation tensor has </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> dimensions&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a>                <span class="sa">f</span><span class="s2">&quot; (having a shape of </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a>            <span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a>        <span class="k">if</span> <span class="n">eval_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a>            <span class="n">eval_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">eval_data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a>            <span class="k">if</span> <span class="n">eval_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a>                    <span class="sa">f</span><span class="s2">&quot;The argument `eval_data` was expected as a 1-dimensional sequence.&quot;</span>
<a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a>                    <span class="sa">f</span><span class="s2">&quot; However, the shape of `eval_data` is </span><span class="si">{</span><span class="n">eval_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a>                <span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">eval_data</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a>    <span class="k">def</span> <span class="nf">set_evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluation</span><span class="p">:</span> <span class="n">RealOrVector</span><span class="p">,</span> <span class="n">eval_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a><span class="sd">        Set the evaluation results of the Solution.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a><span class="sd">        This method is an alias for `set_evals(...)`, added for having</span>
<a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a><span class="sd">        a setter counterpart for the `evaluation` property of the Solution</span>
<a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a><span class="sd">        class.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a><span class="sd">            evals: New evaluation result(s) for the Solution.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a><span class="sd">                For single-objective problems, this argument can be given</span>
<a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a><span class="sd">                as a scalar.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a><span class="sd">                When this argument is given as a scalar (for single-objective</span>
<a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a><span class="sd">                cases) or as a tensor which is long enough to cover for</span>
<a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a><span class="sd">                all the objectives but not for the extra evaluation data,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a><span class="sd">                then the extra evaluation data will be cleared</span>
<a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a><span class="sd">                (in more details, extra evaluation data will be filled with</span>
<a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a><span class="sd">                NaN values).</span>
<a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a><span class="sd">            eval_data: Optionally, the argument `eval_data` can be used to</span>
<a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a><span class="sd">                specify extra evaluation data separately.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a><span class="sd">                `eval_data` is expected as a 1-dimensional sequence.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="n">evaluation</span><span class="p">,</span> <span class="n">eval_data</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a>    <span class="k">def</span> <span class="nf">objective_sense</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectiveSense</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a><span class="sd">        Get the objective sense(s) of this Solution&#39;s associated Problem.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a><span class="sd">        If the problem is single-objective, then a single string is returned.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a><span class="sd">        If the problem is multi-objective, then the objective senses will be</span>
<a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a><span class="sd">        returned in a list.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a><span class="sd">        The returned string in the single-objective case, or each returned</span>
<a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a><span class="sd">        string in the multi-objective case, is &quot;min&quot; or &quot;max&quot;.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">objective_sense</span>
<a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a>    <span class="k">def</span> <span class="nf">senses</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a><span class="sd">        Objective sense(s) of this Solution&#39;s associated Problem.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a><span class="sd">        This is a list of strings, each string being &quot;min&quot; or &quot;max&quot;.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">senses</span>
<a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a>    <span class="k">def</span> <span class="nf">is_evaluated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a><span class="sd">        Whether or not the Solution is fully evaluated.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a><span class="sd">        This property returns True only when all of the evaluation results</span>
<a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a><span class="sd">        for all objectives have numeric values other than NaN.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a><span class="sd">        This property assumes that the extra evaluation data is optional,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a><span class="sd">        and therefore does not take into consideration whether or not the</span>
<a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a><span class="sd">        extra evaluation data contains NaN values.</span>
<a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a><span class="sd">        In other words, while determining whether or not a solution is fully</span>
<a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a><span class="sd">        evaluated, only the evaluation results corresponding to the</span>
<a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a><span class="sd">        objectives are taken into account.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a>        <span class="n">num_objs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a>            <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">evals</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">num_objs</span><span class="p">])))</span>
<a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DType</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a><span class="sd">        dtype of the decision values</span>
<a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a>    <span class="k">def</span> <span class="nf">device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Device</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a><span class="sd">        The device storing the Solution</span>
<a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a>    <span class="k">def</span> <span class="nf">eval_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DType</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a><span class="sd">        dtype of the evaluation results</span>
<a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">eval_dtype</span>
<a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a>    <span class="k">def</span> <span class="nf">_rightmost_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a>            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])])</span>
<a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a>            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([])</span>
<a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a><span class="sd">        Shape of the decision values of the Solution</span>
<a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rightmost_shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">values_shape</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a><span class="sd">        Shape of the decision values of the Solution</span>
<a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a>    <span class="k">def</span> <span class="nf">eval_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a><span class="sd">        Shape of the evaluation results</span>
<a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rightmost_shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">eval_shape</span><span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a><span class="sd">        Number of dimensions of the decision values.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a><span class="sd">        For numeric solutions (e.g. of dtype `torch.float32`), this returns</span>
<a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a><span class="sd">        1, since such numeric solutions are kepts as 1-dimensional vectors.</span>
<a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a><span class="sd">        When dtype is `object`, `ndim` is reported as whatever the contained</span>
<a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a><span class="sd">        object reports as its `ndim`, or 0 if the contained object does not</span>
<a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a><span class="sd">        have an `ndim` attribute.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="s2">&quot;ndim&quot;</span><span class="p">):</span>
<a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a>            <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="n">ndim</span>
<a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a>            <span class="k">return</span> <span class="mi">0</span>
<a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a>    <span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a><span class="sd">        This method returns the `ndim` attribute of this Solution.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span>
<a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span>
<a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a>    <span class="k">def</span> <span class="fm">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="fm">__reversed__</span><span class="p">()</span>
<a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a>    <span class="k">def</span> <span class="nf">_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a>        <span class="n">clsname</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a>        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">access_values</span><span class="p">(</span><span class="n">keep_evals</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a>        <span class="n">evals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">access_evals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a>        <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
<a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a>            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a>                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
<a id="__codelineno-0-313" name="__codelineno-0-313" href="#__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314" href="#__codelineno-0-314"></a>        <span class="n">write</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="n">clsname</span><span class="p">,</span> <span class="s2">&quot; values=&quot;</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315" href="#__codelineno-0-315"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">evals</span><span class="p">)):</span>
<a id="__codelineno-0-316" name="__codelineno-0-316" href="#__codelineno-0-316"></a>            <span class="n">write</span><span class="p">(</span><span class="s2">&quot;, evals=&quot;</span><span class="p">,</span> <span class="n">evals</span><span class="p">)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317" href="#__codelineno-0-317"></a>        <span class="n">write</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318" href="#__codelineno-0-318"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319" href="#__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320" href="#__codelineno-0-320"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321" href="#__codelineno-0-321"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_string</span><span class="p">()</span>
<a id="__codelineno-0-322" name="__codelineno-0-322" href="#__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323" href="#__codelineno-0-323"></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324" href="#__codelineno-0-324"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_string</span><span class="p">()</span>
<a id="__codelineno-0-325" name="__codelineno-0-325" href="#__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326" href="#__codelineno-0-326"></a>    <span class="k">def</span> <span class="nf">_get_cloned_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">memo</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327" href="#__codelineno-0-327"></a>        <span class="k">with</span> <span class="n">_no_grad_if_basic_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-328" name="__codelineno-0-328" href="#__codelineno-0-328"></a>            <span class="k">return</span> <span class="n">deep_clone</span><span class="p">(</span>
<a id="__codelineno-0-329" name="__codelineno-0-329" href="#__codelineno-0-329"></a>                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330" href="#__codelineno-0-330"></a>                <span class="n">otherwise_deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-331" name="__codelineno-0-331" href="#__codelineno-0-331"></a>                <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332" href="#__codelineno-0-332"></a>            <span class="p">)</span>
<a id="__codelineno-0-333" name="__codelineno-0-333" href="#__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334" href="#__codelineno-0-334"></a>    <span class="k">def</span> <span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Device</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Solution&quot;</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335" href="#__codelineno-0-335"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-336" name="__codelineno-0-336" href="#__codelineno-0-336"></a><span class="sd">        Get the counterpart of this Solution on the new device.</span>
<a id="__codelineno-0-337" name="__codelineno-0-337" href="#__codelineno-0-337"></a>
<a id="__codelineno-0-338" name="__codelineno-0-338" href="#__codelineno-0-338"></a><span class="sd">        If the specified device is the device of this Solution,</span>
<a id="__codelineno-0-339" name="__codelineno-0-339" href="#__codelineno-0-339"></a><span class="sd">        then this Solution itself is returned.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340" href="#__codelineno-0-340"></a><span class="sd">        If the specified device is a different device, then a clone</span>
<a id="__codelineno-0-341" name="__codelineno-0-341" href="#__codelineno-0-341"></a><span class="sd">        of this Solution on this different device is first</span>
<a id="__codelineno-0-342" name="__codelineno-0-342" href="#__codelineno-0-342"></a><span class="sd">        created, and then this new clone is returned.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343" href="#__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344" href="#__codelineno-0-344"></a><span class="sd">        Please note that the `to(...)` method is not supported when</span>
<a id="__codelineno-0-345" name="__codelineno-0-345" href="#__codelineno-0-345"></a><span class="sd">        the dtype is `object`.</span>
<a id="__codelineno-0-346" name="__codelineno-0-346" href="#__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347" href="#__codelineno-0-347"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348" href="#__codelineno-0-348"></a><span class="sd">            device: The device on which the resulting Solution</span>
<a id="__codelineno-0-349" name="__codelineno-0-349" href="#__codelineno-0-349"></a><span class="sd">                will be stored.</span>
<a id="__codelineno-0-350" name="__codelineno-0-350" href="#__codelineno-0-350"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351" href="#__codelineno-0-351"></a><span class="sd">            The Solution on the specified device.</span>
<a id="__codelineno-0-352" name="__codelineno-0-352" href="#__codelineno-0-352"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353" href="#__codelineno-0-353"></a>        <span class="k">return</span> <span class="n">Solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354" href="#__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355" href="#__codelineno-0-355"></a>    <span class="k">def</span> <span class="nf">to_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356" href="#__codelineno-0-356"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-357" name="__codelineno-0-357" href="#__codelineno-0-357"></a><span class="sd">        Get the single-row SolutionBatch counterpart of the Solution.</span>
<a id="__codelineno-0-358" name="__codelineno-0-358" href="#__codelineno-0-358"></a><span class="sd">        The returned SolutionBatch and the Solution have shared</span>
<a id="__codelineno-0-359" name="__codelineno-0-359" href="#__codelineno-0-359"></a><span class="sd">        storage, meaning that modifying one of them affects the other.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360" href="#__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361" href="#__codelineno-0-361"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-362" name="__codelineno-0-362" href="#__codelineno-0-362"></a><span class="sd">            The SolutionBatch counterpart of the Solution.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363" href="#__codelineno-0-363"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364" href="#__codelineno-0-364"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.device" class="doc doc-heading">
<code class="highlight language-python"><span class="n">device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.device" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The device storing the Solution</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.dtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">Type</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.dtype" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>dtype of the decision values</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.eval_dtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">Type</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.eval_dtype" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>dtype of the evaluation results</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.eval_shape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_shape</span><span class="p">:</span> <span class="n">Size</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.eval_shape" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Shape of the evaluation results</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.evals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">evals</span><span class="p">:</span> <span class="n">Tensor</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.evals" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Evaluation results of the solution in a 1-dimensional tensor.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.evaluation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">evaluation</span><span class="p">:</span> <span class="n">Tensor</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.evaluation" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the evaluation result.</p>
<p>If the problem is single-objective and the problem does not
allocate any space for extra evaluation data, then a scalar
is returned.
Otherwise, this property becomes equivalent to the <code>evals</code>
property, and a 1-dimensional tensor is returned.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.is_evaluated" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_evaluated</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.is_evaluated" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Whether or not the Solution is fully evaluated.</p>
<p>This property returns True only when all of the evaluation results
for all objectives have numeric values other than NaN.</p>
<p>This property assumes that the extra evaluation data is optional,
and therefore does not take into consideration whether or not the
extra evaluation data contains NaN values.
In other words, while determining whether or not a solution is fully
evaluated, only the evaluation results corresponding to the
objectives are taken into account.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.ndim" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ndim</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.ndim" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Number of dimensions of the decision values.</p>
<p>For numeric solutions (e.g. of dtype <code>torch.float32</code>), this returns
1, since such numeric solutions are kepts as 1-dimensional vectors.</p>
<p>When dtype is <code>object</code>, <code>ndim</code> is reported as whatever the contained
object reports as its <code>ndim</code>, or 0 if the contained object does not
have an <code>ndim</code> attribute.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.senses" class="doc doc-heading">
<code class="highlight language-python"><span class="n">senses</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.senses" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Objective sense(s) of this Solution's associated Problem.</p>
<p>This is a list of strings, each string being "min" or "max".</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.shape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">shape</span><span class="p">:</span> <span class="n">Size</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.shape" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Shape of the decision values of the Solution</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.Solution.values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">values</span><span class="p">:</span> <span class="n">Any</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.Solution.values" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Decision values of the solution</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.Solution.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p><code>__init__(...)</code>: Initialize the Solution object.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>parent</code></td>
        <td><code>SolutionBatch</code></td>
        <td><p>The parent SolutionBatch which stores the Solution.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>index</code></td>
        <td><code>int</code></td>
        <td><p>Index of the solution in SolutionBatch.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    `__init__(...)`: Initialize the Solution object.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">        parent: The parent SolutionBatch which stores the Solution.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">        index: Index of the solution in SolutionBatch.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>            <span class="sa">f</span><span class="s2">&quot;Expected a SolutionBatch as a parent, but encountered </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span><span class="si">}</span><span class="s2">,&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>            <span class="sa">f</span><span class="s2">&quot; which is of type </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> <span class="o">+</span> <span class="n">index</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parent</span><span class="p">))):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid index: </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="p">:</span> <span class="n">SolutionBatch</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">index</span> <span class="p">:</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>








  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.access_evals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">access_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Solution.access_evals" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Access the evaluation results of the solution.
The received tensor will be mutable.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tensor</code></td>
      <td><p>The evaluation results tensor of the solution.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">access_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Access the evaluation results of the solution.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    The received tensor will be mutable.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">        The evaluation results tensor of the solution.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">access_evals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.access_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">access_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">keep_evals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#evotorch.core.Solution.access_values" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Access the decision values tensor of the solution.
The received tensor will be mutable.</p>
<p>By default, it will be assumed that the user wishes to
obtain this tensor to change the decision values, and therefore,
the evaluation results associated with this solution will be
cleared (i.e. will be NaN).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>keep_evals</code></td>
        <td><code>bool</code></td>
        <td><p>When this is set to True, the evaluation results
associated with this solution will be kept (i.e. will NOT
be cleared).</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tensor</code></td>
      <td><p>The decision values tensor of the solution.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">access_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">keep_evals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Access the decision values tensor of the solution.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    The received tensor will be mutable.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    By default, it will be assumed that the user wishes to</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    obtain this tensor to change the decision values, and therefore,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    the evaluation results associated with this solution will be</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    cleared (i.e. will be NaN).</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">        keep_evals: When this is set to True, the evaluation results</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">            associated with this solution will be kept (i.e. will NOT</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">            be cleared).</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">        The decision values tensor of the solution.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">access_values</span><span class="p">(</span><span class="n">keep_evals</span><span class="o">=</span><span class="n">keep_evals</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.dim" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Solution.dim" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>This method returns the <code>ndim</code> attribute of this Solution.</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    This method returns the `ndim` attribute of this Solution.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.objective_sense" class="doc doc-heading">
<code class="highlight language-python"><span class="n">objective_sense</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Solution.objective_sense" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the objective sense(s) of this Solution's associated Problem.</p>
<p>If the problem is single-objective, then a single string is returned.
If the problem is multi-objective, then the objective senses will be
returned in a list.</p>
<p>The returned string in the single-objective case, or each returned
string in the multi-objective case, is "min" or "max".</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">objective_sense</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectiveSense</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Get the objective sense(s) of this Solution&#39;s associated Problem.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    If the problem is single-objective, then a single string is returned.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    If the problem is multi-objective, then the objective senses will be</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    returned in a list.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    The returned string in the single-objective case, or each returned</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    string in the multi-objective case, is &quot;min&quot; or &quot;max&quot;.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">objective_sense</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.set_evals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="n">eval_data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.Solution.set_evals" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Set the evaluation results of the Solution.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>evals</code></td>
        <td><code>Tensor</code></td>
        <td><p>New evaluation result(s) for the Solution.
For single-objective problems, this argument can be given
as a scalar.
When this argument is given as a scalar (for single-objective
cases) or as a tensor which is long enough to cover for
all the objectives but not for the extra evaluation data,
then the extra evaluation data will be cleared
(in more details, extra evaluation data will be filled with
NaN values).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>eval_data</code></td>
        <td><code>Optional[Iterable]</code></td>
        <td><p>Optionally, the argument <code>eval_data</code> can be used to
specify extra evaluation data separately.
<code>eval_data</code> is expected as a 1-dimensional sequence.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">set_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">eval_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Set the evaluation results of the Solution.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">        evals: New evaluation result(s) for the Solution.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">            For single-objective problems, this argument can be given</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">            as a scalar.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">            When this argument is given as a scalar (for single-objective</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">            cases) or as a tensor which is long enough to cover for</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">            all the objectives but not for the extra evaluation data,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">            then the extra evaluation data will be cleared</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">            (in more details, extra evaluation data will be filled with</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">            NaN values).</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">        eval_data: Optionally, the argument `eval_data` can be used to</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">            specify extra evaluation data separately.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">            `eval_data` is expected as a 1-dimensional sequence.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">evals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="k">if</span> <span class="n">evals</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="n">evals</span> <span class="o">=</span> <span class="n">evals</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>            <span class="sa">f</span><span class="s2">&quot;`set_evals(...)` method of a Solution expects a 1-dimensional or a 2-dimensional&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>            <span class="sa">f</span><span class="s2">&quot; evaluation tensor. However, the received evaluation tensor has </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> dimensions&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>            <span class="sa">f</span><span class="s2">&quot; (having a shape of </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    <span class="k">if</span> <span class="n">eval_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>        <span class="n">eval_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">eval_data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>        <span class="k">if</span> <span class="n">eval_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>                <span class="sa">f</span><span class="s2">&quot;The argument `eval_data` was expected as a 1-dimensional sequence.&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>                <span class="sa">f</span><span class="s2">&quot; However, the shape of `eval_data` is </span><span class="si">{</span><span class="n">eval_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>            <span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">eval_data</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.set_evaluation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluation</span><span class="p">,</span> <span class="n">eval_data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.Solution.set_evaluation" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Set the evaluation results of the Solution.</p>
<p>This method is an alias for <code>set_evals(...)</code>, added for having
a setter counterpart for the <code>evaluation</code> property of the Solution
class.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>evals</code></td>
        <td></td>
        <td><p>New evaluation result(s) for the Solution.
For single-objective problems, this argument can be given
as a scalar.
When this argument is given as a scalar (for single-objective
cases) or as a tensor which is long enough to cover for
all the objectives but not for the extra evaluation data,
then the extra evaluation data will be cleared
(in more details, extra evaluation data will be filled with
NaN values).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>eval_data</code></td>
        <td><code>Optional[Iterable]</code></td>
        <td><p>Optionally, the argument <code>eval_data</code> can be used to
specify extra evaluation data separately.
<code>eval_data</code> is expected as a 1-dimensional sequence.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">set_evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evaluation</span><span class="p">:</span> <span class="n">RealOrVector</span><span class="p">,</span> <span class="n">eval_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Set the evaluation results of the Solution.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    This method is an alias for `set_evals(...)`, added for having</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    a setter counterpart for the `evaluation` property of the Solution</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    class.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">        evals: New evaluation result(s) for the Solution.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">            For single-objective problems, this argument can be given</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">            as a scalar.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">            When this argument is given as a scalar (for single-objective</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">            cases) or as a tensor which is long enough to cover for</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">            all the objectives but not for the extra evaluation data,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">            then the extra evaluation data will be cleared</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">            (in more details, extra evaluation data will be filled with</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">            NaN values).</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">        eval_data: Optionally, the argument `eval_data` can be used to</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">            specify extra evaluation data separately.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">            `eval_data` is expected as a 1-dimensional sequence.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_evals</span><span class="p">(</span><span class="n">evaluation</span><span class="p">,</span> <span class="n">eval_data</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.set_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>


<a href="#evotorch.core.Solution.set_values" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Set the decision values of the Solution.</p>
<p>Note that modifying the decision values will result in the
evaluation results being getting cleared (in more details,
the evaluation results tensor will be filled with NaN values).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>values</code></td>
        <td><code>Any</code></td>
        <td><p>New decision values for this Solution.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Set the decision values of the Solution.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    Note that modifying the decision values will result in the</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    evaluation results being getting cleared (in more details,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    the evaluation results tensor will be filled with NaN values).</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">        values: New decision values for this Solution.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">if</span> <span class="n">is_dtype_object</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="n">value_tensor</span> <span class="o">=</span> <span class="n">ObjectArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="n">value_tensor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="n">value_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">set_values</span><span class="p">(</span><span class="n">value_tensor</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.size" class="doc doc-heading">
<code class="highlight language-python"><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Solution.size" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Shape of the decision values of the Solution</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Shape of the decision values of the Solution</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></code>


<a href="#evotorch.core.Solution.to" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the counterpart of this Solution on the new device.</p>
<p>If the specified device is the device of this Solution,
then this Solution itself is returned.
If the specified device is a different device, then a clone
of this Solution on this different device is first
created, and then this new clone is returned.</p>
<p>Please note that the <code>to(...)</code> method is not supported when
the dtype is <code>object</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>device</code></td>
        <td><code>Union[str, torch.device]</code></td>
        <td><p>The device on which the resulting Solution
will be stored.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Solution</code></td>
      <td><p>The Solution on the specified device.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Device</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Solution&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Get the counterpart of this Solution on the new device.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    If the specified device is the device of this Solution,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    then this Solution itself is returned.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    If the specified device is a different device, then a clone</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    of this Solution on this different device is first</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    created, and then this new clone is returned.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    Please note that the `to(...)` method is not supported when</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    the dtype is `object`.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">        device: The device on which the resulting Solution</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">            will be stored.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">        The Solution on the specified device.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="k">return</span> <span class="n">Solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.Solution.to_batch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.Solution.to_batch" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the single-row SolutionBatch counterpart of the Solution.
The returned SolutionBatch and the Solution have shared
storage, meaning that modifying one of them affects the other.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>SolutionBatch</code></td>
      <td><p>The SolutionBatch counterpart of the Solution.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">to_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Get the single-row SolutionBatch counterpart of the Solution.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    The returned SolutionBatch and the Solution have shared</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    storage, meaning that modifying one of them affects the other.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">        The SolutionBatch counterpart of the Solution.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.SolutionBatch" class="doc doc-heading">
        <code>
SolutionBatch            (<a class="autorefs autorefs-internal" title="evotorch.tools.cloning.Serializable" href="../tools/cloning/#evotorch.tools.cloning.Serializable">Serializable</a>)
        </code>



<a href="#evotorch.core.SolutionBatch" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Representation of a batch of solutions.</p>
<p>A SolutionBatch stores the decision values of multiple solutions
in a single contiguous tensor. For numeric and fixed-length
problems, this contiguous tensor is a PyTorch tensor.
For not-necessarily-numeric and not-necessarily-fixed-length
problems, this contiguous tensor is an ObjectArray.</p>
<p>The evalution results and extra evaluation data of the solutions
are also stored in an additional contiguous tensor.</p>
<p>Interface-wise, a SolutionBatch behaves like a sequence of
Solution objects. One can get single Solution from a SolutionBatch
via the indexing operator (<code>[]</code>).
Additionally, one can iterate over each solution using
the <code>for ... in ...</code> statement.</p>
<p>One can also get a slice of a SolutionBatch.
The slicing of a SolutionBatch results in a new SolutionBatch.
With simple slicing, the obtained SolutionBatch shares its
memory with the original SolutionBatch.
With advanced slicing (i.e. the kind of slicing where the
solution indices are specified one by one, like:
<code>mybatch[[0, 4, 2, 5]]</code>), the obtained SolutionBatch is a copy,
and does not share any memory with its original.</p>
<p>The decision values of all the stored solutions in the batch
can be obtained in a read-only tensor via:</p>
<div class="highlight"><pre><span></span><code>values = batch.values
</code></pre></div>
<p>If one has modified decision values and wishes to put them
into the batch, the <code>set_values(...)</code> method can be used
as follows:</p>
<div class="highlight"><pre><span></span><code>batch.set_values(modified_values)
</code></pre></div>
<p>The evaluation results of the solutions can be obtained
in a read-only tensor via:</p>
<div class="highlight"><pre><span></span><code>evals = batch.evals
</code></pre></div>
<p>If one has newly computed evaluation results, and wishes
to put them into the batch, the <code>set_evals(...)</code> method
can be used as follows:</p>
<div class="highlight"><pre><span></span><code>batch.set_evals(newly_computed_evals)
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span> <span class="nc">SolutionBatch</span><span class="p">(</span><span class="n">Serializable</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Representation of a batch of solutions.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    A SolutionBatch stores the decision values of multiple solutions</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    in a single contiguous tensor. For numeric and fixed-length</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    problems, this contiguous tensor is a PyTorch tensor.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    For not-necessarily-numeric and not-necessarily-fixed-length</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    problems, this contiguous tensor is an ObjectArray.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    The evalution results and extra evaluation data of the solutions</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    are also stored in an additional contiguous tensor.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    Interface-wise, a SolutionBatch behaves like a sequence of</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    Solution objects. One can get single Solution from a SolutionBatch</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    via the indexing operator (`[]`).</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    Additionally, one can iterate over each solution using</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">    the `for ... in ...` statement.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">    One can also get a slice of a SolutionBatch.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">    The slicing of a SolutionBatch results in a new SolutionBatch.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">    With simple slicing, the obtained SolutionBatch shares its</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">    memory with the original SolutionBatch.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">    With advanced slicing (i.e. the kind of slicing where the</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">    solution indices are specified one by one, like:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">    `mybatch[[0, 4, 2, 5]]`), the obtained SolutionBatch is a copy,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">    and does not share any memory with its original.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">    The decision values of all the stored solutions in the batch</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">    can be obtained in a read-only tensor via:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="sd">        values = batch.values</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="sd">    If one has modified decision values and wishes to put them</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="sd">    into the batch, the `set_values(...)` method can be used</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="sd">    as follows:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="sd">        batch.set_values(modified_values)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="sd">    The evaluation results of the solutions can be obtained</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="sd">    in a read-only tensor via:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="sd">        evals = batch.evals</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="sd">    If one has newly computed evaluation results, and wishes</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="sd">    to put them into the batch, the `set_evals(...)` method</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="sd">    can be used as follows:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="sd">        batch.set_evals(newly_computed_evals)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>        <span class="n">problem</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Problem</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>        <span class="n">popsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>        <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Device</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>        <span class="n">slice_of</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">SolutionBatchSliceInfo</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>        <span class="n">like</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;SolutionBatch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>        <span class="n">merging_of</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;SolutionBatch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>        <span class="n">empty</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>    <span class="p">):</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">]</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_slice</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IndicesOrSlice</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>        <span class="k">if</span> <span class="n">slice_of</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>            <span class="n">expect_none</span><span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>                <span class="s2">&quot;While making a new SolutionBatch via slicing&quot;</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>                <span class="n">problem</span><span class="o">=</span><span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>                <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>                <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>                <span class="n">merging_of</span><span class="o">=</span><span class="n">merging_of</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>                <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>                <span class="n">empty</span><span class="o">=</span><span class="n">empty</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>            <span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>            <span class="n">source</span><span class="p">:</span> <span class="s2">&quot;SolutionBatch&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>            <span class="n">slice_info</span><span class="p">:</span> <span class="n">IndicesOrSlice</span>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>            <span class="n">source</span><span class="p">,</span> <span class="n">slice_info</span> <span class="o">=</span> <span class="n">slice_of</span>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>            <span class="k">def</span> <span class="nf">safe_slice</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">slice_info</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>                <span class="n">d0</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ndim</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>                <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">slice_info</span><span class="p">]</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>                <span class="n">d1</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ndim</span>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>                <span class="k">if</span> <span class="n">d0</span> <span class="o">!=</span> <span class="n">d1</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>                        <span class="s2">&quot;Encountered an illegal slicing operation which would&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>                        <span class="s2">&quot; change the shape of the stored tensor(s) of the&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>                        <span class="s2">&quot; SolutionBatch.&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>                    <span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>                <span class="k">return</span> <span class="n">t</span>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>            <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>                <span class="c1"># self._data = source._data[slice_info]</span>
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>                <span class="c1"># self._evdata = source._evdata[slice_info]</span>
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">safe_slice</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">slice_info</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span> <span class="o">=</span> <span class="n">safe_slice</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">_evdata</span><span class="p">,</span> <span class="n">slice_info</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_slice</span> <span class="o">=</span> <span class="n">slice_info</span>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">_descending</span>
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>            <span class="n">shares_storage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">storage</span><span class="p">()</span><span class="o">.</span><span class="n">data_ptr</span><span class="p">()</span> <span class="o">==</span> <span class="n">source</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">storage</span><span class="p">()</span><span class="o">.</span><span class="n">data_ptr</span><span class="p">()</span>
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">shares_storage</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">_num_objs</span>
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>        <span class="k">elif</span> <span class="n">like</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>            <span class="n">expect_none</span><span class="p">(</span>
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>                <span class="s2">&quot;While making a new SolutionBatch via the like=... argument&quot;</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>                <span class="n">merging_of</span><span class="o">=</span><span class="n">merging_of</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>                <span class="n">slice_of</span><span class="o">=</span><span class="n">slice_of</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>            <span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">empty_tensor_like</span><span class="p">(</span><span class="n">like</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span> <span class="o">=</span> <span class="n">empty_tensor_like</span><span class="p">(</span><span class="n">like</span><span class="o">.</span><span class="n">_evdata</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span> <span class="o">=</span> <span class="n">like</span><span class="o">.</span><span class="n">_descending</span>
<a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">=</span> <span class="n">like</span><span class="o">.</span><span class="n">_num_objs</span>
<a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">_opt_bool</span><span class="p">(</span><span class="n">empty</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_fill_via_problem</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a>        <span class="k">elif</span> <span class="n">merging_of</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a>            <span class="n">expect_none</span><span class="p">(</span>
<a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a>                <span class="s2">&quot;While making a new SolutionBatch via merging&quot;</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a>                <span class="n">problem</span><span class="o">=</span><span class="n">problem</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a>                <span class="n">popsize</span><span class="o">=</span><span class="n">popsize</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a>                <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a>                <span class="n">slice_of</span><span class="o">=</span><span class="n">slice_of</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a>                <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a>                <span class="n">empty</span><span class="o">=</span><span class="n">empty</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a>            <span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a>            <span class="c1"># Convert `merging_of` into a list.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a>            <span class="c1"># While doing that, also count the total number of rows</span>
<a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a>            <span class="n">batches</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a>            <span class="n">total_rows</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a>            <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">merging_of</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a>                <span class="n">total_rows</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a>                <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a>            <span class="c1"># Get essential attributes from the first batch</span>
<a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">batches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_descending</span><span class="p">)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">=</span> <span class="n">batches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_num_objs</span>
<a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">):</span>
<a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a>                <span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a>                    <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">ObjectArray</span><span class="p">(</span><span class="n">total_rows</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a>                <span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a>                    <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">empty_tensor_like</span><span class="p">(</span><span class="n">batches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">total_rows</span><span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span> <span class="o">=</span> <span class="n">empty_tensor_like</span><span class="p">(</span><span class="n">batches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_evdata</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">total_rows</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a>            <span class="n">row_begin</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a>            <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">batches</span><span class="p">:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a>                <span class="n">row_end</span> <span class="o">=</span> <span class="n">row_begin</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">row_begin</span><span class="p">:</span><span class="n">row_end</span><span class="p">]</span> <span class="o">=</span> <span class="n">process_data</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">row_begin</span><span class="p">:</span><span class="n">row_end</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">_evdata</span>
<a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a>                <span class="n">row_begin</span> <span class="o">=</span> <span class="n">row_end</span>
<a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a>        <span class="k">elif</span> <span class="n">problem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a>            <span class="n">expect_none</span><span class="p">(</span>
<a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a>                <span class="s2">&quot;While making a new SolutionBatch with a given problem&quot;</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a>                <span class="n">slice_of</span><span class="o">=</span><span class="n">slice_of</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a>                <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a>                <span class="n">merging_of</span><span class="o">=</span><span class="n">merging_of</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a>            <span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a>            <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a>                <span class="n">device</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a>            <span class="k">if</span> <span class="n">problem</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="nb">object</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a>                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot create a batch containing arbitrary objects on a device other than cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">ObjectArray</span><span class="p">(</span><span class="n">popsize</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">popsize</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">solution_length</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">_opt_bool</span><span class="p">(</span><span class="n">empty</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">generate_values</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">))</span>
<a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">make_nan</span><span class="p">(</span>
<a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a>                <span class="n">popsize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">+</span> <span class="n">problem</span><span class="o">.</span><span class="n">eval_data_length</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">use_eval_dtype</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a>            <span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_obj_order_descending</span><span class="p">()</span>
<a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid call to the __init__(...) of SolutionBatch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a>    <span class="k">def</span> <span class="nf">_normalize_row_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a>        <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a>        <span class="n">org_i</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a>            <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">i</span>
<a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)):</span>
<a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid row: </span><span class="si">{</span><span class="n">org_i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a>        <span class="k">return</span> <span class="n">i</span>
<a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a>    <span class="k">def</span> <span class="nf">_normalize_obj_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a>        <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a>        <span class="n">org_i</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a>            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">+</span> <span class="n">i</span>
<a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span><span class="p">)):</span>
<a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid objective index: </span><span class="si">{</span><span class="n">org_i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a>        <span class="k">return</span> <span class="n">i</span>
<a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a>    <span class="k">def</span> <span class="nf">_optionally_get_obj_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a>        <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a>                    <span class="sa">f</span><span class="s2">&quot;The objective index was given as None.&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a>                    <span class="sa">f</span><span class="s2">&quot; However, the number of objectives is not 1,&quot;</span>
<a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a>                    <span class="sa">f</span><span class="s2">&quot; it is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a>                    <span class="sa">f</span><span class="s2">&quot; Therefore, the objective index is not optional,&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a>                    <span class="sa">f</span><span class="s2">&quot; and must be provided as an integer, not as None.&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a>                <span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a>            <span class="k">return</span> <span class="mi">0</span>
<a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_obj_index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a>    <span class="k">def</span> <span class="nf">argsort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a>        <span class="sd">&quot;&quot;&quot;Return the indices of solutions, sorted from best to worst.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a><span class="sd">            obj_index: The objective index. Can be passed as None</span>
<a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a><span class="sd">                if the problem is single-objective. Otherwise,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a><span class="sd">                expected as an int.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a><span class="sd">            A PyTorch tensor, containing the solution indices,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a><span class="sd">            sorted from the best solution to the worst.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a>        <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optionally_get_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a>        <span class="n">descending</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">[</span><span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a>        <span class="n">ev_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:,</span> <span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a>        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">ev_col</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="n">descending</span><span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a>    <span class="k">def</span> <span class="nf">arg_pareto_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crowdsort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">crowdsort_upto</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParetoInfo</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a><span class="sd">        Pareto-sort the solutions in the batch.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a><span class="sd">        The result is a namedtuple consisting of two elements:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a><span class="sd">        `fronts` and `ranks`.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a><span class="sd">        Let us assume that we have 5 solutions, and after a</span>
<a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a><span class="sd">        pareto-sorting they ended up in this order:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a><span class="sd">            front 0 (best front) : solution 1, solution 2</span>
<a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a><span class="sd">            front 1              : solution 0, solution 4</span>
<a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a><span class="sd">            front 2 (worst front): solution 3</span>
<a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a><span class="sd">        Considering the example ordering above, the returned</span>
<a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a><span class="sd">        ParetoInfo instance looks like this:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a><span class="sd">            ParetoInfo(</span>
<a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a><span class="sd">                fronts=[[1, 2], [0, 4], [3]],</span>
<a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a><span class="sd">                ranks=tensor([1, 0, 0, 2, 1])</span>
<a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a><span class="sd">            )</span>
<a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a><span class="sd">        where `fronts` stores the solution indices grouped by</span>
<a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a><span class="sd">        pareto fronts; and `ranks` stores, as a tensor of int64,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a><span class="sd">        the pareto rank for each solution (where 0 means best</span>
<a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a><span class="sd">        rank).</span>
<a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a><span class="sd">            crowdsort: If given as True, each front in itself</span>
<a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a><span class="sd">                will be sorted from the least crowding solution</span>
<a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a><span class="sd">                to the most crowding solution.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a><span class="sd">                If given as False, there will be no crowd-sorting.</span>
<a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a><span class="sd">            crowdsort_upto: To be used with `crowdsort=True`.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a><span class="sd">                If given as an integer n, crowd-sorting will be done</span>
<a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a><span class="sd">                only in the fronts containing the first n solutions</span>
<a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a><span class="sd">                of the population.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a><span class="sd">                If given as None (and if `crowdsort=True`),</span>
<a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a><span class="sd">                crowd-sorting will be done for each front.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a><span class="sd">            A ParetoInfo instance</span>
<a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">NumbaLib</span><span class="o">.</span><span class="n">is_found</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a>            <span class="n">NumbaLib</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;arg_pareto_sort&quot;</span><span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a>        <span class="n">utils</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">utils</span><span class="p">()</span>
<a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">crowdsort</span><span class="p">:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a>            <span class="k">if</span> <span class="n">crowdsort_upto</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a>                    <span class="s2">&quot;With the argument `crowdsort` provided as False,&quot;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a>                    <span class="s2">&quot; the argument `crowdsort_upto` was expected as None.&quot;</span>
<a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a>                    <span class="s2">&quot; However, `crowdsort_upto` was found to be something&quot;</span>
<a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a>                    <span class="s2">&quot; other than None.&quot;</span>
<a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a>                <span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a>            <span class="n">fronts</span><span class="p">,</span> <span class="n">ranks</span> <span class="o">=</span> <span class="n">_pareto_sort</span><span class="p">(</span><span class="n">utils</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313" href="#__codelineno-0-313"></a>            <span class="k">if</span> <span class="n">crowdsort_upto</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314" href="#__codelineno-0-314"></a>                <span class="n">crowdsort_upto</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">utils</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315" href="#__codelineno-0-315"></a>            <span class="n">fronts</span><span class="p">,</span> <span class="n">ranks</span> <span class="o">=</span> <span class="n">_pareto_sort</span><span class="p">(</span><span class="n">utils</span><span class="p">,</span> <span class="n">crowdsort</span><span class="p">,</span> <span class="n">crowdsort_upto</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316" href="#__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317" href="#__codelineno-0-317"></a>        <span class="k">return</span> <span class="n">ParetoInfo</span><span class="p">(</span><span class="n">fronts</span><span class="o">=</span><span class="n">fronts</span><span class="p">,</span> <span class="n">ranks</span><span class="o">=</span><span class="n">ranks</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318" href="#__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319" href="#__codelineno-0-319"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-320" name="__codelineno-0-320" href="#__codelineno-0-320"></a>    <span class="k">def</span> <span class="nf">argbest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321" href="#__codelineno-0-321"></a>        <span class="sd">&quot;&quot;&quot;Return the best solution&#39;s index</span>
<a id="__codelineno-0-322" name="__codelineno-0-322" href="#__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323" href="#__codelineno-0-323"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324" href="#__codelineno-0-324"></a><span class="sd">            obj_index: The objective index. Can be passed as None</span>
<a id="__codelineno-0-325" name="__codelineno-0-325" href="#__codelineno-0-325"></a><span class="sd">                if the problem is single-objective. Otherwise,</span>
<a id="__codelineno-0-326" name="__codelineno-0-326" href="#__codelineno-0-326"></a><span class="sd">                expected as an int.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327" href="#__codelineno-0-327"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328" href="#__codelineno-0-328"></a><span class="sd">            The index of the best solution.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329" href="#__codelineno-0-329"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-330" name="__codelineno-0-330" href="#__codelineno-0-330"></a>        <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optionally_get_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331" href="#__codelineno-0-331"></a>        <span class="n">descending</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">[</span><span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-332" name="__codelineno-0-332" href="#__codelineno-0-332"></a>        <span class="n">argf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span> <span class="k">if</span> <span class="n">descending</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmin</span>
<a id="__codelineno-0-333" name="__codelineno-0-333" href="#__codelineno-0-333"></a>        <span class="k">return</span> <span class="n">argf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:,</span> <span class="n">obj_index</span><span class="p">])</span>
<a id="__codelineno-0-334" name="__codelineno-0-334" href="#__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335" href="#__codelineno-0-335"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-336" name="__codelineno-0-336" href="#__codelineno-0-336"></a>    <span class="k">def</span> <span class="nf">argworst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337" href="#__codelineno-0-337"></a>        <span class="sd">&quot;&quot;&quot;Return the worst solution&#39;s index</span>
<a id="__codelineno-0-338" name="__codelineno-0-338" href="#__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339" href="#__codelineno-0-339"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340" href="#__codelineno-0-340"></a><span class="sd">            obj_index: The objective index. Can be passed as None</span>
<a id="__codelineno-0-341" name="__codelineno-0-341" href="#__codelineno-0-341"></a><span class="sd">                if the problem is single-objective. Otherwise,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342" href="#__codelineno-0-342"></a><span class="sd">                expected as an int.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343" href="#__codelineno-0-343"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344" href="#__codelineno-0-344"></a><span class="sd">            The index of the worst solution.</span>
<a id="__codelineno-0-345" name="__codelineno-0-345" href="#__codelineno-0-345"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-346" name="__codelineno-0-346" href="#__codelineno-0-346"></a>        <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optionally_get_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347" href="#__codelineno-0-347"></a>        <span class="n">descending</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">[</span><span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-348" name="__codelineno-0-348" href="#__codelineno-0-348"></a>        <span class="n">argf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmin</span> <span class="k">if</span> <span class="n">descending</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span>
<a id="__codelineno-0-349" name="__codelineno-0-349" href="#__codelineno-0-349"></a>        <span class="k">return</span> <span class="n">argf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:,</span> <span class="n">obj_index</span><span class="p">])</span>
<a id="__codelineno-0-350" name="__codelineno-0-350" href="#__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351" href="#__codelineno-0-351"></a>    <span class="k">def</span> <span class="nf">_get_objective_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i_obj</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-352" name="__codelineno-0-352" href="#__codelineno-0-352"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">[</span><span class="n">i_obj</span><span class="p">]:</span>
<a id="__codelineno-0-353" name="__codelineno-0-353" href="#__codelineno-0-353"></a>            <span class="k">return</span> <span class="mf">1.0</span>
<a id="__codelineno-0-354" name="__codelineno-0-354" href="#__codelineno-0-354"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355" href="#__codelineno-0-355"></a>            <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span>
<a id="__codelineno-0-356" name="__codelineno-0-356" href="#__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357" href="#__codelineno-0-357"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-358" name="__codelineno-0-358" href="#__codelineno-0-358"></a>    <span class="k">def</span> <span class="nf">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">solutions</span><span class="p">:</span> <span class="n">MaybeIndicesOrSlice</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-359" name="__codelineno-0-359" href="#__codelineno-0-359"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-360" name="__codelineno-0-360" href="#__codelineno-0-360"></a><span class="sd">        Set the decision values of the solutions.</span>
<a id="__codelineno-0-361" name="__codelineno-0-361" href="#__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362" href="#__codelineno-0-362"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363" href="#__codelineno-0-363"></a><span class="sd">            values: New decision values.</span>
<a id="__codelineno-0-364" name="__codelineno-0-364" href="#__codelineno-0-364"></a><span class="sd">            solutions: Optionally a list of integer indices or an instance</span>
<a id="__codelineno-0-365" name="__codelineno-0-365" href="#__codelineno-0-365"></a><span class="sd">                of `slice(...)`, to be used if one wishes to set the</span>
<a id="__codelineno-0-366" name="__codelineno-0-366" href="#__codelineno-0-366"></a><span class="sd">                decision values of only some of the solutions.</span>
<a id="__codelineno-0-367" name="__codelineno-0-367" href="#__codelineno-0-367"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-368" name="__codelineno-0-368" href="#__codelineno-0-368"></a>        <span class="k">if</span> <span class="n">solutions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369" href="#__codelineno-0-369"></a>            <span class="n">solutions</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370" href="#__codelineno-0-370"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">solutions</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
<a id="__codelineno-0-371" name="__codelineno-0-371" href="#__codelineno-0-371"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372" href="#__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373" href="#__codelineno-0-373"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-374" name="__codelineno-0-374" href="#__codelineno-0-374"></a>    <span class="k">def</span> <span class="nf">set_evals</span><span class="p">(</span>
<a id="__codelineno-0-375" name="__codelineno-0-375" href="#__codelineno-0-375"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376" href="#__codelineno-0-376"></a>        <span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-377" name="__codelineno-0-377" href="#__codelineno-0-377"></a>        <span class="n">eval_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378" href="#__codelineno-0-378"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379" href="#__codelineno-0-379"></a>        <span class="n">solutions</span><span class="p">:</span> <span class="n">MaybeIndicesOrSlice</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380" href="#__codelineno-0-380"></a>    <span class="p">):</span>
<a id="__codelineno-0-381" name="__codelineno-0-381" href="#__codelineno-0-381"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382" href="#__codelineno-0-382"></a><span class="sd">        Set the evaluations of the solutions.</span>
<a id="__codelineno-0-383" name="__codelineno-0-383" href="#__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384" href="#__codelineno-0-384"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385" href="#__codelineno-0-385"></a><span class="sd">            evals: A numeric tensor which contains the evaluation results.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386" href="#__codelineno-0-386"></a><span class="sd">                Acceptable shapes are as follows:</span>
<a id="__codelineno-0-387" name="__codelineno-0-387" href="#__codelineno-0-387"></a><span class="sd">                `(n,)` only to be used for single-objective problems, sets</span>
<a id="__codelineno-0-388" name="__codelineno-0-388" href="#__codelineno-0-388"></a><span class="sd">                the evaluation results of the target `n` solutions, and clears</span>
<a id="__codelineno-0-389" name="__codelineno-0-389" href="#__codelineno-0-389"></a><span class="sd">                (where clearing means to fill with NaN values)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390" href="#__codelineno-0-390"></a><span class="sd">                extra evaluation data (if the problem has allocations for such</span>
<a id="__codelineno-0-391" name="__codelineno-0-391" href="#__codelineno-0-391"></a><span class="sd">                extra evaluation data);</span>
<a id="__codelineno-0-392" name="__codelineno-0-392" href="#__codelineno-0-392"></a><span class="sd">                `(n,m)` where `m` is the number of objectives, sets the</span>
<a id="__codelineno-0-393" name="__codelineno-0-393" href="#__codelineno-0-393"></a><span class="sd">                evaluation results of the target `n` solutions, and clears</span>
<a id="__codelineno-0-394" name="__codelineno-0-394" href="#__codelineno-0-394"></a><span class="sd">                their extra evaluation data;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395" href="#__codelineno-0-395"></a><span class="sd">                `(n,m+q)` where `m` is the number of objectives and `q` is the</span>
<a id="__codelineno-0-396" name="__codelineno-0-396" href="#__codelineno-0-396"></a><span class="sd">                length of extra evaluation data, sets the evaluation result</span>
<a id="__codelineno-0-397" name="__codelineno-0-397" href="#__codelineno-0-397"></a><span class="sd">                and extra data of the target `n` solutions.</span>
<a id="__codelineno-0-398" name="__codelineno-0-398" href="#__codelineno-0-398"></a><span class="sd">            eval_data: To be used only when the problem has extra evaluation</span>
<a id="__codelineno-0-399" name="__codelineno-0-399" href="#__codelineno-0-399"></a><span class="sd">                data. Optionally, one can pass the extra evaluation data</span>
<a id="__codelineno-0-400" name="__codelineno-0-400" href="#__codelineno-0-400"></a><span class="sd">                separately via this argument (instead of jointly through</span>
<a id="__codelineno-0-401" name="__codelineno-0-401" href="#__codelineno-0-401"></a><span class="sd">                a single tensor via `evals`).</span>
<a id="__codelineno-0-402" name="__codelineno-0-402" href="#__codelineno-0-402"></a><span class="sd">                The expected shape of this tensor is `(n,q)` where `n`</span>
<a id="__codelineno-0-403" name="__codelineno-0-403" href="#__codelineno-0-403"></a><span class="sd">                is the number of solutions and `q` is the length of the</span>
<a id="__codelineno-0-404" name="__codelineno-0-404" href="#__codelineno-0-404"></a><span class="sd">                extra evaluation data.</span>
<a id="__codelineno-0-405" name="__codelineno-0-405" href="#__codelineno-0-405"></a><span class="sd">            solutions: Optionally a list of integer indices or an instance</span>
<a id="__codelineno-0-406" name="__codelineno-0-406" href="#__codelineno-0-406"></a><span class="sd">                of `slice(...)`, to be used if one wishes to set the</span>
<a id="__codelineno-0-407" name="__codelineno-0-407" href="#__codelineno-0-407"></a><span class="sd">                evaluations of only some of the solutions.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408" href="#__codelineno-0-408"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409" href="#__codelineno-0-409"></a><span class="sd">            ValueError: if the given tensor has an incompatible shape.</span>
<a id="__codelineno-0-410" name="__codelineno-0-410" href="#__codelineno-0-410"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411" href="#__codelineno-0-411"></a>        <span class="k">if</span> <span class="n">solutions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412" href="#__codelineno-0-412"></a>            <span class="n">solutions</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413" href="#__codelineno-0-413"></a>            <span class="n">num_solutions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-414" name="__codelineno-0-414" href="#__codelineno-0-414"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
<a id="__codelineno-0-415" name="__codelineno-0-415" href="#__codelineno-0-415"></a>            <span class="n">num_solutions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-416" name="__codelineno-0-416" href="#__codelineno-0-416"></a>        <span class="k">elif</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">solutions</span><span class="p">):</span>
<a id="__codelineno-0-417" name="__codelineno-0-417" href="#__codelineno-0-417"></a>            <span class="n">num_solutions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">solutions</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418" href="#__codelineno-0-418"></a>        <span class="n">total_eval_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-419" name="__codelineno-0-419" href="#__codelineno-0-419"></a>
<a id="__codelineno-0-420" name="__codelineno-0-420" href="#__codelineno-0-420"></a>        <span class="n">num_objs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span>
<a id="__codelineno-0-421" name="__codelineno-0-421" href="#__codelineno-0-421"></a>        <span class="n">num_data</span> <span class="o">=</span> <span class="n">total_eval_width</span> <span class="o">-</span> <span class="n">num_objs</span>
<a id="__codelineno-0-422" name="__codelineno-0-422" href="#__codelineno-0-422"></a>
<a id="__codelineno-0-423" name="__codelineno-0-423" href="#__codelineno-0-423"></a>        <span class="k">if</span> <span class="n">evals</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424" href="#__codelineno-0-424"></a>            <span class="k">if</span> <span class="n">num_objs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-425" name="__codelineno-0-425" href="#__codelineno-0-425"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-426" name="__codelineno-0-426" href="#__codelineno-0-426"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `set_evals(...)` was given a 1-dimensional tensor.&quot;</span>
<a id="__codelineno-0-427" name="__codelineno-0-427" href="#__codelineno-0-427"></a>                    <span class="sa">f</span><span class="s2">&quot; However, the number of objectives of the problem at hand is </span><span class="si">{</span><span class="n">num_objs</span><span class="si">}</span><span class="s2">, not 1.&quot;</span>
<a id="__codelineno-0-428" name="__codelineno-0-428" href="#__codelineno-0-428"></a>                    <span class="sa">f</span><span class="s2">&quot; 1-dimensional evaluation tensors can only be accepted if the problem&quot;</span>
<a id="__codelineno-0-429" name="__codelineno-0-429" href="#__codelineno-0-429"></a>                    <span class="sa">f</span><span class="s2">&quot; has one objective.&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430" href="#__codelineno-0-430"></a>                <span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431" href="#__codelineno-0-431"></a>            <span class="n">evals</span> <span class="o">=</span> <span class="n">evals</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432" href="#__codelineno-0-432"></a>        <span class="k">elif</span> <span class="n">evals</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433" href="#__codelineno-0-433"></a>            <span class="k">pass</span>  <span class="c1"># nothing to do here</span>
<a id="__codelineno-0-434" name="__codelineno-0-434" href="#__codelineno-0-434"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435" href="#__codelineno-0-435"></a>            <span class="k">if</span> <span class="n">num_objs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436" href="#__codelineno-0-436"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-437" name="__codelineno-0-437" href="#__codelineno-0-437"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `set_evals(...)` received a tensor with </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> dimensions.&quot;</span>
<a id="__codelineno-0-438" name="__codelineno-0-438" href="#__codelineno-0-438"></a>                    <span class="sa">f</span><span class="s2">&quot; Since the problem at hand has only one objective,&quot;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439" href="#__codelineno-0-439"></a>                    <span class="sa">f</span><span class="s2">&quot; 1-dimensional or 2-dimensional tensors are acceptable, but not </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">-dimensional ones.&quot;</span>
<a id="__codelineno-0-440" name="__codelineno-0-440" href="#__codelineno-0-440"></a>                <span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441" href="#__codelineno-0-441"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-442" name="__codelineno-0-442" href="#__codelineno-0-442"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-443" name="__codelineno-0-443" href="#__codelineno-0-443"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `set_evals(...)` received a tensor with </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> dimensions.&quot;</span>
<a id="__codelineno-0-444" name="__codelineno-0-444" href="#__codelineno-0-444"></a>                    <span class="sa">f</span><span class="s2">&quot; Since the problem at hand has more than one objective (there are </span><span class="si">{</span><span class="n">num_objs</span><span class="si">}</span><span class="s2"> objectives),&quot;</span>
<a id="__codelineno-0-445" name="__codelineno-0-445" href="#__codelineno-0-445"></a>                    <span class="sa">f</span><span class="s2">&quot; only 2-dimensional tensors are acceptable, not </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">-dimensional ones.&quot;</span>
<a id="__codelineno-0-446" name="__codelineno-0-446" href="#__codelineno-0-446"></a>                <span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447" href="#__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448" href="#__codelineno-0-448"></a>        <span class="p">[</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">]</span> <span class="o">=</span> <span class="n">evals</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-449" name="__codelineno-0-449" href="#__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450" href="#__codelineno-0-450"></a>        <span class="k">if</span> <span class="n">nrows</span> <span class="o">!=</span> <span class="n">num_solutions</span><span class="p">:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451" href="#__codelineno-0-451"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-452" name="__codelineno-0-452" href="#__codelineno-0-452"></a>                <span class="sa">f</span><span class="s2">&quot;Trying to set the evaluations of </span><span class="si">{</span><span class="n">num_solutions</span><span class="si">}</span><span class="s2"> solutions, but the given tensor has </span><span class="si">{</span><span class="n">nrows</span><span class="si">}</span><span class="s2"> rows.&quot;</span>
<a id="__codelineno-0-453" name="__codelineno-0-453" href="#__codelineno-0-453"></a>            <span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454" href="#__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455" href="#__codelineno-0-455"></a>        <span class="k">if</span> <span class="n">eval_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456" href="#__codelineno-0-456"></a>            <span class="k">if</span> <span class="n">eval_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457" href="#__codelineno-0-457"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-458" name="__codelineno-0-458" href="#__codelineno-0-458"></a>                    <span class="sa">f</span><span class="s2">&quot;The `eval_data` argument was expected as a 2-dimensional tensor.&quot;</span>
<a id="__codelineno-0-459" name="__codelineno-0-459" href="#__codelineno-0-459"></a>                    <span class="sa">f</span><span class="s2">&quot; However, the shape of the given `eval_data` is </span><span class="si">{</span><span class="n">eval_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-460" name="__codelineno-0-460" href="#__codelineno-0-460"></a>                <span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461" href="#__codelineno-0-461"></a>            <span class="k">if</span> <span class="n">eval_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">num_data</span><span class="p">:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462" href="#__codelineno-0-462"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-463" name="__codelineno-0-463" href="#__codelineno-0-463"></a>                    <span class="sa">f</span><span class="s2">&quot;The `eval_data` argument was expected to have </span><span class="si">{</span><span class="n">num_data</span><span class="si">}</span><span class="s2"> columns.&quot;</span>
<a id="__codelineno-0-464" name="__codelineno-0-464" href="#__codelineno-0-464"></a>                    <span class="sa">f</span><span class="s2">&quot; However, the received `eval_data` has the shape: </span><span class="si">{</span><span class="n">eval_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465" href="#__codelineno-0-465"></a>                <span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466" href="#__codelineno-0-466"></a>            <span class="k">if</span> <span class="n">ncols</span> <span class="o">!=</span> <span class="n">num_objs</span><span class="p">:</span>
<a id="__codelineno-0-467" name="__codelineno-0-467" href="#__codelineno-0-467"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-468" name="__codelineno-0-468" href="#__codelineno-0-468"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `set_evals(...)` was used with `evals` and `eval_data` arguments.&quot;</span>
<a id="__codelineno-0-469" name="__codelineno-0-469" href="#__codelineno-0-469"></a>                    <span class="sa">f</span><span class="s2">&quot; When both of these arguments are provided, `evals` is expected either as a 1-dimensional tensor&quot;</span>
<a id="__codelineno-0-470" name="__codelineno-0-470" href="#__codelineno-0-470"></a>                    <span class="sa">f</span><span class="s2">&quot; (for single-objective cases only), or as a tensor of shape (n, m) where n is the number of&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471" href="#__codelineno-0-471"></a>                    <span class="sa">f</span><span class="s2">&quot; solutions, and m is the number of objectives.&quot;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472" href="#__codelineno-0-472"></a>                    <span class="sa">f</span><span class="s2">&quot; However, while the problem at hand has </span><span class="si">{</span><span class="n">num_objs</span><span class="si">}</span><span class="s2"> objectives,&quot;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473" href="#__codelineno-0-473"></a>                    <span class="sa">f</span><span class="s2">&quot; the `evals` tensor has </span><span class="si">{</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns.&quot;</span>
<a id="__codelineno-0-474" name="__codelineno-0-474" href="#__codelineno-0-474"></a>                <span class="p">)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475" href="#__codelineno-0-475"></a>            <span class="k">if</span> <span class="n">evals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">eval_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476" href="#__codelineno-0-476"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The provided `evals` and `eval_data` tensors have incompatible shapes.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477" href="#__codelineno-0-477"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">evals</span><span class="p">,</span> <span class="n">eval_data</span><span class="p">])</span>
<a id="__codelineno-0-478" name="__codelineno-0-478" href="#__codelineno-0-478"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479" href="#__codelineno-0-479"></a>            <span class="k">if</span> <span class="n">ncols</span> <span class="o">==</span> <span class="n">num_objs</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480" href="#__codelineno-0-480"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">,</span> <span class="p">:</span><span class="n">num_objs</span><span class="p">]</span> <span class="o">=</span> <span class="n">evals</span>
<a id="__codelineno-0-481" name="__codelineno-0-481" href="#__codelineno-0-481"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">,</span> <span class="n">num_objs</span><span class="p">:]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482" href="#__codelineno-0-482"></a>            <span class="k">elif</span> <span class="n">ncols</span> <span class="o">==</span> <span class="n">total_eval_width</span><span class="p">:</span>
<a id="__codelineno-0-483" name="__codelineno-0-483" href="#__codelineno-0-483"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">evals</span>
<a id="__codelineno-0-484" name="__codelineno-0-484" href="#__codelineno-0-484"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485" href="#__codelineno-0-485"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486" href="#__codelineno-0-486"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `set_evals(...)` received a tensor with </span><span class="si">{</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns, which is incompatible.&quot;</span>
<a id="__codelineno-0-487" name="__codelineno-0-487" href="#__codelineno-0-487"></a>                    <span class="sa">f</span><span class="s2">&quot; Acceptable number of columns are: </span><span class="si">{</span><span class="n">num_objs</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-488" name="__codelineno-0-488" href="#__codelineno-0-488"></a>                    <span class="sa">f</span><span class="s2">&quot; (for setting only the objective-associated evaluations and leave extra evaluation data as NaN), or&quot;</span>
<a id="__codelineno-0-489" name="__codelineno-0-489" href="#__codelineno-0-489"></a>                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">total_eval_width</span><span class="si">}</span><span class="s2"> (for setting both objective-associated evaluations and extra evaluation data).&quot;</span>
<a id="__codelineno-0-490" name="__codelineno-0-490" href="#__codelineno-0-490"></a>                <span class="p">)</span>
<a id="__codelineno-0-491" name="__codelineno-0-491" href="#__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492" href="#__codelineno-0-492"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-493" name="__codelineno-0-493" href="#__codelineno-0-493"></a>    <span class="k">def</span> <span class="nf">evals</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494" href="#__codelineno-0-494"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-495" name="__codelineno-0-495" href="#__codelineno-0-495"></a><span class="sd">        Evaluation results of the solutions, in a ReadOnlyTensor</span>
<a id="__codelineno-0-496" name="__codelineno-0-496" href="#__codelineno-0-496"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-497" name="__codelineno-0-497" href="#__codelineno-0-497"></a>        <span class="kn">from</span> <span class="nn">.tools.readonlytensor</span> <span class="kn">import</span> <span class="n">as_read_only_tensor</span>
<a id="__codelineno-0-498" name="__codelineno-0-498" href="#__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499" href="#__codelineno-0-499"></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-500" name="__codelineno-0-500" href="#__codelineno-0-500"></a>            <span class="k">return</span> <span class="n">as_read_only_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501" href="#__codelineno-0-501"></a>
<a id="__codelineno-0-502" name="__codelineno-0-502" href="#__codelineno-0-502"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-503" name="__codelineno-0-503" href="#__codelineno-0-503"></a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]:</span>
<a id="__codelineno-0-504" name="__codelineno-0-504" href="#__codelineno-0-504"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-505" name="__codelineno-0-505" href="#__codelineno-0-505"></a><span class="sd">        Decision values of the solutions, in a read-only tensor-like object</span>
<a id="__codelineno-0-506" name="__codelineno-0-506" href="#__codelineno-0-506"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-507" name="__codelineno-0-507" href="#__codelineno-0-507"></a>        <span class="kn">from</span> <span class="nn">.tools.readonlytensor</span> <span class="kn">import</span> <span class="n">as_read_only_tensor</span>
<a id="__codelineno-0-508" name="__codelineno-0-508" href="#__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509" href="#__codelineno-0-509"></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-510" name="__codelineno-0-510" href="#__codelineno-0-510"></a>            <span class="k">return</span> <span class="n">as_read_only_tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
<a id="__codelineno-0-511" name="__codelineno-0-511" href="#__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512" href="#__codelineno-0-512"></a>    <span class="c1"># @property</span>
<a id="__codelineno-0-513" name="__codelineno-0-513" href="#__codelineno-0-513"></a>    <span class="c1"># def unsafe_evals(self) -&gt; torch.Tensor:</span>
<a id="__codelineno-0-514" name="__codelineno-0-514" href="#__codelineno-0-514"></a>    <span class="c1">#    &quot;&quot;&quot;</span>
<a id="__codelineno-0-515" name="__codelineno-0-515" href="#__codelineno-0-515"></a>    <span class="c1">#    It is not recommended to use this property.</span>
<a id="__codelineno-0-516" name="__codelineno-0-516" href="#__codelineno-0-516"></a>    <span class="c1">#</span>
<a id="__codelineno-0-517" name="__codelineno-0-517" href="#__codelineno-0-517"></a>    <span class="c1">#    Grants mutable access to the evaluations of the solutions.</span>
<a id="__codelineno-0-518" name="__codelineno-0-518" href="#__codelineno-0-518"></a>    <span class="c1">#    &quot;&quot;&quot;</span>
<a id="__codelineno-0-519" name="__codelineno-0-519" href="#__codelineno-0-519"></a>    <span class="c1">#    return self._evdata</span>
<a id="__codelineno-0-520" name="__codelineno-0-520" href="#__codelineno-0-520"></a>    <span class="c1">#</span>
<a id="__codelineno-0-521" name="__codelineno-0-521" href="#__codelineno-0-521"></a>    <span class="c1"># @property</span>
<a id="__codelineno-0-522" name="__codelineno-0-522" href="#__codelineno-0-522"></a>    <span class="c1"># def unsafe_values(self) -&gt; Union[torch.Tensor, Iterable]:</span>
<a id="__codelineno-0-523" name="__codelineno-0-523" href="#__codelineno-0-523"></a>    <span class="c1">#    &quot;&quot;&quot;</span>
<a id="__codelineno-0-524" name="__codelineno-0-524" href="#__codelineno-0-524"></a>    <span class="c1">#    It is not recommended to use this property.</span>
<a id="__codelineno-0-525" name="__codelineno-0-525" href="#__codelineno-0-525"></a>    <span class="c1">#</span>
<a id="__codelineno-0-526" name="__codelineno-0-526" href="#__codelineno-0-526"></a>    <span class="c1">#    Grants mutable access to the decision values of the solutions.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527" href="#__codelineno-0-527"></a>    <span class="c1">#    &quot;&quot;&quot;</span>
<a id="__codelineno-0-528" name="__codelineno-0-528" href="#__codelineno-0-528"></a>    <span class="c1">#    return self._data</span>
<a id="__codelineno-0-529" name="__codelineno-0-529" href="#__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530" href="#__codelineno-0-530"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-531" name="__codelineno-0-531" href="#__codelineno-0-531"></a>    <span class="k">def</span> <span class="nf">access_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-532" name="__codelineno-0-532" href="#__codelineno-0-532"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-533" name="__codelineno-0-533" href="#__codelineno-0-533"></a><span class="sd">        Get the internal mutable tensor storing the evaluations.</span>
<a id="__codelineno-0-534" name="__codelineno-0-534" href="#__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535" href="#__codelineno-0-535"></a><span class="sd">        IMPORTANT: This method exposes the evaluation tensor of the batch</span>
<a id="__codelineno-0-536" name="__codelineno-0-536" href="#__codelineno-0-536"></a><span class="sd">        as it is, in mutable mode. It is therefore considered unsafe to rely</span>
<a id="__codelineno-0-537" name="__codelineno-0-537" href="#__codelineno-0-537"></a><span class="sd">        on this method. Before using this method, please consider using the</span>
<a id="__codelineno-0-538" name="__codelineno-0-538" href="#__codelineno-0-538"></a><span class="sd">        `evals` property for reading the evaluation results, and using the</span>
<a id="__codelineno-0-539" name="__codelineno-0-539" href="#__codelineno-0-539"></a><span class="sd">        `set_evals(...)` method which allows one to update the evaluations</span>
<a id="__codelineno-0-540" name="__codelineno-0-540" href="#__codelineno-0-540"></a><span class="sd">        without exposing any internal tensor.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541" href="#__codelineno-0-541"></a>
<a id="__codelineno-0-542" name="__codelineno-0-542" href="#__codelineno-0-542"></a><span class="sd">        When this method is used without any argument, the returned tensor</span>
<a id="__codelineno-0-543" name="__codelineno-0-543" href="#__codelineno-0-543"></a><span class="sd">        will be of shape `(n, m)`, where `n` is the number of solutions,</span>
<a id="__codelineno-0-544" name="__codelineno-0-544" href="#__codelineno-0-544"></a><span class="sd">        and `m` is the number of objectives plus the length of extra</span>
<a id="__codelineno-0-545" name="__codelineno-0-545" href="#__codelineno-0-545"></a><span class="sd">        evaluation data.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546" href="#__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547" href="#__codelineno-0-547"></a><span class="sd">        When this method is used with an integer argument specifying an</span>
<a id="__codelineno-0-548" name="__codelineno-0-548" href="#__codelineno-0-548"></a><span class="sd">        objective index, the returned tensor will be 1-dimensional</span>
<a id="__codelineno-0-549" name="__codelineno-0-549" href="#__codelineno-0-549"></a><span class="sd">        having a length of `n`, where `n` is the number of solutions.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550" href="#__codelineno-0-550"></a><span class="sd">        In this case, the returned 1-dimensional tensor will be a view</span>
<a id="__codelineno-0-551" name="__codelineno-0-551" href="#__codelineno-0-551"></a><span class="sd">        upon the evaluation results of the specified objective.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552" href="#__codelineno-0-552"></a>
<a id="__codelineno-0-553" name="__codelineno-0-553" href="#__codelineno-0-553"></a><span class="sd">        The value `nan` (not-a-number) means not evaluated yet.</span>
<a id="__codelineno-0-554" name="__codelineno-0-554" href="#__codelineno-0-554"></a>
<a id="__codelineno-0-555" name="__codelineno-0-555" href="#__codelineno-0-555"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556" href="#__codelineno-0-556"></a><span class="sd">            obj_index: None for getting the entire 2-dimensional evaluation</span>
<a id="__codelineno-0-557" name="__codelineno-0-557" href="#__codelineno-0-557"></a><span class="sd">                tensor; an objective index (as integer) for getting a</span>
<a id="__codelineno-0-558" name="__codelineno-0-558" href="#__codelineno-0-558"></a><span class="sd">                1-dimensional mutable slice of the evaluation tensor,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559" href="#__codelineno-0-559"></a><span class="sd">                the slice being a view upon the evaluation results</span>
<a id="__codelineno-0-560" name="__codelineno-0-560" href="#__codelineno-0-560"></a><span class="sd">                regarding the specified objective.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561" href="#__codelineno-0-561"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-562" name="__codelineno-0-562" href="#__codelineno-0-562"></a><span class="sd">            The mutable tensor storing the evaluation information.</span>
<a id="__codelineno-0-563" name="__codelineno-0-563" href="#__codelineno-0-563"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-564" name="__codelineno-0-564" href="#__codelineno-0-564"></a>        <span class="k">if</span> <span class="n">obj_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-565" name="__codelineno-0-565" href="#__codelineno-0-565"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span>
<a id="__codelineno-0-566" name="__codelineno-0-566" href="#__codelineno-0-566"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-567" name="__codelineno-0-567" href="#__codelineno-0-567"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)]</span>
<a id="__codelineno-0-568" name="__codelineno-0-568" href="#__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569" href="#__codelineno-0-569"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-570" name="__codelineno-0-570" href="#__codelineno-0-570"></a>    <span class="k">def</span> <span class="nf">access_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">keep_evals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">]:</span>
<a id="__codelineno-0-571" name="__codelineno-0-571" href="#__codelineno-0-571"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-572" name="__codelineno-0-572" href="#__codelineno-0-572"></a><span class="sd">        Get the internal mutable tensor storing the decision values.</span>
<a id="__codelineno-0-573" name="__codelineno-0-573" href="#__codelineno-0-573"></a>
<a id="__codelineno-0-574" name="__codelineno-0-574" href="#__codelineno-0-574"></a><span class="sd">        IMPORTANT: This method exposes the internal decision values tensor of</span>
<a id="__codelineno-0-575" name="__codelineno-0-575" href="#__codelineno-0-575"></a><span class="sd">        the batch as it is, in mutable mode. It is therefore considered unsafe</span>
<a id="__codelineno-0-576" name="__codelineno-0-576" href="#__codelineno-0-576"></a><span class="sd">        to rely on this method. Before using this method, please consider</span>
<a id="__codelineno-0-577" name="__codelineno-0-577" href="#__codelineno-0-577"></a><span class="sd">        using the `values` property for reading the decision values, and using</span>
<a id="__codelineno-0-578" name="__codelineno-0-578" href="#__codelineno-0-578"></a><span class="sd">        the `set_values(...)` method which allows one to update the decision</span>
<a id="__codelineno-0-579" name="__codelineno-0-579" href="#__codelineno-0-579"></a><span class="sd">        values without exposing any internal tensor.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580" href="#__codelineno-0-580"></a>
<a id="__codelineno-0-581" name="__codelineno-0-581" href="#__codelineno-0-581"></a><span class="sd">        IMPORTANT: The default assumption of this method is that the tensor</span>
<a id="__codelineno-0-582" name="__codelineno-0-582" href="#__codelineno-0-582"></a><span class="sd">        is requested for modification purposes. Therefore, by default, as soon</span>
<a id="__codelineno-0-583" name="__codelineno-0-583" href="#__codelineno-0-583"></a><span class="sd">        as this method is called, the evaluation results of the solutions will</span>
<a id="__codelineno-0-584" name="__codelineno-0-584" href="#__codelineno-0-584"></a><span class="sd">        be cleared (where clearing means that the evaluation results will be</span>
<a id="__codelineno-0-585" name="__codelineno-0-585" href="#__codelineno-0-585"></a><span class="sd">        filled with `NaN`s).</span>
<a id="__codelineno-0-586" name="__codelineno-0-586" href="#__codelineno-0-586"></a><span class="sd">        The reasoning behind this default behavior is to prevent the modified</span>
<a id="__codelineno-0-587" name="__codelineno-0-587" href="#__codelineno-0-587"></a><span class="sd">        solutions from having outdated evaluation results.</span>
<a id="__codelineno-0-588" name="__codelineno-0-588" href="#__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589" href="#__codelineno-0-589"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-590" name="__codelineno-0-590" href="#__codelineno-0-590"></a><span class="sd">            keep_evals: If set as False, the evaluation data of the solutions</span>
<a id="__codelineno-0-591" name="__codelineno-0-591" href="#__codelineno-0-591"></a><span class="sd">                will be cleared (i.e. will be filled with `NaN`s).</span>
<a id="__codelineno-0-592" name="__codelineno-0-592" href="#__codelineno-0-592"></a><span class="sd">                If set as True, the existing evaluation data will be kept.</span>
<a id="__codelineno-0-593" name="__codelineno-0-593" href="#__codelineno-0-593"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-594" name="__codelineno-0-594" href="#__codelineno-0-594"></a><span class="sd">            The mutable tensor storing the decision values.</span>
<a id="__codelineno-0-595" name="__codelineno-0-595" href="#__codelineno-0-595"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-596" name="__codelineno-0-596" href="#__codelineno-0-596"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_evals</span><span class="p">:</span>
<a id="__codelineno-0-597" name="__codelineno-0-597" href="#__codelineno-0-597"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">forget_evals</span><span class="p">()</span>
<a id="__codelineno-0-598" name="__codelineno-0-598" href="#__codelineno-0-598"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
<a id="__codelineno-0-599" name="__codelineno-0-599" href="#__codelineno-0-599"></a>
<a id="__codelineno-0-600" name="__codelineno-0-600" href="#__codelineno-0-600"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-601" name="__codelineno-0-601" href="#__codelineno-0-601"></a>    <span class="k">def</span> <span class="nf">forget_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">solutions</span><span class="p">:</span> <span class="n">MaybeIndicesOrSlice</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-602" name="__codelineno-0-602" href="#__codelineno-0-602"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-603" name="__codelineno-0-603" href="#__codelineno-0-603"></a><span class="sd">        Forget the evaluations of the solutions.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604" href="#__codelineno-0-604"></a><span class="sd">        The evaluation results will be cleared, which means that they will</span>
<a id="__codelineno-0-605" name="__codelineno-0-605" href="#__codelineno-0-605"></a><span class="sd">        be filled with `NaN`s.</span>
<a id="__codelineno-0-606" name="__codelineno-0-606" href="#__codelineno-0-606"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-607" name="__codelineno-0-607" href="#__codelineno-0-607"></a>        <span class="k">if</span> <span class="n">solutions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-608" name="__codelineno-0-608" href="#__codelineno-0-608"></a>            <span class="n">solutions</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-609" name="__codelineno-0-609" href="#__codelineno-0-609"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
<a id="__codelineno-0-610" name="__codelineno-0-610" href="#__codelineno-0-610"></a>
<a id="__codelineno-0-611" name="__codelineno-0-611" href="#__codelineno-0-611"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-612" name="__codelineno-0-612" href="#__codelineno-0-612"></a>    <span class="k">def</span> <span class="nf">utility</span><span class="p">(</span>
<a id="__codelineno-0-613" name="__codelineno-0-613" href="#__codelineno-0-613"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614" href="#__codelineno-0-614"></a>        <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-615" name="__codelineno-0-615" href="#__codelineno-0-615"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-616" name="__codelineno-0-616" href="#__codelineno-0-616"></a>        <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-617" name="__codelineno-0-617" href="#__codelineno-0-617"></a>        <span class="n">check_nans</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-618" name="__codelineno-0-618" href="#__codelineno-0-618"></a>        <span class="n">using_values_dtype</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-619" name="__codelineno-0-619" href="#__codelineno-0-619"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620" href="#__codelineno-0-620"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-621" name="__codelineno-0-621" href="#__codelineno-0-621"></a><span class="sd">        Return numeric scores for each solution.</span>
<a id="__codelineno-0-622" name="__codelineno-0-622" href="#__codelineno-0-622"></a>
<a id="__codelineno-0-623" name="__codelineno-0-623" href="#__codelineno-0-623"></a><span class="sd">        Utility scores are different from evaluation results,</span>
<a id="__codelineno-0-624" name="__codelineno-0-624" href="#__codelineno-0-624"></a><span class="sd">        in the sense that utilities monotonically increase from</span>
<a id="__codelineno-0-625" name="__codelineno-0-625" href="#__codelineno-0-625"></a><span class="sd">        bad solutions to good solutions, regardless of the</span>
<a id="__codelineno-0-626" name="__codelineno-0-626" href="#__codelineno-0-626"></a><span class="sd">        objective sense.</span>
<a id="__codelineno-0-627" name="__codelineno-0-627" href="#__codelineno-0-627"></a>
<a id="__codelineno-0-628" name="__codelineno-0-628" href="#__codelineno-0-628"></a><span class="sd">        **If ranking method is passed as None:**</span>
<a id="__codelineno-0-629" name="__codelineno-0-629" href="#__codelineno-0-629"></a><span class="sd">        if the objective sense is &#39;max&#39;, the evaluation results are returned</span>
<a id="__codelineno-0-630" name="__codelineno-0-630" href="#__codelineno-0-630"></a><span class="sd">        as the utility scores; otherwise, if the objective sense is &#39;min&#39;,</span>
<a id="__codelineno-0-631" name="__codelineno-0-631" href="#__codelineno-0-631"></a><span class="sd">        the evaluation results multiplied by -1 are returned as the</span>
<a id="__codelineno-0-632" name="__codelineno-0-632" href="#__codelineno-0-632"></a><span class="sd">        utility scores.</span>
<a id="__codelineno-0-633" name="__codelineno-0-633" href="#__codelineno-0-633"></a>
<a id="__codelineno-0-634" name="__codelineno-0-634" href="#__codelineno-0-634"></a><span class="sd">        **If the name of a ranking method is given** (e.g. &#39;centered&#39;):</span>
<a id="__codelineno-0-635" name="__codelineno-0-635" href="#__codelineno-0-635"></a><span class="sd">        then the solutions are ranked (best solutions having the</span>
<a id="__codelineno-0-636" name="__codelineno-0-636" href="#__codelineno-0-636"></a><span class="sd">        highest rank), and those ranks are returned as the utility</span>
<a id="__codelineno-0-637" name="__codelineno-0-637" href="#__codelineno-0-637"></a><span class="sd">        scores.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638" href="#__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639" href="#__codelineno-0-639"></a><span class="sd">        **If an objective index is not provided:** (i.e. passed as None)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640" href="#__codelineno-0-640"></a><span class="sd">        if the problem is multi-objective, the utility scores</span>
<a id="__codelineno-0-641" name="__codelineno-0-641" href="#__codelineno-0-641"></a><span class="sd">        for each objective is given, in a tensor shaped (n, m),</span>
<a id="__codelineno-0-642" name="__codelineno-0-642" href="#__codelineno-0-642"></a><span class="sd">        n being the number of solutions and m being the number</span>
<a id="__codelineno-0-643" name="__codelineno-0-643" href="#__codelineno-0-643"></a><span class="sd">        of objectives; otherwise, if the problem is single-objective,</span>
<a id="__codelineno-0-644" name="__codelineno-0-644" href="#__codelineno-0-644"></a><span class="sd">        the utility scores for each objective is given in a 1-dimensional</span>
<a id="__codelineno-0-645" name="__codelineno-0-645" href="#__codelineno-0-645"></a><span class="sd">        tensor of length n, n being the number of solutions.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646" href="#__codelineno-0-646"></a>
<a id="__codelineno-0-647" name="__codelineno-0-647" href="#__codelineno-0-647"></a><span class="sd">        **If an objective index is provided as an int:**</span>
<a id="__codelineno-0-648" name="__codelineno-0-648" href="#__codelineno-0-648"></a><span class="sd">        the utility scores are returned in a 1-dimensional tensor</span>
<a id="__codelineno-0-649" name="__codelineno-0-649" href="#__codelineno-0-649"></a><span class="sd">        of length n, n being the number of solutions.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650" href="#__codelineno-0-650"></a>
<a id="__codelineno-0-651" name="__codelineno-0-651" href="#__codelineno-0-651"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-652" name="__codelineno-0-652" href="#__codelineno-0-652"></a><span class="sd">            obj_index: Expected as None, or as an integer.</span>
<a id="__codelineno-0-653" name="__codelineno-0-653" href="#__codelineno-0-653"></a><span class="sd">                In the single-objective case, None is equivalent to 0.</span>
<a id="__codelineno-0-654" name="__codelineno-0-654" href="#__codelineno-0-654"></a><span class="sd">                In the multi-objective case, None means &quot;for each</span>
<a id="__codelineno-0-655" name="__codelineno-0-655" href="#__codelineno-0-655"></a><span class="sd">                objective&quot;.</span>
<a id="__codelineno-0-656" name="__codelineno-0-656" href="#__codelineno-0-656"></a><span class="sd">            ranking_method: If the utility scores are to be generated</span>
<a id="__codelineno-0-657" name="__codelineno-0-657" href="#__codelineno-0-657"></a><span class="sd">                according to a certain ranking method, pass here the name</span>
<a id="__codelineno-0-658" name="__codelineno-0-658" href="#__codelineno-0-658"></a><span class="sd">                of that ranking method as a str (e.g. &#39;centered&#39;).</span>
<a id="__codelineno-0-659" name="__codelineno-0-659" href="#__codelineno-0-659"></a><span class="sd">            check_nans: Check for nan (not-a-number) values in the</span>
<a id="__codelineno-0-660" name="__codelineno-0-660" href="#__codelineno-0-660"></a><span class="sd">                evaluation results, which is an indication of</span>
<a id="__codelineno-0-661" name="__codelineno-0-661" href="#__codelineno-0-661"></a><span class="sd">                unevaluated solutions.</span>
<a id="__codelineno-0-662" name="__codelineno-0-662" href="#__codelineno-0-662"></a><span class="sd">            using_values_dtype: If True, the utility values will be returned</span>
<a id="__codelineno-0-663" name="__codelineno-0-663" href="#__codelineno-0-663"></a><span class="sd">                using the dtype of the decision values.</span>
<a id="__codelineno-0-664" name="__codelineno-0-664" href="#__codelineno-0-664"></a><span class="sd">                If False, the utility values will be returned using the dtype</span>
<a id="__codelineno-0-665" name="__codelineno-0-665" href="#__codelineno-0-665"></a><span class="sd">                of the evaluation data.</span>
<a id="__codelineno-0-666" name="__codelineno-0-666" href="#__codelineno-0-666"></a><span class="sd">                The default is False.</span>
<a id="__codelineno-0-667" name="__codelineno-0-667" href="#__codelineno-0-667"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668" href="#__codelineno-0-668"></a><span class="sd">            Utility scores, in a PyTorch tensor.</span>
<a id="__codelineno-0-669" name="__codelineno-0-669" href="#__codelineno-0-669"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-670" name="__codelineno-0-670" href="#__codelineno-0-670"></a>        <span class="k">if</span> <span class="n">obj_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671" href="#__codelineno-0-671"></a>            <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-672" name="__codelineno-0-672" href="#__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673" href="#__codelineno-0-673"></a>            <span class="n">evdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:,</span> <span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-674" name="__codelineno-0-674" href="#__codelineno-0-674"></a>            <span class="k">if</span> <span class="n">check_nans</span><span class="p">:</span>
<a id="__codelineno-0-675" name="__codelineno-0-675" href="#__codelineno-0-675"></a>                <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">evdata</span><span class="p">)):</span>
<a id="__codelineno-0-676" name="__codelineno-0-676" href="#__codelineno-0-676"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-677" name="__codelineno-0-677" href="#__codelineno-0-677"></a>                        <span class="s2">&quot;Cannot compute the utility values, because there are solutions which are not evaluated yet.&quot;</span>
<a id="__codelineno-0-678" name="__codelineno-0-678" href="#__codelineno-0-678"></a>                    <span class="p">)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679" href="#__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680" href="#__codelineno-0-680"></a>            <span class="k">if</span> <span class="n">ranking_method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681" href="#__codelineno-0-681"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">evdata</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_objective_sign</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-682" name="__codelineno-0-682" href="#__codelineno-0-682"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-683" name="__codelineno-0-683" href="#__codelineno-0-683"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">rank</span><span class="p">(</span><span class="n">evdata</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span> <span class="n">higher_is_better</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">[</span><span class="n">obj_index</span><span class="p">])</span>
<a id="__codelineno-0-684" name="__codelineno-0-684" href="#__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685" href="#__codelineno-0-685"></a>            <span class="k">if</span> <span class="n">using_values_dtype</span><span class="p">:</span>
<a id="__codelineno-0-686" name="__codelineno-0-686" href="#__codelineno-0-686"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-687" name="__codelineno-0-687" href="#__codelineno-0-687"></a>
<a id="__codelineno-0-688" name="__codelineno-0-688" href="#__codelineno-0-688"></a>            <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-689" name="__codelineno-0-689" href="#__codelineno-0-689"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-690" name="__codelineno-0-690" href="#__codelineno-0-690"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691" href="#__codelineno-0-691"></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">utility</span><span class="p">(</span>
<a id="__codelineno-0-692" name="__codelineno-0-692" href="#__codelineno-0-692"></a>                    <span class="mi">0</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span> <span class="n">check_nans</span><span class="o">=</span><span class="n">check_nans</span><span class="p">,</span> <span class="n">using_values_dtype</span><span class="o">=</span><span class="n">using_values_dtype</span>
<a id="__codelineno-0-693" name="__codelineno-0-693" href="#__codelineno-0-693"></a>                <span class="p">)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694" href="#__codelineno-0-694"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-695" name="__codelineno-0-695" href="#__codelineno-0-695"></a>                <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<a id="__codelineno-0-696" name="__codelineno-0-696" href="#__codelineno-0-696"></a>                    <span class="p">[</span>
<a id="__codelineno-0-697" name="__codelineno-0-697" href="#__codelineno-0-697"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">utility</span><span class="p">(</span>
<a id="__codelineno-0-698" name="__codelineno-0-698" href="#__codelineno-0-698"></a>                            <span class="n">j</span><span class="p">,</span>
<a id="__codelineno-0-699" name="__codelineno-0-699" href="#__codelineno-0-699"></a>                            <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-700" name="__codelineno-0-700" href="#__codelineno-0-700"></a>                            <span class="n">check_nans</span><span class="o">=</span><span class="n">check_nans</span><span class="p">,</span>
<a id="__codelineno-0-701" name="__codelineno-0-701" href="#__codelineno-0-701"></a>                            <span class="n">using_values_dtype</span><span class="o">=</span><span class="n">using_values_dtype</span><span class="p">,</span>
<a id="__codelineno-0-702" name="__codelineno-0-702" href="#__codelineno-0-702"></a>                        <span class="p">)</span>
<a id="__codelineno-0-703" name="__codelineno-0-703" href="#__codelineno-0-703"></a>                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span><span class="p">)</span>
<a id="__codelineno-0-704" name="__codelineno-0-704" href="#__codelineno-0-704"></a>                    <span class="p">],</span>
<a id="__codelineno-0-705" name="__codelineno-0-705" href="#__codelineno-0-705"></a>                <span class="p">)</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-706" name="__codelineno-0-706" href="#__codelineno-0-706"></a>
<a id="__codelineno-0-707" name="__codelineno-0-707" href="#__codelineno-0-707"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-708" name="__codelineno-0-708" href="#__codelineno-0-708"></a>    <span class="k">def</span> <span class="nf">utils</span><span class="p">(</span>
<a id="__codelineno-0-709" name="__codelineno-0-709" href="#__codelineno-0-709"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-710" name="__codelineno-0-710" href="#__codelineno-0-710"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-711" name="__codelineno-0-711" href="#__codelineno-0-711"></a>        <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-712" name="__codelineno-0-712" href="#__codelineno-0-712"></a>        <span class="n">check_nans</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-713" name="__codelineno-0-713" href="#__codelineno-0-713"></a>        <span class="n">using_values_dtype</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-714" name="__codelineno-0-714" href="#__codelineno-0-714"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-715" name="__codelineno-0-715" href="#__codelineno-0-715"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-716" name="__codelineno-0-716" href="#__codelineno-0-716"></a><span class="sd">        Return numeric scores for each solution, and for each objective.</span>
<a id="__codelineno-0-717" name="__codelineno-0-717" href="#__codelineno-0-717"></a><span class="sd">        Utility scores are different from evaluation results,</span>
<a id="__codelineno-0-718" name="__codelineno-0-718" href="#__codelineno-0-718"></a><span class="sd">        in the sense that utilities monotonically increase from</span>
<a id="__codelineno-0-719" name="__codelineno-0-719" href="#__codelineno-0-719"></a><span class="sd">        bad solutions to good solutions, regardless of the</span>
<a id="__codelineno-0-720" name="__codelineno-0-720" href="#__codelineno-0-720"></a><span class="sd">        objective sense.</span>
<a id="__codelineno-0-721" name="__codelineno-0-721" href="#__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722" href="#__codelineno-0-722"></a><span class="sd">        Unlike the method called `utility(...)`, this function returns</span>
<a id="__codelineno-0-723" name="__codelineno-0-723" href="#__codelineno-0-723"></a><span class="sd">        a 2-dimensional tensor even when the problem is single-objective.</span>
<a id="__codelineno-0-724" name="__codelineno-0-724" href="#__codelineno-0-724"></a>
<a id="__codelineno-0-725" name="__codelineno-0-725" href="#__codelineno-0-725"></a><span class="sd">        The result of this method is always a 2-dimensional tensor of</span>
<a id="__codelineno-0-726" name="__codelineno-0-726" href="#__codelineno-0-726"></a><span class="sd">        shape `(n, m)`, `n` being the number of solutions, `m` being the</span>
<a id="__codelineno-0-727" name="__codelineno-0-727" href="#__codelineno-0-727"></a><span class="sd">        number of objectives.</span>
<a id="__codelineno-0-728" name="__codelineno-0-728" href="#__codelineno-0-728"></a>
<a id="__codelineno-0-729" name="__codelineno-0-729" href="#__codelineno-0-729"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-730" name="__codelineno-0-730" href="#__codelineno-0-730"></a><span class="sd">            ranking_method: If the utility scores are to be generated</span>
<a id="__codelineno-0-731" name="__codelineno-0-731" href="#__codelineno-0-731"></a><span class="sd">                according to a certain ranking method, pass here the name</span>
<a id="__codelineno-0-732" name="__codelineno-0-732" href="#__codelineno-0-732"></a><span class="sd">                of that ranking method as a str (e.g. &#39;centered&#39;).</span>
<a id="__codelineno-0-733" name="__codelineno-0-733" href="#__codelineno-0-733"></a><span class="sd">            check_nans: Check for nan (not-a-number) values in the</span>
<a id="__codelineno-0-734" name="__codelineno-0-734" href="#__codelineno-0-734"></a><span class="sd">                evaluation results, which is an indication of</span>
<a id="__codelineno-0-735" name="__codelineno-0-735" href="#__codelineno-0-735"></a><span class="sd">                unevaluated solutions.</span>
<a id="__codelineno-0-736" name="__codelineno-0-736" href="#__codelineno-0-736"></a><span class="sd">            using_values_dtype: If True, the utility values will be returned</span>
<a id="__codelineno-0-737" name="__codelineno-0-737" href="#__codelineno-0-737"></a><span class="sd">                using the dtype of the decision values.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738" href="#__codelineno-0-738"></a><span class="sd">                If False, the utility values will be returned using the dtype</span>
<a id="__codelineno-0-739" name="__codelineno-0-739" href="#__codelineno-0-739"></a><span class="sd">                of the evaluation data.</span>
<a id="__codelineno-0-740" name="__codelineno-0-740" href="#__codelineno-0-740"></a><span class="sd">                The default is False.</span>
<a id="__codelineno-0-741" name="__codelineno-0-741" href="#__codelineno-0-741"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-742" name="__codelineno-0-742" href="#__codelineno-0-742"></a><span class="sd">            Utility scores, in a 2-dimensional PyTorch tensor.</span>
<a id="__codelineno-0-743" name="__codelineno-0-743" href="#__codelineno-0-743"></a>
<a id="__codelineno-0-744" name="__codelineno-0-744" href="#__codelineno-0-744"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-745" name="__codelineno-0-745" href="#__codelineno-0-745"></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">utility</span><span class="p">(</span>
<a id="__codelineno-0-746" name="__codelineno-0-746" href="#__codelineno-0-746"></a>            <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span> <span class="n">check_nans</span><span class="o">=</span><span class="n">check_nans</span><span class="p">,</span> <span class="n">using_values_dtype</span><span class="o">=</span><span class="n">using_values_dtype</span>
<a id="__codelineno-0-747" name="__codelineno-0-747" href="#__codelineno-0-747"></a>        <span class="p">)</span>
<a id="__codelineno-0-748" name="__codelineno-0-748" href="#__codelineno-0-748"></a>        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749" href="#__codelineno-0-749"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-750" name="__codelineno-0-750" href="#__codelineno-0-750"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-751" name="__codelineno-0-751" href="#__codelineno-0-751"></a>
<a id="__codelineno-0-752" name="__codelineno-0-752" href="#__codelineno-0-752"></a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_pieces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatchPieces&quot;</span><span class="p">:</span>
<a id="__codelineno-0-753" name="__codelineno-0-753" href="#__codelineno-0-753"></a>        <span class="sd">&quot;&quot;&quot;Split this SolutionBatch into a specified number of pieces,</span>
<a id="__codelineno-0-754" name="__codelineno-0-754" href="#__codelineno-0-754"></a><span class="sd">        or into an unspecified number of pieces where the maximum</span>
<a id="__codelineno-0-755" name="__codelineno-0-755" href="#__codelineno-0-755"></a><span class="sd">        size of each piece is specified.</span>
<a id="__codelineno-0-756" name="__codelineno-0-756" href="#__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757" href="#__codelineno-0-757"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758" href="#__codelineno-0-758"></a><span class="sd">            num_pieces: Can be provided as an integer n, which means</span>
<a id="__codelineno-0-759" name="__codelineno-0-759" href="#__codelineno-0-759"></a><span class="sd">                that the this SolutionBatch will be split to n pieces.</span>
<a id="__codelineno-0-760" name="__codelineno-0-760" href="#__codelineno-0-760"></a><span class="sd">                Alternatively, can be left as None if the user intends</span>
<a id="__codelineno-0-761" name="__codelineno-0-761" href="#__codelineno-0-761"></a><span class="sd">                to set max_size as an integer instead.</span>
<a id="__codelineno-0-762" name="__codelineno-0-762" href="#__codelineno-0-762"></a><span class="sd">            max_size: Can be provided as an integer n, which means</span>
<a id="__codelineno-0-763" name="__codelineno-0-763" href="#__codelineno-0-763"></a><span class="sd">                that this SolutionBatch will be split to multiple</span>
<a id="__codelineno-0-764" name="__codelineno-0-764" href="#__codelineno-0-764"></a><span class="sd">                pieces, each piece containing n solutions at most.</span>
<a id="__codelineno-0-765" name="__codelineno-0-765" href="#__codelineno-0-765"></a><span class="sd">                Alternatively, can be left as None if the user intends</span>
<a id="__codelineno-0-766" name="__codelineno-0-766" href="#__codelineno-0-766"></a><span class="sd">                to set num_pieces as an integer instead.</span>
<a id="__codelineno-0-767" name="__codelineno-0-767" href="#__codelineno-0-767"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768" href="#__codelineno-0-768"></a><span class="sd">            A SolutionBatchPieces object, which behaves like a list of</span>
<a id="__codelineno-0-769" name="__codelineno-0-769" href="#__codelineno-0-769"></a><span class="sd">            SolutionBatch objects, each object in the list being a</span>
<a id="__codelineno-0-770" name="__codelineno-0-770" href="#__codelineno-0-770"></a><span class="sd">            slice view of this SolutionBatch object.</span>
<a id="__codelineno-0-771" name="__codelineno-0-771" href="#__codelineno-0-771"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-772" name="__codelineno-0-772" href="#__codelineno-0-772"></a>        <span class="k">return</span> <span class="n">SolutionBatchPieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_pieces</span><span class="o">=</span><span class="n">num_pieces</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="n">max_size</span><span class="p">)</span>
<a id="__codelineno-0-773" name="__codelineno-0-773" href="#__codelineno-0-773"></a>
<a id="__codelineno-0-774" name="__codelineno-0-774" href="#__codelineno-0-774"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-775" name="__codelineno-0-775" href="#__codelineno-0-775"></a>    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;SolutionBatch&quot;</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776" href="#__codelineno-0-776"></a>        <span class="sd">&quot;&quot;&quot;Concatenate this SolutionBatch with the other(s).</span>
<a id="__codelineno-0-777" name="__codelineno-0-777" href="#__codelineno-0-777"></a>
<a id="__codelineno-0-778" name="__codelineno-0-778" href="#__codelineno-0-778"></a><span class="sd">        In this context, concatenation means that the solutions of</span>
<a id="__codelineno-0-779" name="__codelineno-0-779" href="#__codelineno-0-779"></a><span class="sd">        this SolutionBatch and of the others are collected in one big</span>
<a id="__codelineno-0-780" name="__codelineno-0-780" href="#__codelineno-0-780"></a><span class="sd">        SolutionBatch object.</span>
<a id="__codelineno-0-781" name="__codelineno-0-781" href="#__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782" href="#__codelineno-0-782"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-783" name="__codelineno-0-783" href="#__codelineno-0-783"></a><span class="sd">            other: A SolutionBatch, or a sequence of SolutionBatch objects.</span>
<a id="__codelineno-0-784" name="__codelineno-0-784" href="#__codelineno-0-784"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-785" name="__codelineno-0-785" href="#__codelineno-0-785"></a><span class="sd">            A new SolutionBatch object which is the result of the</span>
<a id="__codelineno-0-786" name="__codelineno-0-786" href="#__codelineno-0-786"></a><span class="sd">            concatenation.</span>
<a id="__codelineno-0-787" name="__codelineno-0-787" href="#__codelineno-0-787"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-788" name="__codelineno-0-788" href="#__codelineno-0-788"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-789" name="__codelineno-0-789" href="#__codelineno-0-789"></a>            <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">]</span>
<a id="__codelineno-0-790" name="__codelineno-0-790" href="#__codelineno-0-790"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-791" name="__codelineno-0-791" href="#__codelineno-0-791"></a>            <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
<a id="__codelineno-0-792" name="__codelineno-0-792" href="#__codelineno-0-792"></a>            <span class="n">lst</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
<a id="__codelineno-0-793" name="__codelineno-0-793" href="#__codelineno-0-793"></a>        <span class="k">return</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="n">merging_of</span><span class="o">=</span><span class="n">lst</span><span class="p">)</span>
<a id="__codelineno-0-794" name="__codelineno-0-794" href="#__codelineno-0-794"></a>
<a id="__codelineno-0-795" name="__codelineno-0-795" href="#__codelineno-0-795"></a>    <span class="k">def</span> <span class="nf">take</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-796" name="__codelineno-0-796" href="#__codelineno-0-796"></a>        <span class="sd">&quot;&quot;&quot;Make a new SolutionBatch containing the specified solutions.</span>
<a id="__codelineno-0-797" name="__codelineno-0-797" href="#__codelineno-0-797"></a>
<a id="__codelineno-0-798" name="__codelineno-0-798" href="#__codelineno-0-798"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-799" name="__codelineno-0-799" href="#__codelineno-0-799"></a><span class="sd">            indices: A sequence of solution indices. These specified</span>
<a id="__codelineno-0-800" name="__codelineno-0-800" href="#__codelineno-0-800"></a><span class="sd">                solutions will make it to the newly made SolutionBatch.</span>
<a id="__codelineno-0-801" name="__codelineno-0-801" href="#__codelineno-0-801"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-802" name="__codelineno-0-802" href="#__codelineno-0-802"></a><span class="sd">            The new SolutionBatch.</span>
<a id="__codelineno-0-803" name="__codelineno-0-803" href="#__codelineno-0-803"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-804" name="__codelineno-0-804" href="#__codelineno-0-804"></a>        <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">indices</span><span class="p">):</span>
<a id="__codelineno-0-805" name="__codelineno-0-805" href="#__codelineno-0-805"></a>            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">slice_of</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">))</span>
<a id="__codelineno-0-806" name="__codelineno-0-806" href="#__codelineno-0-806"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-807" name="__codelineno-0-807" href="#__codelineno-0-807"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Expected a sequence of solution indices, but got a `{type(indices)}`&quot;</span><span class="p">)</span>
<a id="__codelineno-0-808" name="__codelineno-0-808" href="#__codelineno-0-808"></a>
<a id="__codelineno-0-809" name="__codelineno-0-809" href="#__codelineno-0-809"></a>    <span class="k">def</span> <span class="nf">take_best</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-810" name="__codelineno-0-810" href="#__codelineno-0-810"></a>        <span class="sd">&quot;&quot;&quot;Make a new SolutionBatch containing the best `n` solutions.</span>
<a id="__codelineno-0-811" name="__codelineno-0-811" href="#__codelineno-0-811"></a>
<a id="__codelineno-0-812" name="__codelineno-0-812" href="#__codelineno-0-812"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-813" name="__codelineno-0-813" href="#__codelineno-0-813"></a><span class="sd">            n: Number of solutions which will be taken.</span>
<a id="__codelineno-0-814" name="__codelineno-0-814" href="#__codelineno-0-814"></a><span class="sd">            obj_index: Objective index according to which the best ones</span>
<a id="__codelineno-0-815" name="__codelineno-0-815" href="#__codelineno-0-815"></a><span class="sd">                will be taken.</span>
<a id="__codelineno-0-816" name="__codelineno-0-816" href="#__codelineno-0-816"></a><span class="sd">                If `obj_index` is left as None and the problem is multi-</span>
<a id="__codelineno-0-817" name="__codelineno-0-817" href="#__codelineno-0-817"></a><span class="sd">                objective, then the solutions will be ranked according to</span>
<a id="__codelineno-0-818" name="__codelineno-0-818" href="#__codelineno-0-818"></a><span class="sd">                their fronts, and according how crowding they are, and then</span>
<a id="__codelineno-0-819" name="__codelineno-0-819" href="#__codelineno-0-819"></a><span class="sd">                the topmost `n` solutions will be taken.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820" href="#__codelineno-0-820"></a><span class="sd">                If `obj_index` is left as None and the problem is single-</span>
<a id="__codelineno-0-821" name="__codelineno-0-821" href="#__codelineno-0-821"></a><span class="sd">                objective, then that single objective will be taken as the</span>
<a id="__codelineno-0-822" name="__codelineno-0-822" href="#__codelineno-0-822"></a><span class="sd">                ranking criterion.</span>
<a id="__codelineno-0-823" name="__codelineno-0-823" href="#__codelineno-0-823"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-824" name="__codelineno-0-824" href="#__codelineno-0-824"></a><span class="sd">            The new SolutionBatch.</span>
<a id="__codelineno-0-825" name="__codelineno-0-825" href="#__codelineno-0-825"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-826" name="__codelineno-0-826" href="#__codelineno-0-826"></a>        <span class="k">if</span> <span class="n">obj_index</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-827" name="__codelineno-0-827" href="#__codelineno-0-827"></a>            <span class="n">fronts</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg_pareto_sort</span><span class="p">(</span><span class="n">crowdsort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">crowdsort_upto</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-828" name="__codelineno-0-828" href="#__codelineno-0-828"></a>            <span class="n">indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">fronts</span><span class="p">)[:</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-829" name="__codelineno-0-829" href="#__codelineno-0-829"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-830" name="__codelineno-0-830" href="#__codelineno-0-830"></a>            <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)[:</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-831" name="__codelineno-0-831" href="#__codelineno-0-831"></a>        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">slice_of</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">))</span>
<a id="__codelineno-0-832" name="__codelineno-0-832" href="#__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833" href="#__codelineno-0-833"></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-834" name="__codelineno-0-834" href="#__codelineno-0-834"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="o">...</span><span class="p">)):</span>
<a id="__codelineno-0-835" name="__codelineno-0-835" href="#__codelineno-0-835"></a>            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">slice_of</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
<a id="__codelineno-0-836" name="__codelineno-0-836" href="#__codelineno-0-836"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-837" name="__codelineno-0-837" href="#__codelineno-0-837"></a>            <span class="k">return</span> <span class="n">Solution</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-838" name="__codelineno-0-838" href="#__codelineno-0-838"></a>
<a id="__codelineno-0-839" name="__codelineno-0-839" href="#__codelineno-0-839"></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-840" name="__codelineno-0-840" href="#__codelineno-0-840"></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-841" name="__codelineno-0-841" href="#__codelineno-0-841"></a>
<a id="__codelineno-0-842" name="__codelineno-0-842" href="#__codelineno-0-842"></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-843" name="__codelineno-0-843" href="#__codelineno-0-843"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
<a id="__codelineno-0-844" name="__codelineno-0-844" href="#__codelineno-0-844"></a>            <span class="k">yield</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-845" name="__codelineno-0-845" href="#__codelineno-0-845"></a>
<a id="__codelineno-0-846" name="__codelineno-0-846" href="#__codelineno-0-846"></a>    <span class="k">def</span> <span class="nf">_get_cloned_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">memo</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-847" name="__codelineno-0-847" href="#__codelineno-0-847"></a>        <span class="k">with</span> <span class="n">_no_grad_if_basic_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-848" name="__codelineno-0-848" href="#__codelineno-0-848"></a>            <span class="k">return</span> <span class="n">deep_clone</span><span class="p">(</span>
<a id="__codelineno-0-849" name="__codelineno-0-849" href="#__codelineno-0-849"></a>                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span>
<a id="__codelineno-0-850" name="__codelineno-0-850" href="#__codelineno-0-850"></a>                <span class="n">otherwise_deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-851" name="__codelineno-0-851" href="#__codelineno-0-851"></a>                <span class="n">memo</span><span class="o">=</span><span class="n">memo</span><span class="p">,</span>
<a id="__codelineno-0-852" name="__codelineno-0-852" href="#__codelineno-0-852"></a>            <span class="p">)</span>
<a id="__codelineno-0-853" name="__codelineno-0-853" href="#__codelineno-0-853"></a>
<a id="__codelineno-0-854" name="__codelineno-0-854" href="#__codelineno-0-854"></a>    <span class="k">def</span> <span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Device</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-855" name="__codelineno-0-855" href="#__codelineno-0-855"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-856" name="__codelineno-0-856" href="#__codelineno-0-856"></a><span class="sd">        Get the counterpart of this SolutionBatch on the new device.</span>
<a id="__codelineno-0-857" name="__codelineno-0-857" href="#__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858" href="#__codelineno-0-858"></a><span class="sd">        If the specified device is the device of this SolutionBatch,</span>
<a id="__codelineno-0-859" name="__codelineno-0-859" href="#__codelineno-0-859"></a><span class="sd">        then this SolutionBatch itself is returned.</span>
<a id="__codelineno-0-860" name="__codelineno-0-860" href="#__codelineno-0-860"></a><span class="sd">        If the specified device is a different device, then a clone</span>
<a id="__codelineno-0-861" name="__codelineno-0-861" href="#__codelineno-0-861"></a><span class="sd">        of this SolutionBatch on this different device is first</span>
<a id="__codelineno-0-862" name="__codelineno-0-862" href="#__codelineno-0-862"></a><span class="sd">        created, and then this new clone is returned.</span>
<a id="__codelineno-0-863" name="__codelineno-0-863" href="#__codelineno-0-863"></a>
<a id="__codelineno-0-864" name="__codelineno-0-864" href="#__codelineno-0-864"></a><span class="sd">        Please note that the `to(...)` method is not supported when</span>
<a id="__codelineno-0-865" name="__codelineno-0-865" href="#__codelineno-0-865"></a><span class="sd">        the dtype is `object`.</span>
<a id="__codelineno-0-866" name="__codelineno-0-866" href="#__codelineno-0-866"></a>
<a id="__codelineno-0-867" name="__codelineno-0-867" href="#__codelineno-0-867"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-868" name="__codelineno-0-868" href="#__codelineno-0-868"></a><span class="sd">            device: The device on which the resulting SolutionBatch</span>
<a id="__codelineno-0-869" name="__codelineno-0-869" href="#__codelineno-0-869"></a><span class="sd">                will be stored.</span>
<a id="__codelineno-0-870" name="__codelineno-0-870" href="#__codelineno-0-870"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-871" name="__codelineno-0-871" href="#__codelineno-0-871"></a><span class="sd">            The SolutionBatch on the specified device.</span>
<a id="__codelineno-0-872" name="__codelineno-0-872" href="#__codelineno-0-872"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-873" name="__codelineno-0-873" href="#__codelineno-0-873"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">):</span>
<a id="__codelineno-0-874" name="__codelineno-0-874" href="#__codelineno-0-874"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The `to(...)` method is not supported when the dtype is `object`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-875" name="__codelineno-0-875" href="#__codelineno-0-875"></a>
<a id="__codelineno-0-876" name="__codelineno-0-876" href="#__codelineno-0-876"></a>        <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-877" name="__codelineno-0-877" href="#__codelineno-0-877"></a>        <span class="k">if</span> <span class="n">device</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">:</span>
<a id="__codelineno-0-878" name="__codelineno-0-878" href="#__codelineno-0-878"></a>            <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-879" name="__codelineno-0-879" href="#__codelineno-0-879"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-880" name="__codelineno-0-880" href="#__codelineno-0-880"></a>            <span class="n">new_batch</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-881" name="__codelineno-0-881" href="#__codelineno-0-881"></a>            <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-882" name="__codelineno-0-882" href="#__codelineno-0-882"></a>                <span class="n">new_batch</span><span class="o">.</span><span class="n">_data</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-883" name="__codelineno-0-883" href="#__codelineno-0-883"></a>                <span class="n">new_batch</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-884" name="__codelineno-0-884" href="#__codelineno-0-884"></a>            <span class="k">return</span> <span class="n">new_batch</span>
<a id="__codelineno-0-885" name="__codelineno-0-885" href="#__codelineno-0-885"></a>
<a id="__codelineno-0-886" name="__codelineno-0-886" href="#__codelineno-0-886"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-887" name="__codelineno-0-887" href="#__codelineno-0-887"></a>    <span class="k">def</span> <span class="nf">device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Device</span><span class="p">:</span>
<a id="__codelineno-0-888" name="__codelineno-0-888" href="#__codelineno-0-888"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-889" name="__codelineno-0-889" href="#__codelineno-0-889"></a><span class="sd">        The device in which the solutions are stored.</span>
<a id="__codelineno-0-890" name="__codelineno-0-890" href="#__codelineno-0-890"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-891" name="__codelineno-0-891" href="#__codelineno-0-891"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-892" name="__codelineno-0-892" href="#__codelineno-0-892"></a>
<a id="__codelineno-0-893" name="__codelineno-0-893" href="#__codelineno-0-893"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-894" name="__codelineno-0-894" href="#__codelineno-0-894"></a>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DType</span><span class="p">:</span>
<a id="__codelineno-0-895" name="__codelineno-0-895" href="#__codelineno-0-895"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-896" name="__codelineno-0-896" href="#__codelineno-0-896"></a><span class="sd">        The dtype of the decision values of the solutions.</span>
<a id="__codelineno-0-897" name="__codelineno-0-897" href="#__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898" href="#__codelineno-0-898"></a><span class="sd">        This property exists as an alias for the property</span>
<a id="__codelineno-0-899" name="__codelineno-0-899" href="#__codelineno-0-899"></a><span class="sd">        `.values_dtype`.</span>
<a id="__codelineno-0-900" name="__codelineno-0-900" href="#__codelineno-0-900"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-901" name="__codelineno-0-901" href="#__codelineno-0-901"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-902" name="__codelineno-0-902" href="#__codelineno-0-902"></a>
<a id="__codelineno-0-903" name="__codelineno-0-903" href="#__codelineno-0-903"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-904" name="__codelineno-0-904" href="#__codelineno-0-904"></a>    <span class="k">def</span> <span class="nf">values_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DType</span><span class="p">:</span>
<a id="__codelineno-0-905" name="__codelineno-0-905" href="#__codelineno-0-905"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-906" name="__codelineno-0-906" href="#__codelineno-0-906"></a><span class="sd">        The dtype of the decision values of the solutions.</span>
<a id="__codelineno-0-907" name="__codelineno-0-907" href="#__codelineno-0-907"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-908" name="__codelineno-0-908" href="#__codelineno-0-908"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-909" name="__codelineno-0-909" href="#__codelineno-0-909"></a>
<a id="__codelineno-0-910" name="__codelineno-0-910" href="#__codelineno-0-910"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-911" name="__codelineno-0-911" href="#__codelineno-0-911"></a>    <span class="k">def</span> <span class="nf">eval_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DType</span><span class="p">:</span>
<a id="__codelineno-0-912" name="__codelineno-0-912" href="#__codelineno-0-912"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-913" name="__codelineno-0-913" href="#__codelineno-0-913"></a><span class="sd">        The dtype of the evaluation results and extra evaluation data</span>
<a id="__codelineno-0-914" name="__codelineno-0-914" href="#__codelineno-0-914"></a><span class="sd">        of the solutions.</span>
<a id="__codelineno-0-915" name="__codelineno-0-915" href="#__codelineno-0-915"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-916" name="__codelineno-0-916" href="#__codelineno-0-916"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-917" name="__codelineno-0-917" href="#__codelineno-0-917"></a>
<a id="__codelineno-0-918" name="__codelineno-0-918" href="#__codelineno-0-918"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-919" name="__codelineno-0-919" href="#__codelineno-0-919"></a>    <span class="k">def</span> <span class="nf">values_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920" href="#__codelineno-0-920"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-921" name="__codelineno-0-921" href="#__codelineno-0-921"></a><span class="sd">        The shape of the batch&#39;s decision values tensor, as a tuple (n, l),</span>
<a id="__codelineno-0-922" name="__codelineno-0-922" href="#__codelineno-0-922"></a><span class="sd">        where `n` is the number of solutions, and `l` is the length</span>
<a id="__codelineno-0-923" name="__codelineno-0-923" href="#__codelineno-0-923"></a><span class="sd">        of a single solution.</span>
<a id="__codelineno-0-924" name="__codelineno-0-924" href="#__codelineno-0-924"></a>
<a id="__codelineno-0-925" name="__codelineno-0-925" href="#__codelineno-0-925"></a><span class="sd">        If `dtype=None`, then there is no fixed length.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926" href="#__codelineno-0-926"></a><span class="sd">        Therefore, the shape is returned as (n,).</span>
<a id="__codelineno-0-927" name="__codelineno-0-927" href="#__codelineno-0-927"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-928" name="__codelineno-0-928" href="#__codelineno-0-928"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-929" name="__codelineno-0-929" href="#__codelineno-0-929"></a>
<a id="__codelineno-0-930" name="__codelineno-0-930" href="#__codelineno-0-930"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-931" name="__codelineno-0-931" href="#__codelineno-0-931"></a>    <span class="k">def</span> <span class="nf">eval_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">:</span>
<a id="__codelineno-0-932" name="__codelineno-0-932" href="#__codelineno-0-932"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-933" name="__codelineno-0-933" href="#__codelineno-0-933"></a><span class="sd">        The shape of the batch&#39;s evaluation tensor, as a tuple (n, l),</span>
<a id="__codelineno-0-934" name="__codelineno-0-934" href="#__codelineno-0-934"></a><span class="sd">        where `n` is the number of solutions, and `l` is an integer</span>
<a id="__codelineno-0-935" name="__codelineno-0-935" href="#__codelineno-0-935"></a><span class="sd">        which is equal to number of objectives plus the length of the</span>
<a id="__codelineno-0-936" name="__codelineno-0-936" href="#__codelineno-0-936"></a><span class="sd">        extra evaluation data, if any.</span>
<a id="__codelineno-0-937" name="__codelineno-0-937" href="#__codelineno-0-937"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-938" name="__codelineno-0-938" href="#__codelineno-0-938"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-939" name="__codelineno-0-939" href="#__codelineno-0-939"></a>
<a id="__codelineno-0-940" name="__codelineno-0-940" href="#__codelineno-0-940"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-941" name="__codelineno-0-941" href="#__codelineno-0-941"></a>    <span class="k">def</span> <span class="nf">solution_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942" href="#__codelineno-0-942"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-943" name="__codelineno-0-943" href="#__codelineno-0-943"></a><span class="sd">        Get the length of a solution, if this batch is numeric.</span>
<a id="__codelineno-0-944" name="__codelineno-0-944" href="#__codelineno-0-944"></a><span class="sd">        For non-numeric batches (i.e. batches with dtype=object),</span>
<a id="__codelineno-0-945" name="__codelineno-0-945" href="#__codelineno-0-945"></a><span class="sd">        `solution_length` is given as None.</span>
<a id="__codelineno-0-946" name="__codelineno-0-946" href="#__codelineno-0-946"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-947" name="__codelineno-0-947" href="#__codelineno-0-947"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-948" name="__codelineno-0-948" href="#__codelineno-0-948"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-949" name="__codelineno-0-949" href="#__codelineno-0-949"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-950" name="__codelineno-0-950" href="#__codelineno-0-950"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-951" name="__codelineno-0-951" href="#__codelineno-0-951"></a>
<a id="__codelineno-0-952" name="__codelineno-0-952" href="#__codelineno-0-952"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-953" name="__codelineno-0-953" href="#__codelineno-0-953"></a>    <span class="k">def</span> <span class="nf">objective_sense</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectiveSense</span><span class="p">:</span>
<a id="__codelineno-0-954" name="__codelineno-0-954" href="#__codelineno-0-954"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-955" name="__codelineno-0-955" href="#__codelineno-0-955"></a><span class="sd">        Get the objective sense(s) of this batch&#39;s associated Problem.</span>
<a id="__codelineno-0-956" name="__codelineno-0-956" href="#__codelineno-0-956"></a>
<a id="__codelineno-0-957" name="__codelineno-0-957" href="#__codelineno-0-957"></a><span class="sd">        If the problem is single-objective, then a single string is returned.</span>
<a id="__codelineno-0-958" name="__codelineno-0-958" href="#__codelineno-0-958"></a><span class="sd">        If the problem is multi-objective, then the objective senses will be</span>
<a id="__codelineno-0-959" name="__codelineno-0-959" href="#__codelineno-0-959"></a><span class="sd">        returned in a list.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960" href="#__codelineno-0-960"></a>
<a id="__codelineno-0-961" name="__codelineno-0-961" href="#__codelineno-0-961"></a><span class="sd">        The returned string in the single-objective case, or each returned</span>
<a id="__codelineno-0-962" name="__codelineno-0-962" href="#__codelineno-0-962"></a><span class="sd">        string in the multi-objective case, is &quot;min&quot; or &quot;max&quot;.</span>
<a id="__codelineno-0-963" name="__codelineno-0-963" href="#__codelineno-0-963"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-964" name="__codelineno-0-964" href="#__codelineno-0-964"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-965" name="__codelineno-0-965" href="#__codelineno-0-965"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">senses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-966" name="__codelineno-0-966" href="#__codelineno-0-966"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-967" name="__codelineno-0-967" href="#__codelineno-0-967"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">senses</span>
<a id="__codelineno-0-968" name="__codelineno-0-968" href="#__codelineno-0-968"></a>
<a id="__codelineno-0-969" name="__codelineno-0-969" href="#__codelineno-0-969"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-970" name="__codelineno-0-970" href="#__codelineno-0-970"></a>    <span class="k">def</span> <span class="nf">senses</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-971" name="__codelineno-0-971" href="#__codelineno-0-971"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-972" name="__codelineno-0-972" href="#__codelineno-0-972"></a><span class="sd">        Objective sense(s) of this batch&#39;s associated Problem.</span>
<a id="__codelineno-0-973" name="__codelineno-0-973" href="#__codelineno-0-973"></a>
<a id="__codelineno-0-974" name="__codelineno-0-974" href="#__codelineno-0-974"></a><span class="sd">        This is a list of strings, each string being &quot;min&quot; or &quot;max&quot;.</span>
<a id="__codelineno-0-975" name="__codelineno-0-975" href="#__codelineno-0-975"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-976" name="__codelineno-0-976" href="#__codelineno-0-976"></a>
<a id="__codelineno-0-977" name="__codelineno-0-977" href="#__codelineno-0-977"></a>        <span class="k">def</span> <span class="nf">desc_to_sense</span><span class="p">(</span><span class="n">desc</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-978" name="__codelineno-0-978" href="#__codelineno-0-978"></a>            <span class="k">return</span> <span class="s2">&quot;max&quot;</span> <span class="k">if</span> <span class="n">desc</span> <span class="k">else</span> <span class="s2">&quot;min&quot;</span>
<a id="__codelineno-0-979" name="__codelineno-0-979" href="#__codelineno-0-979"></a>
<a id="__codelineno-0-980" name="__codelineno-0-980" href="#__codelineno-0-980"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">desc_to_sense</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span> <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">]</span>
<a id="__codelineno-0-981" name="__codelineno-0-981" href="#__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982" href="#__codelineno-0-982"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-983" name="__codelineno-0-983" href="#__codelineno-0-983"></a>    <span class="k">def</span> <span class="nf">cat</span><span class="p">(</span><span class="n">solution_batches</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-984" name="__codelineno-0-984" href="#__codelineno-0-984"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-985" name="__codelineno-0-985" href="#__codelineno-0-985"></a><span class="sd">        Concatenate multiple SolutionBatch instances into one.</span>
<a id="__codelineno-0-986" name="__codelineno-0-986" href="#__codelineno-0-986"></a>
<a id="__codelineno-0-987" name="__codelineno-0-987" href="#__codelineno-0-987"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-988" name="__codelineno-0-988" href="#__codelineno-0-988"></a><span class="sd">            solution_batches: An Iterable of SolutionBatch objects to</span>
<a id="__codelineno-0-989" name="__codelineno-0-989" href="#__codelineno-0-989"></a><span class="sd">                concatenate.</span>
<a id="__codelineno-0-990" name="__codelineno-0-990" href="#__codelineno-0-990"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-991" name="__codelineno-0-991" href="#__codelineno-0-991"></a><span class="sd">            The result of the concatenation, as a new SolutionBatch.</span>
<a id="__codelineno-0-992" name="__codelineno-0-992" href="#__codelineno-0-992"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-993" name="__codelineno-0-993" href="#__codelineno-0-993"></a>        <span class="n">first</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-994" name="__codelineno-0-994" href="#__codelineno-0-994"></a>        <span class="n">rest</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-995" name="__codelineno-0-995" href="#__codelineno-0-995"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">solution_batches</span><span class="p">):</span>
<a id="__codelineno-0-996" name="__codelineno-0-996" href="#__codelineno-0-996"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-997" name="__codelineno-0-997" href="#__codelineno-0-997"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected a SolutionBatch but got </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-998" name="__codelineno-0-998" href="#__codelineno-0-998"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-999" name="__codelineno-0-999" href="#__codelineno-0-999"></a>                <span class="n">first</span> <span class="o">=</span> <span class="n">batch</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000" href="#__codelineno-0-1000"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001" href="#__codelineno-0-1001"></a>                <span class="n">rest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002" href="#__codelineno-0-1002"></a>        <span class="k">return</span> <span class="n">first</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">rest</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.device" class="doc doc-heading">
<code class="highlight language-python"><span class="n">device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.device" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The device in which the solutions are stored.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.dtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">Type</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.dtype" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The dtype of the decision values of the solutions.</p>
<p>This property exists as an alias for the property
<code>.values_dtype</code>.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.eval_dtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">Type</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.eval_dtype" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The dtype of the evaluation results and extra evaluation data
of the solutions.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.eval_shape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_shape</span><span class="p">:</span> <span class="n">Size</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.eval_shape" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The shape of the batch's evaluation tensor, as a tuple (n, l),
where <code>n</code> is the number of solutions, and <code>l</code> is an integer
which is equal to number of objectives plus the length of the
extra evaluation data, if any.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.evals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">evals</span><span class="p">:</span> <span class="n">Tensor</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.evals" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Evaluation results of the solutions, in a ReadOnlyTensor</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.objective_sense" class="doc doc-heading">
<code class="highlight language-python"><span class="n">objective_sense</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.objective_sense" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the objective sense(s) of this batch's associated Problem.</p>
<p>If the problem is single-objective, then a single string is returned.
If the problem is multi-objective, then the objective senses will be
returned in a list.</p>
<p>The returned string in the single-objective case, or each returned
string in the multi-objective case, is "min" or "max".</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.senses" class="doc doc-heading">
<code class="highlight language-python"><span class="n">senses</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.senses" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Objective sense(s) of this batch's associated Problem.</p>
<p>This is a list of strings, each string being "min" or "max".</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.solution_length" class="doc doc-heading">
<code class="highlight language-python"><span class="n">solution_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.solution_length" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the length of a solution, if this batch is numeric.
For non-numeric batches (i.e. batches with dtype=object),
<code>solution_length</code> is given as None.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.values" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Decision values of the solutions, in a read-only tensor-like object</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.values_dtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">values_dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">Type</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.values_dtype" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The dtype of the decision values of the solutions.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatch.values_shape" class="doc doc-heading">
<code class="highlight language-python"><span class="n">values_shape</span><span class="p">:</span> <span class="n">Size</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.values_shape" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The shape of the batch's decision values tensor, as a tuple (n, l),
where <code>n</code> is the number of solutions, and <code>l</code> is the length
of a single solution.</p>
<p>If <code>dtype=None</code>, then there is no fixed length.
Therefore, the shape is returned as (n,).</p>
    </div>

  </div>










  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.access_evals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">access_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.access_evals" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the internal mutable tensor storing the evaluations.</p>
<p>IMPORTANT: This method exposes the evaluation tensor of the batch
as it is, in mutable mode. It is therefore considered unsafe to rely
on this method. Before using this method, please consider using the
<code>evals</code> property for reading the evaluation results, and using the
<code>set_evals(...)</code> method which allows one to update the evaluations
without exposing any internal tensor.</p>
<p>When this method is used without any argument, the returned tensor
will be of shape <code>(n, m)</code>, where <code>n</code> is the number of solutions,
and <code>m</code> is the number of objectives plus the length of extra
evaluation data.</p>
<p>When this method is used with an integer argument specifying an
objective index, the returned tensor will be 1-dimensional
having a length of <code>n</code>, where <code>n</code> is the number of solutions.
In this case, the returned 1-dimensional tensor will be a view
upon the evaluation results of the specified objective.</p>
<p>The value <code>nan</code> (not-a-number) means not evaluated yet.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>None for getting the entire 2-dimensional evaluation
tensor; an objective index (as integer) for getting a
1-dimensional mutable slice of the evaluation tensor,
the slice being a view upon the evaluation results
regarding the specified objective.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tensor</code></td>
      <td><p>The mutable tensor storing the evaluation information.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">access_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    Get the internal mutable tensor storing the evaluations.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    IMPORTANT: This method exposes the evaluation tensor of the batch</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    as it is, in mutable mode. It is therefore considered unsafe to rely</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    on this method. Before using this method, please consider using the</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    `evals` property for reading the evaluation results, and using the</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    `set_evals(...)` method which allows one to update the evaluations</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    without exposing any internal tensor.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">    When this method is used without any argument, the returned tensor</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    will be of shape `(n, m)`, where `n` is the number of solutions,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    and `m` is the number of objectives plus the length of extra</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    evaluation data.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">    When this method is used with an integer argument specifying an</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    objective index, the returned tensor will be 1-dimensional</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">    having a length of `n`, where `n` is the number of solutions.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">    In this case, the returned 1-dimensional tensor will be a view</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">    upon the evaluation results of the specified objective.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">    The value `nan` (not-a-number) means not evaluated yet.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">        obj_index: None for getting the entire 2-dimensional evaluation</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="sd">            tensor; an objective index (as integer) for getting a</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">            1-dimensional mutable slice of the evaluation tensor,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">            the slice being a view upon the evaluation results</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="sd">            regarding the specified objective.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="sd">        The mutable tensor storing the evaluation information.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>    <span class="k">if</span> <span class="n">obj_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.access_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">access_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">keep_evals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.access_values" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the internal mutable tensor storing the decision values.</p>
<p>IMPORTANT: This method exposes the internal decision values tensor of
the batch as it is, in mutable mode. It is therefore considered unsafe
to rely on this method. Before using this method, please consider
using the <code>values</code> property for reading the decision values, and using
the <code>set_values(...)</code> method which allows one to update the decision
values without exposing any internal tensor.</p>
<p>IMPORTANT: The default assumption of this method is that the tensor
is requested for modification purposes. Therefore, by default, as soon
as this method is called, the evaluation results of the solutions will
be cleared (where clearing means that the evaluation results will be
filled with <code>NaN</code>s).
The reasoning behind this default behavior is to prevent the modified
solutions from having outdated evaluation results.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>keep_evals</code></td>
        <td><code>bool</code></td>
        <td><p>If set as False, the evaluation data of the solutions
will be cleared (i.e. will be filled with <code>NaN</code>s).
If set as True, the existing evaluation data will be kept.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[torch.Tensor, evotorch.tools.objectarray.ObjectArray]</code></td>
      <td><p>The mutable tensor storing the decision values.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">access_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">keep_evals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">]:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    Get the internal mutable tensor storing the decision values.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    IMPORTANT: This method exposes the internal decision values tensor of</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    the batch as it is, in mutable mode. It is therefore considered unsafe</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    to rely on this method. Before using this method, please consider</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    using the `values` property for reading the decision values, and using</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    the `set_values(...)` method which allows one to update the decision</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    values without exposing any internal tensor.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">    IMPORTANT: The default assumption of this method is that the tensor</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    is requested for modification purposes. Therefore, by default, as soon</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    as this method is called, the evaluation results of the solutions will</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    be cleared (where clearing means that the evaluation results will be</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    filled with `NaN`s).</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">    The reasoning behind this default behavior is to prevent the modified</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    solutions from having outdated evaluation results.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">        keep_evals: If set as False, the evaluation data of the solutions</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">            will be cleared (i.e. will be filled with `NaN`s).</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">            If set as True, the existing evaluation data will be kept.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">        The mutable tensor storing the decision values.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_evals</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forget_evals</span><span class="p">()</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.arg_pareto_sort" class="doc doc-heading">
<code class="highlight language-python"><span class="n">arg_pareto_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crowdsort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">crowdsort_upto</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.arg_pareto_sort" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Pareto-sort the solutions in the batch.</p>
<p>The result is a namedtuple consisting of two elements:
<code>fronts</code> and <code>ranks</code>.
Let us assume that we have 5 solutions, and after a
pareto-sorting they ended up in this order:</p>
<div class="highlight"><pre><span></span><code>front 0 (best front) : solution 1, solution 2
front 1              : solution 0, solution 4
front 2 (worst front): solution 3
</code></pre></div>
<p>Considering the example ordering above, the returned
ParetoInfo instance looks like this:</p>
<div class="highlight"><pre><span></span><code>ParetoInfo(
    fronts=[[1, 2], [0, 4], [3]],
    ranks=tensor([1, 0, 0, 2, 1])
)
</code></pre></div>
<p>where <code>fronts</code> stores the solution indices grouped by
pareto fronts; and <code>ranks</code> stores, as a tensor of int64,
the pareto rank for each solution (where 0 means best
rank).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>crowdsort</code></td>
        <td><code>bool</code></td>
        <td><p>If given as True, each front in itself
will be sorted from the least crowding solution
to the most crowding solution.
If given as False, there will be no crowd-sorting.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>crowdsort_upto</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>To be used with <code>crowdsort=True</code>.
If given as an integer n, crowd-sorting will be done
only in the fronts containing the first n solutions
of the population.
If given as None (and if <code>crowdsort=True</code>),
crowd-sorting will be done for each front.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ParetoInfo</code></td>
      <td><p>A ParetoInfo instance</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">arg_pareto_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crowdsort</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">crowdsort_upto</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParetoInfo</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    Pareto-sort the solutions in the batch.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    The result is a namedtuple consisting of two elements:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    `fronts` and `ranks`.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    Let us assume that we have 5 solutions, and after a</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    pareto-sorting they ended up in this order:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">        front 0 (best front) : solution 1, solution 2</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">        front 1              : solution 0, solution 4</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">        front 2 (worst front): solution 3</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    Considering the example ordering above, the returned</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    ParetoInfo instance looks like this:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">        ParetoInfo(</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">            fronts=[[1, 2], [0, 4], [3]],</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">            ranks=tensor([1, 0, 0, 2, 1])</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">        )</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">    where `fronts` stores the solution indices grouped by</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">    pareto fronts; and `ranks` stores, as a tensor of int64,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">    the pareto rank for each solution (where 0 means best</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">    rank).</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">        crowdsort: If given as True, each front in itself</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">            will be sorted from the least crowding solution</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="sd">            to the most crowding solution.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="sd">            If given as False, there will be no crowd-sorting.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="sd">        crowdsort_upto: To be used with `crowdsort=True`.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="sd">            If given as an integer n, crowd-sorting will be done</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="sd">            only in the fronts containing the first n solutions</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="sd">            of the population.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="sd">            If given as None (and if `crowdsort=True`),</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="sd">            crowd-sorting will be done for each front.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="sd">        A ParetoInfo instance</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">NumbaLib</span><span class="o">.</span><span class="n">is_found</span><span class="p">:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>        <span class="n">NumbaLib</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;arg_pareto_sort&quot;</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>    <span class="n">utils</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">utils</span><span class="p">()</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">crowdsort</span><span class="p">:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>        <span class="k">if</span> <span class="n">crowdsort_upto</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>                <span class="s2">&quot;With the argument `crowdsort` provided as False,&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>                <span class="s2">&quot; the argument `crowdsort_upto` was expected as None.&quot;</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>                <span class="s2">&quot; However, `crowdsort_upto` was found to be something&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>                <span class="s2">&quot; other than None.&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>            <span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>        <span class="n">fronts</span><span class="p">,</span> <span class="n">ranks</span> <span class="o">=</span> <span class="n">_pareto_sort</span><span class="p">(</span><span class="n">utils</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>        <span class="k">if</span> <span class="n">crowdsort_upto</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>            <span class="n">crowdsort_upto</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">utils</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>        <span class="n">fronts</span><span class="p">,</span> <span class="n">ranks</span> <span class="o">=</span> <span class="n">_pareto_sort</span><span class="p">(</span><span class="n">utils</span><span class="p">,</span> <span class="n">crowdsort</span><span class="p">,</span> <span class="n">crowdsort_upto</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>    <span class="k">return</span> <span class="n">ParetoInfo</span><span class="p">(</span><span class="n">fronts</span><span class="o">=</span><span class="n">fronts</span><span class="p">,</span> <span class="n">ranks</span><span class="o">=</span><span class="n">ranks</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.argbest" class="doc doc-heading">
<code class="highlight language-python"><span class="n">argbest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.argbest" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return the best solution's index</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>The objective index. Can be passed as None
if the problem is single-objective. Otherwise,
expected as an int.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tensor</code></td>
      <td><p>The index of the best solution.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">argbest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Return the best solution&#39;s index</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">        obj_index: The objective index. Can be passed as None</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">            if the problem is single-objective. Otherwise,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">            expected as an int.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">        The index of the best solution.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optionally_get_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">descending</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">[</span><span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">argf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span> <span class="k">if</span> <span class="n">descending</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmin</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="k">return</span> <span class="n">argf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:,</span> <span class="n">obj_index</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.argsort" class="doc doc-heading">
<code class="highlight language-python"><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.argsort" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return the indices of solutions, sorted from best to worst.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>The objective index. Can be passed as None
if the problem is single-objective. Otherwise,
expected as an int.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tensor</code></td>
      <td><p>A PyTorch tensor, containing the solution indices,
sorted from the best solution to the worst.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">argsort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Return the indices of solutions, sorted from best to worst.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">        obj_index: The objective index. Can be passed as None</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">            if the problem is single-objective. Otherwise,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">            expected as an int.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">        A PyTorch tensor, containing the solution indices,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">        sorted from the best solution to the worst.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optionally_get_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">descending</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">[</span><span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">ev_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:,</span> <span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">ev_col</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="n">descending</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.argworst" class="doc doc-heading">
<code class="highlight language-python"><span class="n">argworst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.argworst" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return the worst solution's index</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>The objective index. Can be passed as None
if the problem is single-objective. Otherwise,
expected as an int.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tensor</code></td>
      <td><p>The index of the worst solution.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">argworst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Return the worst solution&#39;s index</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">        obj_index: The objective index. Can be passed as None</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">            if the problem is single-objective. Otherwise,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">            expected as an int.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">        The index of the worst solution.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optionally_get_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">descending</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">[</span><span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">argf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmin</span> <span class="k">if</span> <span class="n">descending</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="k">return</span> <span class="n">argf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:,</span> <span class="n">obj_index</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.cat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cat</span><span class="p">(</span><span class="n">solution_batches</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#evotorch.core.SolutionBatch.cat" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Concatenate multiple SolutionBatch instances into one.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>solution_batches</code></td>
        <td><code>Iterable</code></td>
        <td><p>An Iterable of SolutionBatch objects to
concatenate.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>SolutionBatch</code></td>
      <td><p>The result of the concatenation, as a new SolutionBatch.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">cat</span><span class="p">(</span><span class="n">solution_batches</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    Concatenate multiple SolutionBatch instances into one.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">        solution_batches: An Iterable of SolutionBatch objects to</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">            concatenate.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">        The result of the concatenation, as a new SolutionBatch.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">first</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">rest</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">solution_batches</span><span class="p">):</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected a SolutionBatch but got </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>            <span class="n">first</span> <span class="o">=</span> <span class="n">batch</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>            <span class="n">rest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="k">return</span> <span class="n">first</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">rest</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.concat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.concat" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Concatenate this SolutionBatch with the other(s).</p>
<p>In this context, concatenation means that the solutions of
this SolutionBatch and of the others are collected in one big
SolutionBatch object.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>other</code></td>
        <td><code>Union[SolutionBatch, Iterable]</code></td>
        <td><p>A SolutionBatch, or a sequence of SolutionBatch objects.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>SolutionBatch</code></td>
      <td><p>A new SolutionBatch object which is the result of the
concatenation.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;SolutionBatch&quot;</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Concatenate this SolutionBatch with the other(s).</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    In this context, concatenation means that the solutions of</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    this SolutionBatch and of the others are collected in one big</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    SolutionBatch object.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">        other: A SolutionBatch, or a sequence of SolutionBatch objects.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">        A new SolutionBatch object which is the result of the</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">        concatenation.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SolutionBatch</span><span class="p">):</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">]</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="n">lst</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="k">return</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="n">merging_of</span><span class="o">=</span><span class="n">lst</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.forget_evals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">forget_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">solutions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.forget_evals" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Forget the evaluations of the solutions.
The evaluation results will be cleared, which means that they will
be filled with <code>NaN</code>s.</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">forget_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">solutions</span><span class="p">:</span> <span class="n">MaybeIndicesOrSlice</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    Forget the evaluations of the solutions.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    The evaluation results will be cleared, which means that they will</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    be filled with `NaN`s.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">if</span> <span class="n">solutions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="n">solutions</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.set_evals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_evals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evals</span><span class="p">,</span> <span class="n">eval_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">solutions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.set_evals" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Set the evaluations of the solutions.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>evals</code></td>
        <td><code>Tensor</code></td>
        <td><p>A numeric tensor which contains the evaluation results.
Acceptable shapes are as follows:
<code>(n,)</code> only to be used for single-objective problems, sets
the evaluation results of the target <code>n</code> solutions, and clears
(where clearing means to fill with NaN values)
extra evaluation data (if the problem has allocations for such
extra evaluation data);
<code>(n,m)</code> where <code>m</code> is the number of objectives, sets the
evaluation results of the target <code>n</code> solutions, and clears
their extra evaluation data;
<code>(n,m+q)</code> where <code>m</code> is the number of objectives and <code>q</code> is the
length of extra evaluation data, sets the evaluation result
and extra data of the target <code>n</code> solutions.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>eval_data</code></td>
        <td><code>Optional[torch.Tensor]</code></td>
        <td><p>To be used only when the problem has extra evaluation
data. Optionally, one can pass the extra evaluation data
separately via this argument (instead of jointly through
a single tensor via <code>evals</code>).
The expected shape of this tensor is <code>(n,q)</code> where <code>n</code>
is the number of solutions and <code>q</code> is the length of the
extra evaluation data.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>solutions</code></td>
        <td><code>Union[int, Iterable[int], slice]</code></td>
        <td><p>Optionally a list of integer indices or an instance
of <code>slice(...)</code>, to be used if one wishes to set the
evaluations of only some of the solutions.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the given tensor has an incompatible shape.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">set_evals</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">evals</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">eval_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">solutions</span><span class="p">:</span> <span class="n">MaybeIndicesOrSlice</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">):</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    Set the evaluations of the solutions.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">        evals: A numeric tensor which contains the evaluation results.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">            Acceptable shapes are as follows:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">            `(n,)` only to be used for single-objective problems, sets</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">            the evaluation results of the target `n` solutions, and clears</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">            (where clearing means to fill with NaN values)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">            extra evaluation data (if the problem has allocations for such</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">            extra evaluation data);</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">            `(n,m)` where `m` is the number of objectives, sets the</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">            evaluation results of the target `n` solutions, and clears</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">            their extra evaluation data;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">            `(n,m+q)` where `m` is the number of objectives and `q` is the</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">            length of extra evaluation data, sets the evaluation result</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">            and extra data of the target `n` solutions.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">        eval_data: To be used only when the problem has extra evaluation</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">            data. Optionally, one can pass the extra evaluation data</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="sd">            separately via this argument (instead of jointly through</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">            a single tensor via `evals`).</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">            The expected shape of this tensor is `(n,q)` where `n`</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="sd">            is the number of solutions and `q` is the length of the</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="sd">            extra evaluation data.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="sd">        solutions: Optionally a list of integer indices or an instance</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="sd">            of `slice(...)`, to be used if one wishes to set the</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="sd">            evaluations of only some of the solutions.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="sd">        ValueError: if the given tensor has an incompatible shape.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    <span class="k">if</span> <span class="n">solutions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>        <span class="n">solutions</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>        <span class="n">num_solutions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>        <span class="n">num_solutions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>    <span class="k">elif</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">solutions</span><span class="p">):</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>        <span class="n">num_solutions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">solutions</span><span class="p">)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>    <span class="n">total_eval_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>    <span class="n">num_objs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>    <span class="n">num_data</span> <span class="o">=</span> <span class="n">total_eval_width</span> <span class="o">-</span> <span class="n">num_objs</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>    <span class="k">if</span> <span class="n">evals</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>        <span class="k">if</span> <span class="n">num_objs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>                <span class="sa">f</span><span class="s2">&quot;The method `set_evals(...)` was given a 1-dimensional tensor.&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>                <span class="sa">f</span><span class="s2">&quot; However, the number of objectives of the problem at hand is </span><span class="si">{</span><span class="n">num_objs</span><span class="si">}</span><span class="s2">, not 1.&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>                <span class="sa">f</span><span class="s2">&quot; 1-dimensional evaluation tensors can only be accepted if the problem&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>                <span class="sa">f</span><span class="s2">&quot; has one objective.&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>            <span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>        <span class="n">evals</span> <span class="o">=</span> <span class="n">evals</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>    <span class="k">elif</span> <span class="n">evals</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>        <span class="k">pass</span>  <span class="c1"># nothing to do here</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>        <span class="k">if</span> <span class="n">num_objs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>                <span class="sa">f</span><span class="s2">&quot;The method `set_evals(...)` received a tensor with </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> dimensions.&quot;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>                <span class="sa">f</span><span class="s2">&quot; Since the problem at hand has only one objective,&quot;</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>                <span class="sa">f</span><span class="s2">&quot; 1-dimensional or 2-dimensional tensors are acceptable, but not </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">-dimensional ones.&quot;</span>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>            <span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>                <span class="sa">f</span><span class="s2">&quot;The method `set_evals(...)` received a tensor with </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> dimensions.&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>                <span class="sa">f</span><span class="s2">&quot; Since the problem at hand has more than one objective (there are </span><span class="si">{</span><span class="n">num_objs</span><span class="si">}</span><span class="s2"> objectives),&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>                <span class="sa">f</span><span class="s2">&quot; only 2-dimensional tensors are acceptable, not </span><span class="si">{</span><span class="n">evals</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">-dimensional ones.&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>            <span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>    <span class="p">[</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">]</span> <span class="o">=</span> <span class="n">evals</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>    <span class="k">if</span> <span class="n">nrows</span> <span class="o">!=</span> <span class="n">num_solutions</span><span class="p">:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>            <span class="sa">f</span><span class="s2">&quot;Trying to set the evaluations of </span><span class="si">{</span><span class="n">num_solutions</span><span class="si">}</span><span class="s2"> solutions, but the given tensor has </span><span class="si">{</span><span class="n">nrows</span><span class="si">}</span><span class="s2"> rows.&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>        <span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>    <span class="k">if</span> <span class="n">eval_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>        <span class="k">if</span> <span class="n">eval_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>                <span class="sa">f</span><span class="s2">&quot;The `eval_data` argument was expected as a 2-dimensional tensor.&quot;</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>                <span class="sa">f</span><span class="s2">&quot; However, the shape of the given `eval_data` is </span><span class="si">{</span><span class="n">eval_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>            <span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>        <span class="k">if</span> <span class="n">eval_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">num_data</span><span class="p">:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>                <span class="sa">f</span><span class="s2">&quot;The `eval_data` argument was expected to have </span><span class="si">{</span><span class="n">num_data</span><span class="si">}</span><span class="s2"> columns.&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>                <span class="sa">f</span><span class="s2">&quot; However, the received `eval_data` has the shape: </span><span class="si">{</span><span class="n">eval_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>            <span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>        <span class="k">if</span> <span class="n">ncols</span> <span class="o">!=</span> <span class="n">num_objs</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>                <span class="sa">f</span><span class="s2">&quot;The method `set_evals(...)` was used with `evals` and `eval_data` arguments.&quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>                <span class="sa">f</span><span class="s2">&quot; When both of these arguments are provided, `evals` is expected either as a 1-dimensional tensor&quot;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>                <span class="sa">f</span><span class="s2">&quot; (for single-objective cases only), or as a tensor of shape (n, m) where n is the number of&quot;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>                <span class="sa">f</span><span class="s2">&quot; solutions, and m is the number of objectives.&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>                <span class="sa">f</span><span class="s2">&quot; However, while the problem at hand has </span><span class="si">{</span><span class="n">num_objs</span><span class="si">}</span><span class="s2"> objectives,&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>                <span class="sa">f</span><span class="s2">&quot; the `evals` tensor has </span><span class="si">{</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns.&quot;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>            <span class="p">)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>        <span class="k">if</span> <span class="n">evals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">eval_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The provided `evals` and `eval_data` tensors have incompatible shapes.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">evals</span><span class="p">,</span> <span class="n">eval_data</span><span class="p">])</span>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>        <span class="k">if</span> <span class="n">ncols</span> <span class="o">==</span> <span class="n">num_objs</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">,</span> <span class="p">:</span><span class="n">num_objs</span><span class="p">]</span> <span class="o">=</span> <span class="n">evals</span>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">,</span> <span class="n">num_objs</span><span class="p">:]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>        <span class="k">elif</span> <span class="n">ncols</span> <span class="o">==</span> <span class="n">total_eval_width</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">evals</span>
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>                <span class="sa">f</span><span class="s2">&quot;The method `set_evals(...)` received a tensor with </span><span class="si">{</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns, which is incompatible.&quot;</span>
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>                <span class="sa">f</span><span class="s2">&quot; Acceptable number of columns are: </span><span class="si">{</span><span class="n">num_objs</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>                <span class="sa">f</span><span class="s2">&quot; (for setting only the objective-associated evaluations and leave extra evaluation data as NaN), or&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">total_eval_width</span><span class="si">}</span><span class="s2"> (for setting both objective-associated evaluations and extra evaluation data).&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a>            <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.set_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">solutions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.set_values" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Set the decision values of the solutions.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>values</code></td>
        <td><code>Any</code></td>
        <td><p>New decision values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>solutions</code></td>
        <td><code>Union[int, Iterable[int], slice]</code></td>
        <td><p>Optionally a list of integer indices or an instance
of <code>slice(...)</code>, to be used if one wishes to set the
decision values of only some of the solutions.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">set_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">solutions</span><span class="p">:</span> <span class="n">MaybeIndicesOrSlice</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    Set the decision values of the solutions.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">        values: New decision values.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">        solutions: Optionally a list of integer indices or an instance</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">            of `slice(...)`, to be used if one wishes to set the</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">            decision values of only some of the solutions.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">if</span> <span class="n">solutions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="n">solutions</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">solutions</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[</span><span class="n">solutions</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.split" class="doc doc-heading">
<code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_pieces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.split" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Split this SolutionBatch into a specified number of pieces,
or into an unspecified number of pieces where the maximum
size of each piece is specified.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>num_pieces</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Can be provided as an integer n, which means
that the this SolutionBatch will be split to n pieces.
Alternatively, can be left as None if the user intends
to set max_size as an integer instead.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_size</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Can be provided as an integer n, which means
that this SolutionBatch will be split to multiple
pieces, each piece containing n solutions at most.
Alternatively, can be left as None if the user intends
to set num_pieces as an integer instead.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>SolutionBatchPieces</code></td>
      <td><p>A SolutionBatchPieces object, which behaves like a list of
SolutionBatch objects, each object in the list being a
slice view of this SolutionBatch object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_pieces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatchPieces&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Split this SolutionBatch into a specified number of pieces,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    or into an unspecified number of pieces where the maximum</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    size of each piece is specified.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">        num_pieces: Can be provided as an integer n, which means</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">            that the this SolutionBatch will be split to n pieces.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">            Alternatively, can be left as None if the user intends</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">            to set max_size as an integer instead.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">        max_size: Can be provided as an integer n, which means</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">            that this SolutionBatch will be split to multiple</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">            pieces, each piece containing n solutions at most.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">            Alternatively, can be left as None if the user intends</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">            to set num_pieces as an integer instead.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">        A SolutionBatchPieces object, which behaves like a list of</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">        SolutionBatch objects, each object in the list being a</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">        slice view of this SolutionBatch object.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="k">return</span> <span class="n">SolutionBatchPieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_pieces</span><span class="o">=</span><span class="n">num_pieces</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="n">max_size</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.take" class="doc doc-heading">
<code class="highlight language-python"><span class="n">take</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.take" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Make a new SolutionBatch containing the specified solutions.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>indices</code></td>
        <td><code>Iterable</code></td>
        <td><p>A sequence of solution indices. These specified
solutions will make it to the newly made SolutionBatch.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>SolutionBatch</code></td>
      <td><p>The new SolutionBatch.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">take</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Make a new SolutionBatch containing the specified solutions.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">        indices: A sequence of solution indices. These specified</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">            solutions will make it to the newly made SolutionBatch.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">        The new SolutionBatch.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">if</span> <span class="n">is_sequence</span><span class="p">(</span><span class="n">indices</span><span class="p">):</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">slice_of</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">))</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Expected a sequence of solution indices, but got a `{type(indices)}`&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.take_best" class="doc doc-heading">
<code class="highlight language-python"><span class="n">take_best</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.take_best" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Make a new SolutionBatch containing the best <code>n</code> solutions.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>n</code></td>
        <td><code>int</code></td>
        <td><p>Number of solutions which will be taken.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Objective index according to which the best ones
will be taken.
If <code>obj_index</code> is left as None and the problem is multi-
objective, then the solutions will be ranked according to
their fronts, and according how crowding they are, and then
the topmost <code>n</code> solutions will be taken.
If <code>obj_index</code> is left as None and the problem is single-
objective, then that single objective will be taken as the
ranking criterion.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>SolutionBatch</code></td>
      <td><p>The new SolutionBatch.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">take_best</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Make a new SolutionBatch containing the best `n` solutions.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">        n: Number of solutions which will be taken.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">        obj_index: Objective index according to which the best ones</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">            will be taken.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">            If `obj_index` is left as None and the problem is multi-</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">            objective, then the solutions will be ranked according to</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">            their fronts, and according how crowding they are, and then</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">            the topmost `n` solutions will be taken.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">            If `obj_index` is left as None and the problem is single-</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">            objective, then that single objective will be taken as the</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">            ranking criterion.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">        The new SolutionBatch.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="k">if</span> <span class="n">obj_index</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="n">fronts</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg_pareto_sort</span><span class="p">(</span><span class="n">crowdsort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">crowdsort_upto</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">fronts</span><span class="p">)[:</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)[:</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">slice_of</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.to" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the counterpart of this SolutionBatch on the new device.</p>
<p>If the specified device is the device of this SolutionBatch,
then this SolutionBatch itself is returned.
If the specified device is a different device, then a clone
of this SolutionBatch on this different device is first
created, and then this new clone is returned.</p>
<p>Please note that the <code>to(...)</code> method is not supported when
the dtype is <code>object</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>device</code></td>
        <td><code>Union[str, torch.device]</code></td>
        <td><p>The device on which the resulting SolutionBatch
will be stored.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>SolutionBatch</code></td>
      <td><p>The SolutionBatch on the specified device.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Device</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SolutionBatch&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Get the counterpart of this SolutionBatch on the new device.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    If the specified device is the device of this SolutionBatch,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    then this SolutionBatch itself is returned.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    If the specified device is a different device, then a clone</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    of this SolutionBatch on this different device is first</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    created, and then this new clone is returned.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    Please note that the `to(...)` method is not supported when</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    the dtype is `object`.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">        device: The device on which the resulting SolutionBatch</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">            will be stored.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">        The SolutionBatch on the specified device.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">ObjectArray</span><span class="p">):</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The `to(...)` method is not supported when the dtype is `object`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="k">if</span> <span class="n">device</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="n">new_batch</span> <span class="o">=</span> <span class="n">SolutionBatch</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>            <span class="n">new_batch</span><span class="o">.</span><span class="n">_data</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>            <span class="n">new_batch</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>        <span class="k">return</span> <span class="n">new_batch</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.utility" class="doc doc-heading">
<code class="highlight language-python"><span class="n">utility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_nans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">using_values_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.utility" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return numeric scores for each solution.</p>
<p>Utility scores are different from evaluation results,
in the sense that utilities monotonically increase from
bad solutions to good solutions, regardless of the
objective sense.</p>
<p><strong>If ranking method is passed as None:</strong>
if the objective sense is 'max', the evaluation results are returned
as the utility scores; otherwise, if the objective sense is 'min',
the evaluation results multiplied by -1 are returned as the
utility scores.</p>
<p><strong>If the name of a ranking method is given</strong> (e.g. 'centered'):
then the solutions are ranked (best solutions having the
highest rank), and those ranks are returned as the utility
scores.</p>
<p><strong>If an objective index is not provided:</strong> (i.e. passed as None)
if the problem is multi-objective, the utility scores
for each objective is given, in a tensor shaped (n, m),
n being the number of solutions and m being the number
of objectives; otherwise, if the problem is single-objective,
the utility scores for each objective is given in a 1-dimensional
tensor of length n, n being the number of solutions.</p>
<p><strong>If an objective index is provided as an int:</strong>
the utility scores are returned in a 1-dimensional tensor
of length n, n being the number of solutions.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>obj_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Expected as None, or as an integer.
In the single-objective case, None is equivalent to 0.
In the multi-objective case, None means "for each
objective".</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ranking_method</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>If the utility scores are to be generated
according to a certain ranking method, pass here the name
of that ranking method as a str (e.g. 'centered').</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>check_nans</code></td>
        <td><code>bool</code></td>
        <td><p>Check for nan (not-a-number) values in the
evaluation results, which is an indication of
unevaluated solutions.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>using_values_dtype</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the utility values will be returned
using the dtype of the decision values.
If False, the utility values will be returned using the dtype
of the evaluation data.
The default is False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tensor</code></td>
      <td><p>Utility scores, in a PyTorch tensor.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">utility</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">obj_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">check_nans</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">using_values_dtype</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    Return numeric scores for each solution.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">    Utility scores are different from evaluation results,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    in the sense that utilities monotonically increase from</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">    bad solutions to good solutions, regardless of the</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    objective sense.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">    **If ranking method is passed as None:**</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    if the objective sense is &#39;max&#39;, the evaluation results are returned</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">    as the utility scores; otherwise, if the objective sense is &#39;min&#39;,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">    the evaluation results multiplied by -1 are returned as the</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">    utility scores.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">    **If the name of a ranking method is given** (e.g. &#39;centered&#39;):</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">    then the solutions are ranked (best solutions having the</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">    highest rank), and those ranks are returned as the utility</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">    scores.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">    **If an objective index is not provided:** (i.e. passed as None)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">    if the problem is multi-objective, the utility scores</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="sd">    for each objective is given, in a tensor shaped (n, m),</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="sd">    n being the number of solutions and m being the number</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="sd">    of objectives; otherwise, if the problem is single-objective,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="sd">    the utility scores for each objective is given in a 1-dimensional</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="sd">    tensor of length n, n being the number of solutions.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="sd">    **If an objective index is provided as an int:**</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="sd">    the utility scores are returned in a 1-dimensional tensor</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="sd">    of length n, n being the number of solutions.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="sd">        obj_index: Expected as None, or as an integer.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="sd">            In the single-objective case, None is equivalent to 0.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="sd">            In the multi-objective case, None means &quot;for each</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="sd">            objective&quot;.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="sd">        ranking_method: If the utility scores are to be generated</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="sd">            according to a certain ranking method, pass here the name</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="sd">            of that ranking method as a str (e.g. &#39;centered&#39;).</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="sd">        check_nans: Check for nan (not-a-number) values in the</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="sd">            evaluation results, which is an indication of</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="sd">            unevaluated solutions.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="sd">        using_values_dtype: If True, the utility values will be returned</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="sd">            using the dtype of the decision values.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="sd">            If False, the utility values will be returned using the dtype</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="sd">            of the evaluation data.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a><span class="sd">            The default is False.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a><span class="sd">        Utility scores, in a PyTorch tensor.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>    <span class="k">if</span> <span class="n">obj_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>        <span class="n">obj_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_obj_index</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>        <span class="n">evdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evdata</span><span class="p">[:,</span> <span class="n">obj_index</span><span class="p">]</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>        <span class="k">if</span> <span class="n">check_nans</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>            <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">evdata</span><span class="p">)):</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>                    <span class="s2">&quot;Cannot compute the utility values, because there are solutions which are not evaluated yet.&quot;</span>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>                <span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>        <span class="k">if</span> <span class="n">ranking_method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">evdata</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_objective_sign</span><span class="p">(</span><span class="n">obj_index</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">rank</span><span class="p">(</span><span class="n">evdata</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span> <span class="n">higher_is_better</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_descending</span><span class="p">[</span><span class="n">obj_index</span><span class="p">])</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>        <span class="k">if</span> <span class="n">using_values_dtype</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">utility</span><span class="p">(</span>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>                <span class="mi">0</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span> <span class="n">check_nans</span><span class="o">=</span><span class="n">check_nans</span><span class="p">,</span> <span class="n">using_values_dtype</span><span class="o">=</span><span class="n">using_values_dtype</span>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>            <span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>                <span class="p">[</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">utility</span><span class="p">(</span>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>                        <span class="n">j</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>                        <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>                        <span class="n">check_nans</span><span class="o">=</span><span class="n">check_nans</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>                        <span class="n">using_values_dtype</span><span class="o">=</span><span class="n">using_values_dtype</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>                    <span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num_objs</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>                <span class="p">],</span>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>            <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatch.utils" class="doc doc-heading">
<code class="highlight language-python"><span class="n">utils</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ranking_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_nans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">using_values_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatch.utils" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return numeric scores for each solution, and for each objective.
Utility scores are different from evaluation results,
in the sense that utilities monotonically increase from
bad solutions to good solutions, regardless of the
objective sense.</p>
<p>Unlike the method called <code>utility(...)</code>, this function returns
a 2-dimensional tensor even when the problem is single-objective.</p>
<p>The result of this method is always a 2-dimensional tensor of
shape <code>(n, m)</code>, <code>n</code> being the number of solutions, <code>m</code> being the
number of objectives.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ranking_method</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>If the utility scores are to be generated
according to a certain ranking method, pass here the name
of that ranking method as a str (e.g. 'centered').</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>check_nans</code></td>
        <td><code>bool</code></td>
        <td><p>Check for nan (not-a-number) values in the
evaluation results, which is an indication of
unevaluated solutions.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>using_values_dtype</code></td>
        <td><code>bool</code></td>
        <td><p>If True, the utility values will be returned
using the dtype of the decision values.
If False, the utility values will be returned using the dtype
of the evaluation data.
The default is False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tensor</code></td>
      <td><p>Utility scores, in a 2-dimensional PyTorch tensor.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="nf">utils</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">ranking_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">check_nans</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">using_values_dtype</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    Return numeric scores for each solution, and for each objective.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    Utility scores are different from evaluation results,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    in the sense that utilities monotonically increase from</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">    bad solutions to good solutions, regardless of the</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">    objective sense.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">    Unlike the method called `utility(...)`, this function returns</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">    a 2-dimensional tensor even when the problem is single-objective.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">    The result of this method is always a 2-dimensional tensor of</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">    shape `(n, m)`, `n` being the number of solutions, `m` being the</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">    number of objectives.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">        ranking_method: If the utility scores are to be generated</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">            according to a certain ranking method, pass here the name</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">            of that ranking method as a str (e.g. &#39;centered&#39;).</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">        check_nans: Check for nan (not-a-number) values in the</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="sd">            evaluation results, which is an indication of</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">            unevaluated solutions.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">        using_values_dtype: If True, the utility values will be returned</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="sd">            using the dtype of the decision values.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="sd">            If False, the utility values will be returned using the dtype</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="sd">            of the evaluation data.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="sd">            The default is False.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="sd">        Utility scores, in a 2-dimensional PyTorch tensor.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">utility</span><span class="p">(</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>        <span class="n">ranking_method</span><span class="o">=</span><span class="n">ranking_method</span><span class="p">,</span> <span class="n">check_nans</span><span class="o">=</span><span class="n">check_nans</span><span class="p">,</span> <span class="n">using_values_dtype</span><span class="o">=</span><span class="n">using_values_dtype</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>    <span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.SolutionBatchPieces" class="doc doc-heading">
        <code>
SolutionBatchPieces            (<span title="collections.abc.Sequence">Sequence</span>)
        </code>



<a href="#evotorch.core.SolutionBatchPieces" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>A collection of SolutionBatch slice views.</p>
<p>An instance of this class behaves like a read-only collection of
SolutionBatch objects (each being a sliced view of a bigger
SolutionBatch).</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span> <span class="nc">SolutionBatchPieces</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;A collection of SolutionBatch slice views.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    An instance of this class behaves like a read-only collection of</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    SolutionBatch objects (each being a sliced view of a bigger</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    SolutionBatch).</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">num_pieces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">        `__init__(...)`: Initialize the SolutionBatchPieces.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">            batch: The SolutionBatch which will be split into</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">                multiple SolutionBatch views.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">                Each view itself is a SolutionBatch object,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">                but not independent, meaning that any modification</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">                done to a SolutionBatch view will reflect on this</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">                main batch.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">            num_pieces: Can be provided as an integer n, which means</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">                that the main SolutionBatch will be split to n pieces.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sd">                Alternatively, can be left as None if the user intends</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="sd">                to set max_size as an integer instead.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="sd">            max_size: Can be provided as an integer n, which means</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="sd">                that the main SolutionBatch will be split to multiple</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="sd">                pieces, each piece containing n solutions at most.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="sd">                Alternatively, can be left as None if the user intends</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="sd">                to set num_pieces as an integer instead.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span> <span class="o">=</span> <span class="n">batch</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SolutionBatch</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_piece_slices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>        <span class="n">total_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>        <span class="k">if</span> <span class="n">max_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num_pieces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>            <span class="n">num_pieces</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_pieces</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>            <span class="c1"># divide to pieces</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>            <span class="n">base_size</span> <span class="o">=</span> <span class="n">total_size</span> <span class="o">//</span> <span class="n">num_pieces</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>            <span class="n">rest</span> <span class="o">=</span> <span class="n">total_size</span> <span class="o">-</span> <span class="p">(</span><span class="n">base_size</span> <span class="o">*</span> <span class="n">num_pieces</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">base_size</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_pieces</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rest</span><span class="p">):</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>        <span class="k">elif</span> <span class="n">max_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num_pieces</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>            <span class="n">max_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_size</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>            <span class="c1"># divide to pieces</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>            <span class="n">num_pieces</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">total_size</span> <span class="o">/</span> <span class="n">max_size</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>            <span class="n">current_total</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pieces</span><span class="p">):</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>                <span class="k">if</span> <span class="n">current_total</span> <span class="o">+</span> <span class="n">max_size</span> <span class="o">&gt;</span> <span class="n">total_size</span><span class="p">:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_size</span> <span class="o">-</span> <span class="n">current_total</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_size</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>                <span class="n">current_total</span> <span class="o">+=</span> <span class="n">max_size</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>        <span class="k">elif</span> <span class="n">max_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num_pieces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected either max_size or num_pieces, received both.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>        <span class="k">elif</span> <span class="n">max_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num_pieces</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected either max_size or num_pieces, received none.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>        <span class="n">current_begin</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>        <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>            <span class="n">current_end</span> <span class="o">=</span> <span class="n">current_begin</span> <span class="o">+</span> <span class="n">size</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_piece_slices</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">current_begin</span><span class="p">,</span> <span class="n">current_end</span><span class="p">))</span>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>            <span class="n">current_begin</span> <span class="o">=</span> <span class="n">current_end</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>        <span class="k">for</span> <span class="n">slice_begin</span><span class="p">,</span> <span class="n">slice_end</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_piece_slices</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="p">[</span><span class="n">slice_begin</span><span class="p">:</span><span class="n">slice_end</span><span class="p">])</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>    <span class="k">def</span> <span class="nf">iter_with_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>        <span class="sd">&quot;&quot;&quot;Iterate over each `(piece, (i_begin, i_end))`</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a><span class="sd">        where `piece` is a SolutionBatch view, `i_begin` is the beginning</span>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a><span class="sd">        index of the SolutionBatch view in the main batch, `j_begin` is the</span>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="sd">        ending index (exclusive) of the SolutionBatch view in the main batch.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="p">)):</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_piece_slices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>    <span class="k">def</span> <span class="nf">indices_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>        <span class="sd">&quot;&quot;&quot;Get `(i_begin, i_end)` for the n-th piece</span>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="sd">        (i.e. the n-th sliced view of the main SolutionBatch)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a><span class="sd">        where `i_begin` is the beginning index of the n-th piece,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a><span class="sd">        `i_end` is the (exclusive) ending index of the n-th piece.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a><span class="sd">            n: Specifies the index of the queried SolutionBatch view.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a><span class="sd">            Beginning and ending indices of the SolutionBatch view,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a><span class="sd">            in a tuple.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_piece_slices</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>    <span class="k">def</span> <span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolutionBatch</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>        <span class="sd">&quot;&quot;&quot;Get the main SolutionBatch object, in its non-split form&quot;&quot;&quot;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>    <span class="k">def</span> <span class="nf">_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">piece</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="p">):</span>
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">piece</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>                <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a>        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a>        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_string</span><span class="p">()</span>
<a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_string</span><span class="p">()</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="evotorch.core.SolutionBatchPieces.batch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">batch</span><span class="p">:</span> <span class="n">SolutionBatch</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#evotorch.core.SolutionBatchPieces.batch" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get the main SolutionBatch object, in its non-split form</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatchPieces.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">num_pieces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.SolutionBatchPieces.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p><code>__init__(...)</code>: Initialize the SolutionBatchPieces.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>batch</code></td>
        <td><code>SolutionBatch</code></td>
        <td><p>The SolutionBatch which will be split into
multiple SolutionBatch views.
Each view itself is a SolutionBatch object,
but not independent, meaning that any modification
done to a SolutionBatch view will reflect on this
main batch.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_pieces</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Can be provided as an integer n, which means
that the main SolutionBatch will be split to n pieces.
Alternatively, can be left as None if the user intends
to set max_size as an integer instead.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_size</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Can be provided as an integer n, which means
that the main SolutionBatch will be split to multiple
pieces, each piece containing n solutions at most.
Alternatively, can be left as None if the user intends
to set num_pieces as an integer instead.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">SolutionBatch</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">num_pieces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    `__init__(...)`: Initialize the SolutionBatchPieces.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">        batch: The SolutionBatch which will be split into</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">            multiple SolutionBatch views.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">            Each view itself is a SolutionBatch object,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">            but not independent, meaning that any modification</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">            done to a SolutionBatch view will reflect on this</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">            main batch.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="sd">        num_pieces: Can be provided as an integer n, which means</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="sd">            that the main SolutionBatch will be split to n pieces.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="sd">            Alternatively, can be left as None if the user intends</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="sd">            to set max_size as an integer instead.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sd">        max_size: Can be provided as an integer n, which means</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="sd">            that the main SolutionBatch will be split to multiple</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="sd">            pieces, each piece containing n solutions at most.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="sd">            Alternatively, can be left as None if the user intends</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="sd">            to set num_pieces as an integer instead.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_batch</span> <span class="o">=</span> <span class="n">batch</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SolutionBatch</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_piece_slices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="n">total_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="p">)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="k">if</span> <span class="n">max_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num_pieces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>        <span class="n">num_pieces</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_pieces</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>        <span class="c1"># divide to pieces</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>        <span class="n">base_size</span> <span class="o">=</span> <span class="n">total_size</span> <span class="o">//</span> <span class="n">num_pieces</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>        <span class="n">rest</span> <span class="o">=</span> <span class="n">total_size</span> <span class="o">-</span> <span class="p">(</span><span class="n">base_size</span> <span class="o">*</span> <span class="n">num_pieces</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">base_size</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_pieces</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rest</span><span class="p">):</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>    <span class="k">elif</span> <span class="n">max_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num_pieces</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>        <span class="n">max_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_size</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>        <span class="c1"># divide to pieces</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>        <span class="n">num_pieces</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">total_size</span> <span class="o">/</span> <span class="n">max_size</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>        <span class="n">current_total</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pieces</span><span class="p">):</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>            <span class="k">if</span> <span class="n">current_total</span> <span class="o">+</span> <span class="n">max_size</span> <span class="o">&gt;</span> <span class="n">total_size</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_size</span> <span class="o">-</span> <span class="n">current_total</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_size</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>            <span class="n">current_total</span> <span class="o">+=</span> <span class="n">max_size</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>    <span class="k">elif</span> <span class="n">max_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num_pieces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected either max_size or num_pieces, received both.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>    <span class="k">elif</span> <span class="n">max_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num_pieces</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected either max_size or num_pieces, received none.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>    <span class="n">current_begin</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>    <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_piece_sizes</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>        <span class="n">current_end</span> <span class="o">=</span> <span class="n">current_begin</span> <span class="o">+</span> <span class="n">size</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_piece_slices</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">current_begin</span><span class="p">,</span> <span class="n">current_end</span><span class="p">))</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>        <span class="n">current_begin</span> <span class="o">=</span> <span class="n">current_end</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>    <span class="k">for</span> <span class="n">slice_begin</span><span class="p">,</span> <span class="n">slice_end</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_piece_slices</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch</span><span class="p">[</span><span class="n">slice_begin</span><span class="p">:</span><span class="n">slice_end</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatchPieces.indices_of" class="doc doc-heading">
<code class="highlight language-python"><span class="n">indices_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatchPieces.indices_of" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get <code>(i_begin, i_end)</code> for the n-th piece
(i.e. the n-th sliced view of the main SolutionBatch)
where <code>i_begin</code> is the beginning index of the n-th piece,
<code>i_end</code> is the (exclusive) ending index of the n-th piece.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>n</code></td>
        <td></td>
        <td><p>Specifies the index of the queried SolutionBatch view.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>tuple</code></td>
      <td><p>Beginning and ending indices of the SolutionBatch view,
in a tuple.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">indices_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Get `(i_begin, i_end)` for the n-th piece</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    (i.e. the n-th sliced view of the main SolutionBatch)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    where `i_begin` is the beginning index of the n-th piece,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    `i_end` is the (exclusive) ending index of the n-th piece.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">        n: Specifies the index of the queried SolutionBatch view.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">        Beginning and ending indices of the SolutionBatch view,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">        in a tuple.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_piece_slices</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatchPieces.iter_with_indices" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iter_with_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#evotorch.core.SolutionBatchPieces.iter_with_indices" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Iterate over each <code>(piece, (i_begin, i_end))</code>
where <code>piece</code> is a SolutionBatch view, <code>i_begin</code> is the beginning
index of the SolutionBatch view in the main batch, <code>j_begin</code> is the
ending index (exclusive) of the SolutionBatch view in the main batch.</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">iter_with_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Iterate over each `(piece, (i_begin, i_end))`</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    where `piece` is a SolutionBatch view, `i_begin` is the beginning</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    index of the SolutionBatch view in the main batch, `j_begin` is the</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    ending index (exclusive) of the SolutionBatch view in the main batch.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="p">)):</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pieces</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_piece_slices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="evotorch.core.SolutionBatchSliceInfo" class="doc doc-heading">
        <code>
SolutionBatchSliceInfo            (<span title="tuple">tuple</span>)
        </code>



<a href="#evotorch.core.SolutionBatchSliceInfo" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>SolutionBatchSliceInfo(source, slice)</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatchSliceInfo.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.SolutionBatchSliceInfo.__getnewargs__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatchSliceInfo.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#evotorch.core.SolutionBatchSliceInfo.__new__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Create new instance of SolutionBatchSliceInfo(source, slice)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="evotorch.core.SolutionBatchSliceInfo.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#evotorch.core.SolutionBatchSliceInfo.__repr__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>evotorch/core.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>








  </div>

    </div>

  </div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../algorithms/searchalgorithm/" class="md-footer__link md-footer__link--prev" aria-label="Previous: searchalgorithm" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              searchalgorithm
            </div>
          </div>
        </a>
      
      
        
        <a href="../decorators/" class="md-footer__link md-footer__link--next" aria-label="Next: evotorch.decorators" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              evotorch.decorators
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 NNAISENSE SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.8492ddcf.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>